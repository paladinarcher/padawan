[{"type":"js","data":"/* Imports for global scope */\n\nMongo = Package.mongo.Mongo;\nReactiveVar = Package['reactive-var'].ReactiveVar;\nTracker = Package.tracker.Tracker;\nDeps = Package.tracker.Deps;\nFlowRouter = Package['kadira:flow-router'].FlowRouter;\nBlazeLayout = Package['kadira:blaze-layout'].BlazeLayout;\nRoles = Package['alanning:roles'].Roles;\n_ = Package.underscore._;\nchai = Package['practicalmeteor:chai'].chai;\nassert = Package['practicalmeteor:chai'].assert;\nexpect = Package['practicalmeteor:chai'].expect;\nshould = Package['practicalmeteor:chai'].should;\n$ = Package.jquery.$;\njQuery = Package.jquery.jQuery;\nSession = Package.session.Session;\nGravatar = Package['jparker:gravatar'].Gravatar;\nMeteor = Package.meteor.Meteor;\nglobal = Package.meteor.global;\nmeteorEnv = Package.meteor.meteorEnv;\nWebApp = Package.webapp.WebApp;\nDDP = Package['ddp-client'].DDP;\nLaunchScreen = Package['launch-screen'].LaunchScreen;\nBlaze = Package.ui.Blaze;\nUI = Package.ui.UI;\nHandlebars = Package.ui.Handlebars;\nSpacebars = Package.spacebars.Spacebars;\nTemplate = Package['templating-runtime'].Template;\nmeteorInstall = Package.modules.meteorInstall;\nmeteorBabelHelpers = Package['babel-runtime'].meteorBabelHelpers;\nPromise = Package.promise.Promise;\nAccountsTemplates = Package['useraccounts:core'].AccountsTemplates;\nAccounts = Package['accounts-base'].Accounts;\nAutoupdate = Package.autoupdate.Autoupdate;\nReload = Package.reload.Reload;\nHTML = Package.htmljs.HTML;\nT9n = Package['softwarerero:accounts-t9n'].T9n;\n\n","servePath":"/global-imports.js"},{"type":"js","data":"var require = meteorInstall({\"imports\":{\"ui\":{\"components\":{\"header\":{\"header.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/header/header.html                                                                            //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.header.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.header.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/header/template.header.js                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"header\");\nTemplate[\"header\"] = new Template(\"Template.header\", (function() {\n  var view = this;\n  return HTML.NAV({\n    class: \"navbar navbar-inverse\"\n  }, \"\\n        \", HTML.DIV({\n    class: \"container-fluid\"\n  }, \"\\n            \", HTML.Raw(\"<!-- Brand and toggle get grouped for better mobile display -->\"), \"\\n            \", HTML.Raw('<div class=\"navbar-header\">\\n                <button type=\"button\" class=\"navbar-toggle collapsed\" data-toggle=\"collapse\" data-target=\"#bs-example-navbar-collapse-1\" aria-expanded=\"false\">\\n                    <span class=\"sr-only\">Toggle navigation</span>\\n                    <span class=\"icon-bar\"></span>\\n                    <span class=\"icon-bar\"></span>\\n                    <span class=\"icon-bar\"></span>\\n                </button>\\n                <a class=\"navbar-brand\" href=\"#\"><img src=\"/img/DevLevelLogoAndWordsWhite.5.25.png\"></a>\\n            </div>'), \"\\n\\n            \", HTML.Raw(\"<!-- Collect the nav links, forms, and other content for toggling -->\"), \"\\n            \", HTML.DIV({\n    class: \"collapse navbar-collapse\",\n    id: \"bs-example-navbar-collapse-1\"\n  }, \"\\n                \", HTML.UL({\n    class: \"nav navbar-nav\"\n  }, \"\\n                    \", HTML.Raw('<li><a href=\"#\" id=\"nav-answerquestions\">Answer Questions</a></li>'), \"\\n                    \", Blaze.If(function() {\n    return Spacebars.dataMustache(view.lookup(\"isInRole\"), \"admin,add-questions\");\n  }, function() {\n    return [ \"\\n                        \", HTML.LI(HTML.A({\n      href: \"#\",\n      id: \"nav-addquestions\"\n    }, \"Add Questions\")), \"\\n                    \" ];\n  }), \"\\n                    \", HTML.Raw('<li><a href=\"#\" id=\"nav-learnshare\">Learn/Share</a></li>'), \"\\n                    \", HTML.Raw('<li><a href=\"#\" id=\"nav-traitdesc\">Trait Descriptions</a></li>'), \"\\n                    \", HTML.Raw('<li><a href=\"#\" id=\"nav-goals\">Goals</a></li>'), \"\\n               \"), \"\\n                \", HTML.UL({\n    class: \"nav navbar-nav navbar-right\"\n  }, \"\\n                    \", HTML.Raw('<li><a href=\"#\" id=\"nav-teams\">Teams</a></li>'), \"\\n                    \", HTML.LI({\n    class: \"\"\n  }, \"\\n                        \", Spacebars.include(view.lookupTemplate(\"notification_list\")), \"\\n                    \"), \"\\n                    \", HTML.LI(\"\\n                        \", HTML.A({\n    name: \"profile\"\n  }, \"\\n                            \", Spacebars.include(view.lookupTemplate(\"personality\")), \"\\n                        \"), \"\\n                    \"), \"\\n                    \", HTML.LI({\n    class: \"dropdown\"\n  }, \"\\n                        \", HTML.Raw('<a href=\"#\" id=\"last-dropdown\" class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-haspopup=\"true\" aria-expanded=\"false\"><span class=\"caret\"></span></a>'), \"\\n                        \", HTML.UL({\n    class: \"dropdown-menu\"\n  }, \"\\n                            \", HTML.LI({\n    class: \"dropdown-item\"\n  }, HTML.H4(Blaze.View(\"lookup:userName\", function() {\n    return Spacebars.mustache(view.lookup(\"userName\"));\n  }))), \"\\n                            \", HTML.Raw('<li class=\"dropdown-item\"><a href=\"#\" id=\"nav-profile\" class=\"nav-link\"><span class=\"glyphicon glyphicon-user\"></span> Profile</a></li>'), \"\\n                            \", HTML.LI({\n    class: \"li-button\"\n  }, Spacebars.include(view.lookupTemplate(\"atNavButton\"))), \"\\n                        \"), \"\\n                    \"), \"\\n               \"), \"\\n            \"), \"\\n            \", HTML.Raw(\"<!-- /.navbar-collapse -->\"), \"\\n        \"), HTML.Raw(\"\\n        <!-- /.container-fluid -->\\n    \"));\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"header.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/header/header.js                                                                              //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./header.html\"));\nlet User;\nmodule.watch(require(\"/imports/api/users/users.js\"), {\n  User(v) {\n    User = v;\n  }\n\n}, 0);\nmodule.watch(require(\"../../components/questions/questions.js\"));\nmodule.watch(require(\"../../components/personality/personality.js\"));\nmodule.watch(require(\"../../components/notification_list/notification_list.js\"));\nlet FlowRouter;\nmodule.watch(require(\"meteor/kadira:flow-router\"), {\n  FlowRouter(v) {\n    FlowRouter = v;\n  }\n\n}, 1);\nTemplate.header.onCreated(function () {\n  this.autorun(() => {\n    this.subscription = this.subscribe('userData', this.teamName, {\n      onStop: function () {\n        console.log(\"User header subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"User header subscription ready! \", arguments, this);\n      }\n    });\n  });\n});\nTemplate.header.helpers({\n  userName() {\n    let u = User.findOne({\n      _id: Meteor.userId()\n    });\n\n    if (u) {\n      return u.MyProfile.fullName('');\n    } else {\n      return \"\";\n    }\n  }\n\n});\nTemplate.header.events({\n  'click a#nav-answerquestions'(event, instance) {\n    event.preventDefault();\n    FlowRouter.go('/questions');\n  },\n\n  'click a#nav-addquestions'(event, instance) {\n    event.preventDefault();\n    FlowRouter.go('/addQuestions/IE');\n  },\n\n  'click a#nav-learnshare'(event, instance) {\n    event.preventDefault();\n    FlowRouter.go('/learnShareList');\n  },\n\n  'click a#nav-teams'(event, instance) {\n    event.preventDefault();\n    FlowRouter.go('/adminTeams');\n  },\n\n  'click a#nav-goals'(event, instance) {\n    event.preventDefault();\n    FlowRouter.go('/goals');\n  },\n\n  'click a#nav-traitdesc'(event, instance) {\n    event.preventDefault();\n    FlowRouter.go('/addTraitDescriptions');\n  },\n\n  'click a#nav-profile'(event, instance) {\n    event.preventDefault();\n    FlowRouter.go('/profile');\n  },\n\n  'click a.navbar-brand'(event, instance) {\n    event.preventDefault();\n    FlowRouter.go('/dashboard');\n  }\n\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"label_list\":{\"label_list.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/label_list/label_list.html                                                                    //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.label_list.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.label_list.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/label_list/template.label_list.js                                                             //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"label_list\");\nTemplate[\"label_list\"] = new Template(\"Template.label_list\", (function() {\n  var view = this;\n  return HTML.DIV({\n    class: \"label-list\"\n  }, \"\\n        \", Blaze.Each(function() {\n    return {\n      _sequence: Spacebars.call(view.lookup(\"items\")),\n      _variable: \"item\"\n    };\n  }, function() {\n    return [ \"\\n            \", HTML.DIV({\n      class: function() {\n        return [ \"label \", Spacebars.mustache(view.lookup(\"labelType\")), \" \", Spacebars.mustache(view.lookup(\"customClass\"), view.lookup(\"item\")) ];\n      },\n      \"data-value\": function() {\n        return Spacebars.mustache(Spacebars.dot(view.lookup(\"item\"), \"value\"));\n      }\n    }, Blaze.View(\"lookup:item.text\", function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"item\"), \"text\"));\n    })), \"\\n        \" ];\n  }), \"\\n    \");\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"label_list.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/label_list/label_list.js                                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./label_list.html\"));\nTemplate.label_list.onCreated(function () {//\n});\nTemplate.label_list.helpers({\n  customClass(item) {\n    if (\"guest\" === item.value.slice(0, 5)) {\n      return \"guest\";\n    } else {\n      return \"\";\n    }\n  }\n\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"loading\":{\"loading.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/loading/loading.html                                                                          //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.loading.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.loading.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/loading/template.loading.js                                                                   //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"loading\");\nTemplate[\"loading\"] = new Template(\"Template.loading\", (function() {\n  var view = this;\n  return HTML.Raw('<span class=\"loading-animation\">\\n        <img src=\"/img/loading.gif\">\\n    </span>');\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"notification_list\":{\"notification_list.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/notification_list/notification_list.html                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.notification_list.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.notification_list.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/notification_list/template.notification_list.js                                               //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"notification_list\");\nTemplate[\"notification_list\"] = new Template(\"Template.notification_list\", (function() {\n  var view = this;\n  return [ HTML.A({\n    href: \"#\",\n    id: \"nav-notifications\",\n    class: function() {\n      return [ \"dropdown-toggle nav-icon \", Spacebars.mustache(view.lookup(\"hasUnread\")) ];\n    },\n    \"data-toggle\": \"dropdown\",\n    role: \"button\",\n    \"aria-haspopup\": \"true\",\n    \"aria-expanded\": \"false\"\n  }, \"\\n        \", HTML.Raw('<img src=\"/img/bell.png\" width=\"25px\" height=\"25px\">'), \"\\n    \"), \"\\n    \", HTML.DIV({\n    class: \"dropdown-menu list-group bg-secondary\"\n  }, \"\\n        \", HTML.Raw('<span class=\"li-heading\"><small>Notifications</small></span>'), \"\\n        \", Blaze.Each(function() {\n    return {\n      _sequence: Spacebars.call(view.lookup(\"notifications\")),\n      _variable: \"notification\"\n    };\n  }, function() {\n    return [ \"\\n            \", HTML.A({\n      href: \"#\",\n      class: function() {\n        return [ \"notification li-notification list-group-item \", Spacebars.mustache(view.lookup(\"read\"), Spacebars.dot(view.lookup(\"notification\"), \"isRead\")), \" align-items-start\" ];\n      },\n      \"data-nid\": function() {\n        return Spacebars.mustache(Spacebars.dot(view.lookup(\"notification\"), \"_id\"));\n      },\n      \"data-action\": function() {\n        return Spacebars.mustache(Spacebars.dot(view.lookup(\"notification\"), \"action\"));\n      }\n    }, \"\\n                \", HTML.DIV({\n      class: \"d-flex w-100 justify-content-between\"\n    }, \"\\n                    \", HTML.H5({\n      class: \"mb-1\"\n    }, Blaze.View(\"lookup:notification.title\", function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"notification\"), \"title\"));\n    })), \"\\n                    \", HTML.SMALL({\n      class: \"text-muted float-right\"\n    }, Blaze.View(\"lookup:when\", function() {\n      return Spacebars.mustache(view.lookup(\"when\"), view.lookup(\"notification\"));\n    })), \"\\n                \"), \"\\n                \", HTML.P({\n      class: \"mb-1\"\n    }, Blaze.View(\"lookup:notification.body\", function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"notification\"), \"body\"));\n    })), \"\\n            \"), \"\\n        \" ];\n  }), \"\\n    \") ];\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"notification_list.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/notification_list/notification_list.js                                                        //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nlet UserNotify;\nmodule.watch(require(\"/imports/api/user_notify/user_notify.js\"), {\n  UserNotify(v) {\n    UserNotify = v;\n  }\n\n}, 0);\nmodule.watch(require(\"./notification_list.html\"));\n\nfunction notificationClickAct(action) {\n  console.log(action);\n\n  switch (action[0]) {\n    case \"learnshare\":\n      FlowRouter.go('/learnShare/' + action[1]);\n      break;\n\n    case \"teams\":\n      if (action.length > 1) {\n        FlowRouter.go('/adminTeams/' + action[1]);\n      } else {\n        FlowRouter.go('/adminTeams');\n      }\n\n      break;\n\n    case \"teamgoals\":\n      FlowRouter.go('/teamGoals/' + action[1]);\n      break;\n  }\n}\n\nTemplate.notification_list.onCreated(function () {\n  this.autorun(() => {\n    console.log(\"autorunning notification_list...\");\n    this.subscription = this.subscribe('notificationList', Meteor.userId(), {\n      onStop: function () {\n        console.log(\"Notification List subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"Notification List subscription ready! \", arguments, this);\n      }\n    });\n    console.log(this.subscription);\n  });\n});\nTemplate.notification_list.helpers({\n  notifications() {\n    let MAX_NOTIFICATIONS = 6;\n    let n = UserNotify.find({\n      userId: Meteor.userId()\n    }, {\n      sort: {\n        createdDate: -1\n      }\n    });\n\n    if (n) {\n      let noteList = [];\n      n.forEach(function (note) {\n        if (noteList.length < MAX_NOTIFICATIONS) {\n          noteList.push(note);\n        } else if (noteList.length === MAX_NOTIFICATIONS) {\n          noteList.push({\n            title: \"\",\n            body: \"See all notifications...\",\n            isRead: true,\n            action: \"notifications:all\"\n          });\n        }\n\n        if (!note.isPushed) {\n          if (new Date() - note.createdDate > 1000 * 60) {\n            //too old, don't send push notification\n            note.markNotified();\n          } else {\n            note.pushNotify({\n              onclick: function (event) {\n                let nid = event.target.data;\n                let un = UserNotify.findOne({\n                  _id: nid\n                });\n                un.markRead();\n                event.target.close();\n                notificationClickAct(un.action.split(\":\"));\n              }\n            });\n            note.markNotified();\n          }\n        }\n      });\n      return noteList;\n    } else {\n      return [];\n    }\n  },\n\n  when(note) {\n    let secondsAgo = (new Date() - note.createdDate) / 1000;\n\n    if (secondsAgo < 2) {\n      return \"Just now\";\n    } else if (secondsAgo < 60) {\n      return \"s\";\n    } else if (secondsAgo < 60 * 60) {\n      return parseInt(secondsAgo / 60) + \"m\";\n    } else if (secondsAgo < 60 * 60 * 24) {\n      return parseInt(secondsAgo / (60 * 60)) + \"h\";\n    } else if (typeof note.createdDate !== 'undefined') {\n      return note.createdDate.toLocaleDateString(\"en-US\");\n    } else {\n      return \"\";\n    }\n  },\n\n  read(is) {\n    if (is) {\n      //return \"list-group-item-secondary\";\n      return \"\";\n    } else {\n      return \"list-group-item-info\";\n    }\n  },\n\n  hasUnread() {\n    let n = UserNotify.find({\n      userId: Meteor.userId(),\n      isRead: false\n    });\n\n    if (n && n.fetch().length) {\n      return \"unread\";\n    } else {\n      return \"\";\n    }\n  }\n\n});\nTemplate.notification_list.events({\n  'click a.notification'(event, instance) {\n    event.preventDefault();\n    let $target = $(event.target);\n    let $li = $target.closest(\"[data-action]\");\n    let noteActionStr = $li.data(\"action\");\n    let nid = $li.data(\"nid\");\n    let noteAction = noteActionStr.split(\":\");\n    let un = UserNotify.findOne({\n      _id: nid\n    });\n    un.markRead();\n    notificationClickAct(noteAction);\n  }\n\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"personality\":{\"personality.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/personality/personality.html                                                                  //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.personality.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.personality.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/personality/template.personality.js                                                           //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"personality\");\nTemplate[\"personality\"] = new Template(\"Template.personality\", (function() {\n  var view = this;\n  return [ HTML.SCRIPT(\"\\n        $(document).ready(function(){\\n          $('[data-toggle=\\\"tooltip\\\"]').tooltip();\\n        });\\n    \"), \"\\n    \", HTML.DIV({\n    class: \"personality-display\",\n    style: \"cursor:pointer;color:white;font-weight:bold;display:inline-block;background-color:rgba(255,255,255,0.1)\"\n  }, \"\\n        \", Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"isMinMet\"));\n  }, function() {\n    return [ \"\\n            \", HTML.SPAN({\n      class: \"cat-letter-rows\"\n    }, \"\\n                \", HTML.DIV(\"\\n                    \", HTML.SPAN({\n      class: \"cat-ie cat-disp\",\n      style: function() {\n        return [ \"background-color:rgba(71, 63, 255, \", Spacebars.mustache(view.lookup(\"opacityByCategory\"), 0, view.lookup(\"user\")), \");padding:5px;\" ];\n      },\n      \"data-toggle\": \"tooltip\",\n      \"data-placement\": \"bottom\",\n      title: function() {\n        return [ Spacebars.mustache(view.lookup(\"percentByCategory\"), 0, view.lookup(\"user\")), \"%\" ];\n      }\n    }, Blaze.View(\"lookup:letterByCategory\", function() {\n      return Spacebars.mustache(view.lookup(\"letterByCategory\"), 0, view.lookup(\"user\"));\n    })), \"\\n                    \", HTML.SPAN({\n      class: \"cat-ns cat-disp\",\n      style: function() {\n        return [ \"background-color:rgba(71, 63, 255, \", Spacebars.mustache(view.lookup(\"opacityByCategory\"), 1, view.lookup(\"user\")), \");padding:5px;\" ];\n      },\n      \"data-toggle\": \"tooltip\",\n      \"data-placement\": \"bottom\",\n      title: function() {\n        return [ Spacebars.mustache(view.lookup(\"percentByCategory\"), 1, view.lookup(\"user\")), \"%\" ];\n      }\n    }, Blaze.View(\"lookup:letterByCategory\", function() {\n      return Spacebars.mustache(view.lookup(\"letterByCategory\"), 1, view.lookup(\"user\"));\n    })), \"\\n                    \", HTML.SPAN({\n      class: \"cat-tf cat-disp\",\n      style: function() {\n        return [ \"background-color:rgba(71, 63, 255, \", Spacebars.mustache(view.lookup(\"opacityByCategory\"), 2, view.lookup(\"user\")), \");padding:5px;\" ];\n      },\n      \"data-toggle\": \"tooltip\",\n      \"data-placement\": \"bottom\",\n      title: function() {\n        return [ Spacebars.mustache(view.lookup(\"percentByCategory\"), 2, view.lookup(\"user\")), \"%\" ];\n      }\n    }, Blaze.View(\"lookup:letterByCategory\", function() {\n      return Spacebars.mustache(view.lookup(\"letterByCategory\"), 2, view.lookup(\"user\"));\n    })), \"\\n                    \", HTML.SPAN({\n      class: \"cat-jp cat-disp\",\n      style: function() {\n        return [ \"background-color:rgba(71, 63, 255, \", Spacebars.mustache(view.lookup(\"opacityByCategory\"), 3, view.lookup(\"user\")), \");padding:5px;\" ];\n      },\n      \"data-toggle\": \"tooltip\",\n      \"data-placement\": \"bottom\",\n      title: function() {\n        return [ Spacebars.mustache(view.lookup(\"percentByCategory\"), 3, view.lookup(\"user\")), \"%\" ];\n      }\n    }, Blaze.View(\"lookup:letterByCategory\", function() {\n      return Spacebars.mustache(view.lookup(\"letterByCategory\"), 3, view.lookup(\"user\"));\n    })), \"\\n                \"), \"\\n                \", HTML.DIV(\"\\n                    \", HTML.SPAN({\n      class: \"cat-ie cat-pct cat-disp\",\n      style: function() {\n        return [ \"background-color:rgba(71, 63, 255, \", Spacebars.mustache(view.lookup(\"opacityByCategory\"), 0, view.lookup(\"user\")), \");\" ];\n      },\n      \"data-toggle\": \"tooltip\",\n      \"data-placement\": \"bottom\",\n      title: function() {\n        return [ Spacebars.mustache(view.lookup(\"percentByCategory\"), 0, view.lookup(\"user\")), \"%\" ];\n      }\n    }, Blaze.View(\"lookup:percentByCategory\", function() {\n      return Spacebars.mustache(view.lookup(\"percentByCategory\"), 0, view.lookup(\"user\"));\n    }), \"%\"), \"\\n                    \", HTML.SPAN({\n      class: \"cat-ns cat-pct cat-disp\",\n      style: function() {\n        return [ \"background-color:rgba(71, 63, 255, \", Spacebars.mustache(view.lookup(\"opacityByCategory\"), 1, view.lookup(\"user\")), \");\" ];\n      },\n      \"data-toggle\": \"tooltip\",\n      \"data-placement\": \"bottom\",\n      title: function() {\n        return [ Spacebars.mustache(view.lookup(\"percentByCategory\"), 1, view.lookup(\"user\")), \"%\" ];\n      }\n    }, Blaze.View(\"lookup:percentByCategory\", function() {\n      return Spacebars.mustache(view.lookup(\"percentByCategory\"), 1, view.lookup(\"user\"));\n    }), \"%\"), \"\\n                    \", HTML.SPAN({\n      class: \"cat-tf cat-pct cat-disp\",\n      style: function() {\n        return [ \"background-color:rgba(71, 63, 255, \", Spacebars.mustache(view.lookup(\"opacityByCategory\"), 2, view.lookup(\"user\")), \");\" ];\n      },\n      \"data-toggle\": \"tooltip\",\n      \"data-placement\": \"bottom\",\n      title: function() {\n        return [ Spacebars.mustache(view.lookup(\"percentByCategory\"), 2, view.lookup(\"user\")), \"%\" ];\n      }\n    }, Blaze.View(\"lookup:percentByCategory\", function() {\n      return Spacebars.mustache(view.lookup(\"percentByCategory\"), 2, view.lookup(\"user\"));\n    }), \"%\"), \"\\n                    \", HTML.SPAN({\n      class: \"cat-jp cat-pct cat-disp\",\n      style: function() {\n        return [ \"background-color:rgba(71, 63, 255, \", Spacebars.mustache(view.lookup(\"opacityByCategory\"), 3, view.lookup(\"user\")), \");\" ];\n      },\n      \"data-toggle\": \"tooltip\",\n      \"data-placement\": \"bottom\",\n      title: function() {\n        return [ Spacebars.mustache(view.lookup(\"percentByCategory\"), 3, view.lookup(\"user\")), \"%\" ];\n      }\n    }, Blaze.View(\"lookup:percentByCategory\", function() {\n      return Spacebars.mustache(view.lookup(\"percentByCategory\"), 3, view.lookup(\"user\"));\n    }), \"%\"), \"\\n                \"), \"\\n            \"), \"\\n        \" ];\n  }, function() {\n    return [ \"\\n            \", HTML.SPAN({\n      \"data-toggle\": \"tooltip\",\n      \"data-placement\": \"bottom\",\n      title: \"Minimum remaining questions\"\n    }, Blaze.View(\"lookup:remainingMinQCount\", function() {\n      return Spacebars.mustache(view.lookup(\"remainingMinQCount\"));\n    })), \"\\n        \" ];\n  }), \"\\n        \", HTML.IMG({\n    src: function() {\n      return Spacebars.mustache(view.lookup(\"userImageUrl\"), view.lookup(\"user\"));\n    },\n    class: \"img-circle\"\n  }), \"\\n    \"), \"\\n    \", HTML.DIV({\n    class: \"modal fade\",\n    id: \"personality-readings\",\n    tabindex: \"-1\",\n    role: \"dialog\"\n  }, \"\\n        \", Blaze._TemplateWith(function() {\n    return {\n      source: Spacebars.call(\"personality\")\n    };\n  }, function() {\n    return Spacebars.include(view.lookupTemplate(\"select_feedback\"));\n  }), \"\\n        \", HTML.DIV({\n    class: \"modal-dialog\",\n    role: \"document\",\n    style: \"margin:auto auto;\"\n  }, \"\\n            \", HTML.DIV({\n    class: \"modal-content\"\n  }, \"\\n                \", HTML.DIV({\n    class: \"modal-header\"\n  }, \"\\n                    \", HTML.Raw('<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>'), \"\\n                    \", HTML.H4({\n    class: \"modal-title\",\n    style: \"color:#898;font-weight:bold;background-color:rgba(255,255,255,0.1)\"\n  }, \"\\n                      \", HTML.SPAN({\n    class: \"cat-ie\",\n    style: function() {\n      return [ \"background-color:rgba(71, 63, 255, \", Spacebars.mustache(view.lookup(\"opacityByCategory\"), 0, view.lookup(\"user\")), \");padding:5px;\" ];\n    }\n  }, Blaze.View(\"lookup:letterByCategory\", function() {\n    return Spacebars.mustache(view.lookup(\"letterByCategory\"), 0, view.lookup(\"user\"));\n  })), \"\\n                      \", HTML.SPAN({\n    class: \"cat-ns\",\n    style: function() {\n      return [ \"background-color:rgba(71, 63, 255, \", Spacebars.mustache(view.lookup(\"opacityByCategory\"), 1, view.lookup(\"user\")), \");padding:5px;\" ];\n    }\n  }, Blaze.View(\"lookup:letterByCategory\", function() {\n    return Spacebars.mustache(view.lookup(\"letterByCategory\"), 1, view.lookup(\"user\"));\n  })), \"\\n                      \", HTML.SPAN({\n    class: \"cat-tf\",\n    style: function() {\n      return [ \"background-color:rgba(71, 63, 255, \", Spacebars.mustache(view.lookup(\"opacityByCategory\"), 2, view.lookup(\"user\")), \");padding:5px;\" ];\n    }\n  }, Blaze.View(\"lookup:letterByCategory\", function() {\n    return Spacebars.mustache(view.lookup(\"letterByCategory\"), 2, view.lookup(\"user\"));\n  })), \"\\n                      \", HTML.SPAN({\n    class: \"cat-jp\",\n    style: function() {\n      return [ \"background-color:rgba(71, 63, 255, \", Spacebars.mustache(view.lookup(\"opacityByCategory\"), 3, view.lookup(\"user\")), \");padding:5px;\" ];\n    }\n  }, Blaze.View(\"lookup:letterByCategory\", function() {\n    return Spacebars.mustache(view.lookup(\"letterByCategory\"), 3, view.lookup(\"user\"));\n  })), \"\\n                    \"), \"\\n                \"), \"\\n                \", HTML.DIV({\n    class: \"modal-body\",\n    style: \"color:#333;\"\n  }, \"\\n                    \", Blaze.Each(function() {\n    return {\n      _sequence: Spacebars.call(view.lookup(\"readings\")),\n      _variable: \"reading\"\n    };\n  }, function() {\n    return [ \"\\n                        \", Blaze._TemplateWith(function() {\n      return {\n        reading: Spacebars.call(view.lookup(\"reading\"))\n      };\n    }, function() {\n      return Spacebars.include(view.lookupTemplate(\"singleReading\"));\n    }), \"\\n                    \" ];\n  }), \"\\n                \"), \"\\n                \", HTML.Raw('<div class=\"modal-footer\">\\n                    <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Close</button>\\n                </div>'), \"\\n            \"), HTML.Raw(\"<!-- /.modal-content -->\"), \"\\n        \"), HTML.Raw(\"<!-- /.modal-dialog -->\"), \"\\n    \"), HTML.Raw(\"<!-- /.modal -->\") ];\n}));\n\nTemplate.__checkName(\"singleReading\");\nTemplate[\"singleReading\"] = new Template(\"Template.singleReading\", (function() {\n  var view = this;\n  return [ Blaze.View(\"lookup:getHSize\", function() {\n    return Spacebars.makeRaw(Spacebars.mustache(view.lookup(\"getHSize\"), view.lookup(\"reading\")));\n  }), \"\\n    \", HTML.P({\n    style: \"text-align:justify;\"\n  }, Blaze.View(\"lookup:reading.Body\", function() {\n    return Spacebars.mustache(Spacebars.dot(view.lookup(\"reading\"), \"Body\"));\n  })) ];\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"personality.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/personality/personality.js                                                                    //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nlet Question;\nmodule.watch(require(\"/imports/api/questions/questions.js\"), {\n  Question(v) {\n    Question = v;\n  }\n\n}, 0);\nlet User, Profile, UserType, MyersBriggs, Answer;\nmodule.watch(require(\"/imports/api/users/users.js\"), {\n  User(v) {\n    User = v;\n  },\n\n  Profile(v) {\n    Profile = v;\n  },\n\n  UserType(v) {\n    UserType = v;\n  },\n\n  MyersBriggs(v) {\n    MyersBriggs = v;\n  },\n\n  Answer(v) {\n    Answer = v;\n  }\n\n}, 1);\nlet TypeReading;\nmodule.watch(require(\"/imports/api/type_readings/type_readings.js\"), {\n  TypeReading(v) {\n    TypeReading = v;\n  }\n\n}, 2);\nlet Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 3);\nmodule.watch(require(\"./personality.html\"));\nvar minQuestionsAnswered = 72;\nTemplate.personality.onCreated(function () {\n  if (this.data.userId) {\n    this.userId = this.data.userId;\n  } else {\n    this.userId = Meteor.userId();\n  }\n\n  this.autorun(() => {\n    console.log(\"autorunning...\");\n    this.subscription = this.subscribe('userData', this.userId, {\n      onStop: function () {\n        console.log(\"Subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"Subscription ready! \", arguments, this);\n      }\n    });\n    console.log(this.subscription);\n    this.subscription2 = this.subscribe('typereadings.myReadings', this.userId, {\n      onStop: function () {\n        console.log(\"Readings subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"Readings subscription ready! \", arguments, this);\n      }\n    });\n    console.log(this.subscription2);\n  });\n});\nTemplate.personality.helpers({\n  readings() {\n    let tr = TypeReading.find({});\n    console.log(\"1234\", tr.fetch());\n    return tr;\n  },\n\n  user() {\n    return User.findOne({\n      _id: Template.instance().userId\n    });\n  },\n\n  isMinMet() {\n    let u = User.findOne({\n      _id: Template.instance().userId\n    });\n    if (!u) return false;\n    console.log(u);\n\n    if (u.MyProfile.UserType.AnsweredQuestions.length >= minQuestionsAnswered) {\n      return true;\n    } else {\n      return false;\n    }\n\n    return false;\n  },\n\n  remainingMinQCount() {\n    let u = User.findOne({\n      _id: Template.instance().userId\n    });\n    console.log(u);\n    if (!u) return -1;\n    let rmn = Math.max(0, minQuestionsAnswered - u.MyProfile.UserType.AnsweredQuestions.length);\n    console.log(\"yyyyy\", minQuestionsAnswered, u.MyProfile.UserType.AnsweredQuestions.length, rmn); //let rmn = 0;\n\n    return rmn;\n  },\n\n  opacityByCategory(category, userObj) {\n    //console.log(category, userObj); //return;\n    if (typeof userObj === \"undefined\") return false;\n    var value = userObj.MyProfile.UserType.Personality[userObj.MyProfile.UserType.Personality.getIdentifierById(category)]; //console.log(value);\n\n    return Math.abs(value.Value) * 2 / 100;\n  },\n\n  percentByCategory(category, userObj) {\n    if (typeof userObj === \"undefined\") return false;\n    var value = userObj.MyProfile.UserType.Personality[userObj.MyProfile.UserType.Personality.getIdentifierById(category)];\n    console.log(\"555555\", value);\n    return Math.round(Math.abs(value.Value) * 2);\n  },\n\n  letterByCategory(category, userObj) {\n    //console.log(category, userObj); //return;\n    if (typeof userObj === \"undefined\") return false;\n    var identifier = userObj.MyProfile.UserType.Personality.getIdentifierById(category);\n    var value = userObj.MyProfile.UserType.Personality[identifier].Value;\n    console.log(category, value, identifier);\n\n    if (userObj.MyProfile.UserType.AnsweredQuestions.length >= minQuestionsAnswered) {\n      return value === 0 ? \"?\" : value < 0 ? identifier.slice(0, 1) : identifier.slice(1, 2);\n    } else {\n      return \"?\";\n    }\n  },\n\n  userImageUrl(userObj) {\n    if (typeof userObj === \"undefined\") return false;\n    return Gravatar.imageUrl(userObj.emails[0].address, {\n      size: 50,\n      default: 'mm'\n    });\n  }\n\n});\nTemplate.personality.events({\n  'click div.personality-display'(event, instance) {\n    console.log('click div.personality-display =>', event, instance);\n    $('#personality-readings').modal('show'); //$('.Selected-Category').html(newCat);\n  }\n\n});\nTemplate.singleReading.helpers({\n  getHSize(reading) {\n    console.log(\"asdf\", reading);\n    let count = delta = 0;\n\n    _.forEach(reading.TypeReadingCategories, cat => {\n      if (cat == null) {\n        return;\n      }\n\n      count++;\n      delta += cat.Range.Delta;\n    });\n\n    delta /= count;\n\n    if (!reading.Header) {\n      return \"\";\n    }\n\n    if (delta >= 50) {\n      return \"<h1>\" + reading.Header + \"</h1>\";\n    }\n\n    if (delta >= 40) {\n      return \"<h2>\" + reading.Header + \"</h2>\";\n    }\n\n    if (delta >= 30) {\n      return \"<h3>\" + reading.Header + \"</h3>\";\n    }\n\n    if (delta >= 20) {\n      return \"<h4>\" + reading.Header + \"</h4>\";\n    }\n\n    if (delta >= 10) {\n      return \"<h5>\" + reading.Header + \"</h5>\";\n    }\n\n    return \"<h6>\" + reading.Header + \"</h6>\";\n  }\n\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"questions\":{\"questions.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/questions/questions.html                                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.questions.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.questions.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/questions/template.questions.js                                                               //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"questions\");\nTemplate[\"questions\"] = new Template(\"Template.questions\", (function() {\n  var view = this;\n  return [ HTML.DIV({\n    style: \"position:fixed;top:80px;left:10px;background-color:silver;font-size:small;padding:5px;border-radius:3px;max-width:180px;\"\n  }, \"\\n        \", Blaze.If(function() {\n    return Spacebars.dataMustache(view.lookup(\"isRemainingGreaterThan\"), 10);\n  }, function() {\n    return [ \"\\n            Answer at least \", Blaze.View(\"lookup:remainingMinQCount\", function() {\n      return Spacebars.mustache(view.lookup(\"remainingMinQCount\"));\n    }), \" more to see your personality reading\\n        \" ];\n  }, function() {\n    return [ \"\\n            \", Blaze.If(function() {\n      return Spacebars.dataMustache(view.lookup(\"isRemainingGreaterThan\"), 0);\n    }, function() {\n      return [ \"\\n                You're almost there! Only \", Blaze.View(\"lookup:remainingMinQCount\", function() {\n        return Spacebars.mustache(view.lookup(\"remainingMinQCount\"));\n      }), \" questions remain to see your personality readin\\n            \" ];\n    }, function() {\n      return \"\\n                Congratulations! Your personality reading is ready with the minimum questions answered. As you continue answering questions, the accuracy of your reading will improve.\\n            \";\n    }), \"\\n        \" ];\n  }), \"\\n    \"), \"\\n    \", HTML.DIV({\n    style: \"position:fixed;top:80px;left:200px;background-color:silver;font-size:small;padding:5px;border-radius:3px;max-width:180px;\"\n  }, \"\\n        \", HTML.DIV(\"Answered: \", Blaze.View(\"lookup:answeredQuestionsLength\", function() {\n    return Spacebars.mustache(view.lookup(\"answeredQuestionsLength\"));\n  }), HTML.Raw(\"<br>\")), \"\\n        \", HTML.DIV({\n    id: \"allQuestions\"\n  }, \"Total questions: \", Blaze.View(\"lookup:totalQuestions\", function() {\n    return Spacebars.mustache(view.lookup(\"totalQuestions\"));\n  })), \"\\n    \"), HTML.Raw('\\n    <div class=\"row text-center\" style=\"margin-right:0px;\">\\n        <div class=\"col-md-12\">\\n            <h4>\\n                Move each slider towards the side that best describes you.\\n                <small></small>\\n            </h4>\\n        </div>\\n    </div>\\n    '), HTML.DIV({\n    class: \"row\",\n    style: \"margin-right:0px;\"\n  }, \"\\n        \", HTML.DIV({\n    class: \"col-md-12\"\n  }, \"\\n            \", HTML.DIV({\n    class: \"well-large\"\n  }, \"\\n            \", Blaze.Each(function() {\n    return {\n      _sequence: Spacebars.call(view.lookup(\"questions\")),\n      _variable: \"question\"\n    };\n  }, function() {\n    return [ \"\\n                \", Blaze._TemplateWith(function() {\n      return {\n        index: Spacebars.call(view.lookup(\"@index\")),\n        question: Spacebars.call(view.lookup(\"question\"))\n      };\n    }, function() {\n      return Spacebars.include(view.lookupTemplate(\"getTemplate\"));\n    }), \"\\n            \" ];\n  }), \"\\n            \"), \"\\n        \"), \"\\n    \"), \"\\n    \", Spacebars.include(view.lookupTemplate(\"footer\")) ];\n}));\n\nTemplate.__checkName(\"questionTemplate\");\nTemplate[\"questionTemplate\"] = new Template(\"Template.questionTemplate\", (function() {\n  var view = this;\n  return Blaze._TemplateWith(function() {\n    return {\n      question: Spacebars.call(view.lookup(\"question\")),\n      reversed: Spacebars.call(false),\n      rightText: Spacebars.call(Spacebars.dot(view.lookup(\"question\"), \"RightText\")),\n      leftText: Spacebars.call(Spacebars.dot(view.lookup(\"question\"), \"LeftText\"))\n    };\n  }, function() {\n    return Spacebars.include(view.lookupTemplate(\"question\"));\n  });\n}));\n\nTemplate.__checkName(\"questionTemplateReversed\");\nTemplate[\"questionTemplateReversed\"] = new Template(\"Template.questionTemplateReversed\", (function() {\n  var view = this;\n  return Blaze._TemplateWith(function() {\n    return {\n      question: Spacebars.call(view.lookup(\"question\")),\n      reversed: Spacebars.call(true),\n      rightText: Spacebars.call(Spacebars.dot(view.lookup(\"question\"), \"LeftText\")),\n      leftText: Spacebars.call(Spacebars.dot(view.lookup(\"question\"), \"RightText\"))\n    };\n  }, function() {\n    return Spacebars.include(view.lookupTemplate(\"question\"));\n  });\n}));\n\nTemplate.__checkName(\"question\");\nTemplate[\"question\"] = new Template(\"Template.question\", (function() {\n  var view = this;\n  return HTML.DIV({\n    \"data-id\": function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"question\"), \"_id\"));\n    },\n    \"data-reversed\": function() {\n      return Spacebars.mustache(view.lookup(\"reversed\"));\n    },\n    class: \"answer-question\",\n    \"data-readings\": function() {\n      return Spacebars.mustache(view.lookup(\"getReadingsAsJSON\"), view.lookup(\"question\"));\n    },\n    style: \"padding: 10px;\"\n  }, \"\\n                \", HTML.DIV({\n    class: \"row\",\n    style: \"text-align: center;\"\n  }, \"\\n                    \", HTML.DIV({\n    class: \"col-md-12\"\n  }, HTML.EM({\n    style: \"visibility: hidden\"\n  }, Blaze.View(\"lookup:question.Text\", function() {\n    return Spacebars.mustache(Spacebars.dot(view.lookup(\"question\"), \"Text\"));\n  }))), \"\\n                \"), \"\\n                \", HTML.DIV({\n    class: \"row\",\n    style: \"font-weight:bold;text-align: left;\"\n  }, \"\\n                    \", HTML.DIV({\n    class: \"col-md-10 left-option\",\n    style: \"background-color:rgba(78, 100, 142, 1);padding:10px;border-radius: 5px 5px 0px 5px;\"\n  }, \"\\n                        \", Blaze.View(\"lookup:leftText\", function() {\n    return Spacebars.mustache(view.lookup(\"leftText\"));\n  }), \"\\n                        \", HTML.Raw('<span class=\"label label-default percent\"></span>'), \"\\n                    \"), \"\\n                    \", HTML.Raw('<div class=\"col-md-2\"></div>'), \"\\n                \"), HTML.Raw('\\n                <div class=\"row\">\\n                    <!-- <div class=\\'col-md-1\\'></div> -->\\n                    <div class=\"col-md-12\">\\n                        <div class=\"slider\" data-value=\"0\" style=\"z-index: 10;\"></div>\\n                    </div>\\n                    <!-- <div class=\\'col-md-1\\'></div> -->\\n                </div>\\n                '), HTML.DIV({\n    class: \"row\",\n    style: \"font-weight:bold;text-align: right;\"\n  }, \"\\n                    \", HTML.Raw('<div class=\"col-md-2\"></div>'), \"\\n                    \", HTML.DIV({\n    class: \"col-md-10 right-option\",\n    style: \"background-color:rgba(78, 100, 142, 1);padding:10px;border-radius: 0px 5px 5px 5px;\"\n  }, \"\\n                        \", HTML.Raw('<span class=\"label label-default percent\"></span>'), \"\\n                        \", Blaze.View(\"lookup:rightText\", function() {\n    return Spacebars.mustache(view.lookup(\"rightText\"));\n  }), \"\\n                    \"), \"\\n                \"), HTML.Raw('\\n                <div class=\"row\" style=\"text-align: center;\">\\n                    <div class=\"col-md-12 reading text-primary\" style=\"margin:5px 0;font-weight:bold;\">Read each option carefully.</div>\\n                </div>\\n                <div class=\"row\" style=\"text-align: center;\">\\n                    <div class=\"col-md-12\">\\n                        <button class=\"btn btn-large btn-success answer-button\">\\n                            Answer Now\\n                        </button>\\n                    </div>\\n                </div>\\n            '));\n}));\n\nTemplate.__checkName(\"footer\");\nTemplate[\"footer\"] = new Template(\"Template.footer\", (function() {\n  var view = this;\n  return \"\";\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"questions.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/questions/questions.js                                                                        //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nlet Question;\nmodule.watch(require(\"/imports/api/questions/questions.js\"), {\n  Question(v) {\n    Question = v;\n  }\n\n}, 0);\nlet User, Profile, UserType, MyersBriggs, Answer;\nmodule.watch(require(\"/imports/api/users/users.js\"), {\n  User(v) {\n    User = v;\n  },\n\n  Profile(v) {\n    Profile = v;\n  },\n\n  UserType(v) {\n    UserType = v;\n  },\n\n  MyersBriggs(v) {\n    MyersBriggs = v;\n  },\n\n  Answer(v) {\n    Answer = v;\n  }\n\n}, 1);\nlet Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 2);\nmodule.watch(require(\"./questions.html\"));\nvar minQuestionsAnswered = 72;\nTemplate.questions.onCreated(function () {\n  if (this.data.userId) {\n    this.userId = this.data.userId;\n  } else {\n    this.userId = Meteor.userId();\n  }\n\n  this.autorun(() => {\n    console.log(\"autorunning...\");\n    this.subscription = this.subscribe('questions.toanswer', Meteor.userId(), Session.get('refreshQuestions'), {\n      onStop: function () {\n        console.log(\"Subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"Subscription ready! \", arguments, this);\n      }\n    });\n    console.log(this.subscription);\n  });\n});\nTemplate.questions.helpers({\n  questions() {\n    let u = User.findOne({\n      _id: Template.instance().userId\n    });\n    let useg = u.MyProfile.segments;\n    let conditions = [{\n      segments: {\n        $exists: false\n      }\n    }, {\n      segments: {\n        $eq: []\n      }\n    }];\n\n    if (useg) {\n      conditions.push({\n        segments: {\n          $in: useg\n        }\n      });\n    }\n\n    if (!u) return [];\n    console.log(\"kkkkkkkkkkkkkkkk\", u);\n    return Question.find({\n      $or: conditions\n    });\n  },\n\n  reversed(index) {\n    return index % 2;\n  },\n\n  remainingMinQCount() {\n    let u = User.findOne({\n      _id: Template.instance().userId\n    });\n    console.log(u);\n    console.log(Template.instance().userId);\n    if (!u) return -1;\n    let rmn = Math.max(0, minQuestionsAnswered - u.MyProfile.UserType.AnsweredQuestions.length);\n    console.log(\"yyyyy\", minQuestionsAnswered, u.MyProfile.UserType.AnsweredQuestions.length, rmn); //let rmn = 0;\n\n    return rmn;\n  },\n\n  isRemainingGreaterThan(num) {\n    let u = User.findOne({\n      _id: Template.instance().userId\n    });\n    if (!u) return true;\n    let rmn = Math.max(0, minQuestionsAnswered - u.MyProfile.UserType.AnsweredQuestions.length);\n    return rmn > num;\n  },\n\n  getTemplate() {\n    //console.log(this.index, arguments, this);\n    return this.index % 2 ? Template.questionTemplate : Template.questionTemplateReversed;\n  },\n\n  answeredQuestionsLength() {\n    let u = User.findOne({\n      _id: Template.instance().userId\n    });\n    let length = u.MyProfile.UserType.AnsweredQuestions.length; //console.log(\"answeredQuestionsLengthhhhhhhhh\", length);\n\n    return length;\n  },\n\n  totalQuestions() {\n    let u = User.findOne({\n      _id: Template.instance().userId\n    }); //console.log(\"myUserID\", u._id);\n\n    let total = u.MyProfile.UserType.getTotalQuestions(); //console.log(\"preTotalQuestions\", total);\n\n    Meteor.call('question.countQuestions', u._id, (error, result) => {\n      if (error) {//console.log(\"EEERRR0r: \", error);\n      } else {\n        //success\n        //console.log(\"myUserID2\", u._id);\n        total = u.MyProfile.UserType.getTotalQuestions();\n        u.MyProfile.UserType.setTotalQuestions(total); //console.log(\"uiquestionsjstotal\", total);\n\n        document.getElementById(\"allQuestions\").innerHTML = \"Total questions: \" + result;\n      }\n    });\n    return total;\n  }\n\n});\nTemplate.questions.events({\n  'click button.answer-button'(event, instance) {\n    event.preventDefault();\n    console.log('click button.answer-button => ', event, instance);\n    const target = event.target;\n    const parent = $(target).closest('div.answer-question');\n    const values = {\n      'questionId': parent.data('id'),\n      'value': parent.data('value'),\n      'isReversed': !!parent.data('reversed')\n    };\n    console.log(values);\n    Meteor.call('question.answer', values.questionId, values.value, values.isReversed, error => {\n      if (error) {\n        console.log(\"EEEEEERRRORRRRR: \", error);\n      } else {\n        parent.remove();\n\n        if ($('div.answer-question').length < 1) {\n          Session.set('refreshQuestions', Math.random());\n        }\n      }\n    });\n  }\n\n});\nTemplate.question.helpers({\n  getReadingsAsJSON(question) {\n    return JSON.stringify(question.Readings);\n  }\n\n});\nTemplate.question.onRendered(function () {\n  console.log(\"onRendered\", this);\n\n  let updateValue = function (elem, value) {\n    let parent = $(elem).data('value', value);\n    parent.find('div.left-option span.percent').html(Math.abs(Math.round(value) - 50) + \"%\");\n    parent.find('div.right-option span.percent').html(Math.round(value) + 50 + \"%\");\n    updateBGOpacity($(elem).find('.left-option'), 0.5 - value / 100);\n    updateBGOpacity($(elem).find('.right-option'), 0.5 + value / 100);\n    updateReading(parent, value);\n  };\n\n  let updateReading = function (elem, value) {\n    let readings = $(elem).data('readings');\n    let index = -1;\n    let curMax = value < 0 ? -100 : 100;\n    $.each(readings, function (i, reading) {\n      if (value < 0 && reading.Rank <= value && reading.Rank > curMax || value > 0 && reading.Rank >= value && reading.Rank < curMax) {\n        index = i;\n        curMax = reading.Rank;\n      }\n    });\n\n    if (index < 0) {\n      return;\n    }\n\n    $(elem).find('div.reading').html(readings[index].Text);\n  };\n\n  let updateBGOpacity = function (elem, value) {\n    let m;\n    m = $(elem).css('background-color').replace(/^rgba?\\(|\\s+|\\)$/g, '').split(',');\n    let btn = $(elem).parents('div.answer-question').find('button.answer-button');\n    let reading = $(elem).parents('div.answer-question').find('div.reading');\n    reading.css('visibility', 'visible');\n    btn.css('visibility', 'visible');\n\n    if (value > 0.5) {\n      $(elem).css('color', 'white');\n    } else if (value == 0.5) {\n      $(elem).css('color', 'Grey');\n      btn.css('visibility', 'hidden');\n      reading.css('visibility', 'hidden');\n      value = 0.1;\n    } else {\n      $(elem).css('color', 'black');\n    }\n\n    let newRGBA = \"rgba(\" + m[0] + \", \" + m[1] + \", \" + m[2] + \", \" + value + \")\";\n    $(elem).css('background-color', newRGBA); //console.log($(elem).css('background-color'), m, newRGBA, value);\n  };\n\n  $('.slider', this.firstNode).each(function () {\n    $(this).noUiSlider({\n      start: $(this).data('value'),\n      step: 1,\n      range: {\n        min: -50,\n        max: 50\n      }\n    }).on('slide', function (event, val) {\n      //console.log(arguments);\n      updateValue($(event.target).closest('.answer-question'), val);\n    }).on('set', function (event, val) {\n      updateValue($(event.target).closest('.answer-question'), val);\n    });\n    updateValue($(this).closest('.answer-question'), $(this).data('value'));\n  });\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"select_autocomplete\":{\"select_autocomplete.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/select_autocomplete/select_autocomplete.html                                                  //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.select_autocomplete.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.select_autocomplete.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/select_autocomplete/template.select_autocomplete.js                                           //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"select_autocomplete\");\nTemplate[\"select_autocomplete\"] = new Template(\"Template.select_autocomplete\", (function() {\n  var view = this;\n  return HTML.SPAN({\n    class: \"select-autocomplete\",\n    id: function() {\n      return [ \"selectize-outer-\", Spacebars.mustache(view.lookup(\"id\")), Spacebars.mustache(view.lookup(\"id2\")) ];\n    }\n  }, \"\\n        \", HTML.SELECT({\n    id: function() {\n      return [ Spacebars.mustache(view.lookup(\"id\")), Spacebars.mustache(view.lookup(\"id2\")) ];\n    },\n    name: function() {\n      return Spacebars.mustache(view.lookup(\"name\"));\n    },\n    class: \"demo-default\",\n    multiple: \"\",\n    placeholder: function() {\n      return Spacebars.mustache(view.lookup(\"placeholder\"));\n    }\n  }, \"\\n        \"), \"\\n    \");\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"select_autocomplete.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/select_autocomplete/select_autocomplete.js                                                    //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./select_autocomplete.html\"));\nTemplate.select_autocomplete.onCreated(function () {//\n});\nTemplate.select_autocomplete.onRendered(function () {\n  var self = this;\n  self.autorun(function () {\n    console.log(\"select_autocomplete autorun\");\n    var dat = Template.currentData();\n\n    if (!dat.list || dat.list.length < 1) {\n      return;\n    }\n\n    var params = {\n      plugins: ['remove_button'],\n      options: dat.list\n    };\n\n    if (typeof dat.onItemAdd !== \"undefined\") {\n      params.onItemAdd = dat.onItemAdd;\n    }\n\n    if (typeof dat.onItemRemove !== \"undefined\") {\n      params.onItemRemove = dat.onItemRemove;\n    }\n\n    if (typeof dat.readOnly !== \"undefined\") {\n      params.readOnly = true;\n      params.plugins = [];\n    }\n\n    if (typeof dat.create !== \"undefined\") {\n      params.create = true;\n    }\n\n    let $select = $('#' + dat.id + dat.id2).selectize(params);\n    $select[0].selectize.clear(true);\n    $select[0].selectize.clearOptions();\n    $select[0].selectize.addOption(dat.list);\n\n    if (\"undefined\" !== typeof dat.selected) {\n      for (let i in dat.selected) {\n        let id = dat.selected[i];\n\n        if (\"string\" !== typeof id) {\n          id = id.value;\n        }\n\n        if (\"undefined\" === typeof _.find(dat.list, function (o) {\n          return o.value === id;\n        })) {\n          $select[0].selectize.addOption(dat.selected[i]);\n          $select[0].selectize.addItem(id, true);\n        } else {\n          $select[0].selectize.addItem(id, true);\n        }\n      }\n    }\n\n    $select[0].selectize.refreshItems();\n  });\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"select_feedback\":{\"select_feedback.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/select_feedback/select_feedback.html                                                          //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.select_feedback.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.select_feedback.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/select_feedback/template.select_feedback.js                                                   //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"select_feedback\");\nTemplate[\"select_feedback\"] = new Template(\"Template.select_feedback\", (function() {\n  var view = this;\n  return HTML.DIV({\n    id: function() {\n      return [ \"feedback-box-\", Spacebars.mustache(view.lookup(\"source\")) ];\n    },\n    class: \"container feedback-box\"\n  }, \"\\n        \", HTML.DIV({\n    id: function() {\n      return [ \"sf-instruction-begin-\", Spacebars.mustache(view.lookup(\"source\")) ];\n    },\n    class: \"sf-instruction-begin\"\n  }, HTML.Raw(\"<h3>Select text to leave feedback for a passage</h3>\")), \"\\n        \", HTML.DIV({\n    id: function() {\n      return [ \"sf-instruction-selected-\", Spacebars.mustache(view.lookup(\"source\")) ];\n    },\n    class: \"sf-instruction-selected\",\n    style: \"display:none;\"\n  }, \"\\n            \", HTML.Raw('<div class=\"row spaced\">\\n                <div class=\"col-md-12\"><h3>Leaving feedback for this text:</h3></div>\\n            </div>'), \"\\n            \", HTML.DIV({\n    class: \"row spaced\"\n  }, \"\\n                \", HTML.DIV({\n    class: \"col-md-12\"\n  }, \"\\n                    \", HTML.DIV({\n    id: function() {\n      return [ \"sf-feedback-context-\", Spacebars.mustache(view.lookup(\"source\")) ];\n    },\n    class: \"sf-feedback-context\"\n  }), \"\\n                \"), \"\\n            \"), \"\\n            \", HTML.DIV({\n    class: \"row spaced sf-textbox\",\n    id: function() {\n      return [ \"sf-textbox-\", Spacebars.mustache(view.lookup(\"source\")) ];\n    }\n  }, \"\\n                \", HTML.DIV({\n    class: \"col-md-12\"\n  }, \"\\n                    My comment:\\n                    \", HTML.TEXTAREA({\n    id: function() {\n      return [ \"mytextarea-\", Spacebars.mustache(view.lookup(\"source\")) ];\n    },\n    class: \"mytextarea\"\n  }), \"\\n                \"), \"\\n            \"), \"\\n            \", HTML.DIV({\n    class: \"row spaced\"\n  }, \"\\n                \", HTML.DIV({\n    class: \"col-sm-12 text-right btn-group-xs\"\n  }, \"\\n                    \", HTML.BUTTON({\n    id: function() {\n      return [ \"feedback-cancel-\", Spacebars.mustache(view.lookup(\"source\")) ];\n    },\n    class: \"btn btn-danger feedback-cancel btn-cancel glyphicon glyphicon-remove details\",\n    alt: \"Discard changes\"\n  }), \"\\n                    \", HTML.BUTTON({\n    id: function() {\n      return [ \"feedback-save-\", Spacebars.mustache(view.lookup(\"source\")) ];\n    },\n    class: \"btn feedback-save btn-success btn-save glyphicon glyphicon-ok details\",\n    disabled: \"\",\n    alt: \"Save changes\"\n  }), \"\\n                \"), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n    id: function() {\n      return [ \"sf-list-feedback-\", Spacebars.mustache(view.lookup(\"source\")) ];\n    },\n    class: \"sf-list-feedback\"\n  }, \"\\n            \", HTML.Raw(\"<hr>\"), \"\\n            \", HTML.Raw('<div class=\"row spaced\">\\n                <div class=\"col-sm-12\">\\n                    <h3>Feedback I\\'ve left:</h3>\\n                </div>\\n            </div>'), \"\\n            \", Blaze.Each(function() {\n    return {\n      _sequence: Spacebars.call(view.lookup(\"commentsMade\")),\n      _variable: \"comment\"\n    };\n  }, function() {\n    return [ \"\\n            \", HTML.DIV({\n      class: \"row spaced\"\n    }, \"\\n                \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                    \", HTML.SPAN({\n      style: \"background-color:blue;\"\n    }, Blaze.View(\"lookup:comment.context\", function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"comment\"), \"context\"));\n    })), \" -\\n                    \", Blaze.View(\"lookup:comment.comment\", function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"comment\"), \"comment\"));\n    }), \"\\n                \"), \"\\n            \"), \"\\n            \" ];\n  }), \"\\n        \"), \"\\n    \");\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"select_feedback.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/select_feedback/select_feedback.js                                                            //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nlet Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 0);\nlet UserFeedback;\nmodule.watch(require(\"/imports/api/user_feedback/user_feedback.js\"), {\n  UserFeedback(v) {\n    UserFeedback = v;\n  }\n\n}, 1);\nmodule.watch(require(\"./select_feedback.html\"));\nvar selectedText;\n\nfunction selectionHandler(event) {\n  if ($(event.target).closest(\".feedback-box\").length) {\n    //click happened inside feedback box, ignore\n    return;\n  }\n\n  let $box = $(\".feedback-box:visible\");\n  selectedText = window.getSelection().toString();\n  console.log(selectedText);\n  $box.find(\".sf-feedback-context\").html(selectedText);\n\n  if (selectedText === \"\") {\n    $box.find(\".sf-instruction-selected\").hide();\n    $box.find(\".sf-instruction-begin\").show();\n  } else {\n    $box.find(\".sf-instruction-selected\").show();\n    $box.find(\".sf-instruction-begin\").hide();\n  }\n}\n\nTemplate.select_feedback.onCreated(function () {\n  $(document).on('mouseup', selectionHandler);\n  this.autorun(() => {\n    console.log(\"autorun\", this);\n    this.subscription = this.subscribe('feedback.userComments', {\n      onStop: function () {\n        console.log(\"Subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"Subscription ready! \", arguments, this);\n      }\n    });\n  });\n});\nTemplate.select_feedback.onDestroyed(function () {\n  $(document).off('mouseup', selectionHandler);\n});\nTemplate.select_feedback.helpers({\n  commentsMade() {\n    let uf = UserFeedback.find({\n      userId: Meteor.userId(),\n      source: Template.instance().data.source\n    }).fetch();\n    console.log(uf);\n    return uf;\n  }\n\n});\nTemplate.select_feedback.events({\n  'keyup .mytextarea'(event, instance) {\n    let $box = $(\".feedback-box:visible\");\n    console.log($box);\n    $box.find(\".feedback-save\").prop(\"disabled\", false);\n  },\n\n  'click button.feedback-cancel'(event, instance) {\n    console.log(\"cancel\");\n    let $box = $(\".feedback-box:visible\");\n    $box.find(\".sf-instruction-selected\").hide();\n    $box.find(\".sf-instruction-begin\").show();\n  },\n\n  'click button.feedback-save'(event, instance) {\n    console.log(Template.instance());\n    let $box = $(\".feedback-box:visible\");\n    let fbk = {\n      source: Template.instance().data.source,\n      context: selectedText,\n      comment: $box.find(\".mytextarea\").val()\n    };\n    Meteor.call('feedback.createNewFeedback', fbk, (err, rslt) => {\n      console.log(err, rslt);\n    });\n    $box.find(\".sf-instruction-selected\").hide();\n    $box.find(\".sf-instruction-begin\").show();\n  }\n\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"team_icon\":{\"team_icon.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/team_icon/team_icon.html                                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.team_icon.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.team_icon.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/team_icon/template.team_icon.js                                                               //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"team_icon\");\nTemplate[\"team_icon\"] = new Template(\"Template.team_icon\", (function() {\n  var view = this;\n  return Blaze.If(function() {\n    return Spacebars.call(Spacebars.dot(view.lookup(\"team\"), \"Icon64\"));\n  }, function() {\n    return [ \"\\n        \", HTML.SPAN({\n      class: \"team-icon\"\n    }, \"\\n            \", HTML.IMG({\n      src: function() {\n        return [ \"data:\", Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"IconType\")), \";base64,\", Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"Icon64\")) ];\n      }\n    }), \"\\n        \"), \"\\n    \" ];\n  });\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"video_embed\":{\"video_embed.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/video_embed/video_embed.html                                                                  //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.video_embed.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.video_embed.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/video_embed/template.video_embed.js                                                           //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"video_embed\");\nTemplate[\"video_embed\"] = new Template(\"Template.video_embed\", (function() {\n  var view = this;\n  return Blaze.If(function() {\n    return Spacebars.dataMustache(view.lookup(\"fileExists\"), view.lookup(\"id\"));\n  }, function() {\n    return [ \"\\n        \", HTML.SPAN({\n      class: \"video-embed embed-responsive embed-responsive-16by9\"\n    }, \"\\n            \", HTML.VIDEO({\n      width: \"320\",\n      height: \"240\",\n      controls: \"\"\n    }, \"\\n                \", HTML.SOURCE({\n      src: function() {\n        return [ \"/learnShareRecording/\", Spacebars.mustache(view.lookup(\"id\")), \".mp4\" ];\n      },\n      type: \"video/mp4\"\n    }), \"\\n            \"), \"\\n        \"), \"\\n    \" ];\n  });\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"video_embed.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/components/video_embed/video_embed.js                                                                    //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./video_embed.html\"));\nTemplate.video_embed.onCreated(function () {\n  this._fileExists = new ReactiveVar(false);\n  console.log(this.data);\n  this.autorun(() => {\n    Meteor.call('learnshare.recordingExists', this.data.id, (err, rslt) => {\n      this._fileExists.set(rslt);\n    });\n  });\n});\nTemplate.video_embed.helpers({\n  fileExists(fname) {\n    return Template.instance()._fileExists.get();\n  }\n\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}}},\"layouts\":{\"body\":{\"body.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/layouts/body/body.html                                                                                   //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.body.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.body.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/layouts/body/template.body.js                                                                            //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"App_body\");\nTemplate[\"App_body\"] = new Template(\"Template.App_body\", (function() {\n  var view = this;\n  return [ Blaze._TemplateWith(function() {\n    return {\n      template: Spacebars.call(view.lookup(\"top\"))\n    };\n  }, function() {\n    return Spacebars.include(function() {\n      return Spacebars.call(Template.__dynamic);\n    });\n  }), \"\\n  \", Blaze._TemplateWith(function() {\n    return {\n      template: Spacebars.call(view.lookup(\"main\"))\n    };\n  }, function() {\n    return Spacebars.include(function() {\n      return Spacebars.call(Template.__dynamic);\n    });\n  }) ];\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"body.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/layouts/body/body.js                                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./body.html\"));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"login\":{\"login.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/layouts/login/login.html                                                                                 //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.login.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.login.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/layouts/login/template.login.js                                                                          //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"Auth_page\");\nTemplate[\"Auth_page\"] = new Template(\"Template.Auth_page\", (function() {\n  var view = this;\n  return Spacebars.include(view.lookupTemplate(\"atForm\"));\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"login.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/layouts/login/login.js                                                                                   //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./login.html\"));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}}},\"pages\":{\"add_questions\":{\"add_questions.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/add_questions/add_questions.html                                                                   //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.add_questions.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.add_questions.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/add_questions/template.add_questions.js                                                            //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"add_questions\");\nTemplate[\"add_questions\"] = new Template(\"Template.add_questions\", (function() {\n  var view = this;\n  return Blaze.If(function() {\n    return Spacebars.call(view.templateInstance().subscriptionsReady());\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      class: \"container\"\n    }, \"\\n        \", HTML.DIV({\n      class: \"row\"\n    }, \"\\n            \", HTML.H4(\"Select a category to enter into\"), \"\\n        \"), \"\\n        \", HTML.DIV({\n      class: \"row\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"btn-group\",\n      role: \"group\",\n      \"aria-label\": \"...\"\n    }, \"\\n                \", HTML.BUTTON({\n      type: \"button\",\n      class: function() {\n        return [ \"btn btn-default quest-cat-select cat-IE \", Blaze.If(function() {\n          return Spacebars.call(Spacebars.dot(view.lookup(\"categoryCheck\"), \"IE\"));\n        }, function() {\n          return \"active\";\n        }) ];\n      },\n      \"data-category\": \"IE\"\n    }, \"Introvert/Extrovert\"), \"\\n                \", HTML.BUTTON({\n      type: \"button\",\n      class: function() {\n        return [ \"btn btn-default quest-cat-select cat-NS \", Blaze.If(function() {\n          return Spacebars.call(Spacebars.dot(view.lookup(\"categoryCheck\"), \"NS\"));\n        }, function() {\n          return \"active\";\n        }) ];\n      },\n      \"data-category\": \"NS\"\n    }, \"iNtuitive/Sensing\"), \"\\n                \", HTML.BUTTON({\n      type: \"button\",\n      class: function() {\n        return [ \"btn btn-default quest-cat-select cat-TF \", Blaze.If(function() {\n          return Spacebars.call(Spacebars.dot(view.lookup(\"categoryCheck\"), \"TF\"));\n        }, function() {\n          return \"active\";\n        }) ];\n      },\n      \"data-category\": \"TF\"\n    }, \"Thinking/Feeling\"), \"\\n                \", HTML.BUTTON({\n      type: \"button\",\n      class: function() {\n        return [ \"btn btn-default quest-cat-select cat-JP \", Blaze.If(function() {\n          return Spacebars.call(Spacebars.dot(view.lookup(\"categoryCheck\"), \"JP\"));\n        }, function() {\n          return \"active\";\n        }) ];\n      },\n      \"data-category\": \"JP\"\n    }, \"Judging/Perceiving\"), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n      class: \"row\"\n    }, \"\\n            \", HTML.TABLE({\n      class: \"table table-striped table-hover\"\n    }, \"\\n                \", HTML.THEAD(\"\\n                \", HTML.TR(\"\\n                    \", HTML.TD(\"\\n                        \", HTML.UL({\n      class: \"nav nav-tabs\",\n      role: \"tablist\",\n      style: \"margin-bottom:5px;\"\n    }, \"\\n                            \", HTML.LI({\n      role: \"presentation\",\n      class: \"active\"\n    }, HTML.A({\n      href: \"#addQuestion\",\n      \"aria-controls\": \"addQuestion\",\n      role: \"tab\",\n      \"data-toggle\": \"tab\",\n      \"data-type\": \"question\"\n    }, HTML.H4({\n      style: \"margin:0;\"\n    }, \"Add new question\"))), \"\\n                        \"), \"\\n                        \", HTML.DIV({\n      class: \"tab-content\",\n      style: \"overflow: inherit\"\n    }, \"\\n                            \", HTML.DIV({\n      role: \"tabpanel\",\n      class: \"tab-pane active\",\n      id: \"addQuestion\"\n    }, \"\\n                                \", HTML.FORM({\n      id: \"newQuestion\"\n    }, \"\\n                                    \", HTML.DIV({\n      class: \"input-group\"\n    }, \"\\n                                        \", HTML.INPUT({\n      type: \"text\",\n      class: \"form-control input-medium\",\n      name: \"Text\",\n      style: \"height:34px;\",\n      placeholder: \"Brief description...\"\n    }), \"\\n                                        \", HTML.DIV({\n      class: \"input-group-btn\"\n    }, \"\\n                                            \", Blaze._TemplateWith(function() {\n      return {\n        id: Spacebars.call(\"select-segments\"),\n        id2: Spacebars.call(\"\"),\n        name: Spacebars.call(\"segments[]\"),\n        placeholder: Spacebars.call(\"User Segments...\"),\n        list: Spacebars.call(view.lookup(\"userSegmentList\")),\n        selected: Spacebars.call(view.lookup(\"assignedUserSegments\")),\n        onItemRemove: Spacebars.call(view.lookup(\"itemRemoveHandler\")),\n        onItemAdd: Spacebars.call(view.lookup(\"itemAddHandler\"))\n      };\n    }, function() {\n      return Spacebars.include(view.lookupTemplate(\"select_autocomplete\"));\n    }), \"\\n                                        \"), \"\\n                                    \"), \"\\n                                    \", HTML.DIV({\n      class: \"input-group\"\n    }, \"\\n                                        \", HTML.DIV({\n      class: \"input-group-btn\"\n    }, \"\\n                                            \", Blaze._TemplateWith(function() {\n      return {\n        id: Spacebars.call(\"select-categories\"),\n        id2: Spacebars.call(\"\"),\n        name: Spacebars.call(\"Categories\"),\n        placeholder: Spacebars.call(\"Categories...\"),\n        list: Spacebars.call(view.lookup(\"categoryList\"))\n      };\n    }, function() {\n      return Spacebars.include(view.lookupTemplate(\"select_autocomplete\"));\n    }), \"\\n                                        \"), \"\\n                                        \", HTML.INPUT({\n      type: \"text\",\n      class: \"form-control input-medium\",\n      name: \"LeftText\",\n      style: \"height:35px;\",\n      placeholder: \"Are you more like this...\"\n    }), \"\\n                                        \", HTML.SPAN({\n      class: \"input-group-addon\"\n    }, HTML.CharRef({\n      html: \"&nbsp;\",\n      str: \"\"\n    }), \"vs\", HTML.CharRef({\n      html: \"&nbsp;\",\n      str: \"\"\n    })), \"\\n                                        \", HTML.INPUT({\n      type: \"text\",\n      class: \"form-control input-medium\",\n      name: \"RightText\",\n      style: \"height:35px;\",\n      placeholder: \"Or are you more like this?\"\n    }), \"\\n                                        \", HTML.SPAN({\n      class: \"input-group-btn\"\n    }, \"\\n                                            \", HTML.BUTTON({\n      class: \"btn btn-default btn-primary new-question\",\n      type: \"submit\"\n    }, \"Add\"), \"\\n                                        \"), \"\\n                                    \"), \"\\n                                \"), \"\\n                            \"), \"\\n                        \"), \"\\n                    \"), \"\\n                \"), \"\\n                \"), \"\\n                \", HTML.TBODY(\"\\n                \", HTML.TR(\"\\n                    \", HTML.TD(\"\\n                        \", HTML.H4(\"Edit existing questions\"), \"\\n                    \"), \"\\n                \"), \"\\n                \"), \"\\n                \", HTML.TBODY({\n      id: \"questionTable\",\n      class: \"edit-body\"\n    }, \"\\n            \", Blaze.Each(function() {\n      return {\n        _sequence: Spacebars.call(view.lookup(\"questions\")),\n        _variable: \"question\"\n      };\n    }, function() {\n      return [ \"\\n                    \", HTML.TR({\n        \"data-id\": function() {\n          return Spacebars.mustache(Spacebars.dot(view.lookup(\"question\"), \"_id\"));\n        },\n        id: function() {\n          return Spacebars.mustache(Spacebars.dot(view.lookup(\"question\"), \"_id\"));\n        },\n        class: \"edit-question edit-row\"\n      }, \"\\n                        \", HTML.TD(\"\\n                            \", HTML.DIV({\n        class: \"row\"\n      }, \"\\n                                \", HTML.DIV({\n        class: \"col-md-1\"\n      }, \"\\n                                    \", HTML.SPAN({\n        class: \"label label-default\"\n      }, Blaze.View(\"lookup:indexToCategory\", function() {\n        return Spacebars.mustache(view.lookup(\"indexToCategory\"), Spacebars.dot(view.lookup(\"question\"), \"Category\"));\n      })), HTML.CharRef({\n        html: \"&nbsp;\",\n        str: \"\"\n      }), HTML.SPAN({\n        class: \"label label-warning\"\n      }, Blaze.View(\"lookup:totalAnswers\", function() {\n        return Spacebars.mustache(view.lookup(\"totalAnswers\"), Spacebars.dot(view.lookup(\"question\"), \"TimesAnswered\", \"LeftSum\"), Spacebars.dot(view.lookup(\"question\"), \"TimesAnswered\", \"RightSum\"));\n      })), \"\\n                                    \", HTML.SPAN({\n        class: \"label label-info\"\n      }, Blaze.View(\"lookup:averageAnswer\", function() {\n        return Spacebars.mustache(view.lookup(\"averageAnswer\"), Spacebars.dot(view.lookup(\"question\"), \"TimesAnswered\", \"LeftSum\"), Spacebars.dot(view.lookup(\"question\"), \"SumOfAnswers\", \"LeftSum\"));\n      }), \" vs \", Blaze.View(\"lookup:averageAnswer\", function() {\n        return Spacebars.mustache(view.lookup(\"averageAnswer\"), Spacebars.dot(view.lookup(\"question\"), \"TimesAnswered\", \"RightSum\"), Spacebars.dot(view.lookup(\"question\"), \"SumOfAnswers\", \"RightSum\"));\n      })), HTML.BR(), \"\\n                                    \", HTML.SPAN({\n        style: \"cursor: pointer;\",\n        class: function() {\n          return [ \"label label-\", Blaze.If(function() {\n            return Spacebars.call(Spacebars.dot(view.lookup(\"question\"), \"Active\"));\n          }, function() {\n            return \"success\";\n          }, function() {\n            return \"danger\";\n          }), \" toggle-enable\" ];\n        }\n      }, Blaze.If(function() {\n        return Spacebars.call(Spacebars.dot(view.lookup(\"question\"), \"Active\"));\n      }, function() {\n        return \"Active\";\n      }, function() {\n        return \"Inactive\";\n      })), \"\\n                                \"), \"\\n                                \", HTML.DIV({\n        class: \"col-md-10\"\n      }, \"\\n                                    \", HTML.EM(Blaze.View(\"lookup:question.Text\", function() {\n        return Spacebars.mustache(Spacebars.dot(view.lookup(\"question\"), \"Text\"));\n      })), \"\\n                                    \", HTML.SPAN({\n        class: \"pull-right\"\n      }, \"\\n                                        \", HTML.STRONG(Blaze.View(\"lookup:questionAuthor\", function() {\n        return Spacebars.makeRaw(Spacebars.mustache(view.lookup(\"questionAuthor\"), view.lookup(\"question\")));\n      })), \"\\n                                    \"), \"\\n                                    \", HTML.BR(), \"\\n                                    \", HTML.SPAN({\n        class: \"glyphicon glyphicon-arrow-left\"\n      }), \" \", Blaze.View(\"lookup:question.LeftText\", function() {\n        return Spacebars.mustache(Spacebars.dot(view.lookup(\"question\"), \"LeftText\"));\n      }), \"\\n                                    \", HTML.SPAN({\n        class: \"pull-right\"\n      }, \"\\n                                        \", Blaze._TemplateWith(function() {\n        return {\n          items: Spacebars.call(Spacebars.dataMustache(view.lookup(\"assignedUserSegments\"), view.lookup(\"question\"))),\n          labelType: Spacebars.call(\"label-info\")\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"label_list\"));\n      }), \"\\n                                    \"), \"\\n                                    \", HTML.BR(), \"\\n                                    \", HTML.SPAN({\n        class: \"glyphicon glyphicon-arrow-right\"\n      }), \" \", Blaze.View(\"lookup:question.RightText\", function() {\n        return Spacebars.mustache(Spacebars.dot(view.lookup(\"question\"), \"RightText\"));\n      }), \"\\n                                \"), \"\\n                                \", HTML.DIV({\n        class: \"col-md-1\",\n        style: \"text-align: right;\"\n      }, \"\\n                                    \", Blaze.If(function() {\n        return Spacebars.dataMustache(view.lookup(\"canDelete\"), view.lookup(\"question\"));\n      }, function() {\n        return [ \"\\n                                    \", HTML.SPAN({\n          class: \"glyphicon glyphicon-remove delete text-danger\",\n          \"data-qid\": function() {\n            return Spacebars.mustache(Spacebars.dot(view.lookup(\"question\"), \"_id\"));\n          },\n          style: \"cursor: pointer;\"\n        }), \"\\n                                    \" ];\n      }, function() {\n        return [ \"\\n                                    \", HTML.SPAN({\n          class: \"glyphicon glyphicon-remove text-muted\",\n          style: \"cursor: not-allowed;\",\n          title: \"You can not delete questions that have been answered\",\n          \"data-toggle\": \"tooltip\"\n        }), \"\\n                                    \" ];\n      }), \"\\n                                \"), \"\\n                                \", HTML.DIV({\n        class: \"col-md-10 col-md-offset-1\",\n        style: \"display:none;\"\n      }, \"\\n                                    \", HTML.Comment(\" additional info here \"), \"\\n                                \"), \"\\n                            \"), \"\\n                        \"), \"\\n                    \"), HTML.SCRIPT(\"\\n                    $('#\", Blaze.View(\"lookup:question._id\", function() {\n        return Spacebars.mustache(Spacebars.dot(view.lookup(\"question\"), \"_id\"));\n      }), ' [data-toogle=\"tooltip\"]\\').tooltip();\\n                    '), \"\\n            \" ];\n    }), \"\\n                \"), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.Comment(\" Modal \"), \"\\n        \", HTML.DIV({\n      class: \"modal fade\",\n      id: \"tempModal\",\n      tabindex: \"-1\",\n      role: \"dialog\",\n      \"aria-labelledby\": \"tempModalLabel\"\n    }, \"\\n          \", HTML.DIV({\n      class: \"modal-dialog\",\n      role: \"document\",\n      style: \"margin:0;\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"modal-content\"\n    }, \"\\n              \", HTML.DIV({\n      class: \"modal-header\"\n    }, \"\\n                \", HTML.BUTTON({\n      type: \"button\",\n      class: \"close\",\n      \"data-dismiss\": \"modal\",\n      \"aria-label\": \"Close\"\n    }, HTML.SPAN({\n      \"aria-hidden\": \"true\"\n    }, HTML.CharRef({\n      html: \"&times;\",\n      str: \"\"\n    }))), \"\\n                \", HTML.H4({\n      class: \"modal-title\"\n    }), \"\\n              \"), \"\\n              \", HTML.DIV({\n      class: \"modal-body\"\n    }, \"\\n\\n              \"), \"\\n              \", HTML.DIV({\n      class: \"modal-footer\"\n    }, \"\\n                \", HTML.BUTTON({\n      type: \"button\",\n      class: \"btn btn-default closebtn\",\n      \"data-dismiss\": \"modal\"\n    }), \"\\n                \", HTML.BUTTON({\n      type: \"button\",\n      class: \"btn btn-primary savebtn\"\n    }), \"\\n              \"), \"\\n            \"), \"\\n          \"), \"\\n        \"), \"\\n    \"), \"\\n    \" ];\n  }, function() {\n    return [ \"\\n        \", Spacebars.include(view.lookupTemplate(\"loading\")), \"\\n    \" ];\n  });\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"add_questions.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/add_questions/add_questions.js                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nlet Question;\nmodule.watch(require(\"/imports/api/questions/questions.js\"), {\n  Question(v) {\n    Question = v;\n  }\n\n}, 0);\nlet User;\nmodule.watch(require(\"/imports/api/users/users.js\"), {\n  User(v) {\n    User = v;\n  }\n\n}, 1);\nlet FlowRouter;\nmodule.watch(require(\"meteor/kadira:flow-router\"), {\n  FlowRouter(v) {\n    FlowRouter = v;\n  }\n\n}, 2);\nlet Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 3);\nlet TypeReading;\nmodule.watch(require(\"/imports/api/type_readings/type_readings.js\"), {\n  TypeReading(v) {\n    TypeReading = v;\n  }\n\n}, 4);\nlet UserSegment;\nmodule.watch(require(\"/imports/api/user_segments/user_segments.js\"), {\n  UserSegment(v) {\n    UserSegment = v;\n  }\n\n}, 5);\nmodule.watch(require(\"./add_questions.html\"));\nTemplate.add_questions.onCreated(function add_questionsOnCreated() {\n  this._category = new ReactiveVar(FlowRouter.getParam('category'));\n\n  this.category = () => this._category.get();\n\n  this.convertCategory = cat => {\n    if (cat === 'IE') {\n      return 0;\n    }\n\n    if (cat === 'NS') {\n      return 1;\n    }\n\n    if (cat === 'TF') {\n      return 2;\n    }\n\n    if (cat === 'JP') {\n      return 3;\n    }\n\n    return -1;\n  };\n\n  this.categoryToIndex = new ReactiveVar(this.convertCategory(this._category.get()));\n\n  this.categoryCheck = () => {\n    return {\n      IE: this.category() === 'IE',\n      NS: this.category() === 'NS',\n      TF: this.category() === 'TF',\n      JP: this.category() === 'JP'\n    };\n  };\n\n  this.showModal = function (stuff) {\n    let m = $('#tempModal');\n    m.find('h4.modal-title').html(stuff.Title);\n    m.find('div.modal-body').html(stuff.Body);\n    m.find('div.modal-footer button.closebtn').html(stuff.CloseText);\n    m.find('div.modal-footer button.savebtn').html(stuff.SaveText).click(stuff.SaveFunction);\n\n    _.each(stuff.data, function (name, val) {\n      m.data(name, val);\n    });\n\n    m.modal('show');\n  };\n\n  this.fixTabs = () => {\n    let active = $('li[role=presentation].active a').data('type');\n    console.log(active);\n    $('tbody.edit-body').hide();\n    $('#' + active + \"Table\").show();\n  };\n\n  this.makeModalStuff = function (title, body, closeText, saveText, saveFunction, data) {\n    return {\n      Title: title,\n      Body: body,\n      CloseText: closeText,\n      SaveText: saveText,\n      SaveFunction: saveFunction,\n      data: data\n    };\n  };\n\n  this.autorun(() => {\n    console.log(\"autorunning...\", this.categoryToIndex.get());\n    this.subscription = this.subscribe('questions.bycategory', this.categoryToIndex.get(), {\n      onStop: function () {\n        console.log(\"Subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"Subscription ready! \", arguments, this);\n      },\n      sort: {\n        createdAt: -1\n      }\n    });\n    console.log(this.subscription);\n    this.subscription3 = this.subscribe('segmentList', this.userId, {\n      onStop: function () {\n        console.log(\"Segment List subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"Segment List subscription ready! \", arguments, this);\n      }\n    });\n    console.log(this.subscription3);\n  });\n});\nTemplate.add_questions.helpers({\n  category() {\n    return Template.instance().category();\n  },\n\n  categoryCheck() {\n    return Template.instance().categoryCheck();\n  },\n\n  userSegmentList() {\n    let segList = [];\n    let s = UserSegment.find();\n    s.forEach(m => {\n      segList.push({\n        value: m._id,\n        text: m.name\n      });\n    });\n    return segList;\n  },\n\n  assignedUserSegments(q) {\n    console.log(\"sssssssssssss\", q);\n\n    if (typeof q === \"undefined\") {\n      return [];\n    }\n\n    let assigned = [];\n\n    for (let i = 0; i < q.segments.length; i++) {\n      let seg = UserSegment.findOne({\n        _id: q.segments[i]\n      });\n      assigned.push({\n        value: q.segments[i],\n        text: seg.name\n      });\n    }\n\n    return assigned;\n  },\n\n  questions() {\n    let x = Question.find({\n      Categories: parseInt(Template.instance().categoryToIndex.get())\n    }, {\n      sort: {\n        createdAt: -1\n      }\n    });\n    return x;\n  },\n\n  questionAuthor(question) {\n    let u = User.findOne(question.CreatedBy);\n    return \"<span style='white-space:nowrap;'>\" + u.MyProfile.fullName() + \" <span class='label label-warning'>\" + u.MyProfile.UserType.Personality.getFourLetter() + \"</span></span>\";\n  },\n\n  getUserName(userId) {\n    let u = User.findOne({\n      _id: userId\n    });\n    u.callMethod('fullName', (err, result) => {\n      console.log(err, result);\n      return result;\n    }); //return u.fullName();\n  },\n\n  indexToCategory(ind) {\n    if (ind === 0) {\n      return 'IE';\n    }\n\n    if (ind === 1) {\n      return 'NS';\n    }\n\n    if (ind === 2) {\n      return 'TF';\n    }\n\n    if (ind === 3) {\n      return 'JP';\n    }\n\n    return 'UN';\n  },\n\n  categoryToIndex(cat) {\n    if (cat === 'IE') {\n      return 0;\n    }\n\n    if (cat === 'NS') {\n      return 1;\n    }\n\n    if (cat === 'TF') {\n      return 2;\n    }\n\n    if (cat === 'JP') {\n      return 3;\n    }\n\n    return -1;\n  },\n\n  categoryList() {\n    let categories = [{\n      text: 'IE',\n      value: 0\n    }, {\n      text: 'NS',\n      value: 1\n    }, {\n      text: 'TF',\n      value: 2\n    }, {\n      text: 'JP',\n      value: 3\n    }];\n    return categories;\n  },\n\n  averageAnswer(times, sum) {\n    if (times === 0) {\n      return 0;\n    }\n\n    return Math.round(Math.abs(sum) / times);\n  },\n\n  totalAnswers(right, left) {\n    return right + left;\n  },\n\n  canDelete(question) {\n    return question.TimesAnswered.LeftSum + question.TimesAnswered.RightSum < 1;\n  }\n\n});\nTemplate.add_questions.events({\n  'click button.quest-cat-select'(event, instance) {\n    console.log('click button.quest-cat-select =>', event, instance);\n    let newCat = $(event.target).data('category');\n    FlowRouter.go(\"/addQuestions/\" + newCat);\n\n    instance._category.set(newCat);\n\n    instance.categoryToIndex.set(instance.convertCategory(newCat));\n    instance.fixTabs();\n  },\n\n  'click button.dropdown-toggle'(event, instance) {\n    event.preventDefault();\n    console.log('click button.dropdown-toggle => ', event, instance);\n  },\n\n  'click ul.dropdown-menu li a'(event, instance) {\n    event.preventDefault();\n    console.log('click ul.dropdown-menu li a => ', event, instance);\n    let newCat = $(event.target).html();\n    FlowRouter.go($(event.target).attr('href'));\n\n    instance._category.set(newCat);\n\n    instance.categoryToIndex.set(instance.convertCategory(newCat)); //$('.Selected-Category').html(newCat);\n\n    $('[name=Category]').val($(event.target).data('value'));\n    $('button.quest-cat-select.cat-' + newCat).addClass('active');\n    instance.fixTabs();\n  },\n\n  'click span.toggle-enable'(event, instance) {\n    console.log('click span.toggle-enable => ', event, instance);\n    let qid = $(event.target).closest('tr').data('id');\n    let q = Question.findOne({\n      _id: qid\n    });\n    q.Active = !q.Active;\n    q.save();\n  },\n\n  'click span.delete'(event, instance) {\n    event.preventDefault();\n    console.log('click span.delete => ', event, instance);\n    const target = event.target;\n    let qid = $(target).data('qid');\n    let vals = instance.makeModalStuff(\"Are you really sure?\", \"<h5>Do you really want to delete the question:</h5><table class='table table-bordered'><tr>\" + $(\"#\" + qid).html() + \"</tr></table>\", \"No!\", \"I guess...\", function (event) {\n      $('#tempModal').modal('hide');\n      $(this).off(event);\n      Meteor.call('question.delete', qid, error => {\n        if (error) {\n          console.log(\"Error on delete: \", error);\n        } else {\n          console.log(qid + \" should be deleted...\");\n        }\n      });\n    }, {\n      qid: qid\n    });\n    instance.showModal(vals);\n  },\n\n  'submit #newQuestion'(event, instance) {\n    event.preventDefault();\n    console.log('submit #newQuestion => ', event, instance);\n    const target = event.target;\n    const values = {\n      //'Category':target.Category.value,\n      'Categories': $(target).find(\"#select-categories\")[0].selectize.items,\n      'Text': target.Text.value,\n      'LeftText': target.LeftText.value,\n      'RightText': target.RightText.value,\n      'segments': $(target).find(\"#select-segments\")[0].selectize ? $(target).find(\"#select-segments\")[0].selectize.items : []\n    };\n    console.log(values);\n    Meteor.call('question.insert', values.Categories, values.Text, values.LeftText, values.RightText, values.segments, error => {\n      if (error) {\n        console.log(\"EEEEEERRRORRRRR: \", error);\n      } else {\n        target.Text.value = '';\n        target.LeftText.value = '';\n        target.RightText.value = '';\n      }\n    });\n  }\n\n});\nTemplate.add_questions.onRendered(function () {\n  $('.dropdown-toggle').dropdown();\n  $('ul.nav-tabs li a').click(function (e) {\n    e.preventDefault();\n    $(this).tab('show');\n    $('tbody.edit-body').hide();\n    $('#' + $(this).data('type') + \"Table\").show();\n  });\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"add_readings\":{\"add_readings.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/add_readings/add_readings.html                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.add_readings.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.add_readings.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/add_readings/template.add_readings.js                                                              //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"add_readings\");\nTemplate[\"add_readings\"] = new Template(\"Template.add_readings\", (function() {\n  var view = this;\n  return Blaze.If(function() {\n    return Spacebars.call(view.templateInstance().subscriptionsReady());\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      class: \"container\"\n    }, \"\\n        \", HTML.DIV({\n      class: \"row\"\n    }, \"\\n            \", HTML.TABLE({\n      class: \"table table-striped table-hover\"\n    }, \"\\n                \", HTML.THEAD(\"\\n                \", HTML.TR(\"\\n                    \", HTML.TD(\"\\n                        \", HTML.A({\n      href: \"#\",\n      id: \"addTypeReadingLink\"\n    }, HTML.H4({\n      style: \"margin:0;\"\n    }, \"Add new trait description \", HTML.SPAN({\n      class: \"glyphicon glyphicon-chevron-down\"\n    }))), \"\\n                        \", HTML.DIV({\n      class: \"add-type-reading\",\n      style: \"overflow: inherit;display:none;\"\n    }, \"\\n                            \", HTML.DIV({\n      role: \"\",\n      class: \"\",\n      id: \"addReading\"\n    }, \"\\n                                \", HTML.FORM({\n      id: \"newReading\"\n    }, \"\\n                                    \", HTML.INPUT({\n      type: \"text\",\n      class: \"form-control input-medium\",\n      name: \"Header\",\n      style: \"height:34px;margin:5px 0 5px 0;\",\n      placeholder: \"Title...\"\n    }), \"\\n                                    \", HTML.TEXTAREA({\n      class: \"form-control\",\n      name: \"Body\",\n      placeholder: \"Body of the description...\",\n      style: \"height:200px;margin:5px 0 5px 0;\"\n    }), \"\\n                                    \", HTML.BUTTON({\n      class: \"btn btn-default btn-primary new-reading pull-right\",\n      type: \"submit\",\n      style: \"margin:5px 0 5px 0;\"\n    }, \"Add\"), \"\\n                                \"), \"\\n                            \"), \"\\n                        \"), \"\\n                    \"), \"\\n                \"), \"\\n                \"), \"\\n                \", HTML.TBODY(\"\\n                \", HTML.TR(\"\\n                    \", HTML.TD(\"\\n                        \", HTML.H4(\"Edit existing trait descriptions\"), \"\\n                    \"), \"\\n                \"), \"\\n                \"), \"\\n                \", HTML.TBODY({\n      id: \"readingTable\",\n      class: \"edit-body\",\n      style: \"\"\n    }, \"\\n            \", Blaze.Each(function() {\n      return {\n        _sequence: Spacebars.call(view.lookup(\"readings\")),\n        _variable: \"reading\"\n      };\n    }, function() {\n      return [ \"\\n                \", HTML.TR({\n        \"data-id\": function() {\n          return Spacebars.mustache(Spacebars.dot(view.lookup(\"reading\"), \"_id\"));\n        },\n        id: function() {\n          return Spacebars.mustache(Spacebars.dot(view.lookup(\"reading\"), \"_id\"));\n        },\n        class: \"edit-reading edit-row\"\n      }, \"\\n                    \", HTML.TD(\"\\n                        \", HTML.DIV({\n        class: \"row\"\n      }, \"\\n                            \", HTML.DIV({\n        class: \"col-md-1\"\n      }, \"\\n                                \", HTML.SPAN({\n        style: \"cursor: pointer;\",\n        class: function() {\n          return [ \"label label-\", Blaze.If(function() {\n            return Spacebars.call(Spacebars.dot(view.lookup(\"reading\"), \"Enabled\"));\n          }, function() {\n            return \"success\";\n          }, function() {\n            return \"danger\";\n          }), \" toggle-enable-reading\" ];\n        }\n      }, Blaze.If(function() {\n        return Spacebars.call(Spacebars.dot(view.lookup(\"reading\"), \"Enabled\"));\n      }, function() {\n        return \"Active\";\n      }, function() {\n        return \"Inactive\";\n      })), \"\\n                            \"), \"\\n                            \", HTML.DIV({\n        class: \"col-md-10\"\n      }, \"\\n                                \", HTML.H5(HTML.STRONG(Blaze.View(\"lookup:reading.Header\", function() {\n        return Spacebars.mustache(Spacebars.dot(view.lookup(\"reading\"), \"Header\"));\n      }))), \"\\n                                \", HTML.P({\n        class: \"text-justify\"\n      }, \"\\n                                    \", Blaze.View(\"lookup:reading.Body\", function() {\n        return Spacebars.mustache(Spacebars.dot(view.lookup(\"reading\"), \"Body\"));\n      }), \"\\n                                \"), \"\\n                                \", HTML.DIV({\n        style: \"float:left;\"\n      }, \"\\n                                    \", HTML.A({\n        href: \"#\",\n        class: \"readingCategoryLink\",\n        \"data-category\": \"0\",\n        \"data-high\": function() {\n          return Spacebars.mustache(view.lookup(\"getRange\"), view.lookup(\"reading\"), 0, 1);\n        },\n        \"data-low\": function() {\n          return Spacebars.mustache(view.lookup(\"getRange\"), view.lookup(\"reading\"), 0, 0);\n        }\n      }, \"\\n                                        \", Blaze.If(function() {\n        return Spacebars.dataMustache(view.lookup(\"readingHasCategory\"), view.lookup(\"reading\"), 0);\n      }, function() {\n        return [ \"\\n                                            \", HTML.SPAN({\n          class: \"label label-primary\",\n          \"data-toggle\": \"tooltip\",\n          \"data-placement\": \"top\",\n          title: function() {\n            return Spacebars.mustache(view.lookup(\"readingCategory\"), view.lookup(\"reading\"), 0);\n          }\n        }, Blaze.View(\"lookup:indexToCategory\", function() {\n          return Spacebars.mustache(view.lookup(\"indexToCategory\"), 0);\n        })), \"\\n                                        \" ];\n      }, function() {\n        return [ \"\\n                                            \", HTML.SPAN({\n          class: \"label label-default\",\n          \"data-toggle\": \"tooltip\",\n          \"data-placement\": \"top\",\n          title: \"Not set\"\n        }, Blaze.View(\"lookup:indexToCategory\", function() {\n          return Spacebars.mustache(view.lookup(\"indexToCategory\"), 0);\n        })), \"\\n                                        \" ];\n      }), \"\\n                                    \"), \"\\n                                    \", HTML.A({\n        href: \"#\",\n        class: \"readingCategoryLink\",\n        \"data-category\": \"1\",\n        \"data-high\": function() {\n          return Spacebars.mustache(view.lookup(\"getRange\"), view.lookup(\"reading\"), 1, 1);\n        },\n        \"data-low\": function() {\n          return Spacebars.mustache(view.lookup(\"getRange\"), view.lookup(\"reading\"), 1, 0);\n        }\n      }, Blaze.If(function() {\n        return Spacebars.dataMustache(view.lookup(\"readingHasCategory\"), view.lookup(\"reading\"), 1);\n      }, function() {\n        return HTML.SPAN({\n          class: \"label label-primary\",\n          \"data-toggle\": \"tooltip\",\n          \"data-placement\": \"top\",\n          title: function() {\n            return Spacebars.mustache(view.lookup(\"readingCategory\"), view.lookup(\"reading\"), 1);\n          }\n        }, Blaze.View(\"lookup:indexToCategory\", function() {\n          return Spacebars.mustache(view.lookup(\"indexToCategory\"), 1);\n        }));\n      }, function() {\n        return HTML.SPAN({\n          class: \"label label-default\",\n          \"data-toggle\": \"tooltip\",\n          \"data-placement\": \"top\",\n          title: \"Not set\"\n        }, Blaze.View(\"lookup:indexToCategory\", function() {\n          return Spacebars.mustache(view.lookup(\"indexToCategory\"), 1);\n        }));\n      })), \"\\n                                    \", HTML.A({\n        href: \"#\",\n        class: \"readingCategoryLink\",\n        \"data-category\": \"2\",\n        \"data-high\": function() {\n          return Spacebars.mustache(view.lookup(\"getRange\"), view.lookup(\"reading\"), 2, 1);\n        },\n        \"data-low\": function() {\n          return Spacebars.mustache(view.lookup(\"getRange\"), view.lookup(\"reading\"), 2, 0);\n        }\n      }, Blaze.If(function() {\n        return Spacebars.dataMustache(view.lookup(\"readingHasCategory\"), view.lookup(\"reading\"), 2);\n      }, function() {\n        return HTML.SPAN({\n          class: \"label label-primary\",\n          \"data-toggle\": \"tooltip\",\n          \"data-placement\": \"top\",\n          title: function() {\n            return Spacebars.mustache(view.lookup(\"readingCategory\"), view.lookup(\"reading\"), 2);\n          }\n        }, Blaze.View(\"lookup:indexToCategory\", function() {\n          return Spacebars.mustache(view.lookup(\"indexToCategory\"), 2);\n        }));\n      }, function() {\n        return HTML.SPAN({\n          class: \"label label-default\",\n          \"data-toggle\": \"tooltip\",\n          \"data-placement\": \"top\",\n          title: \"Not set\"\n        }, Blaze.View(\"lookup:indexToCategory\", function() {\n          return Spacebars.mustache(view.lookup(\"indexToCategory\"), 2);\n        }));\n      })), \"\\n                                    \", HTML.A({\n        href: \"#\",\n        class: \"readingCategoryLink\",\n        \"data-category\": \"3\",\n        \"data-high\": function() {\n          return Spacebars.mustache(view.lookup(\"getRange\"), view.lookup(\"reading\"), 3, 1);\n        },\n        \"data-low\": function() {\n          return Spacebars.mustache(view.lookup(\"getRange\"), view.lookup(\"reading\"), 3, 0);\n        }\n      }, Blaze.If(function() {\n        return Spacebars.dataMustache(view.lookup(\"readingHasCategory\"), view.lookup(\"reading\"), 3);\n      }, function() {\n        return HTML.SPAN({\n          class: \"label label-primary\",\n          \"data-toggle\": \"tooltip\",\n          \"data-placement\": \"top\",\n          title: function() {\n            return Spacebars.mustache(view.lookup(\"readingCategory\"), view.lookup(\"reading\"), 3);\n          }\n        }, Blaze.View(\"lookup:indexToCategory\", function() {\n          return Spacebars.mustache(view.lookup(\"indexToCategory\"), 3);\n        }));\n      }, function() {\n        return HTML.SPAN({\n          class: \"label label-default\",\n          \"data-toggle\": \"tooltip\",\n          \"data-placement\": \"top\",\n          title: \"Not set\"\n        }, Blaze.View(\"lookup:indexToCategory\", function() {\n          return Spacebars.mustache(view.lookup(\"indexToCategory\"), 3);\n        }));\n      })), \"\\n                                \"), \"\\n                                \", HTML.DIV({\n        style: \"float:right;font-weight:bold;\"\n      }, Blaze.View(\"lookup:readingAuthor\", function() {\n        return Spacebars.makeRaw(Spacebars.mustache(view.lookup(\"readingAuthor\"), view.lookup(\"reading\")));\n      })), \"\\n                            \"), \"\\n                            \", HTML.DIV({\n        class: \"col-md-1\",\n        style: \"text-align: right;\"\n      }, \"\\n                                \", HTML.SPAN({\n        class: \"glyphicon glyphicon-remove delete-reading text-danger\",\n        \"data-rid\": function() {\n          return Spacebars.mustache(Spacebars.dot(view.lookup(\"reading\"), \"_id\"));\n        },\n        style: \"cursor: pointer;\"\n      }), \"\\n                            \"), \"\\n                            \", HTML.DIV({\n        class: \"col-md-10 col-md-offset-1 expansion-drawer\",\n        style: \"display:none;\"\n      }, \"\\n                                \", HTML.FORM({\n        id: function() {\n          return [ \"addCategoryToReading-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"reading\"), \"_id\")) ];\n        },\n        class: \"addCategoryToReadingForm\"\n      }, \"\\n                                    \", HTML.INPUT({\n        type: \"hidden\",\n        name: \"readingId\",\n        value: function() {\n          return Spacebars.mustache(Spacebars.dot(view.lookup(\"reading\"), \"_id\"));\n        }\n      }), \"\\n                                    \", HTML.DIV({\n        class: \"input-group\",\n        style: \"margin-top:10px;\"\n      }, \"\\n                                        \", HTML.SPAN({\n        class: \"input-group-addon readingCategoryDisplay\"\n      }), \"\\n                                        \", HTML.INPUT({\n        type: \"hidden\",\n        name: \"Category\",\n        value: \"\"\n      }), \"\\n                                        \", HTML.INPUT({\n        type: \"text\",\n        class: \"form-control input-medium\",\n        name: \"Low\",\n        style: \"height:34px;\",\n        placeholder: \"Low limit\"\n      }), \"\\n                                        \", HTML.SPAN({\n        class: \"input-group-addon\"\n      }, HTML.CharRef({\n        html: \"&nbsp;\",\n        str: \"\"\n      }), \"to\", HTML.CharRef({\n        html: \"&nbsp;\",\n        str: \"\"\n      })), \"\\n                                        \", HTML.INPUT({\n        type: \"text\",\n        class: \"form-control input-medium\",\n        name: \"High\",\n        style: \"height:34px;\",\n        placeholder: \"High limit\"\n      }), \"\\n                                        \", HTML.SPAN({\n        class: \"input-group-btn\"\n      }, \"\\n                                            \", HTML.BUTTON({\n        class: \"btn btn-default btn-primary new-reading-category\",\n        type: \"submit\"\n      }, \"Set\"), \"\\n                                        \"), \"\\n                                    \"), \"\\n                                \"), \"\\n                            \"), \"\\n                        \"), \"\\n                    \"), HTML.SCRIPT(\"\\n                        $('#\", Blaze.View(\"lookup:reading._id\", function() {\n        return Spacebars.mustache(Spacebars.dot(view.lookup(\"reading\"), \"_id\"));\n      }), ' *[data-toggle=\"tooltip\"]\\').tooltip();\\n                    '), \"\\n                \"), \"\\n            \" ];\n    }), \"\\n                \"), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.Comment(\" Modal \"), \"\\n        \", HTML.DIV({\n      class: \"modal fade\",\n      id: \"tempModal\",\n      tabindex: \"-1\",\n      role: \"dialog\",\n      \"aria-labelledby\": \"tempModalLabel\"\n    }, \"\\n          \", HTML.DIV({\n      class: \"modal-dialog\",\n      role: \"document\",\n      style: \"margin:0;\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"modal-content\"\n    }, \"\\n              \", HTML.DIV({\n      class: \"modal-header\"\n    }, \"\\n                \", HTML.BUTTON({\n      type: \"button\",\n      class: \"close\",\n      \"data-dismiss\": \"modal\",\n      \"aria-label\": \"Close\"\n    }, HTML.SPAN({\n      \"aria-hidden\": \"true\"\n    }, HTML.CharRef({\n      html: \"&times;\",\n      str: \"\"\n    }))), \"\\n                \", HTML.H4({\n      class: \"modal-title\"\n    }), \"\\n              \"), \"\\n              \", HTML.DIV({\n      class: \"modal-body\"\n    }, \"\\n\\n              \"), \"\\n              \", HTML.DIV({\n      class: \"modal-footer\"\n    }, \"\\n                \", HTML.BUTTON({\n      type: \"button\",\n      class: \"btn btn-default closebtn\",\n      \"data-dismiss\": \"modal\"\n    }), \"\\n                \", HTML.BUTTON({\n      type: \"button\",\n      class: \"btn btn-primary savebtn\"\n    }), \"\\n              \"), \"\\n            \"), \"\\n          \"), \"\\n        \"), \"\\n    \"), \"\\n    \" ];\n  }, function() {\n    return [ \"\\n        \", Spacebars.include(view.lookupTemplate(\"loading\")), \"\\n    \" ];\n  });\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"add_readings.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/add_readings/add_readings.js                                                                       //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nlet Question;\nmodule.watch(require(\"/imports/api/questions/questions.js\"), {\n  Question(v) {\n    Question = v;\n  }\n\n}, 0);\nlet User;\nmodule.watch(require(\"/imports/api/users/users.js\"), {\n  User(v) {\n    User = v;\n  }\n\n}, 1);\nlet FlowRouter;\nmodule.watch(require(\"meteor/kadira:flow-router\"), {\n  FlowRouter(v) {\n    FlowRouter = v;\n  }\n\n}, 2);\nlet Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 3);\nlet TypeReading;\nmodule.watch(require(\"/imports/api/type_readings/type_readings.js\"), {\n  TypeReading(v) {\n    TypeReading = v;\n  }\n\n}, 4);\nmodule.watch(require(\"./add_readings.html\"));\nTemplate.add_readings.onCreated(function add_readingsOnCreated() {\n  this.showModal = function (stuff) {\n    let m = $('#tempModal');\n    m.find('h4.modal-title').html(stuff.Title);\n    m.find('div.modal-body').html(stuff.Body);\n    m.find('div.modal-footer button.closebtn').html(stuff.CloseText);\n    m.find('div.modal-footer button.savebtn').html(stuff.SaveText).click(stuff.SaveFunction);\n\n    _.each(stuff.data, function (name, val) {\n      m.data(name, val);\n    });\n\n    m.modal('show');\n  };\n\n  this.makeModalStuff = function (title, body, closeText, saveText, saveFunction, data) {\n    return {\n      Title: title,\n      Body: body,\n      CloseText: closeText,\n      SaveText: saveText,\n      SaveFunction: saveFunction,\n      data: data\n    };\n  };\n\n  this.autorun(() => {\n    this.subscription = this.subscribe('typereadings.getAll', {\n      onStop: function () {\n        console.log(\"Subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"Subscription ready! \", arguments, this);\n      },\n      sort: {\n        \"TypeReadingCategories.Range.Delta\": -1\n      }\n    });\n    console.log(this.subscription);\n  });\n});\nTemplate.add_readings.helpers({\n  readings() {\n    return TypeReading.find({}, {\n      sort: {\n        \"TypeReadingCategories.Range.low\": 1,\n        \"TypeReadingCategories.Range.Delta\": -1\n      }\n    });\n  },\n\n  indexToCategory(ind) {\n    if (ind === 0) {\n      return 'IE';\n    }\n\n    if (ind === 1) {\n      return 'NS';\n    }\n\n    if (ind === 2) {\n      return 'TF';\n    }\n\n    if (ind === 3) {\n      return 'JP';\n    }\n\n    return 'UN';\n  },\n\n  categoryToIndex(cat) {\n    if (cat === 'IE') {\n      return 0;\n    }\n\n    if (cat === 'NS') {\n      return 1;\n    }\n\n    if (cat === 'TF') {\n      return 2;\n    }\n\n    if (cat === 'JP') {\n      return 3;\n    }\n\n    return -1;\n  },\n\n  readingHasCategory(reading, category) {\n    return !!reading.TypeReadingCategories[category];\n  },\n\n  readingCategory(reading, category) {\n    if (!reading.TypeReadingCategories[category]) {\n      return \"-\";\n    } else {\n      return \"from \" + reading.TypeReadingCategories[category].Range.low + \" to \" + reading.TypeReadingCategories[category].Range.high;\n    }\n  },\n\n  getRange(reading, category, isHigh) {\n    if (!reading.TypeReadingCategories[category]) {\n      return \"\";\n    }\n\n    return isHigh ? reading.TypeReadingCategories[category].Range.high : reading.TypeReadingCategories[category].Range.low;\n  },\n\n  readingAuthor(reading) {\n    let u = User.findOne(reading.CreatedBy);\n    return u.MyProfile.fullName() + \" <span class='label label-warning'>\" + u.MyProfile.UserType.Personality.getFourLetter() + \"</span>\";\n  },\n\n  getUserName(userId) {\n    let u = User.findOne({\n      _id: userId\n    });\n    u.callMethod('fullName', (err, result) => {\n      console.log(err, result);\n      return result;\n    }); //return u.fullName();\n  }\n\n});\nTemplate.add_readings.events({\n  'click span.toggle-enable-reading'(event, instance) {\n    console.log('click span.toggle-enable-reading => ', event, instance);\n    let rid = $(event.target).closest('tr').data('id');\n    Meteor.call('typereadings.toggle', rid, error => {\n      if (error) {\n        console.log(\"Error on toggle reading: \", error);\n      } else {\n        console.log(rid + \" should be toggled.\");\n      }\n    });\n  },\n\n  'click span.delete-reading'(event, instance) {\n    event.preventDefault();\n    console.log('click span.delete-reading => ', event, instance);\n    const target = event.target;\n    let rid = $(target).data('rid');\n    let vals = instance.makeModalStuff(\"Are you really sure?\", \"<h5>Do you really want to delete the reading:</h5><table class='table table-bordered'><tr>\" + $(\"#\" + rid).html() + \"</tr></table>\", \"No!\", \"I guess...\", function (event) {\n      $('#tempModal').modal('hide');\n      $(this).off(event);\n      Meteor.call('typereadings.delete', rid, error => {\n        if (error) {\n          console.log(\"Error on delete: \", error);\n        } else {\n          console.log(rid + \" should be deleted...\");\n        }\n      });\n    }, {\n      rid: rid\n    });\n    instance.showModal(vals);\n  },\n\n  'click #addTypeReadingLink'(event, instance) {\n    event.preventDefault();\n\n    if ($('span', event.target).hasClass('glyphicon-chevron-down')) {\n      $('span', event.target).removeClass('glyphicon-chevron-down').addClass('glyphicon-chevron-up');\n      $('div.add-type-reading').slideDown(300);\n    } else {\n      $('span', event.target).removeClass('glyphicon-chevron-up').addClass('glyphicon-chevron-down');\n      $('div.add-type-reading').slideUp(300);\n    }\n  },\n\n  'click a.readingCategoryLink'(event, instance) {\n    event.preventDefault();\n    var me = $(event.target);\n    var parentData = me.parent().get(0).dataset;\n    var cat = parseInt(parentData.category);\n    var hi = parentData.high;\n    var low = parentData.low;\n    var mom = me.parents('div.row:first');\n    mom.find('input[name=Category]').val(cat);\n    mom.find('span.readingCategoryDisplay').html(instance.view.template.__helpers[\" indexToCategory\"](cat));\n    mom.find('input[name=Low]').val(low);\n    mom.find('input[name=High]').val(hi);\n\n    if (!mom.find('.expansion-drawer').is(':visible')) {\n      $('.expansion-drawer').slideUp(300);\n      mom.find('.expansion-drawer').slideDown(300);\n    }\n  },\n\n  'submit #newReading'(event, instance) {\n    event.preventDefault();\n    console.log('submit #newReading => ', event, instance);\n    const target = event.target;\n    const values = {\n      'Header': target.Header.value,\n      'Body': target.Body.value\n    };\n    console.log(values);\n    Meteor.call('typereadings.insert', values.Header, values.Body, error => {\n      if (error) {\n        console.log(\"EEEEEERRRORRRRR: \", error);\n      } else {\n        target.Header.value = '';\n        target.Body.value = '';\n      }\n    });\n  },\n\n  'submit form.addCategoryToReadingForm'(event, instance) {\n    event.preventDefault();\n    const target = event.target;\n    const values = {\n      Category: target.Category.value,\n      High: target.High.value,\n      Low: target.Low.value,\n      ReadingId: target.readingId.value\n    };\n    Meteor.call('typereadings.addCategoryToReading', values.ReadingId, values.Category, values.High, values.Low, error => {\n      if (error) {\n        console.log(\"EEEEEEEEEEERRRRRRRRRRROOOOOOOOORRRRR: \", error);\n      } else {\n        console.log(\"We good, man!\");\n        target.Low.value = '';\n        target.High.value = '';\n      }\n    });\n  }\n\n});\nTemplate.add_readings.onRendered(function () {});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"admin_teams\":{\"admin_teams.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/admin_teams/admin_teams.html                                                                       //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.admin_teams.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.admin_teams.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/admin_teams/template.admin_teams.js                                                                //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"admin_teams\");\nTemplate[\"admin_teams\"] = new Template(\"Template.admin_teams\", (function() {\n  var view = this;\n  return Blaze.If(function() {\n    return Spacebars.call(view.templateInstance().subscriptionsReady());\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      class: \"container\"\n    }, \"\\n        \", Blaze.If(function() {\n      return Spacebars.dataMustache(view.lookup(\"isInRole\"), \"admin\");\n    }, function() {\n      return [ \"\\n            \", Blaze.Unless(function() {\n        return Spacebars.call(view.lookup(\"specificTeam\"));\n      }, function() {\n        return [ \"\\n                \", HTML.DIV({\n          id: \"form-new-team\"\n        }, \"\\n                    \", HTML.DIV({\n          class: \"row spaced\"\n        }, \"\\n                        \", HTML.DIV({\n          class: \"col-sm-6\"\n        }, \"\\n                            \", HTML.DIV({\n          class: \"input-group\"\n        }, \"\\n                                \", HTML.INPUT({\n          id: \"input-new-team-name\",\n          type: \"text\",\n          class: \"form-control\",\n          placeholder: \"New team name...\"\n        }), \"\\n                                \", HTML.SPAN({\n          class: \"input-group-btn\"\n        }, \"\\n                                    \", HTML.BUTTON({\n          class: \"btn btn-primary\",\n          id: \"btn-create-team\"\n        }, HTML.SPAN({\n          class: \"glyphicon glyphicon-plus-sign\"\n        }), \" Create\"), \"\\n                                \"), \"\\n                            \"), \"\\n                        \"), \"\\n                        \", HTML.DIV({\n          class: \"col-sm-6\"\n        }, \"\\n                            \", HTML.DIV({\n          class: \"alert\",\n          id: \"msg-create\"\n        }, \"\\n                            \"), \"\\n                        \"), \"\\n                    \"), \"\\n                    \", HTML.DIV({\n          class: \"row spaced\",\n          id: \"div-new-team-details\"\n        }, \"\\n                        \", HTML.DIV({\n          class: \"col-sm-6\"\n        }, \"\\n                            \", HTML.TEXTAREA({\n          id: \"input-new-team-description\",\n          class: \"form-control\",\n          placeholder: \"New team description...\"\n        }), \"\\n                        \"), \"\\n                    \"), \"\\n                \"), \"\\n            \" ];\n      }), \"\\n        \" ];\n    }), \"\\n        \", Blaze.If(function() {\n      return Spacebars.call(view.lookup(\"specificTeam\"));\n    }, function() {\n      return [ \"\\n            \", HTML.DIV({\n        class: \"team-list list-group\"\n      }, \"\\n                \", Blaze.Each(function() {\n        return {\n          _sequence: Spacebars.call(view.lookup(\"teams\")),\n          _variable: \"team\"\n        };\n      }, function() {\n        return [ \"\\n                    \", Blaze._TemplateWith(function() {\n          return {\n            team: Spacebars.call(view.lookup(\"team\")),\n            single: Spacebars.call(\"1\")\n          };\n        }, function() {\n          return Spacebars.include(view.lookupTemplate(\"team_view\"));\n        }), \"\\n                \" ];\n      }), \"\\n            \"), \"\\n        \" ];\n    }, function() {\n      return [ \"\\n            \", HTML.DIV({\n        class: \"team-list list-group\"\n      }, \"\\n                My Teams\\n                \", Blaze.Each(function() {\n        return {\n          _sequence: Spacebars.call(view.lookup(\"teamsMemberOf\")),\n          _variable: \"team\"\n        };\n      }, function() {\n        return [ \"\\n                    \", Blaze._TemplateWith(function() {\n          return {\n            team: Spacebars.call(view.lookup(\"team\"))\n          };\n        }, function() {\n          return Spacebars.include(view.lookupTemplate(\"team_view\"));\n        }), \"\\n                \" ];\n      }), \"\\n            \"), \"\\n            \", HTML.DIV({\n        class: \"team-list list-group\"\n      }, \"\\n                Other Teams\\n                \", Blaze.Each(function() {\n        return {\n          _sequence: Spacebars.call(view.lookup(\"teamsOther\")),\n          _variable: \"team\"\n        };\n      }, function() {\n        return [ \"\\n                    \", Blaze._TemplateWith(function() {\n          return {\n            team: Spacebars.call(view.lookup(\"team\"))\n          };\n        }, function() {\n          return Spacebars.include(view.lookupTemplate(\"team_view\"));\n        }), \"\\n                \" ];\n      }), \"\\n            \"), \"\\n        \" ];\n    }), \"\\n    \"), \"\\n    \" ];\n  }, function() {\n    return [ \"\\n        \", Spacebars.include(view.lookupTemplate(\"loading\")), \"\\n    \" ];\n  });\n}));\n\nTemplate.__checkName(\"team_view\");\nTemplate[\"team_view\"] = new Template(\"Template.team_view\", (function() {\n  var view = this;\n  return HTML.DIV({\n    class: function() {\n      return [ \"team-view \", Blaze.Unless(function() {\n        return Spacebars.call(view.lookup(\"single\"));\n      }, function() {\n        return \"collapsed\";\n      }), \" list-group-item\" ];\n    },\n    \"data-team-id\": function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"_id\"));\n    },\n    \"data-team-name\": function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"Name\"));\n    },\n    id: function() {\n      return [ \"div-team-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"_id\")) ];\n    }\n  }, \"\\n        \", HTML.DIV({\n    class: \"row summary-row\"\n  }, \"\\n            \", HTML.DIV({\n    class: \"col-sm-10 collapsed-summary\"\n  }, \"\\n                \", Blaze._TemplateWith(function() {\n    return {\n      team: Spacebars.call(view.lookup(\"team\"))\n    };\n  }, function() {\n    return Spacebars.include(view.lookupTemplate(\"team_icon\"));\n  }), \"\\n                \", HTML.SPAN({\n    class: \"team-name\"\n  }, Blaze.View(\"lookup:team.Name\", function() {\n    return Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"Name\"));\n  })), \"\\n                \", HTML.SPAN({\n    class: \"collapsed-description\"\n  }, Blaze.View(\"lookup:team.Description\", function() {\n    return Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"Description\"));\n  })), \"\\n            \"), \"\\n            \", HTML.DIV({\n    class: \"col-sm-10 expanded-summary\"\n  }, \"\\n                \", HTML.SPAN({\n    class: \"team-title\"\n  }, HTML.INPUT(HTML.Attrs({\n    type: \"text\",\n    id: function() {\n      return [ \"team-title-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"_id\")) ];\n    },\n    class: \"flat form-control\",\n    value: function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"Name\"));\n    },\n    placeholder: [ HTML.CharRef({\n      html: \"&lt;\",\n      str: \"<\"\n    }), \"Enter team name...\", HTML.CharRef({\n      html: \"&gt;\",\n      str: \">\"\n    }) ]\n  }, function() {\n    return Spacebars.attrMustache(view.lookup(\"fldEnabled\"), \"title\");\n  }))), \"\\n            \"), \"\\n            \", HTML.DIV({\n    class: \"col-sm-2 text-right btn-group-xs\"\n  }, \"\\n                \", HTML.Raw('<button class=\"btn btn-success btn-save glyphicon glyphicon-ok details\" disabled=\"\" alt=\"Save changes\"></button>'), \"\\n                \", HTML.Raw('<button class=\"btn btn-warning btn-cancel glyphicon glyphicon-remove details\" disabled=\"\" alt=\"Discard changes\"></button>'), \"\\n                \", Blaze.Unless(function() {\n    return Spacebars.call(view.lookup(\"single\"));\n  }, function() {\n    return [ \"\\n                    \", HTML.BUTTON({\n      class: \"btn btn-primary btn-expand glyphicon glyphicon-chevron-down\",\n      id: function() {\n        return [ \"btn-expand-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"_id\")) ];\n      }\n    }), \"\\n                \" ];\n  }), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n    class: \"row spaced details\"\n  }, \"\\n            \", HTML.DIV({\n    class: \"col-sm-10\"\n  }, \"\\n                \", HTML.DIV({\n    class: \"team-description\"\n  }, \"\\n                    \", HTML.TEXTAREA(HTML.Attrs({\n    id: function() {\n      return [ \"team-description-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"_id\")) ];\n    },\n    class: \"flat form-control\",\n    placeholder: [ HTML.CharRef({\n      html: \"&lt;\",\n      str: \"<\"\n    }), \"Enter team description...\", HTML.CharRef({\n      html: \"&gt;\",\n      str: \">\"\n    }) ]\n  }, function() {\n    return Spacebars.attrMustache(view.lookup(\"fldEnabled\"), \"description\");\n  }, {\n    value: function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"Description\"));\n    }\n  })), \"\\n                \"), \"\\n            \"), \"\\n            \", HTML.Raw('<div class=\"col-sm-2 text-right\">\\n            </div>'), \"\\n        \"), \"\\n        \", HTML.DIV({\n    class: \"row spaced details\"\n  }, \"\\n            \", HTML.DIV({\n    class: \"col-sm-10\"\n  }, \"\\n                \", Blaze.If(function() {\n    return Spacebars.dataMustache(view.lookup(\"isInRole\"), \"admin,view-members\", Spacebars.dot(view.lookup(\"team\"), \"Name\"));\n  }, function() {\n    return [ \"\\n                \", HTML.DIV({\n      class: \"user-list-table\"\n    }, \"\\n                    \", HTML.H4(\"Members\"), \"\\n                    \", HTML.TABLE({\n      class: \"table\"\n    }, \"\\n                        \", HTML.THEAD(\"\\n                            \", HTML.TR(\"\\n                                \", HTML.TH(\"First Name\"), \"\\n                                \", HTML.TH(\"Last Name\"), \"\\n                                \", HTML.TH(\"Team Roles\"), \"\\n                            \"), \"\\n                        \"), \"\\n                        \", HTML.TBODY(\"\\n                            \", Blaze.Each(function() {\n      return {\n        _sequence: Spacebars.dataMustache(view.lookup(\"teamMembers\"), Spacebars.dot(view.lookup(\"team\"), \"Name\")),\n        _variable: \"member\"\n      };\n    }, function() {\n      return [ \"\\n                            \", HTML.TR({\n        \"data-user-id\": function() {\n          return Spacebars.mustache(Spacebars.dot(view.lookup(\"member\"), \"_id\"));\n        }\n      }, \"\\n                                \", HTML.TD(Blaze.View(\"lookup:member.firstName\", function() {\n        return Spacebars.mustache(Spacebars.dot(view.lookup(\"member\"), \"firstName\"));\n      })), \"\\n                                \", HTML.TD(Blaze.View(\"lookup:member.lastName\", function() {\n        return Spacebars.mustache(Spacebars.dot(view.lookup(\"member\"), \"lastName\"));\n      })), \"\\n                                \", HTML.TD(\"\\n                                    \", Blaze._TemplateWith(function() {\n        return {\n          id: Spacebars.call(\"select-roles-\"),\n          id2: Spacebars.call(view.lookup(\"uniqueId\")),\n          name: Spacebars.call(\"roles[]\"),\n          placeholder: Spacebars.call(\"Roles...\"),\n          list: Spacebars.call(view.lookup(\"rolesList\")),\n          selected: Spacebars.call(Spacebars.dot(view.lookup(\"member\"), \"roles\"))\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"select_autocomplete\"));\n      }), \"\\n                                \"), \"\\n                            \"), \"\\n                            \" ];\n    }), \"\\n                        \"), \"\\n                    \"), \"\\n                \"), \"\\n                \" ];\n  }), \"\\n                \", Blaze.If(function() {\n    return Spacebars.dataMustache(view.lookup(\"isInRole\"), \"admin\", Spacebars.dot(view.lookup(\"team\"), \"Name\"));\n  }, function() {\n    return [ \"\\n                \", Blaze.If(function() {\n      return Spacebars.dataMustache(view.lookup(\"hasTeamRequests\"), Spacebars.dot(view.lookup(\"team\"), \"Name\"));\n    }, function() {\n      return [ \"\\n                \", HTML.DIV({\n        class: \"user-list-table\"\n      }, \"\\n                    \", HTML.H4(\"Join requests\"), \"\\n                    \", HTML.TABLE({\n        class: \"table\"\n      }, \"\\n                        \", HTML.THEAD(\"\\n                            \", HTML.TR(\"\\n                                \", HTML.TH(\"First Name\"), \"\\n                                \", HTML.TH(\"Last Name\"), \"\\n                                \", HTML.TH(\"Actions\"), \"\\n                            \"), \"\\n                        \"), \"\\n                        \", HTML.TBODY(\"\\n                            \", Blaze.Each(function() {\n        return {\n          _sequence: Spacebars.dataMustache(view.lookup(\"teamRequests\"), Spacebars.dot(view.lookup(\"team\"), \"Name\")),\n          _variable: \"request\"\n        };\n      }, function() {\n        return [ \"\\n                            \", HTML.TR({\n          class: \"\"\n        }, \"\\n                                \", HTML.TD(Blaze.View(\"lookup:request.firstName\", function() {\n          return Spacebars.mustache(Spacebars.dot(view.lookup(\"request\"), \"firstName\"));\n        })), \"\\n                                \", HTML.TD(Blaze.View(\"lookup:request.lastName\", function() {\n          return Spacebars.mustache(Spacebars.dot(view.lookup(\"request\"), \"lastName\"));\n        })), \"\\n                                \", HTML.TD(\"\\n                                    \", HTML.SPAN({\n          class: \"label label-info\"\n        }, \"\\n                                        \", HTML.A({\n          href: \"#\",\n          \"data-user-id\": function() {\n            return Spacebars.mustache(Spacebars.dot(view.lookup(\"request\"), \"_id\"));\n          },\n          class: \"btn-approve-join\"\n        }, \"Approve\"), \"\\n                                    \"), \"\\n                                    \", HTML.SPAN({\n          class: \"label label-default\"\n        }, \"\\n                                        \", HTML.A({\n          href: \"#\",\n          \"data-user-id\": function() {\n            return Spacebars.mustache(Spacebars.dot(view.lookup(\"request\"), \"_id\"));\n          },\n          class: \"btn-decline-join\"\n        }, \"Decline\"), \"\\n                                    \"), \"\\n                                \"), \"\\n                            \"), \"\\n                            \" ];\n      }), \"\\n                        \"), \"\\n                    \"), \"\\n                \"), \"\\n                \" ];\n    }), \"\\n                \", Blaze.If(function() {\n      return Spacebars.dataMustache(view.lookup(\"hasTeamInvites\"), Spacebars.dot(view.lookup(\"team\"), \"Name\"));\n    }, function() {\n      return [ \"\\n                \", HTML.DIV({\n        class: \"user-list-table\"\n      }, \"\\n                    \", HTML.H4(\"Pending invitations\"), \"\\n                    \", HTML.TABLE({\n        class: \"table\"\n      }, \"\\n                        \", HTML.THEAD(\"\\n                            \", HTML.TR(\"\\n                                \", HTML.TH(\"First Name\"), \"\\n                                \", HTML.TH(\"Last Name\"), \"\\n                                \", HTML.TH(\"Actions\"), \"\\n                            \"), \"\\n                        \"), \"\\n                        \", HTML.TBODY(\"\\n                            \", Blaze.Each(function() {\n        return {\n          _sequence: Spacebars.dataMustache(view.lookup(\"teamInvites\"), Spacebars.dot(view.lookup(\"team\"), \"Name\")),\n          _variable: \"invite\"\n        };\n      }, function() {\n        return [ \"\\n                            \", HTML.TR({\n          class: \"\"\n        }, \"\\n                                \", HTML.TD(Blaze.View(\"lookup:invite.firstName\", function() {\n          return Spacebars.mustache(Spacebars.dot(view.lookup(\"invite\"), \"firstName\"));\n        })), \"\\n                                \", HTML.TD(Blaze.View(\"lookup:invite.lastName\", function() {\n          return Spacebars.mustache(Spacebars.dot(view.lookup(\"invite\"), \"lastName\"));\n        })), \"\\n                                \", HTML.TD(\"\\n                                    \", HTML.SPAN({\n          class: \"label label-warning\"\n        }, \"\\n                                        \", HTML.A({\n          href: \"#\",\n          \"data-user-id\": function() {\n            return Spacebars.mustache(Spacebars.dot(view.lookup(\"invite\"), \"_id\"));\n          },\n          class: \"btn-cancel-invite\"\n        }, \"Cancel\"), \"\\n                                    \"), \"\\n                                \"), \"\\n                            \"), \"\\n                            \" ];\n      }), \"\\n                        \"), \"\\n                    \"), \"\\n                \"), \"\\n                \" ];\n    }), \"\\n                \" ];\n  }), \"\\n            \"), \"\\n            \", HTML.DIV({\n    class: \"col-sm-2 text-right\"\n  }, \"\\n                \", Blaze.If(function() {\n    return Spacebars.dataMustache(view.lookup(\"isInRole\"), \"admin\", Spacebars.dot(view.lookup(\"team\"), \"Name\"));\n  }, function() {\n    return [ \"\\n                \", HTML.DIV({\n      class: \"row spaced\"\n    }, HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                    \", HTML.DIV({\n      class: \"dropdown\",\n      \"data-team-id\": function() {\n        return Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"_id\"));\n      }\n    }, \"\\n                        \", HTML.BUTTON({\n      type: \"button\",\n      id: function() {\n        return [ \"add-user-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"_id\")) ];\n      },\n      class: \"btn btn-primary btn-sm btn-add-users btn-block btn-text-left\",\n      \"data-toggle\": \"dropdown\",\n      \"data-placement\": \"right\",\n      title: \"Send join requests\"\n    }, HTML.SPAN({\n      class: \"glyphicon glyphicon-plus-sign\"\n    }), \" Add users\"), \"\\n                        \", HTML.DIV({\n      class: \"dropdown-menu add-users\",\n      \"aria-labelledby\": function() {\n        return [ \"add-user-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"_id\")) ];\n      }\n    }, \"\\n                            \", HTML.DIV({\n      class: \"text-right btn-bar\"\n    }, \"\\n                                \", HTML.BUTTON({\n      class: \"btn btn-success btn-xs btn-add-users-save\"\n    }, HTML.SPAN({\n      class: \"glyphicon glyphicon-ok\"\n    })), \"\\n                                \", HTML.BUTTON({\n      class: \"btn btn-warning btn-xs btn-add-users-cancel\"\n    }, HTML.SPAN({\n      class: \"glyphicon glyphicon-remove\"\n    })), \"\\n                            \"), \"\\n                            \", Blaze._TemplateWith(function() {\n      return {\n        id: Spacebars.call(\"select-add-users-\"),\n        id2: Spacebars.call(Spacebars.dot(view.lookup(\"team\"), \"_id\")),\n        name: Spacebars.call(\"users[]\"),\n        placeholder: Spacebars.call(\"Users...\"),\n        list: Spacebars.call(view.lookup(\"userAddList\"))\n      };\n    }, function() {\n      return Spacebars.include(view.lookupTemplate(\"select_autocomplete\"));\n    }), \"\\n                        \"), \"\\n                    \"), \"\\n                \")), \"\\n                \" ];\n  }), \"\\n                \", Blaze.Unless(function() {\n    return Spacebars.dataMustache(view.lookup(\"isInRole\"), \"member,admin-join-request,user-join-request\", Spacebars.dot(view.lookup(\"team\"), \"Name\"));\n  }, function() {\n    return [ \"\\n                \", HTML.DIV({\n      class: \"row spaced\"\n    }, HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                    \", HTML.DIV(\"\\n                        \", HTML.BUTTON({\n      type: \"button\",\n      \"data-team-id\": function() {\n        return Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"_id\"));\n      },\n      class: \"btn btn-primary btn-sm btn-user-request-join btn-block btn-text-left\",\n      title: function() {\n        return [ \"Ask to join \", Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"Name\")) ];\n      }\n    }, HTML.SPAN({\n      class: \"glyphicon glyphicon-user\"\n    }), \" Join team\"), \"\\n                    \"), \"\\n                \")), \"\\n                \" ];\n  }), \"\\n                \", Blaze.If(function() {\n    return Spacebars.dataMustache(view.lookup(\"isInRole\"), \"user-join-request\", Spacebars.dot(view.lookup(\"team\"), \"Name\"));\n  }, function() {\n    return [ \"\\n                \", HTML.DIV({\n      class: \"label label-warning\"\n    }, \"\\n                    requested\\n                \"), \"\\n                \" ];\n  }), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n    class: \"row spaced details\"\n  }, \"\\n            \", HTML.DIV({\n    class: \"col-sm-12\"\n  }, \"\\n                \", HTML.INPUT({\n    name: function() {\n      return [ \"icon-upload-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"_id\")) ];\n    },\n    class: \"file-upload-input\",\n    type: \"file\"\n  }), \"\\n                \", HTML.Raw('<!-- <span class=\"team-icon\" style=\"background:url(data:{{team.IconType}};base64,{{iconData64}}) norepeat left center; padding: 5px 0 5px 25px;width:16px;height:16px;\"></span> -->'), \"\\n                \", Blaze._TemplateWith(function() {\n    return {\n      team: Spacebars.call(view.lookup(\"team\"))\n    };\n  }, function() {\n    return Spacebars.include(view.lookupTemplate(\"team_icon\"));\n  }), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n    class: \"row spaced\"\n  }, \"\\n            \", HTML.DIV({\n    class: \"col-sm-12\"\n  }, \"\\n                \", Blaze.If(function() {\n    return Spacebars.dataMustache(view.lookup(\"isInRole\"), \"admin-join-request\", Spacebars.dot(view.lookup(\"team\"), \"Name\"));\n  }, function() {\n    return [ \"\\n                \", HTML.DIV(\"\\n                    \", HTML.DIV({\n      class: \"alert alert-info\"\n    }, \"\\n                        You have been invited to join \", Blaze.View(\"lookup:team.Name\", function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"Name\"));\n    }), \".\\n                        \", HTML.BUTTON({\n      type: \"button\",\n      \"data-team-name\": function() {\n        return Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"Name\"));\n      },\n      \"data-team-id\": function() {\n        return Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"_id\"));\n      },\n      class: \"btn btn-primary btn-xs btn-accept-join\",\n      \"data-toggle\": \"tooltip\",\n      \"data-placement\": \"right\",\n      title: \"Accept invitation to join group\"\n    }, \"Accept\"), \"\\n                        \", HTML.BUTTON({\n      type: \"button\",\n      \"data-team-name\": function() {\n        return Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"Name\"));\n      },\n      \"data-team-id\": function() {\n        return Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"_id\"));\n      },\n      class: \"btn btn-secondary btn-xs btn-decline-join\",\n      \"data-toggle\": \"tooltip\",\n      \"data-placement\": \"right\",\n      title: \"Decline invitation to join group\"\n    }, \"Decline\"), \"\\n                    \"), \"\\n                \"), \"\\n                \" ];\n  }), \"\\n                \", Blaze.If(function() {\n    return Spacebars.dataMustache(view.lookup(\"isInRole\"), \"admin,view-goals\", Spacebars.dot(view.lookup(\"team\"), \"Name\"));\n  }, function() {\n    return [ \"\\n                \", HTML.DIV({\n      class: \"team-goal-quick-list details\"\n    }, \"\\n                    \", HTML.H4({\n      class: \"section-title\"\n    }, \"Goals\"), \"\\n                    \", Blaze._TemplateWith(function() {\n      return {\n        teamName: Spacebars.call(Spacebars.dot(view.lookup(\"team\"), \"Name\"))\n      };\n    }, function() {\n      return Spacebars.include(view.lookupTemplate(\"team_goals\"));\n    }), \"\\n                \"), \"\\n                \" ];\n  }), \"\\n            \"), \"\\n        \"), \"\\n    \");\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"admin_teams.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/admin_teams/admin_teams.js                                                                         //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nlet Team, TeamIcon;\nmodule.watch(require(\"/imports/api/teams/teams.js\"), {\n  Team(v) {\n    Team = v;\n  },\n\n  TeamIcon(v) {\n    TeamIcon = v;\n  }\n\n}, 0);\nlet TeamGoal;\nmodule.watch(require(\"/imports/api/team_goals/team_goals.js\"), {\n  TeamGoal(v) {\n    TeamGoal = v;\n  }\n\n}, 1);\nlet User;\nmodule.watch(require(\"/imports/api/users/users.js\"), {\n  User(v) {\n    User = v;\n  }\n\n}, 2);\nlet FlowRouter;\nmodule.watch(require(\"meteor/kadira:flow-router\"), {\n  FlowRouter(v) {\n    FlowRouter = v;\n  }\n\n}, 3);\nlet Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 4);\nmodule.watch(require(\"./admin_teams.html\"));\nmodule.watch(require(\"../team_goals/team_goals.js\"));\nmodule.watch(require(\"/imports/ui/components/select_autocomplete/select_autocomplete.js\"));\nTemplate.admin_teams.onCreated(function () {\n  if (this.data.teamName) {\n    this.teamName = this.data.teamName;\n  } else if (FlowRouter.getParam('teamName')) {\n    this.teamName = FlowRouter.getParam('teamName').split('-').join(' ');\n  } else {\n    this.teamName = '';\n  }\n\n  console.log(this.teamName, FlowRouter.getParam('teamName'), \"bbbbbbbbbbbbbb\");\n  this.autorun(() => {\n    console.log(\"autorunning admin_teams...\");\n    this.subscription = this.subscribe('userList', Meteor.userId(), {\n      onStop: function () {\n        console.log(\"User List subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"User List subscription ready! \", arguments, this);\n      }\n    });\n    console.log(this.subscription);\n    this.subscription2 = this.subscribe('teamMemberList', Meteor.userId(), {\n      onStop: function () {\n        console.log(\"Team Member subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"Team Member subscription ready! \", arguments, this);\n      }\n    });\n    console.log(this.subscription2);\n    this.subscription3 = this.subscribe('teamsData', Meteor.userId(), {\n      onStop: function () {\n        console.log(\"teamsData subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"teamsData subscription ready! \", arguments, this);\n        console.log(Team.find().fetch());\n      }\n    });\n    console.log(this.subscription3);\n  });\n});\nTemplate.admin_teams.onRendered(function () {\n  Meteor.setTimeout(function () {\n    $(\"table.table select.selectized\").each(function (s) {\n      this.selectize.on('item_add', function (val, $item) {\n        let userId = $item.closest(\"[data-user-id]\").data(\"user-id\");\n        let teamName = $item.closest(\"[data-team-name]\").data(\"team-name\");\n        let t = Team.findOne({\n          Name: teamName\n        });\n        t.addRole(userId, val);\n      });\n      this.selectize.on('item_remove', function (val, $item) {\n        let userId = this.$control.closest(\"[data-user-id]\").data(\"user-id\");\n        let teamName = this.$control.closest(\"[data-team-name]\").data(\"team-name\");\n        let t = Team.findOne({\n          Name: teamName\n        });\n        t.removeRole(userId, val);\n      });\n    });\n  }, 1000);\n});\nTemplate.admin_teams.helpers({\n  specificTeam() {\n    if (typeof Template.instance().teamName === 'undefined' || Template.instance().teamName === '') {\n      return false;\n    } else {\n      return true;\n    }\n  },\n\n  teams() {\n    if (typeof Team === 'undefined') {\n      return false;\n    }\n\n    let t;\n\n    if (typeof Template.instance().teamName === 'undefined' || Template.instance().teamName === '') {\n      t = Team.find(); //.fetch();\n    } else {\n      t = Team.find({\n        Name: Template.instance().teamName\n      }); //.fetch();\n    }\n\n    console.log(Template.instance().teamName, t, \"rrrrrrrrrrrr\");\n    let t_invited = [],\n        t_member = [],\n        t_else = [];\n    t.forEach(team => {\n      if (Roles.userIsInRole(Meteor.userId(), 'admin-join-request', team.Name)) {\n        t_invited.push(team);\n      } else if (team.Members.includes(Meteor.userId())) {\n        t_member.push(team);\n      } else {\n        t_else.push(team);\n      }\n    });\n    return t_invited.concat(t_member, t_else);\n  },\n\n  teamsMemberOf() {\n    if (typeof Team === 'undefined') {\n      return false;\n    }\n\n    let t = Team.find(); //.fetch();\n\n    let t_invited = [],\n        t_member = [],\n        t_else = [];\n    t.forEach(team => {\n      if (Roles.userIsInRole(Meteor.userId(), 'admin-join-request', team.Name)) {\n        t_invited.push(team);\n      } else if (team.Members.includes(Meteor.userId())) {\n        t_member.push(team);\n      } else {//t_else.push(team);\n      }\n    });\n\n    if (t_member.length > 1 && !Roles.userIsInRole(Meteor.userId(), 'admin', Roles.GLOBAL_GROUP)) {\n      //if regular user is a member of a team other than \"No Team\", hide \"No Team\" from this view\n      t_member = t_member.filter(tm => {\n        return tm.Name !== Team.Default.Name;\n      });\n    } else {//\n    }\n\n    return t_invited.concat(t_member, t_else);\n  },\n\n  teamsOther() {\n    if (typeof Team === 'undefined') {\n      return false;\n    }\n\n    let t = Team.find(); //.fetch();\n\n    let t_invited = [],\n        t_member = [],\n        t_else = [];\n    t.forEach(team => {\n      if (Roles.userIsInRole(Meteor.userId(), 'admin-join-request', team.Name)) {//t_invited.push(team);\n      } else if (team.Members.includes(Meteor.userId())) {//t_member.push(team);\n      } else {\n        t_else.push(team);\n      }\n    });\n    return t_invited.concat(t_member, t_else);\n  },\n\n  teamMembers(teamName) {\n    let teamRole = {};\n    teamRole[\"roles.\" + teamName] = \"member\";\n    let u = User.find(teamRole);\n\n    if (typeof u === \"undefined\") {\n      return false;\n    }\n\n    let memberList = [];\n    u.forEach(m => {\n      memberList.push({\n        _id: m._id,\n        firstName: m.MyProfile.firstName,\n        lastName: m.MyProfile.lastName,\n        roles: m.roles[teamName]\n      });\n    });\n    return memberList;\n  },\n\n  uniqueId() {\n    var text = \"\";\n    var idLength = 10;\n    var possible = \"acdeghijklmnopqrstuvwxyzACDEGHIJKLMNOPQRSTUVWXYZ0123456789\";\n\n    for (var i = 0; i < idLength; i++) {\n      text += possible.charAt(Math.floor(Math.random() * possible.length));\n    }\n\n    return text;\n  },\n\n  teamRequests(teamName) {\n    let teamRole = {};\n    teamRole[\"roles.\" + teamName] = \"user-join-request\";\n    let u = User.find(teamRole);\n\n    if (!u) {\n      return [];\n    }\n\n    let requestList = [];\n    u.forEach(m => {\n      requestList.push({\n        _id: m._id,\n        firstName: m.MyProfile.firstName,\n        lastName: m.MyProfile.lastName,\n        roles: \"user-join-request\"\n      });\n    });\n    return requestList;\n  },\n\n  rolesList() {\n    let roles = [];\n    Roles.getAllRoles().forEach(function (r) {\n      roles.push({\n        text: r.name,\n        value: r.name\n      });\n    });\n    return roles;\n  },\n\n  users() {\n    return User.find().fetch();\n  },\n\n  userAddList(teamName) {\n    let t = Team.findOne({\n      Name: teamName\n    });\n    let memberList = [];\n\n    if (t) {\n      memberList = t.Members;\n    }\n\n    let u = User.find({\n      _id: {\n        '$nin': memberList\n      }\n    });\n    let addList = [];\n    u.forEach(m => {\n      addList.push({\n        value: m._id,\n        text: m.MyProfile.firstName + \" \" + m.MyProfile.lastName\n      });\n    });\n    return addList;\n  }\n\n});\n\nfunction teamChanged($g) {\n  $g.find(\".btn-save\").prop(\"disabled\", false);\n  $g.find(\".btn-cancel\").prop(\"disabled\", false);\n}\n\nfunction teamUnchanged($g) {\n  $g.find(\".btn-save\").prop(\"disabled\", true);\n  $g.find(\".btn-cancel\").prop(\"disabled\", true);\n  $g.find(\".changed\").removeClass(\"changed\");\n}\n\nfunction saveTeam(teamId) {\n  let saveObj = {\n    Name: $(\"#team-title-\" + teamId).val(),\n    Description: $(\"#team-description-\" + teamId).val()\n  };\n  let t = Team.findOne({\n    _id: teamId\n  });\n\n  if (t) {\n    t.updateFromObj(saveObj);\n  }\n}\n\nTemplate.admin_teams.events({\n  'change .file-upload-input'(event, instance) {\n    var file = event.currentTarget.files[0];\n    var reader = new FileReader();\n\n    reader.onload = function (fileLoadEvent) {\n      let teamId = $(event.target).closest(\"[data-team-id]\").data(\"team-id\");\n      let t = Team.findOne({\n        _id: teamId\n      });\n      t.uploadIcon(file, reader.result);\n    };\n\n    reader.readAsBinaryString(file);\n  },\n\n  'change input.flat,textarea.flat'(event, instance) {\n    $(event.target).addClass('changed');\n    let $team = $(event.target).closest(\"[data-team-id]\");\n  },\n\n  'change input,textarea,select'(event, instance) {\n    let $t = $(event.target);\n    let $team = $(event.target).closest(\"[data-team-id]\");\n    teamChanged($team);\n  },\n\n  'keyup input,textarea'(event, instance) {\n    let $t = $(event.target);\n    let $team = $(event.target).closest(\"[data-team-id]\");\n    teamChanged($team);\n  },\n\n  'click button.btn-save'(event, instance) {\n    let $t = $(event.target);\n    let teamId = $t.closest(\"[data-team-id]\").data(\"team-id\");\n    saveTeam(teamId);\n    teamUnchanged($(\"#div-team-\" + teamId));\n  },\n\n  'click button#btn-create-team'(event, instance) {\n    let newTeamName = $(\"#input-new-team-name\").val();\n\n    if (\"\" === newTeamName) {\n      $(\"#msg-create\").removeClass(\"alert-success\").addClass(\"alert-danger\").html(\"Team name required\").css(\"display\", \"inline-block\");\n      return;\n    }\n\n    let newTeamDescription = $(\"#input-new-team-description\").val();\n    let newTeam = {\n      Name: newTeamName,\n      Description: newTeamDescription\n    };\n    Meteor.call('team.createNewTeam', newTeam, function (err, rslt) {\n      if (!err) {\n        $(\"#div-new-team-details\").slideUp();\n        $(\"#input-new-team-name\").val(\"\");\n        $(\"#msg-create\").removeClass(\"alert-danger\").addClass(\"alert-success\").html(\"Team created!\").css(\"display\", \"inline-block\");\n        $(\"#input-new-team-name\").closest(\".input-group\").removeClass(\"has-error\").removeClass(\"has-feedback\");\n      } else {\n        console.log(err);\n        $(\"#input-new-team-name\").closest(\".input-group\").addClass(\"has-error\").addClass(\"has-feedback\");\n        $(\"#msg-create\").removeClass(\"alert-success\").addClass(\"alert-danger\").html(\"Duplicate team name\").css(\"display\", \"inline-block\");\n\n        if (err.error === 409) {\n          console.log(\"duplicate\");\n        }\n      }\n\n      Meteor.setTimeout(function () {\n        $(\"#msg-create\").fadeOut();\n      }, 5000);\n    });\n  },\n\n  'focus #form-new-team'(event, instance) {\n    $(\"#div-new-team-details\").slideDown();\n  },\n\n  'blur #form-new-team'(event, instance) {\n    console.log(\"triggered div blur\");\n  },\n\n  'click .dropdown-menu.add-users'(event, instance) {\n    event.stopPropagation();\n  },\n\n  'click button.btn-add-users-save'(event, instance) {\n    let $select = $(event.target).closest(\".dropdown-menu\").find(\".selectized\");\n    let teamId = $(event.target).closest(\"[data-team-id]\").data(\"team-id\");\n    let t = Team.findOne({\n      _id: teamId\n    });\n    let userList = $select[0].selectize.items;\n    t.adminRequestUserJoin(userList);\n    $select[0].selectize.clear(true);\n    $(event.target).closest(\".dropdown\").toggleClass('open');\n  },\n\n  'click button.btn-add-users-cancel'(event, instance) {\n    let $select = $(event.target).closest(\".dropdown-menu\").find(\".selectized\");\n    $select[0].selectize.clear(true);\n    $(event.target).closest(\".dropdown\").toggleClass('open');\n  },\n\n  'click button.btn-add-users'(event, instance) {//show add-user widget\n  },\n\n  'click button.btn-accept-join'(event, instance) {\n    let teamId = $(event.target).data(\"team-id\");\n    let t = Team.findOne({\n      _id: teamId\n    });\n    t.userAcceptJoin();\n  },\n\n  'click button.btn-decline-join'(event, instance) {\n    let teamId = $(event.target).data(\"team-id\");\n    let t = Team.findOne({\n      _id: teamId\n    });\n    t.userDeclineJoin();\n  },\n\n  'click a.btn-admin-request-join'(event, instance) {\n    event.preventDefault();\n    let userId = $(event.target).closest(\"[data-user-id]\").data(\"user-id\");\n    let teamId = $(event.target).closest(\"[data-team-id]\").data(\"team-id\");\n    let t = Team.findOne({\n      _id: teamId\n    });\n    t.adminRequestUserJoin(userId);\n  },\n\n  'click button.btn-user-request-join'(event, instance) {\n    event.preventDefault();\n    let teamId = $(event.target).data(\"team-id\");\n    let t = Team.findOne({\n      _id: teamId\n    });\n    t.userRequestJoin();\n  },\n\n  'click a.btn-approve-join'(event, instance) {\n    event.preventDefault();\n    let userId = $(event.target).data(\"user-id\");\n    let teamId = $(event.target).closest(\"[data-team-id]\").data(\"team-id\");\n    let t = Team.findOne({\n      _id: teamId\n    });\n    t.adminAcceptJoin(userId);\n  },\n\n  'click a.btn-decline-join'(event, instance) {\n    event.preventDefault();\n    let userId = $(event.target).data(\"user-id\");\n    let teamId = $(event.target).closest(\"[data-team-id]\").data(\"team-id\");\n    let t = Team.findOne({\n      _id: teamId\n    });\n    t.adminRejectJoin(userId);\n  },\n\n  'click button.btn-remove-user-role'(event, instance) {\n    event.preventDefault();\n    let userId = $(event.target).closest(\"[data-user-id]\").data(\"user-id\");\n    let teamId = $(event.target).closest(\"[data-team-id]\").data(\"team-id\");\n    let role = $(event.target).closest(\"[data-role]\").data(\"role\");\n  },\n\n  'click div.team-goal-quick-list'(event, instance) {\n    let teamName = $(event.target).closest(\"[data-team-name]\").data(\"team-name\");\n\n    if (teamName) {\n      FlowRouter.go(\"/teamGoals/\" + teamName.split(\" \").join(\"-\"));\n    }\n  },\n\n  'click button.btn-expand,div.collapsed-summary'(event, instance) {\n    let $target = $(event.target);\n    let $teamContainer = $target.closest(\"[data-team-id]\");\n    let $targetExpandBtn = $teamContainer.find(\".btn-expand.glyphicon\");\n    $targetExpandBtn.removeClass(\"glyphicon-chevron-up\").addClass(\"glyphicon-chevron-down\");\n\n    if ($teamContainer.hasClass(\"collapsed\")) {\n      $(\".team-view[data-team-id]:not(.collapsed)\").slideUp(function () {\n        $(this).addClass(\"collapsed\").css(\"display\", \"block\");\n      });\n      $teamContainer.css(\"display\", \"none\").removeClass(\"collapsed\").slideDown(function () {\n        $('html, body').animate({\n          scrollTop: $teamContainer.offset().top\n        }, 500);\n      });\n      $targetExpandBtn.removeClass(\"glyphicon-chevron-down\");\n      $targetExpandBtn.addClass(\"glyphicon-chevron-up\");\n    } else {\n      $teamContainer.slideUp(function () {\n        $teamContainer.addClass(\"collapsed\").css(\"display\", \"block\");\n      });\n      $targetExpandBtn.removeClass(\"glyphicon-chevron-up\");\n      $targetExpandBtn.addClass(\"glyphicon-chevron-down\");\n    }\n  },\n\n  'click tr[data-user-id]'(event, instance) {\n    if (!$(event.target).closest(\".selectize-control\").length) {\n      let $target = $(event.target).closest(\"[data-user-id]\");\n      let uid = $target.data(\"user-id\");\n      FlowRouter.go(\"/profile/\" + uid);\n    }\n  }\n\n});\nTemplate.team_view.helpers({\n  fldEnabled(fld) {\n    let team = Template.instance().data.team; //let t = TeamGoal.findOne( {_id: team._id} );\n    //if (!t) {\n\n    if (Roles.userIsInRole(Meteor.userId(), 'admin', team.Name)) {\n      return \"\";\n    } else {\n      return \"disabled\";\n    } //}\n\n\n    if (g.hasModifyPerm(fld)) {\n      return \"\";\n    } else {\n      return \"disabled\";\n    }\n  },\n\n  iconData64() {\n    let team = Template.instance().data.team;\n    let t = Team.findOne({\n      _id: team._id\n    });\n    return team.Icon64;\n  },\n\n  teamMembers(teamName) {\n    let teamRole = {};\n    teamRole[\"roles.\" + teamName] = \"member\";\n    let u = User.find(teamRole);\n\n    if (typeof u === \"undefined\") {\n      return false;\n    }\n\n    let memberList = [];\n    u.forEach(m => {\n      memberList.push({\n        _id: m._id,\n        firstName: m.MyProfile.firstName,\n        lastName: m.MyProfile.lastName,\n        roles: m.roles[teamName]\n      });\n    });\n    return memberList;\n  },\n\n  hasTeamRequests(teamName) {\n    let teamRole = {};\n    teamRole[\"roles.\" + teamName] = \"user-join-request\";\n    let u = User.find(teamRole);\n\n    if (!u || u.count() == 0) {\n      return false;\n    } else {\n      return true;\n    }\n  },\n\n  teamRequests(teamName) {\n    let teamRole = {};\n    teamRole[\"roles.\" + teamName] = \"user-join-request\";\n    let u = User.find(teamRole);\n\n    if (!u) {\n      return [];\n    }\n\n    let requestList = [];\n    u.forEach(m => {\n      requestList.push({\n        _id: m._id,\n        firstName: m.MyProfile.firstName,\n        lastName: m.MyProfile.lastName,\n        roles: \"user-join-request\"\n      });\n    });\n    return requestList;\n  },\n\n  hasTeamInvites(teamName) {\n    let teamRole = {};\n    teamRole[\"roles.\" + teamName] = \"admin-join-request\";\n    let u = User.find(teamRole);\n\n    if (!u || u.count() == 0) {\n      return false;\n    } else {\n      return true;\n    }\n  },\n\n  teamInvites(teamName) {\n    let teamRole = {};\n    teamRole[\"roles.\" + teamName] = \"admin-join-request\";\n    let u = User.find(teamRole);\n\n    if (!u) {\n      return [];\n    }\n\n    let inviteList = [];\n    u.forEach(m => {\n      inviteList.push({\n        _id: m._id,\n        firstName: m.MyProfile.firstName,\n        lastName: m.MyProfile.lastName,\n        roles: \"admin-join-request\"\n      });\n    });\n    return inviteList;\n  },\n\n  rolesList() {\n    let roles = [];\n    Roles.getAllRoles().forEach(function (r) {\n      roles.push({\n        text: r.name,\n        value: r.name\n      });\n    });\n    return roles;\n  },\n\n  uniqueId() {\n    var text = \"\";\n    var idLength = 10;\n    var possible = \"acdeghijklmnopqrstuvwxyzACDEGHIJKLMNOPQRSTUVWXYZ0123456789\";\n\n    for (var i = 0; i < idLength; i++) {\n      text += possible.charAt(Math.floor(Math.random() * possible.length));\n    }\n\n    return text;\n  },\n\n  userAddList(teamName) {\n    let t = Team.findOne({\n      Name: teamName\n    });\n    let memberList = [];\n\n    if (t) {\n      memberList = t.Members;\n    }\n\n    let u = User.find({\n      _id: {\n        '$nin': memberList\n      }\n    });\n    let addList = [];\n    u.forEach(m => {\n      addList.push({\n        value: m._id,\n        text: m.MyProfile.firstName + \" \" + m.MyProfile.lastName\n      });\n    });\n    return addList;\n  }\n\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"ask_questions\":{\"ask_questions.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/ask_questions/ask_questions.html                                                                   //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.ask_questions.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.ask_questions.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/ask_questions/template.ask_questions.js                                                            //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"ask_questions\");\nTemplate[\"ask_questions\"] = new Template(\"Template.ask_questions\", (function() {\n  var view = this;\n  return Blaze.If(function() {\n    return Spacebars.call(view.templateInstance().subscriptionsReady());\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      class: \"container questions\"\n    }, \"\\n        \", HTML.DIV({\n      class: \"jumbotron\"\n    }, \"\\n            \", Blaze._TemplateWith(function() {\n      return {\n        source: Spacebars.call(\"questions\")\n      };\n    }, function() {\n      return Spacebars.include(view.lookupTemplate(\"select_feedback\"));\n    }), \"\\n            \", Spacebars.include(view.lookupTemplate(\"questions\")), \"\\n        \"), \"\\n    \"), \"\\n    \" ];\n  }, function() {\n    return [ \"\\n        \", Spacebars.include(view.lookupTemplate(\"loading\")), \"\\n    \" ];\n  });\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"ask_questions.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/ask_questions/ask_questions.js                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nlet Question;\nmodule.watch(require(\"/imports/api/questions/questions.js\"), {\n  Question(v) {\n    Question = v;\n  }\n\n}, 0);\nlet User, Profile, UserType, MyersBriggs, Answer;\nmodule.watch(require(\"/imports/api/users/users.js\"), {\n  User(v) {\n    User = v;\n  },\n\n  Profile(v) {\n    Profile = v;\n  },\n\n  UserType(v) {\n    UserType = v;\n  },\n\n  MyersBriggs(v) {\n    MyersBriggs = v;\n  },\n\n  Answer(v) {\n    Answer = v;\n  }\n\n}, 1);\nlet Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 2);\nmodule.watch(require(\"./ask_questions.html\"));\nmodule.watch(require(\"../../components/questions/questions.js\"));\nmodule.watch(require(\"../../components/personality/personality.js\"));\nTemplate.ask_questions.helpers({\n  answeredQuestionsLength() {\n    let u = User.findOne({\n      _id: Template.instance().userId\n    });\n    return u.MyProfile.UserType.AnsweredQuestions.length;\n  }\n\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"dash_min\":{\"dash_min.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/dash_min/dash_min.html                                                                             //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.dash_min.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.dash_min.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/dash_min/template.dash_min.js                                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"dash_min\");\nTemplate[\"dash_min\"] = new Template(\"Template.dash_min\", (function() {\n  var view = this;\n  return HTML.DIV({\n    class: \"container text-center\"\n  }, HTML.Raw('\\n        <div class=\"row spaced\">\\n            <div class=\"col-md-12\">\\n                <button type=\"button\" class=\"btn btn-primary questions\">Answer Questions</button>\\n            </div>\\n        </div>\\n        <div class=\"row spaced\">\\n            <div class=\"col-md-12\">\\n                <button type=\"button\" class=\"btn btn-success learnshare\">Learn Share</button>\\n            </div>\\n        </div>\\n        '), Blaze.If(function() {\n    return Spacebars.dataMustache(view.lookup(\"isInRole\"), \"admin\");\n  }, function() {\n    return [ \"\\n            \", HTML.DIV({\n      class: \"row spaced\"\n    }, \"\\n                \", HTML.DIV({\n      class: \"col-md-12\"\n    }, \"\\n                    \", HTML.BUTTON({\n      type: \"button\",\n      class: \"btn btn-success user-segments\"\n    }, \"User Segments\"), \"\\n                \"), \"\\n            \"), \"\\n        \" ];\n  }), \"\\n    \");\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"dash_min.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/dash_min/dash_min.js                                                                               //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./dash_min.html\"));\nTemplate.dash_min.events({\n  'click button.questions'(event, instance) {\n    FlowRouter.go('/questions');\n  },\n\n  'click button.learnshare'(event, instance) {\n    FlowRouter.go('/learnShareList');\n  },\n\n  'click button.user-segments'(event, instance) {\n    FlowRouter.go('/userSegments');\n  }\n\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"home\":{\"home.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/home/home.html                                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.home.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.home.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/home/template.home.js                                                                              //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"App_home\");\nTemplate[\"App_home\"] = new Template(\"Template.App_home\", (function() {\n  var view = this;\n  return Blaze.If(function() {\n    return Spacebars.call(view.templateInstance().subscriptionsReady());\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      class: \"container questions\"\n    }, \"\\n        \", HTML.DIV({\n      class: \"jumbotron\"\n    }, \"\\n            \", Blaze._TemplateWith(function() {\n      return {\n        source: Spacebars.call(\"questions\")\n      };\n    }, function() {\n      return Spacebars.include(view.lookupTemplate(\"select_feedback\"));\n    }), \"\\n            \", Spacebars.include(view.lookupTemplate(\"questions\")), \"\\n        \"), \"\\n    \"), \"\\n    \" ];\n  }, function() {\n    return [ \"\\n        \", Spacebars.include(view.lookupTemplate(\"loading\")), \"\\n    \" ];\n  });\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"home.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/home/home.js                                                                                       //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./home.html\"));\nmodule.watch(require(\"../../components/questions/questions.js\"));\nmodule.watch(require(\"../../components/personality/personality.js\"));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"individual_goals\":{\"individual_goals.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/individual_goals/individual_goals.html                                                             //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.individual_goals.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.individual_goals.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/individual_goals/template.individual_goals.js                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"individual_goals\");\nTemplate[\"individual_goals\"] = new Template(\"Template.individual_goals\", (function() {\n  var view = this;\n  return [ Blaze.If(function() {\n    return Spacebars.call(view.templateInstance().subscriptionsReady());\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      class: \"container goal-list individual-goal-list\"\n    }, \"\\n        \", HTML.DIV({\n      class: \"row spaced title\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                \", HTML.H2(\"Goals\"), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n      class: \"row spaced goal-controls\",\n      \"data-goal-id\": \"new\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                \", HTML.BUTTON({\n      id: \"btn-add-goal\",\n      class: \"btn btn-primary\",\n      \"data-txt-add\": \"Add a goal...\",\n      \"data-txt-save\": \"Save\"\n    }, \"Add a goal...\"), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n      class: \"row spaced blank-goal\",\n      id: \"blank-goal\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                \", Blaze._TemplateWith(function() {\n      return {\n        goal: Spacebars.call(view.lookup(\"blankGoal\")),\n        users: Spacebars.call(view.lookup(\"userList\"))\n      };\n    }, function() {\n      return Spacebars.include(view.lookupTemplate(\"igoal_view\"));\n    }), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n      class: \"row spaced existing-goals\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                \", Blaze.Unless(function() {\n      return Spacebars.call(view.lookup(\"goalReload\"));\n    }, function() {\n      return [ \"\\n                    \", Blaze.If(function() {\n        return Spacebars.call(view.lookup(\"ownList\"));\n      }, function() {\n        return [ \"\\n                        \", HTML.H3(\"Personal\"), \"\\n                        \", Blaze.If(function() {\n          return Spacebars.dataMustache(view.lookup(\"hasGoalsTeam\"), \"\");\n        }, function() {\n          return [ \"\\n                            \", Blaze.Each(function() {\n            return {\n              _sequence: Spacebars.dataMustache(view.lookup(\"individualGoalsTeam\"), \"\"),\n              _variable: \"goal\"\n            };\n          }, function() {\n            return [ \"\\n                                \", Blaze._TemplateWith(function() {\n              return {\n                goal: Spacebars.call(view.lookup(\"goal\"))\n              };\n            }, function() {\n              return Spacebars.include(view.lookupTemplate(\"igoal_view\"));\n            }), \"\\n                            \" ];\n          }), \"\\n                        \" ];\n        }, function() {\n          return \"\\n                            No goals yet\\n                        \";\n        }), \"\\n                    \" ];\n      }), \"\\n                    \", Blaze.Each(function() {\n        return {\n          _sequence: Spacebars.call(view.lookup(\"teamList\")),\n          _variable: \"team\"\n        };\n      }, function() {\n        return [ \"\\n                        \", HTML.H3(Blaze.View(\"lookup:team.Name\", function() {\n          return Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"Name\"));\n        })), \"\\n                        \", Blaze.If(function() {\n          return Spacebars.dataMustache(view.lookup(\"hasGoalsTeam\"), Spacebars.dot(view.lookup(\"team\"), \"_id\"));\n        }, function() {\n          return [ \"\\n                            \", Blaze.Each(function() {\n            return {\n              _sequence: Spacebars.dataMustache(view.lookup(\"individualGoalsTeam\"), Spacebars.dot(view.lookup(\"team\"), \"_id\")),\n              _variable: \"goal\"\n            };\n          }, function() {\n            return [ \"\\n                                \", Blaze._TemplateWith(function() {\n              return {\n                goal: Spacebars.call(view.lookup(\"goal\"))\n              };\n            }, function() {\n              return Spacebars.include(view.lookupTemplate(\"igoal_view\"));\n            }), \"\\n                            \" ];\n          }), \"\\n                        \" ];\n        }, function() {\n          return \"\\n                            No goals yet\\n                        \";\n        }), \"\\n                    \" ];\n      }), \"\\n                \" ];\n    }), \"\\n            \"), \"\\n        \"), \"\\n    \"), \"\\n    \" ];\n  }, function() {\n    return [ \"\\n        \", Spacebars.include(view.lookupTemplate(\"loading\")), \"\\n    \" ];\n  }), HTML.Raw('\\n\\n    <div class=\"modal fade\" id=\"goal-modal-new\">\\n        <div class=\"modal-dialog modal-lg\" role=\"document\">\\n          <div class=\"modal-content\">\\n            <div class=\"modal-header\">\\n              <h5 class=\"modal-title\">New Sub Goal</h5>\\n            </div>\\n            <div class=\"modal-body\">\\n            </div>\\n          </div>\\n        </div>\\n    </div>\\n    '), HTML.DIV({\n    class: \"modal fade\",\n    id: \"goal-modal-sub\"\n  }, \"\\n        \", HTML.DIV({\n    class: \"modal-dialog modal-lg\",\n    role: \"document\"\n  }, \"\\n          \", HTML.DIV({\n    class: \"modal-content\"\n  }, \"\\n            \", HTML.Raw('<div class=\"modal-header\">\\n              <h5 class=\"modal-title\">View/Edit Sub Goal</h5>\\n            </div>'), \"\\n            \", HTML.DIV({\n    class: \"modal-body\"\n  }, \"\\n                \", Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"hasSubgoalView\"));\n  }, function() {\n    return [ \"\\n                  \", Blaze._TemplateWith(function() {\n      return {\n        goal: Spacebars.call(view.lookup(\"subgoal\"))\n      };\n    }, function() {\n      return Spacebars.include(view.lookupTemplate(\"igoal_view\"));\n    }), \"\\n                \" ];\n  }), \"\\n            \"), \"\\n          \"), \"\\n        \"), \"\\n    \") ];\n}));\n\nTemplate.__checkName(\"igoal_view\");\nTemplate[\"igoal_view\"] = new Template(\"Template.igoal_view\", (function() {\n  var view = this;\n  return HTML.DIV({\n    class: function() {\n      return [ \"team-goal \", Spacebars.mustache(view.lookup(\"collapsed\"), Spacebars.dot(view.lookup(\"goal\"), \"parentId\")) ];\n    },\n    \"data-goal-id\": function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\"));\n    },\n    id: function() {\n      return [ \"div-goal-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    }\n  }, HTML.Raw('\\n        <!-- <form id=\"form-goal-{{goal._id}}\"> -->\\n        '), HTML.DIV({\n    class: function() {\n      return [ \"progress pct-\", Spacebars.mustache(view.lookup(\"progressPct\")) ];\n    },\n    \"data-pct\": function() {\n      return Spacebars.mustache(view.lookup(\"progressPct\"));\n    }\n  }, \"\\n            \", HTML.DIV({\n    class: \"progress-bar\",\n    role: \"progressbar\",\n    style: function() {\n      return [ \"width: \", Spacebars.mustache(view.lookup(\"progressPct\")), \"%;\" ];\n    },\n    \"aria-valuenow\": function() {\n      return Spacebars.mustache(view.lookup(\"progressPct\"));\n    },\n    \"aria-valuemin\": \"0\",\n    \"aria-valuemax\": \"100\"\n  }, Blaze.View(\"lookup:progressPct\", function() {\n    return Spacebars.mustache(view.lookup(\"progressPct\"));\n  }), \"%\"), \"\\n        \"), \"\\n        \", HTML.DIV({\n    class: \"row summary-row\"\n  }, \"\\n            \", HTML.DIV({\n    class: \"col-sm-10 collapsed-summary\"\n  }, \"\\n                \", HTML.SPAN({\n    class: \"team-goal-title\"\n  }, Blaze.View(\"lookup:goal.title\", function() {\n    return Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"title\"));\n  })), \"\\n                \", HTML.SPAN({\n    class: \"collapsed-description\"\n  }, Blaze.View(\"lookup:goal.description\", function() {\n    return Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"description\"));\n  })), \"\\n            \"), \"\\n            \", HTML.DIV({\n    class: \"col-sm-10 expanded-summary\"\n  }, \"\\n                \", HTML.SPAN({\n    class: \"team-goal-title\"\n  }, HTML.INPUT(HTML.Attrs({\n    type: \"text\",\n    id: function() {\n      return [ \"goal-title-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    },\n    class: \"flat form-control goal-title\",\n    value: function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"title\"));\n    },\n    placeholder: [ HTML.CharRef({\n      html: \"&lt;\",\n      str: \"<\"\n    }), \"Enter goal title...\", HTML.CharRef({\n      html: \"&gt;\",\n      str: \">\"\n    }) ]\n  }, function() {\n    return Spacebars.attrMustache(view.lookup(\"fldEnabled\"), \"title\");\n  }))), \"\\n            \"), \"\\n            \", HTML.DIV({\n    class: \"col-sm-2 text-right btn-group-xs\"\n  }, \"\\n                \", HTML.Raw('<button class=\"btn btn-success btn-save glyphicon glyphicon-ok details\" disabled=\"\" alt=\"Save changes\"></button>'), \"\\n                \", HTML.Raw('<button class=\"btn btn-warning btn-cancel glyphicon glyphicon-remove details\" disabled=\"\" alt=\"Discard changes\"></button>'), \"\\n                \", HTML.BUTTON({\n    class: \"btn btn-primary btn-expand glyphicon glyphicon-chevron-down\",\n    id: function() {\n      return [ \"btn-expand-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    }\n  }), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n    class: \"row spaced\"\n  }, \"\\n            \", HTML.DIV({\n    class: \"col-sm-10\"\n  }, \"\\n                \", HTML.DIV({\n    class: \"team-goal-description\"\n  }, \"\\n                    \", HTML.TEXTAREA(HTML.Attrs({\n    id: function() {\n      return [ \"goal-description-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    },\n    class: \"flat form-control goal-description\",\n    placeholder: [ HTML.CharRef({\n      html: \"&lt;\",\n      str: \"<\"\n    }), \"Enter goal description...\", HTML.CharRef({\n      html: \"&gt;\",\n      str: \">\"\n    }) ]\n  }, function() {\n    return Spacebars.attrMustache(view.lookup(\"fldEnabled\"), \"description\");\n  }, {\n    value: function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"description\"));\n    }\n  })), \"\\n                \"), \"\\n            \"), \"\\n            \", HTML.Raw('<div class=\"col-sm-2 text-right\">\\n            </div>'), \"\\n        \"), \"\\n        \", HTML.DIV({\n    class: \"row spaced details\"\n  }, \"\\n            \", HTML.DIV({\n    class: \"col-sm-6\"\n  }, \"\\n                \", HTML.DIV({\n    class: \"row spaced\"\n  }, \"\\n                    \", HTML.DIV({\n    class: \"col-sm-12\"\n  }, \"\\n                        \", HTML.LABEL({\n    for: function() {\n      return [ \"select-team-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    }\n  }, \"Team\"), \"\\n                        \", HTML.SELECT({\n    class: \"form-control\",\n    id: function() {\n      return [ \"select-team-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    }\n  }, \"\\n                            \", Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"ownList\"));\n  }, function() {\n    return [ \"\\n                                \", HTML.OPTION({\n      value: \"\"\n    }, \"(personal)\"), \"\\n                            \" ];\n  }), \"\\n                            \", Blaze.Each(function() {\n    return {\n      _sequence: Spacebars.call(view.lookup(\"teamList\")),\n      _variable: \"team\"\n    };\n  }, function() {\n    return [ \"\\n                                \", HTML.OPTION(HTML.Attrs({\n      value: function() {\n        return Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"_id\"));\n      }\n    }, function() {\n      return Spacebars.attrMustache(view.lookup(\"teamSelected\"), Spacebars.dot(view.lookup(\"team\"), \"_id\"));\n    }), Blaze.View(\"lookup:team.Name\", function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"Name\"));\n    })), \"\\n                            \" ];\n  }), \"\\n                        \"), \"\\n                    \"), \"\\n                \"), \"\\n                \", HTML.DIV({\n    class: \"row spaced\"\n  }, \"\\n                    \", HTML.DIV({\n    class: \"col-sm-12\"\n  }, \"\\n                        \", HTML.LABEL({\n    for: function() {\n      return [ \"select-privacy-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    }\n  }, \"Privacy\"), \"\\n                        \", HTML.SELECT({\n    class: \"form-control\",\n    id: function() {\n      return [ \"select-privacy-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    }\n  }, \"\\n                            \", Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"ownList\"));\n  }, function() {\n    return [ \"\\n                                \", HTML.OPTION(HTML.Attrs({\n      value: \"private\"\n    }, function() {\n      return Spacebars.attrMustache(view.lookup(\"privacySelected\"), \"private\");\n    }), \"Private\"), \"\\n                            \" ];\n  }), \"\\n                            \", HTML.OPTION(HTML.Attrs({\n    value: \"team\"\n  }, function() {\n    return Spacebars.attrMustache(view.lookup(\"privacySelected\"), \"team\");\n  }), \"Team\"), \"\\n                            \", HTML.OPTION(HTML.Attrs({\n    value: \"public\"\n  }, function() {\n    return Spacebars.attrMustache(view.lookup(\"privacySelected\"), \"public\");\n  }), \"Public\"), \"\\n                        \"), \"\\n                    \"), \"\\n                \"), \"\\n            \"), \"\\n            \", HTML.DIV({\n    class: \"col-sm-6\"\n  }, \"\\n                \", HTML.DIV({\n    class: \"row spaced\"\n  }, \"\\n                    \", HTML.DIV({\n    class: \"col-sm-4 text-right\"\n  }, \"\\n                        \", HTML.LABEL({\n    for: function() {\n      return [ \"input-start-date-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    }\n  }, \"Start\"), \"\\n                    \"), \"\\n                    \", HTML.DIV({\n    class: \"col-sm-8\"\n  }, \"\\n                        \", HTML.INPUT(HTML.Attrs({\n    id: function() {\n      return [ \"input-start-date-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    },\n    type: \"text\",\n    class: \"form-control flat date\",\n    value: function() {\n      return Spacebars.mustache(view.lookup(\"dateField\"), \"startDate\");\n    }\n  }, function() {\n    return Spacebars.attrMustache(view.lookup(\"fldEnabled\"), \"startDate\");\n  })), \"\\n                    \"), \"\\n                \"), \"\\n                \", HTML.DIV({\n    class: \"row spaced\"\n  }, \"\\n                    \", HTML.Raw('<div class=\"col-sm-4 text-right\">\\n                        Due\\n                    </div>'), \"\\n                    \", HTML.DIV({\n    class: \"col-sm-8\"\n  }, \"\\n                        \", HTML.INPUT(HTML.Attrs({\n    id: function() {\n      return [ \"input-date-due-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    },\n    type: \"text\",\n    class: \"form-control flat date\",\n    value: function() {\n      return Spacebars.mustache(view.lookup(\"dateField\"), \"dueDate\");\n    }\n  }, function() {\n    return Spacebars.attrMustache(view.lookup(\"fldEnabled\"), \"dueDate\");\n  })), \"\\n                    \"), \"\\n                \"), \"\\n                \", HTML.DIV({\n    class: \"row spaced\"\n  }, \"\\n                    \", HTML.Raw('<div class=\"col-sm-4 text-right\">\\n                        Review\\n                    </div>'), \"\\n                    \", HTML.DIV({\n    class: \"col-sm-8\"\n  }, \"\\n                        \", HTML.INPUT(HTML.Attrs({\n    id: function() {\n      return [ \"input-date-review-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    },\n    type: \"text\",\n    class: \"form-control flat date\",\n    value: function() {\n      return Spacebars.mustache(view.lookup(\"dateField\"), \"reviewDate\");\n    }\n  }, function() {\n    return Spacebars.attrMustache(view.lookup(\"fldEnabled\"), \"reviewDate\");\n  })), \"\\n                    \"), \"\\n                \"), \"\\n                \", Blaze.Unless(function() {\n    return Spacebars.dataMustache(view.lookup(\"isNew\"), Spacebars.dot(view.lookup(\"goal\"), \"_id\"));\n  }, function() {\n    return [ \"\\n                \", HTML.DIV({\n      class: \"row spaced\"\n    }, \"\\n                    \", HTML.DIV({\n      class: \"col-sm-4 text-right\"\n    }, \"\\n                        Completed\\n                    \"), \"\\n                    \", HTML.DIV({\n      class: \"col-sm-8\"\n    }, \"\\n                        \", HTML.INPUT(HTML.Attrs({\n      id: function() {\n        return [ \"input-date-reached-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n      },\n      type: \"text\",\n      class: \"form-control flat date\",\n      value: function() {\n        return Spacebars.mustache(view.lookup(\"dateField\"), \"reachedDate\");\n      }\n    }, function() {\n      return Spacebars.attrMustache(view.lookup(\"fldEnabled\"), \"reachedDate\");\n    })), \"\\n                    \"), \"\\n                \"), \"\\n                \" ];\n  }), \"\\n            \"), \"\\n        \"), \"\\n\\n        \", HTML.DIV({\n    class: \"row spaced comments details\"\n  }, \"\\n            \", HTML.DIV({\n    class: \"col-sm-6 goal-comments\"\n  }, \"\\n                \", HTML.Raw(\"<h3>Comments</h3>\"), \"\\n                \", HTML.DIV(\"\\n                    \", Blaze.Each(function() {\n    return {\n      _sequence: Spacebars.dataMustache(view.lookup(\"goalComments\"), Spacebars.dot(view.lookup(\"goal\"), \"_id\")),\n      _variable: \"comment\"\n    };\n  }, function() {\n    return [ \"\\n                    \", HTML.DIV({\n      class: \"goal-comment-outer\"\n    }, \"\\n                        \", HTML.DIV({\n      class: \"goal-comment-header row\"\n    }, \"\\n                            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                                \", Blaze.View(\"lookup:getUserName\", function() {\n      return Spacebars.mustache(view.lookup(\"getUserName\"), Spacebars.dot(view.lookup(\"comment\"), \"userId\"));\n    }), \"\\n                                \", HTML.DIV({\n      class: \"float-right\"\n    }, \"\\n                                    \", Blaze.View(\"lookup:formatDate\", function() {\n      return Spacebars.mustache(view.lookup(\"formatDate\"), Spacebars.dot(view.lookup(\"comment\"), \"date\"));\n    }), \"\\n                                \"), \"\\n                            \"), \"\\n                        \"), \"\\n                        \", HTML.DIV({\n      class: \"goal-comment row\"\n    }, \"\\n                            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                                \", Blaze.View(\"lookup:comment.text\", function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"comment\"), \"text\"));\n    }), \"\\n                            \"), \"\\n                        \"), \"\\n                    \"), \"\\n                    \" ];\n  }), \"\\n                \"), \"\\n                \", HTML.DIV({\n    class: \"row spaced comment-add details\"\n  }, \"\\n                    \", HTML.DIV({\n    class: \"col-sm-12\"\n  }, \"\\n                        \", HTML.DIV({\n    class: \"row spaced\"\n  }, \"\\n                            \", HTML.DIV({\n    class: \"col-sm-12\"\n  }, \"\\n                                \", HTML.TEXTAREA({\n    id: function() {\n      return [ \"new-comment-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    },\n    class: \"new-comment form-control\"\n  }), \"\\n                            \"), \"\\n                        \"), \"\\n                        \", HTML.DIV({\n    class: \"row spaced\"\n  }, \"\\n                            \", HTML.DIV({\n    class: \"col-sm-12\"\n  }, \"\\n                                \", HTML.BUTTON({\n    id: function() {\n      return [ \"btn-comment-add-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    },\n    class: \"btn btn-primary btn-comment-add\",\n    alt: \"Add comment\"\n  }, HTML.Raw('<span class=\"glyphicon glyphicon-pencil\"></span>'), \" Add comment\"), \"\\n                            \"), \"\\n                        \"), \"\\n                    \"), \"\\n                \"), \"\\n            \"), \"\\n            \", HTML.DIV({\n    class: \"col-sm-6 review-comments\"\n  }, \"\\n                \", HTML.Raw(\"<h3>Reviews</h3>\"), \"\\n                \", HTML.DIV(\"\\n                    \", Blaze.Each(function() {\n    return {\n      _sequence: Spacebars.dataMustache(view.lookup(\"reviewComments\"), Spacebars.dot(view.lookup(\"goal\"), \"_id\")),\n      _variable: \"comment\"\n    };\n  }, function() {\n    return [ \"\\n                    \", HTML.DIV({\n      class: \"goal-comment-outer\"\n    }, \"\\n                        \", HTML.DIV({\n      class: \"goal-comment-header row\"\n    }, \"\\n                            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                                \", Blaze.View(\"lookup:getUserName\", function() {\n      return Spacebars.mustache(view.lookup(\"getUserName\"), Spacebars.dot(view.lookup(\"comment\"), \"userId\"));\n    }), \"\\n                                \", HTML.DIV({\n      class: \"float-right\"\n    }, \"\\n                                    \", Blaze.View(\"lookup:formatDate\", function() {\n      return Spacebars.mustache(view.lookup(\"formatDate\"), Spacebars.dot(view.lookup(\"comment\"), \"date\"));\n    }), \"\\n                                \"), \"\\n                            \"), \"\\n                        \"), \"\\n                        \", HTML.DIV({\n      class: \"goal-comment row\"\n    }, \"\\n                            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                                \", Blaze.View(\"lookup:comment.text\", function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"comment\"), \"text\"));\n    }), \"\\n                            \"), \"\\n                        \"), \"\\n                    \"), \"\\n                    \" ];\n  }), \"\\n                \"), \"\\n                \", Blaze.If(function() {\n    return Spacebars.dataMustache(view.lookup(\"userHasModifyPerm\"), \"reviewComments\");\n  }, function() {\n    return [ \"\\n                \", HTML.DIV({\n      class: \"row spaced comment-add details\"\n    }, \"\\n                    \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                        \", HTML.DIV({\n      class: \"row spaced\"\n    }, \"\\n                            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                                \", HTML.TEXTAREA({\n      id: function() {\n        return [ \"new-review-comment-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n      },\n      class: \"new-review-comment form-control\"\n    }), \"\\n                            \"), \"\\n                        \"), \"\\n                        \", HTML.DIV({\n      class: \"row spaced\"\n    }, \"\\n                            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                                \", HTML.BUTTON({\n      id: function() {\n        return [ \"btn-review-comment-add-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n      },\n      class: \"btn btn-primary btn-review-comment-add\",\n      alt: \"Add comment\"\n    }, HTML.SPAN({\n      class: \"glyphicon glyphicon-pencil\"\n    }), \" Add comment\"), \"\\n                            \"), \"\\n                        \"), \"\\n                    \"), \"\\n                \"), \"\\n                \" ];\n  }), \"\\n            \"), \"\\n        \"), \"\\n        \", Blaze.If(function() {\n    return Spacebars.dataMustache(view.lookup(\"userHasModifyPerm\"), \"subgoals\");\n  }, function() {\n    return [ \"\\n        \", HTML.DIV({\n      class: \"row spaced details subgoal-add\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                \", HTML.BUTTON({\n      class: \"btn btn-primary btn-sm btn-add-subgoal\",\n      alt: \"Add subgoal\"\n    }, HTML.SPAN({\n      class: \"glyphicon glyphicon-th-list\"\n    }), \" Add subgoal\"), \"\\n            \"), \"\\n        \"), \"\\n        \" ];\n  }), \"\\n        \", Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"hasChildren\"));\n  }, function() {\n    return [ \"\\n        \", HTML.DIV({\n      class: \"row spaced details subgoals\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                \", HTML.DIV({\n      class: \"team-goal-children\"\n    }, \"\\n                    \", HTML.UL(\"\\n                        \", Blaze.Each(function() {\n      return {\n        _sequence: Spacebars.call(view.lookup(\"childGoals\")),\n        _variable: \"childGoal\"\n      };\n    }, function() {\n      return [ \"\\n                        \", HTML.LI(\"\\n                            \", Blaze._TemplateWith(function() {\n        return {\n          goal: Spacebars.call(view.lookup(\"childGoal\"))\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"child_igoal_view\"));\n      }), \"\\n                        \"), \"\\n                        \" ];\n    }), \"\\n                    \"), \"\\n                \"), \"\\n            \"), \"\\n        \"), \"\\n        \" ];\n  }), HTML.Raw(\"\\n        <!-- </form> -->\\n    \"));\n}));\n\nTemplate.__checkName(\"child_igoal_view\");\nTemplate[\"child_igoal_view\"] = new Template(\"Template.child_igoal_view\", (function() {\n  var view = this;\n  return [ HTML.DIV({\n    class: \"team-goal-title\",\n    \"data-id\": function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\"));\n    }\n  }, Blaze.View(\"lookup:goal.title\", function() {\n    return Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"title\"));\n  })), \"\\n    \", Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"hasChildren\"));\n  }, function() {\n    return [ \"\\n    \", HTML.UL(\"\\n        \", Blaze.Each(function() {\n      return {\n        _sequence: Spacebars.call(view.lookup(\"childGoals\")),\n        _variable: \"childGoal\"\n      };\n    }, function() {\n      return [ \"\\n        \", HTML.LI(\"\\n            \", Blaze._TemplateWith(function() {\n        return {\n          goal: Spacebars.call(view.lookup(\"childGoal\"))\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"child_igoal_view\"));\n      }), \"\\n        \"), \"\\n        \" ];\n    }), \"\\n    \"), \"\\n    \" ];\n  }) ];\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"individual_goals.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/individual_goals/individual_goals.js                                                               //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nlet Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 0);\nlet User;\nmodule.watch(require(\"/imports/api/users/users.js\"), {\n  User(v) {\n    User = v;\n  }\n\n}, 1);\nlet Team;\nmodule.watch(require(\"/imports/api/teams/teams.js\"), {\n  Team(v) {\n    Team = v;\n  }\n\n}, 2);\nlet IndividualGoal;\nmodule.watch(require(\"/imports/api/individual_goals/individual_goals.js\"), {\n  IndividualGoal(v) {\n    IndividualGoal = v;\n  }\n\n}, 3);\nmodule.watch(require(\"./individual_goals.html\"));\nmodule.watch(require(\"/imports/ui/components/select_autocomplete/select_autocomplete.js\"));\nconst BLANK_GOAL = {\n  _id: \"new\",\n  title: \"\",\n  description: \"\"\n};\n\nlet _hasSubgoalView = new ReactiveVar(false);\n\nlet _subgoalId = new ReactiveVar(\"\");\n\nTemplate.individual_goals.onCreated(function () {\n  if (FlowRouter.getParam('userId')) {\n    this.userId = FlowRouter.getParam('userId');\n  } else {\n    this.userId = Meteor.userId();\n  }\n\n  Session.set(\"goal_user_id\", this.userId);\n  Session.set(\"goalReload\", false);\n  this.userSubscriptionReady = new ReactiveVar(false);\n  this.autorun(() => {\n    this.modalGoalId = FlowRouter.getParam('goalId');\n\n    if (\"undefined\" !== typeof this.modalGoalId && \"\" !== this.modalGoalId) {\n      _hasSubgoalView.set(true);\n\n      _subgoalId.set(FlowRouter.getParam('goalId'));\n\n      $(\"body\").on(\"hidden.bs.modal\", \"#goal-modal-sub\", function () {\n        _hasSubgoalView.set(false);\n\n        _subgoalId.set(\"\");\n\n        FlowRouter.go(\"/individualGoals/\" + FlowRouter.getParam('teamName'));\n      });\n      Meteor.setTimeout(function () {\n        $(\"#goal-modal-sub\").modal(\"show\");\n        $(\"#goal-modal-sub\").find(\"div.team-goal\").removeClass(\"collapsed\");\n      }, 1000);\n    }\n\n    this.subscription = this.subscribe('individualGoalsData', getUserId(), {\n      onStop: function () {\n        console.log(\"Team Goals subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"Team Goals subscription ready! \", arguments, this);\n      }\n    });\n    this.subscription2 = this.subscribe('userList', Meteor.userId(), {\n      onStop: function () {\n        console.log(\"User List subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"User List subscription ready! \", arguments, this);\n      }\n    });\n    this.subscription3 = this.subscribe('teamsMemberOfList', getUserId(), {\n      onStop: function () {\n        console.log(\"Team Member Of List subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"Team Member Of List subscription ready! \", arguments, this);\n      }\n    });\n    console.log(this.subscription2);\n  });\n});\nTemplate.individual_goals.onRendered(function () {\n  Meteor.setTimeout(function () {\n    $(\"input.date\").datetimepicker({\n      format: 'YYYY-MM-DD',\n      useCurrent: false,\n      showClear: true,\n      showClose: true\n    });\n  }, 1000);\n  $(\"body\").on(\"hidden.bs.modal\", \"#goal-modal-new\", function () {\n    $newgoal = $(\"#div-goal-new\").detach();\n    $newgoal.data(\"parent-id\", \"\");\n    $(\"#blank-goal\").find(\".col-sm-12\").append($newgoal);\n  });\n});\n\nvar resetNewGoalForm = () => {\n  let valInputs = [\"goal-title-new\", \"goal-description-new\", \"input-date-due-new\", \"input-date-review-new\", \"input-date-reached-new\"];\n\n  for (let i = 0; i < valInputs.length; i++) {\n    $(\"#\" + valInputs[i]).val(\"\");\n  }\n};\n\nfunction saveGoal(goalId) {\n  let saveObj = {\n    title: $(\"#goal-title-\" + goalId).val(),\n    description: $(\"#goal-description-\" + goalId).val(),\n    userId: getUserId(),\n    teamId: $(\"#select-team-\" + goalId).val(),\n    privacy: $(\"#select-privacy-\" + goalId).val()\n  };\n  let startDate = $(\"#input-start-date-\" + goalId).val();\n\n  if (\"\" !== startDate) {\n    saveObj.startDate = new Date(startDate);\n  }\n\n  let dueDate = $(\"#input-date-due-\" + goalId).val();\n\n  if (\"\" !== dueDate) {\n    saveObj.dueDate = new Date(dueDate);\n  }\n\n  let rvwDate = $(\"#input-date-review-\" + goalId).val();\n\n  if (\"\" !== rvwDate) {\n    saveObj.reviewDate = new Date(rvwDate);\n  }\n\n  if (goalId === BLANK_GOAL._id) {\n    let parentId = $(\"#div-goal-new\").data(\"parent-id\");\n\n    if (\"\" !== parentId) {\n      saveObj.parentId = parentId;\n    }\n\n    Meteor.call('individualgoals.createNewGoal', saveObj, function (err, rslt) {\n      console.log(err, rslt);\n    });\n  } else {\n    let g = IndividualGoal.findOne({\n      _id: goalId\n    });\n    let reviewedOnDate = $(\"#input-date-reviewed-on-\" + goalId).val();\n\n    if (\"\" !== reviewedOnDate) {\n      saveObj.reviewedOnDate = new Date(reviewedOnDate);\n    }\n\n    let reachedDate = $(\"#input-date-reached-\" + goalId).val();\n\n    if (\"\" !== reachedDate) {\n      saveObj.reachedDate = new Date(reachedDate);\n    }\n\n    g.updateFromObj(saveObj);\n  }\n}\n\nfunction goalChanged($g) {\n  $g.find(\".btn-save\").prop(\"disabled\", false);\n  $g.find(\".btn-cancel\").prop(\"disabled\", false);\n}\n\nfunction goalUnchanged($g) {\n  $g.find(\".btn-save\").prop(\"disabled\", true);\n  $g.find(\".btn-cancel\").prop(\"disabled\", true);\n  $g.find(\".changed\").removeClass(\"changed\");\n}\n\nTemplate.individual_goals.events({\n  'change input.flat,textarea.flat'(event, instance) {\n    $(event.target).addClass('changed');\n    let $goal = $(event.target).closest(\"[data-goal-id]\");\n\n    if ($goal) {\n      if ($(\"#goal-title-\" + $goal.data(\"goal-id\")).val() != \"\") {//\n      }\n    }\n  },\n\n  'change input,textarea,select'(event, instance) {\n    let $t = $(event.target);\n    let $goal = $(event.target).closest(\"[data-goal-id]\");\n    goalChanged($goal);\n  },\n\n  'keyup input,textarea'(event, instance) {\n    let $t = $(event.target);\n    let $goal = $(event.target).closest(\"[data-goal-id]\");\n    goalChanged($goal);\n  },\n\n  'click button.btn-save'(event, instance) {\n    let $t = $(event.target);\n    let goalId = $t.closest(\"[data-goal-id]\").data(\"goal-id\");\n    saveGoal(goalId);\n    goalUnchanged($(\"#div-goal-\" + goalId));\n    $modalParent = $t.closest(\".modal\");\n\n    if ($modalParent.length) {\n      $modalParent.modal('hide');\n      $newgoal = $(\"#div-goal-new\").detach();\n      $newgoal.data(\"parent-id\", \"\");\n      $(\"#blank-goal\").find(\".col-sm-12\").html($newgoal);\n    }\n\n    if (goalId == BLANK_GOAL._id) {\n      resetNewGoalForm();\n\n      if (!$modalParent.length) {\n        $(\".goal-controls\").show();\n        $(\"#blank-goal\").slideUp();\n      }\n    }\n  },\n\n  'click button.btn-add-subgoal'(event, instance) {\n    let parentId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n    $newgoal = $(\"#div-goal-new\").detach();\n    $newgoal.data(\"parent-id\", parentId);\n    $newgoal.find(\".btn-cancel\").attr(\"disabled\", false);\n    $(\"#goal-modal-new\").find(\".modal-body\").append($newgoal);\n    $(\"#goal-modal-new\").modal(\"show\");\n    $(\"#goal-modal-new\").find(\"div.team-goal\").removeClass(\"collapsed\");\n  },\n\n  'click button.btn-cancel'(event, instance) {\n    let $t = $(event.target);\n    let goalId = $t.closest(\"[data-goal-id]\").data(\"goal-id\");\n    $modalParent = $t.closest(\".modal\");\n\n    if ($modalParent.length) {\n      $modalParent.modal('hide');\n      $newgoal = $(\"#div-goal-new\").detach();\n      $newgoal.data(\"parent-id\", \"\");\n      $(\"#blank-goal\").find(\".col-sm-12\").append($newgoal);\n    }\n\n    if (goalId == BLANK_GOAL._id) {\n      resetNewGoalForm();\n\n      if (!$modalParent.length) {\n        $(\".goal-controls\").show();\n        $(\"#blank-goal\").slideUp();\n      }\n    } else {\n      //forces a reload from the database\n      Session.set(\"goalReload\", true);\n      Meteor.setTimeout(function () {\n        Session.set(\"goalReload\", false);\n      }, 100);\n    }\n  },\n\n  'click button.btn-comment-add'(event, instance) {\n    $btnAdd = $(event.target);\n    let goalId = $btnAdd.closest(\"[data-goal-id]\").data(\"goal-id\");\n    let $comment = $(\"#new-comment-\" + goalId);\n    let newComment = $comment.val();\n    let g = IndividualGoal.findOne({\n      _id: goalId\n    });\n    g.addComment(newComment);\n    $comment.val(\"\");\n  },\n\n  'click button.btn-review-comment-add'(event, instance) {\n    $btnAdd = $(event.target);\n    let goalId = $btnAdd.closest(\"[data-goal-id]\").data(\"goal-id\");\n    let $comment = $(\"#new-review-comment-\" + goalId);\n    let newComment = $comment.val();\n    let g = IndividualGoal.findOne({\n      _id: goalId\n    });\n    g.addReviewComment(newComment);\n    $comment.val(\"\");\n  },\n\n  'click button#btn-add-goal'(event, instance) {\n    let $btnAdd = $(event.target);\n    $goal = $btnAdd.closest(\"[data-goal-id]\");\n    let goalId = $goal.data(\"goal-id\");\n    $(\".goal-controls\").hide();\n    let $btnCancel = $(\"#blank-goal\").find(\".btn-cancel\");\n    $btnCancel.prop(\"disabled\", false);\n    $(\".team-goal[data-goal-id=\" + goalId + \"]\").removeClass(\"collapsed\");\n    $(\"#blank-goal\").slideDown();\n    $(\"#btn-add-cancel\").fadeIn();\n  },\n\n  'click button#btn-add-cancel'(event, instance) {\n    $(\"#blank-goal\").slideUp();\n    $(\"#btn-add-cancel\").fadeOut();\n  },\n\n  'click button.btn-expand,div.collapsed-summary'(event, instance) {\n    let $target = $(event.target);\n    let $goalContainer = $target.closest(\"[data-goal-id]\");\n    let $targetExpandBtn = $goalContainer.find(\".btn-expand.glyphicon\");\n    $targetExpandBtn.removeClass(\"glyphicon-chevron-up\").addClass(\"glyphicon-chevron-down\");\n\n    if ($goalContainer.hasClass(\"collapsed\")) {\n      $(\".team-goal[data-goal-id]:not(.collapsed)\").slideUp(function () {\n        $(this).addClass(\"collapsed\").css(\"display\", \"block\");\n      });\n      $goalContainer.css(\"display\", \"none\").removeClass(\"collapsed\").slideDown(function () {\n        $('html, body').animate({\n          scrollTop: $goalContainer.offset().top\n        }, 500);\n      });\n      $targetExpandBtn.removeClass(\"glyphicon-chevron-down\");\n      $targetExpandBtn.addClass(\"glyphicon-chevron-up\");\n    } else {\n      $goalContainer.slideUp(function () {\n        $goalContainer.addClass(\"collapsed\").css(\"display\", \"block\");\n      });\n      $targetExpandBtn.removeClass(\"glyphicon-chevron-up\");\n      $targetExpandBtn.addClass(\"glyphicon-chevron-down\");\n    }\n  },\n\n  'keyup textarea.goal-description,input.goal-title': _.debounce(function (event, instance) {\n    let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n\n    if (\"new\" === goalId) {\n      //don't auto-save if creating a new goal\n      return;\n    }\n\n    saveGoal(goalId);\n    goalUnchanged($(\"#div-goal-\" + goalId));\n  }, 2000),\n  'change input,select': _.debounce(function (event, instance) {\n    if (!Session.get(\"saving\")) {\n      let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n\n      if (\"new\" === goalId) {\n        //don't auto-save if creating a new goal\n        return;\n      }\n\n      saveGoal(goalId);\n      goalUnchanged($(\"#div-goal-\" + goalId));\n    }\n  }, 2000),\n  'dp.change': _.debounce(function (event, instance) {\n    if (!Session.get(\"saving\")) {\n      let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n\n      if (\"new\" === goalId) {\n        //don't auto-save if creating a new goal\n        return;\n      }\n\n      saveGoal(goalId);\n      goalUnchanged($(\"#div-goal-\" + goalId));\n    }\n  }, 2000),\n\n  'click div.team-goal-title[data-id]'(event, instance) {\n    _hasSubgoalView.set(true);\n\n    let gid = $(event.target).data(\"id\");\n\n    _subgoalId.set(gid);\n\n    FlowRouter.go(\"/individualGoals/\" + FlowRouter.getParam('teamName') + \"/\" + gid);\n    $(\"#goal-modal-sub\").prop(\"disabled\", false).modal(\"show\");\n  }\n\n});\n\nfunction getUserId() {\n  return Session.get(\"goal_user_id\");\n}\n\nTemplate.individual_goals.helpers({\n  goalReload() {\n    return Session.get(\"goalReload\");\n  },\n\n  hasGoals() {\n    let uid = getUserId();\n    let g = IndividualGoal.find({\n      userId: uid,\n      parentId: ''\n    }).fetch();\n    return g.length > 0;\n  },\n\n  hasGoalsTeam(tid) {\n    let uid = getUserId();\n    let g = IndividualGoal.find({\n      userId: uid,\n      parentId: '',\n      teamId: tid\n    }).fetch();\n    return g.length > 0;\n  },\n\n  individualGoals() {\n    let uid = getUserId();\n    let g = IndividualGoal.find({\n      userId: uid,\n      parentId: ''\n    }).fetch();\n    return g;\n  },\n\n  individualGoalsTeam(tid) {\n    let uid = getUserId();\n    let g = IndividualGoal.find({\n      userId: uid,\n      parentId: '',\n      teamId: tid\n    }).fetch();\n    return g;\n  },\n\n  ownList() {\n    //check to see if the user logged in is the owner of the goals currently displayed\n    return Meteor.userId() === getUserId();\n  },\n\n  blankGoal() {\n    return Object.assign({\n      userId: getUserId()\n    }, BLANK_GOAL);\n  },\n\n  hasSubgoalView() {\n    let hasView = _hasSubgoalView.get();\n\n    let gid = _subgoalId.get();\n\n    if (hasView) {\n      return true;\n    } else {\n      return false;\n    }\n  },\n\n  subgoal() {\n    let hasView = _hasSubgoalView.get();\n\n    let subgoalId = Template.instance().modalGoalId;\n    subgoalId = _subgoalId.get();\n    let g = IndividualGoal.findOne({\n      _id: subgoalId\n    });\n\n    if (g) {\n      return g;\n    } else {\n      return {};\n    }\n  },\n\n  goalComments(goalId) {\n    let g = IndividualGoal.findOne({\n      _id: goalId\n    });\n\n    if (!g) {\n      return;\n    }\n\n    let c = g.goalComments;\n    return c;\n  },\n\n  reviewComments(goalId) {\n    let g = IndividualGoal.findOne({\n      _id: goalId\n    });\n\n    if (!g) {\n      return;\n    }\n\n    let c = g.reviewComments;\n    return c;\n  },\n\n  formatDate(dateObj) {\n    return dateObj.toLocaleDateString();\n  },\n\n  getUserName(userId) {\n    let u = User.findOne({\n      _id: userId\n    });\n    if (!u) return \"\";\n    let fullName = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n    return fullName;\n  },\n\n  userList() {\n    let list = [{\n      id: 1,\n      name: \"George\"\n    }, {\n      id: 2,\n      name: \"Frank\"\n    }];\n    return list;\n  },\n\n  teamList() {\n    //list of teams the user is a member of\n    let t = Team.find({\n      Members: getUserId()\n    });\n\n    if (!t) {\n      return [];\n    }\n\n    return t.fetch();\n  }\n\n}); //Template.igoal_view.onRendered(function () {\n//});\n\nTemplate.igoal_view.helpers({\n  childGoals() {\n    let goalId = Template.instance().data.goal._id;\n\n    let children = IndividualGoal.find({\n      parentId: goalId\n    }).fetch();\n    return children;\n  },\n\n  hasChildren() {\n    let goalId = Template.instance().data.goal._id;\n\n    let doesHave = IndividualGoal.find({\n      parentId: goalId\n    }).fetch().length > 0;\n    return doesHave;\n  },\n\n  goalComments(goalId) {\n    if (goalId === BLANK_GOAL._id) {\n      return;\n    }\n\n    let g = IndividualGoal.findOne({\n      _id: goalId\n    });\n\n    if (!g) {\n      return;\n    }\n\n    let c = g.goalComments;\n    return c;\n  },\n\n  reviewComments(goalId) {\n    if (goalId === BLANK_GOAL._id) {\n      return;\n    }\n\n    let g = IndividualGoal.findOne({\n      _id: goalId\n    });\n\n    if (!g) {\n      return;\n    }\n\n    let c = g.reviewComments;\n    return c;\n  },\n\n  formatDate(dateObj) {\n    return dateObj.toLocaleDateString();\n  },\n\n  dateField(fld) {\n    let goal = Template.instance().data.goal;\n\n    if (goal._id == BLANK_GOAL._id) {\n      return \"\";\n    }\n\n    let d = goal[fld];\n\n    if (!(d instanceof Date)) {\n      return \"\";\n    }\n\n    let dateText = new Date(d.getTime() - d.getTimezoneOffset() * 60000).toISOString().slice(0, -1);\n    return dateText;\n  },\n\n  getUserName(userId) {\n    let u = User.findOne({\n      _id: userId\n    });\n    if (!u) return \"\";\n    let fullName = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n    return fullName;\n  },\n\n  userList() {\n    let userList = [];\n    User.find({}).forEach(user => {\n      userList.push({\n        text: user.MyProfile.firstName + \" \" + user.MyProfile.lastName,\n        value: user._id\n      });\n    });\n    return userList;\n  },\n\n  progressPct() {\n    let goal = Template.instance().data.goal;\n    let g = IndividualGoal.findOne({\n      _id: goal._id\n    });\n    if (!g) return 0;\n\n    if (!g.dueDate || !g.startDate || \"undefined\" === typeof g.dueDate || \"undefined\" === typeof g.startDate) {\n      return 0;\n    }\n\n    let currDt = new Date().getTime();\n    let totalDuration = g.dueDate.getTime() - g.startDate.getTime();\n    let timeSinceStart = currDt - g.startDate.getTime();\n    let pct = timeSinceStart / totalDuration;\n    return Math.min(parseInt(pct * 100), 100);\n  },\n\n  ownList() {\n    //check to see if the user logged in is the owner of the goals currently displayed\n    return Meteor.userId() === getUserId();\n  },\n\n  userHasModifyPerm(fld) {\n    let goal = Template.instance().data.goal;\n    let g = IndividualGoal.findOne({\n      _id: goal._id\n    });\n    if (!g) return true;\n    return g.hasModifyPerm(fld);\n  },\n\n  fldEnabled(fld) {\n    let goal = Template.instance().data.goal;\n    let g = IndividualGoal.findOne({\n      _id: goal._id\n    });\n\n    if (!g) {\n      if (Roles.userIsInRole(Meteor.userId(), 'admin', goal.teamName)) {\n        return \"\";\n      } else {\n        return \"disabled\";\n      }\n    }\n\n    if (g.hasModifyPerm(fld)) {\n      return \"\";\n    } else {\n      return \"disabled\";\n    }\n  },\n\n  isNew(id) {\n    return BLANK_GOAL._id === id;\n  },\n\n  teamList() {\n    //list of teams the user is a member of\n    let t = Team.find();\n\n    if (!t) {\n      return [];\n    }\n\n    return t.fetch();\n  },\n\n  teamSelected(teamId) {\n    let goal = Template.instance().data.goal;\n    let g = IndividualGoal.findOne({\n      _id: goal._id\n    });\n\n    if (!g) {\n      return;\n    }\n\n    if (g.teamId === teamId) {\n      return \"selected\";\n    } else {\n      return \"\";\n    }\n  },\n\n  privacySelected(privVal) {\n    let goal = Template.instance().data.goal;\n    let g = IndividualGoal.findOne({\n      _id: goal._id\n    });\n\n    if (!g) {\n      return;\n    }\n\n    if (g.privacy === privVal) {\n      return \"selected\";\n    } else {\n      return \"\";\n    }\n  },\n\n  collapsed(pid) {\n    //if this goal has a parent it is being displayed in a modal and should not be collapsed\n    if (\"\" !== pid) {\n      return \"\";\n    } else {\n      return \"collapsed\";\n    }\n  }\n\n});\nTemplate.child_igoal_view.helpers({\n  childGoals() {\n    let goalId = Template.instance().data.goal._id;\n\n    let children = IndividualGoal.find({\n      parentId: goalId\n    }).fetch();\n    return children;\n  },\n\n  hasChildren(goalId) {\n    goalId = Template.instance().data.goal._id;\n    let doesHave = IndividualGoal.find({\n      parentId: goalId\n    }).count() > 0;\n    return doesHave;\n  }\n\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"learn_share\":{\"learn_share.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/learn_share/learn_share.html                                                                       //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.learn_share.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.learn_share.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/learn_share/template.learn_share.js                                                                //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"learn_share\");\nTemplate[\"learn_share\"] = new Template(\"Template.learn_share\", (function() {\n  var view = this;\n  return [ Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"canEditAdmin\"));\n  }, function() {\n    return [ \"\\n        \", HTML.SCRIPT({\n      src: \"https://swx.cdn.skype.com/shared/v/1.2.15/SkypeBootstrap.min.js\"\n    }), \"\\n    \" ];\n  }), \"\\n    \", Blaze.If(function() {\n    return Spacebars.call(view.templateInstance().subscriptionsReady());\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      class: \"container\",\n      \"data-lssid\": function() {\n        return Spacebars.mustache(view.lookup(\"lssid\"));\n      }\n    }, \"\\n        \", Blaze.Unless(function() {\n      return Spacebars.call(view.lookup(\"currentUser\"));\n    }, function() {\n      return [ \"\\n            \", Blaze.If(function() {\n        return Spacebars.call(view.lookup(\"sessionActive\"));\n      }, function() {\n        return [ \"\\n                \", HTML.DIV({\n          class: \"row spaced\"\n        }, \"\\n                    \", HTML.DIV({\n          class: \"label label-info\"\n        }, \"You are participating as \", HTML.SPAN({\n          class: \"guest-name\",\n          id: \"guest-name-edit\",\n          \"data-toggle\": \"modal\",\n          \"data-target\": \"#modal-edit-name\"\n        }, Blaze.View(\"lookup:guestName\", function() {\n          return Spacebars.mustache(view.lookup(\"guestName\"));\n        }), \" \", HTML.SPAN({\n          class: \"glyphicon glyphicon-edit\"\n        }))), \"\\n                \"), \"\\n            \" ];\n      }), \"\\n        \" ];\n    }), \"\\n        \", HTML.DIV({\n      class: \"row spaced\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"col-sm-10\"\n    }, \"\\n                \", HTML.H1(\"Learn\", HTML.IMG({\n      src: \"/img/DeveloperLevel_icon_bg.png\",\n      class: \"dl-icon\"\n    }), \"Share\"), \"\\n                \", Blaze.If(function() {\n      return Spacebars.call(view.lookup(\"teamId\"));\n    }, function() {\n      return [ \"\\n                    \", HTML.H1(Blaze._TemplateWith(function() {\n        return {\n          team: Spacebars.call(view.lookup(\"team\"))\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"team_icon\"));\n      }), \" \", Blaze.View(\"lookup:teamName\", function() {\n        return Spacebars.mustache(view.lookup(\"teamName\"));\n      })), \"\\n                \" ];\n    }), \"\\n                \", HTML.DIV(\"Session title\"), \"\\n                \", HTML.DIV(\"\\n                \", Blaze.If(function() {\n      return Spacebars.call(view.lookup(\"canEditAdmin\"));\n    }, function() {\n      return [ \"\\n                    \", HTML.INPUT({\n        class: \"form-control input-lg flat\",\n        value: function() {\n          return Spacebars.mustache(view.lookup(\"title\"));\n        },\n        id: \"input-title\"\n      }), \"\\n                \" ];\n    }, function() {\n      return [ \"\\n                    \", HTML.H2(Blaze.View(\"lookup:title\", function() {\n        return Spacebars.mustache(view.lookup(\"title\"));\n      })), \"\\n                \" ];\n    }), \"\\n                \"), \"\\n            \"), \"\\n            \", HTML.DIV({\n      class: \"col-sm-2 text-right\"\n    }, \"\\n                \", Blaze.If(function() {\n      return Spacebars.call(view.lookup(\"sessionActive\"));\n    }, function() {\n      return [ \"\\n                    \", HTML.DIV({\n        class: \"label label-info\"\n      }, HTML.A({\n        href: \"#\",\n        id: \"lockSession\"\n      }, HTML.SPAN({\n        class: \"glyphicon glyphicon-lock\"\n      }, \" Active\"))), \"\\n                \" ];\n    }, function() {\n      return [ \"\\n                    \", HTML.DIV({\n        class: \"label label-warning\"\n      }, HTML.A({\n        href: \"#\",\n        id: \"unlockSession\"\n      }, HTML.SPAN({\n        class: \"glyphicon glyphicon-lock\"\n      }, \" Locked\"))), \"\\n                \" ];\n    }), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n      class: \"row spaced\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"col-sm-6\"\n    }, \"\\n                Skype URL:\\n                \", Blaze.If(function() {\n      return Spacebars.call(view.lookup(\"canEditAdmin\"));\n    }, function() {\n      return [ \"\\n                    \", Blaze.If(function() {\n        return Spacebars.call(view.lookup(\"skypeUrl\"));\n      }, function() {\n        return [ \"\\n                        \", HTML.SPAN({\n          id: \"span-create-skype\",\n          style: \"display:none;\"\n        }, \"(\", HTML.A({\n          href: \"#\",\n          id: \"a-create-call\"\n        }, \"Create skype meeting\"), \")\"), \"\\n                        \", HTML.A({\n          id: \"a-skype-url\",\n          href: function() {\n            return Spacebars.mustache(view.lookup(\"skypeUrl\"));\n          },\n          target: \"_blank\"\n        }, Blaze.View(\"lookup:skypeUrl\", function() {\n          return Spacebars.mustache(view.lookup(\"skypeUrl\"));\n        })), \" \", HTML.A({\n          id: \"a-skype-url-edit\",\n          href: \"#\"\n        }, HTML.SPAN({\n          class: \"glyphicon glyphicon-edit\"\n        })), \"\\n                        \", HTML.INPUT({\n          type: \"text\",\n          id: \"input-skype-url\",\n          class: \"form-control\",\n          value: function() {\n            return Spacebars.mustache(view.lookup(\"skypeUrl\"));\n          },\n          style: \"display:none\"\n        }), \"\\n                    \" ];\n      }, function() {\n        return [ \"\\n                        \", HTML.SPAN({\n          id: \"span-create-skype\"\n        }, \"(\", HTML.A({\n          href: \"#\",\n          id: \"a-create-call\"\n        }, \"Create skype meeting\"), \")\"), \"\\n                        \", HTML.INPUT({\n          type: \"text\",\n          id: \"input-skype-url\",\n          class: \"form-control\"\n        }), \"\\n                    \" ];\n      }), \"\\n                \" ];\n    }, function() {\n      return [ \"\\n                    \", HTML.A({\n        href: function() {\n          return Spacebars.mustache(view.lookup(\"skypeUrl\"));\n        },\n        target: \"_blank\"\n      }, Blaze.View(\"lookup:skypeUrl\", function() {\n        return Spacebars.mustache(view.lookup(\"skypeUrl\"));\n      })), \"\\n                \" ];\n    }), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n      class: \"row spaced\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"col-sm-4\"\n    }, \"\\n                \", HTML.DIV({\n      class: \"row spaced\"\n    }, \"\\n                    \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                        Participants\\n                    \"), \"\\n                \"), \"\\n                \", HTML.DIV({\n      class: \"row spaced\"\n    }, \"\\n                    \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                        \", HTML.DIV({\n      class: \"control-group\"\n    }, \"\\n                            \", Blaze.If(function() {\n      return Spacebars.call(view.lookup(\"canEdit\"));\n    }, function() {\n      return [ \"\\n                                \", Blaze._TemplateWith(function() {\n        return {\n          id: Spacebars.call(\"select-participants\"),\n          id2: Spacebars.call(\"\"),\n          name: Spacebars.call(\"participants[]\"),\n          placeholder: Spacebars.call(\"Choose session participants...\"),\n          list: Spacebars.call(view.lookup(\"userAddList\")),\n          selected: Spacebars.call(view.lookup(\"sessionParticipantItems\")),\n          onItemRemove: Spacebars.call(view.lookup(\"itemRemoveHandler\")),\n          onItemAdd: Spacebars.call(view.lookup(\"itemAddHandler\")),\n          create: Spacebars.call(\"1\")\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"select_autocomplete\"));\n      }), \"\\n                            \" ];\n    }, function() {\n      return [ \"\\n                                \", Blaze._TemplateWith(function() {\n        return {\n          items: Spacebars.call(view.lookup(\"sessionParticipantItems\")),\n          labelType: Spacebars.call(\"label-warning\")\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"label_list\"));\n      }), \"\\n                            \" ];\n    }), \"\\n                        \"), \"\\n                    \"), \"\\n                \"), \"\\n                \", HTML.DIV({\n      class: \"row spaced\"\n    }, \"\\n                    \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                        Guests\\n                    \"), \"\\n                \"), \"\\n                \", HTML.DIV({\n      class: \"row spaced\"\n    }, \"\\n                    \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                        \", HTML.DIV({\n      class: \"control-group\"\n    }, \"\\n                            \", Blaze.If(function() {\n      return Spacebars.call(view.lookup(\"canEdit\"));\n    }, function() {\n      return [ \"\\n                                \", Blaze._TemplateWith(function() {\n        return {\n          id: Spacebars.call(\"select-guests\"),\n          id2: Spacebars.call(\"\"),\n          name: Spacebars.call(\"guests[]\"),\n          placeholder: Spacebars.call(\"Choose session guests...\"),\n          list: Spacebars.call(view.lookup(\"userAddList\")),\n          selected: Spacebars.call(view.lookup(\"sessionGuestItems\")),\n          onItemRemove: Spacebars.call(view.lookup(\"itemRemoveGuestHandler\")),\n          onItemAdd: Spacebars.call(view.lookup(\"itemAddGuestHandler\")),\n          create: Spacebars.call(\"1\")\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"select_autocomplete\"));\n      }), \"\\n                            \" ];\n    }, function() {\n      return [ \"\\n                                \", Blaze._TemplateWith(function() {\n        return {\n          items: Spacebars.call(view.lookup(\"sessionGuestItems\")),\n          labelType: Spacebars.call(\"label-warning\")\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"label_list\"));\n      }), \"\\n                            \" ];\n    }), \"\\n                        \"), \"\\n                    \"), \"\\n                \"), \"\\n            \"), \"\\n            \", HTML.DIV({\n      class: \"col-sm-4\"\n    }, \"\\n                \", HTML.DIV({\n      class: \"row spaced\"\n    }, \"\\n                    \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                        \", HTML.CharRef({\n      html: \"&nbsp;\",\n      str: \"\"\n    }), \"\\n                    \"), \"\\n                \"), \"\\n                \", HTML.DIV({\n      class: \"row spaced\"\n    }, \"\\n                    \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                        \", Blaze.If(function() {\n      return Spacebars.call(view.lookup(\"canEditAdmin\"));\n    }, function() {\n      return [ \"\\n                        \", HTML.DIV({\n        id: \"p-pick-first\"\n      }, \"\\n                            \", HTML.BUTTON({\n        id: \"btn-pick-first\",\n        class: \"btn btn-primary\"\n      }, \"Pick random presenter\"), \"\\n                        \"), \"\\n                        \", HTML.DIV({\n        id: \"p-on-deck\",\n        style: \"display:none\"\n      }, \"\\n                            \", HTML.BUTTON({\n        id: \"btn-pick-again\",\n        class: \"btn btn-primary\"\n      }, \"Pick again\"), \"\\n                            \", HTML.BUTTON({\n        id: \"btn-pick-accept\",\n        class: \"btn btn-success\"\n      }, \"Accept\"), \"\\n                            \", HTML.DIV({\n        id: \"p-on-deck-info\",\n        class: \"jumbotron\"\n      }), \"\\n                        \"), \"\\n                        \" ];\n    }), \"\\n                    \"), \"\\n                \"), \"\\n            \"), \"\\n            \", HTML.DIV({\n      class: \"col-sm-4\"\n    }, \"\\n                \", HTML.DIV({\n      class: \"row spaced\"\n    }, \"\\n                    \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                        Presenters\\n                    \"), \"\\n                \"), \"\\n                \", HTML.DIV({\n      class: \"row spaced\"\n    }, \"\\n                    \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                        \", HTML.UL({\n      class: \"list-group\",\n      id: \"ls-presenters\"\n    }, \"\\n                            \", Blaze.Each(function() {\n      return {\n        _sequence: Spacebars.call(view.lookup(\"sessionPresenters\")),\n        _variable: \"presenter\"\n      };\n    }, function() {\n      return [ \"\\n                            \", HTML.LI({\n        class: \"list-group-item\",\n        \"data-id\": function() {\n          return Spacebars.mustache(Spacebars.dot(view.lookup(\"presenter\"), \"id\"));\n        }\n      }, Blaze.View(\"lookup:order\", function() {\n        return Spacebars.mustache(view.lookup(\"order\"), view.lookup(\"@index\"));\n      }), \". \", Blaze.View(\"lookup:presenter.name\", function() {\n        return Spacebars.mustache(Spacebars.dot(view.lookup(\"presenter\"), \"name\"));\n      })), \"\\n                            \" ];\n    }), \"\\n                        \"), \"\\n                    \"), \"\\n                \"), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n      class: \"row spaced\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                Session Notes\\n                \", Blaze.If(function() {\n      return Spacebars.call(view.lookup(\"canEdit\"));\n    }, function() {\n      return [ \"\\n                    \", HTML.TEXTAREA({\n        id: \"input-notes\",\n        class: \"form-control\",\n        rows: \"10\",\n        value: function() {\n          return Spacebars.mustache(view.lookup(\"notes\"));\n        }\n      }), \"\\n                \" ];\n    }, function() {\n      return [ \"\\n                    \", HTML.DIV({\n        class: \"jumbotron\"\n      }, HTML.PRE(Blaze.View(\"lookup:notes\", function() {\n        return Spacebars.mustache(view.lookup(\"notes\"));\n      }))), \"\\n                \" ];\n    }), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n      class: \"row spaced\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                Session Recording\\n                \", Blaze.If(function() {\n      return Spacebars.call(view.lookup(\"canEditAdmin\"));\n    }, function() {\n      return [ \"\\n                    \", HTML.INPUT({\n        name: \"recording-upload\",\n        class: \"file-upload-input\",\n        type: \"file\"\n      }), \"\\n                \" ];\n    }), \"\\n                \", HTML.DIV(\"\\n                    \", Blaze._TemplateWith(function() {\n      return {\n        id: Spacebars.call(view.lookup(\"lssid\"))\n      };\n    }, function() {\n      return Spacebars.include(view.lookupTemplate(\"video_embed\"));\n    }), \"\\n                \"), \"\\n            \"), \"\\n        \"), \"\\n    \"), \"\\n    \" ];\n  }, function() {\n    return [ \"\\n        \", Spacebars.include(view.lookupTemplate(\"loading\")), \"\\n    \" ];\n  }), \"\\n\\n    \", HTML.DIV({\n    class: \"modal fade\",\n    id: \"modal-edit-name\"\n  }, \"\\n      \", HTML.DIV({\n    class: \"modal-dialog modal-sm\",\n    role: \"document\"\n  }, \"\\n        \", HTML.DIV({\n    class: \"modal-content\"\n  }, \"\\n          \", HTML.Raw('<div class=\"modal-header\">\\n            <h5 class=\"modal-title\">Guest Name</h5>\\n            <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\\n              <span aria-hidden=\"true\">&times;</span>\\n            </button>\\n          </div>'), \"\\n          \", HTML.DIV({\n    class: \"modal-body\"\n  }, \"\\n            \", HTML.INPUT({\n    id: \"input-guest-name\",\n    class: \"form-control input-lg\",\n    value: function() {\n      return Spacebars.mustache(view.lookup(\"guestName\"));\n    }\n  }), \"\\n          \"), \"\\n          \", HTML.Raw('<div class=\"modal-footer\">\\n            <button type=\"button\" class=\"btn btn-primary\" id=\"modal-save-name\">Save changes</button>\\n            <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">Close</button>\\n          </div>'), \"\\n        \"), \"\\n      \"), \"\\n    \") ];\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"learn_share.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/learn_share/learn_share.js                                                                         //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nlet User;\nmodule.watch(require(\"/imports/api/users/users.js\"), {\n  User(v) {\n    User = v;\n  }\n\n}, 0);\nlet LearnShareSession;\nmodule.watch(require(\"/imports/api/learn_share/learn_share.js\"), {\n  LearnShareSession(v) {\n    LearnShareSession = v;\n  }\n\n}, 1);\nlet Team;\nmodule.watch(require(\"/imports/api/teams/teams.js\"), {\n  Team(v) {\n    Team = v;\n  }\n\n}, 2);\nmodule.watch(require(\"./learn_share.html\"));\nmodule.watch(require(\"/imports/ui/components/label_list/label_list.js\"));\n\nvar generateGuestId = () => {\n  var text = \"guest-\";\n  var idLength = 11;\n  var possible = \"acdeghijklmnopqrstuvwxyzACDEGHIJKLMNOPQRSTUVWXYZ0123456789\";\n\n  for (var i = 0; i < idLength; i++) {\n    text += possible.charAt(Math.floor(Math.random() * possible.length));\n  }\n\n  return text;\n};\n\nvar app;\nvar client_id = '8e7e8c57-117c-454a-bf71-7ec493ab82b1';\nvar meeting;\nvar version = \"appdeveloperlevel/0.59\";\n\nfunction initSkypeAPI() {\n  console.log(sessionStorage);\n  debugger;\n  var hasToken = /^#access_token=/.test(location.hash) || !!sessionStorage.apiAccessToken;\n  var hasError = /^#error=/.test(location.hash);\n\n  if (!hasToken && !hasError) {\n    let pathParts = location.pathname.split('/');\n    sessionStorage.lastLearnShareId = pathParts[pathParts.length - 1];\n    console.log(sessionStorage);\n    location.assign('https://login.microsoftonline.com/common/oauth2/authorize?response_type=token' + '&client_id=' + client_id + '&redirect_uri=' + location.origin + '/learnShare' + '&resource=https://webdir.online.lync.com');\n  } else {\n    if (!sessionStorage.apiAccessToken) {\n      var tokenresponse = parseHashParams(window.location.hash);\n      sessionStorage.apiAccessToken = tokenresponse.access_token;\n      window.location.hash = '#';\n    }\n\n    Skype.initialize({\n      apiKey: 'a42fcebd-5b43-4b89-a065-74450fb91255',\n      correlationIds: {\n        sessionId: 'mySession123' // Necessary for troubleshooting requests, should be unique per session\n\n      }\n    }, function (api) {\n      console.log(\"wwwwwwwwwwwwwwwwwwwwwww\");\n      app = new api.application();\n      console.log(app);\n      apiSignIn();\n    });\n  }\n}\n\nfunction parseHashParams(hash) {\n  var params = hash.slice(1).split('&');\n  var paramarray = {};\n  params.forEach(function (param) {\n    param = param.split('=');\n    paramarray[param[0]] = param[1];\n  });\n  return paramarray;\n}\n\nfunction apiSignIn() {\n  console.log(1234, app);\n  var application = app; // the SDK will get its own access token\n\n  app.signInManager.signIn({\n    client_id: client_id,\n    cors: true,\n    redirect_uri: '/learnShare',\n    origins: [\"https://webdir.online.lync.com/autodiscover/autodiscoverservice.svc/root\"],\n    version: version // Necessary for troubleshooting requests; identifies your application in our telemetry\n\n  }).then(function (a) {\n    console.log(\"signed in\", a);\n    createMeeting();\n  }, function (err) {\n    $(\"#span-create-skype\").html(\"(<a href='#' id='a-create-call'>Create skype meeting</a>)\");\n    console.log(\"sign in error\", err);\n  });\n}\n\nfunction createMeeting() {\n  meeting = app.conversationsManager.createMeeting();\n  meeting.subject('LearnShare Meeting');\n  meeting.accessLevel('Everyone');\n  console.log('0', meeting);\n  meeting.onlineMeetingUri.get().then(function (uri) {\n    console.log('1', uri); //var conversation = app.conversationsManager.getConversationByUri(uri);\n    //console.log(\"what?\",conversation);\n\n    let uriChunks = uri.split(':');\n    let skypeUser = uriChunks[1].split(';')[0];\n    let emlUser = skypeUser.split('@')[0];\n    let emlDomain = skypeUser.split('@')[1];\n    let mtgId = uriChunks[uriChunks.length - 1];\n    let url = 'https://meet.lync.com/' + emlDomain + '/' + emlUser + '/' + mtgId;\n    console.log(url);\n    $(\"#input-skype-url\").val(url);\n    $(\"#span-create-skype\").html(\"(<a href='#' id='a-create-call'>Create skype meeting</a>)\");\n    $(\"#input-skype-url\").trigger(\"change\");\n  }, function (err) {\n    $(\"#span-create-skype\").html(\"(<a href='#' id='a-create-call'>Create skype meeting</a>)\");\n    console.log(err);\n  });\n}\n\nTemplate.learn_share.onCreated(function () {\n  this.lssid = FlowRouter.getParam('lssid');\n\n  if (!Meteor.user()) {\n    //user not logged in, treat as guest\n    let gname = Session.get(\"guestName\");\n\n    if (\"undefined\" === typeof gname) {\n      let gid = generateGuestId(); //Session.setPersistent(\"guestName\", 'lurker'+gid.slice(5,10));\n      //Session.setPersistent(\"guestId\", gid);\n    }\n  }\n\n  this.autorun(() => {\n    console.log(\"autorunning learn_share...\");\n    this.subscription = this.subscribe('userList', Meteor.userId(), {\n      onStop: function () {\n        console.log(\"User List subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"User List subscription ready! \", arguments, this);\n        let userList = [];\n        User.find().forEach(user => {\n          userList.push({\n            text: user.MyProfile.firstName + \" \" + user.MyProfile.lastName,\n            value: user._id\n          });\n        });\n      }\n    });\n    console.log(this.subscription);\n    this.subscription2 = this.subscribe('learnShareDetails', this.lssid, {\n      onStop: function () {\n        console.log(\"LearnShare List subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"LearnShare List subscription ready! \", arguments, this);\n        let lssess = LearnShareSession.findOne({\n          _id: this.params[0]\n        });\n\n        if (\"locked\" !== lssess.state) {\n          if (Meteor.user()) {\n            lssess.addParticipantSelf();\n            lssess = LearnShareSession.findOne({\n              _id: this.params[0]\n            });\n            let selectControl = $(\"#select-participants\")[0].selectize;\n\n            for (let i = 0; i < lssess.participants.length; i++) {\n              selectControl.addItem(lssess.participants[i].id);\n            }\n\n            for (let i = 0; i < lssess.presenters.length; i++) {\n              $(\".item[data-value=\" + lssess.presenters[i].id + \"]\").addClass(\"picked\");\n            }\n\n            if ($(\".item[data-value]\").not(\".picked\").length === 0) {\n              $(\"#btn-pick-first\").prop(\"disabled\", true);\n            } else {\n              $(\"#btn-pick-first\").prop(\"disabled\", false);\n            }\n          } else {\n            lssess.saveGuest(Session.get(\"guestId\"), Session.get(\"guestName\"));\n          }\n        }\n      }\n    });\n    console.log(this.subscription2);\n    this.subscription3 = this.subscribe('teamsData', Meteor.userId(), {\n      onStop: function () {\n        console.log(\"teamsData subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"teamsData subscription ready! \", arguments, this);\n      }\n    });\n    console.log(this.subscription3);\n  });\n});\nTemplate.learn_share.onRendered(() => {\n  Meteor.setTimeout(() => {\n    if (/^#access_token=/.test(location.hash)) {\n      console.log(\"hhhhhhhhhhhhhhhhhhhhhhhhhhhhhh\");\n      $(\"#a-skype-url-edit\").trigger(\"click\");\n      Meteor.setTimeout(() => {\n        $(\"#a-create-call\").trigger(\"click\");\n      }, 500);\n    }\n\n    $('#modal-edit-name').on('shown.bs.modal', function () {\n      $('#input-guest-name').focus();\n    });\n    $(document).on('click', '#selectize-outer-select-guests .selectize-input .item', function (event) {\n      let $target = $(event.target);\n      let participant = {\n        id: $target.data(\"value\"),\n        name: $target.text().slice(0, -1)\n      };\n      let lssid = $(\"#select-participants\").closest(\"[data-lssid]\").data(\"lssid\");\n      let ls = LearnShareSession.findOne({\n        _id: lssid\n      });\n\n      if (!ls) {\n        return;\n      }\n\n      ls.removeGuest(participant.id);\n      ls.addParticipant(participant);\n    });\n    $(document).on('click', '#selectize-outer-select-participants .selectize-input .item', function (event) {\n      let $target = $(event.target);\n      let participant = {\n        id: $target.data(\"value\"),\n        name: $target.text().slice(0, -1)\n      };\n      let lssid = $(\"#select-participants\").closest(\"[data-lssid]\").data(\"lssid\");\n      let ls = LearnShareSession.findOne({\n        _id: lssid\n      });\n\n      if (!ls) {\n        return;\n      }\n\n      ls.saveGuest(participant);\n      ls.removeParticipant(participant.id);\n    });\n  }, 500);\n});\nTemplate.learn_share.helpers({\n  userList() {\n    let u = User.find().fetch();\n    return u;\n  },\n\n  canEdit() {\n    let lssid = Template.instance().lssid;\n    let lssess = LearnShareSession.findOne({\n      _id: lssid\n    });\n\n    if (!lssess) {\n      return false;\n    }\n\n    if (lssess.state === \"locked\" || !Meteor.user()) {\n      return false;\n    }\n\n    return true;\n  },\n\n  canEditAdmin() {\n    let lssid = Template.instance().lssid;\n    let lssess = LearnShareSession.findOne({\n      _id: lssid\n    });\n\n    if (!lssess) {\n      return false;\n    }\n\n    if (lssess.state === \"locked\" || !Roles.userIsInRole(Meteor.userId(), ['admin', 'learn-share-host'], Roles.GLOBAL_GROUP)) {\n      return false;\n    }\n\n    return true;\n  },\n\n  sessionPresenters() {\n    let lssid = Template.instance().lssid;\n    let lssess = LearnShareSession.findOne({\n      _id: lssid\n    });\n\n    if (!lssess) {\n      return [];\n    } else {\n      return lssess.presenters;\n    }\n  },\n\n  sessionParticipants() {\n    let lssid = Template.instance().lssid;\n    let lssess = LearnShareSession.findOne({\n      _id: lssid\n    });\n\n    if (!lssess) {\n      return [];\n    } else {\n      return lssess.participants;\n    }\n  },\n\n  sessionParticipantItems() {\n    let lssid = Template.instance().lssid;\n    let lssess = LearnShareSession.findOne({\n      _id: lssid\n    });\n\n    if (!lssess) {\n      return [];\n    }\n\n    let participants = lssess.participants;\n    let participantIds = [];\n\n    for (let i = 0; i < participants.length; i++) {\n      participantIds.push({\n        value: participants[i].id,\n        text: participants[i].name\n      });\n    }\n\n    return participantIds;\n  },\n\n  sessionGuests() {\n    let lssid = Template.instance().lssid;\n    let lssess = LearnShareSession.findOne({\n      _id: lssid\n    });\n\n    if (!lssess) {\n      return [];\n    } else {\n      return lssess.guests;\n    }\n  },\n\n  sessionGuestItems() {\n    let lssid = Template.instance().lssid;\n    let lssess = LearnShareSession.findOne({\n      _id: lssid\n    });\n\n    if (!lssess) {\n      return [];\n    }\n\n    let guests = lssess.guests;\n    let guestIds = [];\n\n    for (let i = 0; i < guests.length; i++) {\n      guestIds.push({\n        value: guests[i].id,\n        text: guests[i].name\n      });\n    }\n\n    return guestIds;\n  },\n\n  roParticipantNames() {\n    let lssid = Template.instance().lssid;\n    let lssess = LearnShareSession.findOne({\n      _id: lssid\n    });\n\n    if (!lssess) {\n      return [];\n    }\n\n    let participants = lssess.participants;\n    let participantList = [];\n\n    for (let i = 0; i < participants.length; i++) {\n      participantList.push(participants[i].name);\n    }\n\n    return participantList;\n  },\n\n  userAddList(teamName) {\n    let u = User.find();\n    let addList = [];\n    u.forEach(m => {\n      addList.push({\n        value: m._id,\n        text: m.MyProfile.firstName + \" \" + m.MyProfile.lastName\n      });\n    });\n    return addList;\n  },\n\n  itemRemoveHandler() {\n    return (value, $item) => {\n      let numSelected = $(\"#select-participants\")[0].selectize.items.length;\n\n      if (numSelected === 0) {\n        $(\"#btn-pick-first\").attr(\"disabled\", true);\n      }\n\n      let lssid = $(\"#select-participants\").closest(\"[data-lssid]\").data(\"lssid\");\n      let ls = LearnShareSession.findOne({\n        _id: lssid\n      });\n\n      if (!ls) {\n        return;\n      }\n\n      ls.removeParticipant(value);\n    };\n  },\n\n  itemRemoveGuestHandler() {\n    return (value, $item) => {\n      let lssid = $(\"#select-guests\").closest(\"[data-lssid]\").data(\"lssid\");\n      let ls = LearnShareSession.findOne({\n        _id: lssid\n      });\n\n      if (!ls) {\n        return;\n      }\n\n      ls.removeGuest(value);\n    };\n  },\n\n  itemAddHandler() {\n    return (value, $item) => {\n      $(\"#btn-pick-first\").prop(\"disabled\", false);\n      let participant = {\n        id: value,\n        name: $item.text().slice(0, -1)\n      };\n      let id = $item.closest('[data-lssid]').data('lssid');\n      let ls = LearnShareSession.findOne({\n        _id: id\n      });\n\n      if (!ls) {\n        return;\n      }\n\n      if (typeof _.find(ls.presenters, function (o) {\n        return o.id === participant.id;\n      }) !== \"undefined\") {\n        //if added user is in the list of presenters, mark it\n        $item.addClass(\"picked\");\n      }\n\n      if (\"guest\" === participant.id.slice(0, 5)) {\n        $item.addClass(\"guest\");\n      }\n\n      ls.addParticipant(participant);\n    };\n  },\n\n  itemAddGuestHandler() {\n    return (value, $item) => {\n      $(\"#btn-pick-first\").prop(\"disabled\", false);\n      let participant = {\n        id: value,\n        name: $item.text().slice(0, -1)\n      };\n      let id = $item.closest('[data-lssid]').data('lssid');\n      let ls = LearnShareSession.findOne({\n        _id: id\n      });\n\n      if (!ls) {\n        return;\n      }\n\n      if (typeof _.find(ls.presenters, function (o) {\n        return o.id === participant.id;\n      }) !== \"undefined\") {\n        //if added user is in the list of presenters, mark it\n        $item.addClass(\"picked\");\n      }\n\n      if (\"guest\" === participant.id.slice(0, 5)) {\n        $item.addClass(\"guest\");\n      }\n\n      ls.saveGuest(participant);\n    };\n  },\n\n  order(idx) {\n    return idx + 1;\n  },\n\n  lssid() {\n    return Template.instance().lssid;\n  },\n\n  title() {\n    let lssid = Template.instance().lssid;\n    let lssess = LearnShareSession.findOne({\n      _id: lssid\n    });\n\n    if (lssess) {\n      return lssess.title;\n    }\n  },\n\n  teamId() {\n    let lssid = Template.instance().lssid;\n    let lssess = LearnShareSession.findOne({\n      _id: lssid\n    });\n\n    if (lssess) {\n      return lssess.teamId;\n    } else {\n      return \"\";\n    }\n  },\n\n  team() {\n    let lssid = Template.instance().lssid;\n    let lssess = LearnShareSession.findOne({\n      _id: lssid\n    });\n\n    if (lssess) {\n      return Team.findOne({\n        _id: lssess.teamId\n      });\n    } else {\n      return \"\";\n    }\n  },\n\n  teamName() {\n    let lssid = Template.instance().lssid;\n    let lssess = LearnShareSession.findOne({\n      _id: lssid\n    });\n\n    if (lssess) {\n      return Team.findOne({\n        _id: lssess.teamId\n      }).Name;\n    } else {\n      return \"\";\n    }\n  },\n\n  sessionActive() {\n    let lssid = Template.instance().lssid;\n    let lssess = LearnShareSession.findOne({\n      _id: lssid\n    });\n\n    if (lssess) {\n      if (lssess.state == \"locked\") {\n        return false;\n      } else {\n        return true;\n      }\n    }\n  },\n\n  notes() {\n    let lssid = Template.instance().lssid;\n    let lssess = LearnShareSession.findOne({\n      _id: lssid\n    });\n\n    if (lssess) {\n      return lssess.notes;\n    }\n  },\n\n  skypeUrl() {\n    let lssid = Template.instance().lssid;\n    let lssess = LearnShareSession.findOne({\n      _id: lssid\n    });\n\n    if (lssess) {\n      return lssess.skypeUrl;\n    }\n  },\n\n  guestName() {\n    return Session.get(\"guestName\").split('-')[1];\n  }\n\n});\n\nvar pickRandom = () => {\n  let selectControl = $(\"#select-participants\")[0].selectize;\n  let availableItems = [];\n\n  for (let i = 0; i < selectControl.items.length; i++) {\n    let $item = $(\".item[data-value=\" + selectControl.items[i] + \"]\");\n\n    if (!$item.hasClass(\"picked\") && !$item.hasClass(\"picking\")) {\n      availableItems.push($item);\n    }\n  }\n\n  if (availableItems.length === 0) {\n    //don't pick the same item twice in a row unless it's the last one\n    $item = $(\".item.picking[data-value]\");\n\n    if ($item.length && !$item.hasClass(\"picked\")) {\n      availableItems.push($(\".item.picking[data-value]\"));\n    }\n  }\n\n  if (availableItems.length <= 1) {\n    $(\"#btn-pick-first\").prop(\"disabled\", true);\n  }\n\n  if (availableItems.length === 0) {\n    //none left to pick\n    return '';\n  }\n\n  var $picking = availableItems[Math.floor(Math.random() * availableItems.length)];\n  $(\"#p-on-deck-info\").data(\"picking\", $picking.data(\"value\"));\n  $(\"#p-on-deck-info\").html($picking.text().slice(0, -1));\n  $picking.addClass(\"picking\");\n  return $picking.data(\"value\");\n};\n\nTemplate.learn_share.events({\n  'change .file-upload-input'(event, instance) {\n    var file = event.currentTarget.files[0];\n    var reader = new FileReader();\n\n    reader.onload = function (fileLoadEvent) {\n      let lssid = $(\".container[data-lssid]\").data(\"lssid\");\n      let lssess = LearnShareSession.findOne({\n        _id: lssid\n      });\n      lssess.uploadRecording(file, reader.result);\n    };\n\n    reader.readAsBinaryString(file);\n  },\n\n  'click button#btn-pick-first'(event, instance) {\n    var pickingId = pickRandom();\n\n    if (pickingId !== '') {\n      $(\"#p-on-deck\").show();\n      $(\"#p-pick-first\").hide();\n    }\n  },\n\n  'click button#btn-pick-again'(event, instance) {\n    let prevPickingId = $(\"#p-on-deck-info\").data(\"picking\");\n    var pickingId = pickRandom();\n\n    if (prevPickingId != pickingId) {\n      let $prevPicked = $(\".item[data-value=\" + prevPickingId + \"]\");\n      $prevPicked.removeClass(\"picking\");\n    }\n  },\n\n  'click button#btn-pick-accept'(event, instance) {\n    let pickedId = $(\"#p-on-deck-info\").data(\"picking\");\n    let picked = {};\n    let $pickedItem = $(\".item[data-value=\" + pickedId + \"]\");\n    picked.id = $pickedItem.data(\"value\");\n    picked.name = $pickedItem.text().slice(0, -1);\n    $pickedItem.removeClass(\"picking\").addClass(\"picked\");\n    $(\"#p-on-deck-info\").data(\"picking\", \"\");\n    $(\"#p-on-deck-info\").html(\"\");\n    $(\"#p-on-deck\").hide();\n    $(\"#p-pick-first\").show();\n\n    if ($(\".item[data-value]\").not(\".picked\").length === 0) {\n      $(\"#btn-pick-first\").attr(\"disabled\", true);\n    }\n\n    let lssid = Template.instance().lssid;\n    let lssess = LearnShareSession.findOne({\n      _id: lssid\n    });\n    lssess.addPresenter(picked);\n  },\n\n  'keypress #input-notes,#input-title'(event, instance) {\n    if (!Roles.userIsInRole(Meteor.userId(), ['admin', 'learn-share-host'], Roles.GLOBAL_GROUP)) {\n      event.preventDefault();\n    }\n  },\n\n  'keyup #input-notes,#input-title': _.debounce(function (event, instance) {\n    if (Roles.userIsInRole(Meteor.userId(), ['admin', 'learn-share-host'], Roles.GLOBAL_GROUP)) {\n      let lssid = $(\".container[data-lssid]\").data(\"lssid\");\n      let lssess = LearnShareSession.findOne({\n        _id: lssid\n      });\n      lssess.saveText($(\"#input-title\").val(), $(\"#input-notes\").val());\n    }\n  }, 2000),\n\n  'click button#modal-save-name'(event, instance) {\n    let lssid = $(\".container[data-lssid]\").data(\"lssid\");\n    let lssess = LearnShareSession.findOne({\n      _id: lssid\n    });\n    let guestName = \"guest-\" + $(\"#input-guest-name\").val(); //Session.setPersistent(\"guestName\",guestName);\n\n    lssess.saveGuest(Session.get(\"guestId\"), guestName);\n    $(\"#modal-edit-name\").modal(\"hide\");\n  },\n\n  'click a#lockSession'(event, instance) {\n    event.preventDefault();\n    let lssid = $(\".container[data-lssid]\").data(\"lssid\");\n    let lssess = LearnShareSession.findOne({\n      _id: lssid\n    });\n    lssess.saveText($(\"#input-title\").val(), $(\"#input-notes\").val());\n    lssess.lockSession();\n  },\n\n  'click a#unlockSession'(event, instance) {\n    event.preventDefault();\n\n    if (Roles.userIsInRole(Meteor.userId(), ['admin', 'learn-share-host'], Roles.GLOBAL_GROUP)) {\n      let lssid = $(\".container[data-lssid]\").data(\"lssid\");\n      let lssess = LearnShareSession.findOne({\n        _id: lssid\n      });\n      lssess.unlockSession();\n    }\n  },\n\n  'click a#a-skype-url-edit'(event, instance) {\n    event.preventDefault();\n\n    if (Roles.userIsInRole(Meteor.userId(), ['admin', 'learn-share-host'], Roles.GLOBAL_GROUP)) {\n      $(\"#a-skype-url\").hide();\n      $(\"#a-skype-url-edit\").hide();\n      $(\"#input-skype-url\").show();\n      $(\"#span-create-skype\").show();\n    }\n  },\n\n  'click a#a-create-call'(event, instance) {\n    event.preventDefault();\n    console.log(\"click create call\");\n    $(\"#span-create-skype\").html(\"<img src='/img/loading.gif' style='height:20px;width:20px;' /><span style='font-size:xx-small;'>contacting Skype</span>\");\n    initSkypeAPI();\n  },\n\n  'change input#input-skype-url'(event, instance) {\n    let lssid = $(\".container[data-lssid]\").data(\"lssid\");\n    let lssess = LearnShareSession.findOne({\n      _id: lssid\n    });\n    lssess.setSkypeUrl($(\"#input-skype-url\").val());\n    $(\"#a-skype-url\").show();\n    $(\"#a-skype-url-edit\").show();\n    $(\"#input-skype-url\").hide();\n    $(\"#span-create-skype\").hide();\n  }\n\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"learn_share_list\":{\"learn_share_list.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/learn_share_list/learn_share_list.html                                                             //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.learn_share_list.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.learn_share_list.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/learn_share_list/template.learn_share_list.js                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"learn_share_list\");\nTemplate[\"learn_share_list\"] = new Template(\"Template.learn_share_list\", (function() {\n  var view = this;\n  return Blaze.If(function() {\n    return Spacebars.call(view.templateInstance().subscriptionsReady());\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      class: \"container\"\n    }, \"\\n        \", Blaze.If(function() {\n      return Spacebars.dataMustache(view.lookup(\"isInRole\"), \"admin,learn-share-host\");\n    }, function() {\n      return [ \"\\n        \", HTML.DIV({\n        class: \"jumbotron create-new-session\"\n      }, \"\\n            \", HTML.H3(\"Create a new Learn\", HTML.IMG({\n        src: \"/img/DeveloperLevel_icon_bg.png\",\n        class: \"dl-icon\"\n      }), \"Share session\"), \"\\n            \", HTML.DIV({\n        class: \"input-group\"\n      }, \"\\n                \", HTML.INPUT({\n        type: \"text\",\n        class: \"form-control\",\n        name: \"sess-title\",\n        id: \"sess-title\",\n        placeholder: \"Enter a title for the session...\"\n      }), \"\\n                \", HTML.SPAN({\n        class: \"input-group-btn\"\n      }, \"\\n                    \", HTML.BUTTON({\n        class: \"btn btn-primary\",\n        id: \"btn-create-new\"\n      }, \"Begin\"), \"\\n                \"), \"\\n            \"), \"\\n            \", HTML.DIV({\n        class: \"input-group\"\n      }, \"\\n                \", HTML.SELECT({\n        id: \"select-team\"\n      }, \"\\n                    \", HTML.OPTION({\n        value: \"\",\n        selected: \"\"\n      }, \"- public -\"), \"\\n                    \", Blaze.Each(function() {\n        return {\n          _sequence: Spacebars.call(view.lookup(\"teamList\")),\n          _variable: \"team\"\n        };\n      }, function() {\n        return [ \"\\n                        \", HTML.OPTION({\n          value: function() {\n            return Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"_id\"));\n          }\n        }, Blaze.View(\"lookup:team.Name\", function() {\n          return Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"Name\"));\n        })), \"\\n                    \" ];\n      }), \"\\n                \"), \"\\n            \"), \"\\n        \"), \"\\n        \" ];\n    }), \"\\n        \", Blaze.If(function() {\n      return Spacebars.call(view.templateInstance().subscriptionsReady());\n    }, function() {\n      return [ \"\\n            \", HTML.H3(\"Public sessions\"), \"\\n            \", Blaze.Each(function() {\n        return {\n          _sequence: Spacebars.call(view.lookup(\"lsSessList\")),\n          _variable: \"lsSess\"\n        };\n      }, function() {\n        return [ \"\\n                \", HTML.DIV({\n          class: \"jumbotron\"\n        }, \"\\n                    \", HTML.A({\n          href: function() {\n            return [ \"/learnShare/\", Spacebars.mustache(Spacebars.dot(view.lookup(\"lsSess\"), \"_id\")) ];\n          }\n        }, Blaze.View(\"lookup:lsSess._id\", function() {\n          return Spacebars.mustache(Spacebars.dot(view.lookup(\"lsSess\"), \"_id\"));\n        }), \" - \", Blaze.View(\"lookup:lsSess.title\", function() {\n          return Spacebars.mustache(Spacebars.dot(view.lookup(\"lsSess\"), \"title\"));\n        })), \"\\n                \"), \"\\n            \" ];\n      }), \"\\n            \", Blaze.Each(function() {\n        return {\n          _sequence: Spacebars.call(view.lookup(\"teamList\")),\n          _variable: \"team\"\n        };\n      }, function() {\n        return [ \"\\n                \", Blaze.If(function() {\n          return Spacebars.dataMustache(view.lookup(\"hasSessions\"), Spacebars.dot(view.lookup(\"team\"), \"_id\"));\n        }, function() {\n          return [ \"\\n                    \", HTML.H3(Blaze._TemplateWith(function() {\n            return {\n              team: Spacebars.call(view.lookup(\"team\"))\n            };\n          }, function() {\n            return Spacebars.include(view.lookupTemplate(\"team_icon\"));\n          }), Blaze.View(\"lookup:team.Name\", function() {\n            return Spacebars.mustache(Spacebars.dot(view.lookup(\"team\"), \"Name\"));\n          }), \" team sessions\"), \"\\n                    \", Blaze.Each(function() {\n            return {\n              _sequence: Spacebars.dataMustache(view.lookup(\"lsSessList\"), Spacebars.dot(view.lookup(\"team\"), \"_id\")),\n              _variable: \"lsSess\"\n            };\n          }, function() {\n            return [ \"\\n                        \", HTML.DIV({\n              class: \"jumbotron\"\n            }, \"\\n                            \", HTML.A({\n              href: function() {\n                return [ \"/learnShare/\", Spacebars.mustache(Spacebars.dot(view.lookup(\"lsSess\"), \"_id\")) ];\n              }\n            }, Blaze.View(\"lookup:lsSess._id\", function() {\n              return Spacebars.mustache(Spacebars.dot(view.lookup(\"lsSess\"), \"_id\"));\n            }), \" - \", Blaze.View(\"lookup:lsSess.title\", function() {\n              return Spacebars.mustache(Spacebars.dot(view.lookup(\"lsSess\"), \"title\"));\n            })), \"\\n                        \"), \"\\n                    \" ];\n          }), \"\\n                \" ];\n        }), \"\\n            \" ];\n      }), \"\\n        \" ];\n    }), \"\\n    \"), \"\\n    \" ];\n  }, function() {\n    return [ \"\\n        \", Spacebars.include(view.lookupTemplate(\"loading\")), \"\\n    \" ];\n  });\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"learn_share_list.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/learn_share_list/learn_share_list.js                                                               //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nlet LearnShareSession;\nmodule.watch(require(\"/imports/api/learn_share/learn_share.js\"), {\n  LearnShareSession(v) {\n    LearnShareSession = v;\n  }\n\n}, 0);\nlet Team;\nmodule.watch(require(\"/imports/api/teams/teams.js\"), {\n  Team(v) {\n    Team = v;\n  }\n\n}, 1);\nmodule.watch(require(\"./learn_share_list.html\"));\nTemplate.learn_share_list.onCreated(function () {\n  this.autorun(() => {\n    console.log(\"autorunning learn_share_list...\");\n    this.subscription = this.subscribe('userList', Meteor.userId(), {\n      onStop: function () {\n        console.log(\"User List subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"User List subscription ready! \", arguments, this);\n      }\n    });\n    console.log(this.subscription);\n    this.subscription2 = this.subscribe('learnShareList', Meteor.userId(), {\n      onStop: function () {\n        console.log(\"LearnShare List subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"LearnShare List subscription ready! \", arguments, this);\n      }\n    });\n    console.log(this.subscription2);\n    this.subscription3 = this.subscribe('teamsMemberOfList', Meteor.userId(), {\n      onStop: function () {\n        console.log(\"Team Member Of List subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"Team Member Of List subscription ready! \", arguments, this);\n      }\n    });\n    console.log(this.subscription3);\n  });\n});\nTemplate.learn_share_list.helpers({\n  lsSessList(teamId) {\n    let lst = [];\n    let filter = {};\n\n    if (typeof teamId === \"string\" && teamId != \"\") {\n      filter.teamId = teamId;\n    } else {\n      filter.teamId = {\n        '$in': [null, '']\n      };\n    }\n\n    LearnShareSession.find(filter).forEach(function (sess) {\n      //sorting with { sort: {createdAt:-1} } had no effect, so unshift used to reverse order instead\n      lst.unshift(sess);\n    });\n    return lst;\n  },\n\n  hasSessions(teamId) {\n    let ls = LearnShareSession.find({\n      teamId: teamId\n    });\n\n    if (!ls || ls.count() == 0) {\n      return false;\n    } else {\n      return true;\n    }\n  },\n\n  teamList() {\n    //list of teams the user is a member of\n    let t = Team.find({\n      Members: Meteor.userId()\n    });\n\n    if (!t) {\n      return [];\n    }\n\n    let lst = t.fetch();\n    return lst;\n  }\n\n});\nTemplate.learn_share_list.events({\n  'click button#btn-create-new'(event, instance) {\n    Meteor.call('learnshare.createNewSession', $(\"#sess-title\").val(), $(\"#select-team\").val(), (error, result) => {\n      if (error) {\n        console.log(\"can't create new Learn/Share session\", error);\n      } else {\n        FlowRouter.go(\"/learnShare/\" + result);\n      }\n    });\n  }\n\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"not-found\":{\"not-found.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/not-found/not-found.html                                                                           //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.not-found.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.not-found.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/not-found/template.not-found.js                                                                    //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"App_notFound\");\nTemplate[\"App_notFound\"] = new Template(\"Template.App_notFound\", (function() {\n  var view = this;\n  return HTML.Raw('<div id=\"not-found\">\\n    <div class=\"not-found-image\">\\n      <img src=\"/img/404.svg\" alt=\"\">\\n    </div>\\n    <div class=\"not-found-title\">\\n      <h1>Sorry, that page doesn\\'t exist</h1>\\n      <a href=\"/\" class=\"gotohomepage\">Go to home</a>\\n    </div>\\n  </div>');\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"not-found.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/not-found/not-found.js                                                                             //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./not-found.html\"));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"team_goals\":{\"team_goals.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/team_goals/team_goals.html                                                                         //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.team_goals.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.team_goals.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/team_goals/template.team_goals.js                                                                  //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"team_goals\");\nTemplate[\"team_goals\"] = new Template(\"Template.team_goals\", (function() {\n  var view = this;\n  return [ Blaze.If(function() {\n    return Spacebars.call(view.templateInstance().subscriptionsReady());\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      class: \"container goal-list team-goal-list\",\n      \"data-team-name\": function() {\n        return Spacebars.mustache(view.lookup(\"team\"));\n      }\n    }, \"\\n        \", HTML.DIV({\n      class: \"row spaced\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                \", HTML.H2(HTML.A({\n      href: \"/adminTeams\"\n    }, Blaze.View(\"lookup:team\", function() {\n      return Spacebars.mustache(view.lookup(\"team\"));\n    }), \" Goals\")), \"\\n            \"), \"\\n        \"), \"\\n        \", Blaze.If(function() {\n      return Spacebars.dataMustache(view.lookup(\"isInRole\"), \"admin\", view.lookup(\"team\"));\n    }, function() {\n      return [ \"\\n        \", HTML.DIV({\n        class: \"row spaced goal-controls\",\n        \"data-goal-id\": \"new\"\n      }, \"\\n            \", HTML.DIV({\n        class: \"col-sm-12\"\n      }, \"\\n                \", HTML.BUTTON({\n        id: \"btn-add-goal\",\n        class: \"btn btn-primary\",\n        \"data-txt-add\": \"Add a goal...\",\n        \"data-txt-save\": \"Save\"\n      }, \"Add a goal...\"), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n        class: \"row spaced blank-goal\",\n        id: \"blank-goal\"\n      }, \"\\n            \", HTML.DIV({\n        class: \"col-sm-12\"\n      }, \"\\n                \", Blaze._TemplateWith(function() {\n        return {\n          goal: Spacebars.call(view.lookup(\"blankGoal\")),\n          users: Spacebars.call(view.lookup(\"userList\"))\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"goal_view\"));\n      }), \"\\n            \"), \"\\n        \"), \"\\n        \" ];\n    }), \"\\n        \", Blaze.If(function() {\n      return Spacebars.dataMustache(view.lookup(\"isInRole\"), \"admin,view-goals\", view.lookup(\"team\"));\n    }, function() {\n      return [ \"\\n        \", HTML.DIV({\n        class: \"row spaced existing-goals\"\n      }, \"\\n            \", HTML.DIV({\n        class: \"col-sm-12\"\n      }, \"\\n                \", Blaze.Unless(function() {\n        return Spacebars.call(view.lookup(\"goalReload\"));\n      }, function() {\n        return [ \"\\n                    \", Blaze.If(function() {\n          return Spacebars.call(view.lookup(\"hasGoals\"));\n        }, function() {\n          return [ \"\\n                        \", Blaze.Each(function() {\n            return {\n              _sequence: Spacebars.call(view.lookup(\"teamGoals\")),\n              _variable: \"goal\"\n            };\n          }, function() {\n            return [ \"\\n                            \", Blaze._TemplateWith(function() {\n              return {\n                goal: Spacebars.call(view.lookup(\"goal\"))\n              };\n            }, function() {\n              return Spacebars.include(view.lookupTemplate(\"goal_view\"));\n            }), \"\\n                        \" ];\n          }), \"\\n                    \" ];\n        }, function() {\n          return [ \"\\n                        \", HTML.DIV({\n            class: \"div-no-active\"\n          }, \"No active goals\"), \"\\n                    \" ];\n        }), \"\\n                    \", Blaze.If(function() {\n          return Spacebars.call(view.lookup(\"hasReachedGoals\"));\n        }, function() {\n          return [ \"\\n                        \", HTML.BUTTON({\n            \"data-toggle\": \"collapse\",\n            \"data-target\": \"#div-reached-goals\"\n          }, \"Goals Completed\"), \"\\n                        \", HTML.DIV({\n            id: \"div-reached-goals\",\n            class: \"collapse\"\n          }, \"\\n                        \", Blaze.Each(function() {\n            return {\n              _sequence: Spacebars.call(view.lookup(\"teamReachedGoals\")),\n              _variable: \"goal\"\n            };\n          }, function() {\n            return [ \"\\n                            \", Blaze._TemplateWith(function() {\n              return {\n                goal: Spacebars.call(view.lookup(\"goal\"))\n              };\n            }, function() {\n              return Spacebars.include(view.lookupTemplate(\"goal_view\"));\n            }), \"\\n                        \" ];\n          }), \"\\n                        \"), \"\\n                    \" ];\n        }), \"\\n                \" ];\n      }), \"\\n            \"), \"\\n        \"), \"\\n        \" ];\n    }), \"\\n    \"), \"\\n    \" ];\n  }, function() {\n    return [ \"\\n        \", Spacebars.include(view.lookupTemplate(\"loading\")), \"\\n    \" ];\n  }), HTML.Raw('\\n\\n    <div class=\"modal fade\" id=\"goal-modal-new\">\\n        <div class=\"modal-dialog modal-lg\" role=\"document\">\\n          <div class=\"modal-content\">\\n            <div class=\"modal-header\">\\n              <h5 class=\"modal-title\">New Sub Goal</h5>\\n            </div>\\n            <div class=\"modal-body\">\\n            </div>\\n          </div>\\n        </div>\\n    </div>\\n    '), HTML.DIV({\n    class: \"modal fade\",\n    id: \"goal-modal-sub\"\n  }, \"\\n        \", HTML.DIV({\n    class: \"modal-dialog modal-lg\",\n    role: \"document\"\n  }, \"\\n          \", HTML.DIV({\n    class: \"modal-content\"\n  }, \"\\n            \", HTML.Raw('<div class=\"modal-header\">\\n              <h5 class=\"modal-title\">View/Edit Sub Goal</h5>\\n            </div>'), \"\\n            \", HTML.DIV({\n    class: \"modal-body\"\n  }, \"\\n                \", Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"hasSubgoalView\"));\n  }, function() {\n    return [ \"\\n                  \", Blaze._TemplateWith(function() {\n      return {\n        goal: Spacebars.call(view.lookup(\"subgoal\"))\n      };\n    }, function() {\n      return Spacebars.include(view.lookupTemplate(\"goal_view\"));\n    }), \"\\n                \" ];\n  }), \"\\n            \"), \"\\n          \"), \"\\n        \"), \"\\n    \") ];\n}));\n\nTemplate.__checkName(\"goal_view\");\nTemplate[\"goal_view\"] = new Template(\"Template.goal_view\", (function() {\n  var view = this;\n  return HTML.DIV({\n    class: function() {\n      return [ \"team-goal \", Spacebars.mustache(view.lookup(\"collapsed\"), Spacebars.dot(view.lookup(\"goal\"), \"parentId\")) ];\n    },\n    \"data-goal-id\": function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\"));\n    },\n    id: function() {\n      return [ \"div-goal-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    }\n  }, HTML.Raw('\\n        <!-- <form id=\"form-goal-{{goal._id}}\"> -->\\n        '), HTML.DIV({\n    class: function() {\n      return [ \"progress pct-\", Spacebars.mustache(view.lookup(\"progressPct\")) ];\n    },\n    \"data-pct\": function() {\n      return Spacebars.mustache(view.lookup(\"progressPct\"));\n    }\n  }, \"\\n            \", HTML.DIV({\n    class: \"progress-bar\",\n    role: \"progressbar\",\n    style: function() {\n      return [ \"width: \", Spacebars.mustache(view.lookup(\"progressPct\")), \"%;\" ];\n    },\n    \"aria-valuenow\": function() {\n      return Spacebars.mustache(view.lookup(\"progressPct\"));\n    },\n    \"aria-valuemin\": \"0\",\n    \"aria-valuemax\": \"100\"\n  }, Blaze.View(\"lookup:progressPct\", function() {\n    return Spacebars.mustache(view.lookup(\"progressPct\"));\n  }), \"%\"), \"\\n        \"), \"\\n        \", HTML.DIV({\n    class: \"row summary-row\"\n  }, \"\\n            \", HTML.DIV({\n    class: \"col-sm-10 collapsed-summary\"\n  }, \"\\n                \", HTML.SPAN({\n    class: \"team-goal-title\"\n  }, Blaze.View(\"lookup:goal.title\", function() {\n    return Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"title\"));\n  })), \"\\n                \", HTML.SPAN({\n    class: \"collapsed-description\"\n  }, Blaze.View(\"lookup:goal.description\", function() {\n    return Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"description\"));\n  })), \"\\n            \"), \"\\n            \", HTML.DIV({\n    class: \"col-sm-10 expanded-summary\"\n  }, \"\\n                \", HTML.SPAN({\n    class: \"team-goal-title\"\n  }, HTML.INPUT(HTML.Attrs({\n    type: \"text\",\n    id: function() {\n      return [ \"goal-title-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    },\n    class: \"flat form-control goal-title\",\n    value: function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"title\"));\n    },\n    placeholder: [ HTML.CharRef({\n      html: \"&lt;\",\n      str: \"<\"\n    }), \"Enter goal title...\", HTML.CharRef({\n      html: \"&gt;\",\n      str: \">\"\n    }) ]\n  }, function() {\n    return Spacebars.attrMustache(view.lookup(\"fldEnabled\"), \"title\");\n  }))), \"\\n            \"), \"\\n            \", HTML.DIV({\n    class: \"col-sm-2 text-right btn-group-xs\"\n  }, \"\\n                \", HTML.Raw('<button class=\"btn btn-success btn-save glyphicon glyphicon-ok details\" disabled=\"\" alt=\"Save changes\"></button>'), \"\\n                \", HTML.Raw('<button class=\"btn btn-warning btn-cancel glyphicon glyphicon-remove details\" disabled=\"\" alt=\"Discard changes\"></button>'), \"\\n                \", HTML.BUTTON({\n    class: \"btn btn-primary btn-expand glyphicon glyphicon-chevron-down\",\n    id: function() {\n      return [ \"btn-expand-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    }\n  }), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n    class: \"row spaced\"\n  }, \"\\n            \", HTML.DIV({\n    class: \"col-sm-10\"\n  }, \"\\n                \", HTML.DIV({\n    class: \"team-goal-description\"\n  }, \"\\n                    \", HTML.TEXTAREA(HTML.Attrs({\n    id: function() {\n      return [ \"goal-description-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    },\n    class: \"flat form-control goal-description\",\n    placeholder: [ HTML.CharRef({\n      html: \"&lt;\",\n      str: \"<\"\n    }), \"Enter goal description...\", HTML.CharRef({\n      html: \"&gt;\",\n      str: \">\"\n    }) ]\n  }, function() {\n    return Spacebars.attrMustache(view.lookup(\"fldEnabled\"), \"description\");\n  }, {\n    value: function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"description\"));\n    }\n  })), \"\\n                \"), \"\\n            \"), \"\\n            \", HTML.Raw('<div class=\"col-sm-2 text-right\">\\n            </div>'), \"\\n        \"), \"\\n        \", HTML.DIV({\n    class: \"row spaced details\"\n  }, \"\\n            \", HTML.DIV({\n    class: \"col-sm-6\"\n  }, \"\\n                \", HTML.DIV({\n    class: \"row spaced\"\n  }, \"\\n                    \", HTML.DIV({\n    class: \"col-sm-12\"\n  }, \"\\n                        Assigned to\\n                        \", Blaze.If(function() {\n    return Spacebars.dataMustache(view.lookup(\"userHasModifyPerm\"), \"assignedTo\");\n  }, function() {\n    return [ \"\\n                            \", Blaze._TemplateWith(function() {\n      return {\n        id: Spacebars.call(\"select-assigned-to-\"),\n        id2: Spacebars.call(Spacebars.dot(view.lookup(\"goal\"), \"_id\")),\n        name: Spacebars.call(\"assignedTo[]\"),\n        placeholder: Spacebars.call(\"Choose assignees...\"),\n        list: Spacebars.call(view.lookup(\"userList\")),\n        selected: Spacebars.call(Spacebars.dot(view.lookup(\"goal\"), \"assignedTo\")),\n        title: Spacebars.call(Spacebars.dot(view.lookup(\"goal\"), \"title\"))\n      };\n    }, function() {\n      return Spacebars.include(view.lookupTemplate(\"select_autocomplete\"));\n    }), \"\\n                        \" ];\n  }, function() {\n    return [ \"\\n                            \", HTML.SPAN({\n      class: \"ro-user\"\n    }, Blaze.View(\"lookup:commaListUsers\", function() {\n      return Spacebars.mustache(view.lookup(\"commaListUsers\"), Spacebars.dot(view.lookup(\"goal\"), \"assignedTo\"));\n    })), \"\\n                        \" ];\n  }), \"\\n                    \"), \"\\n                \"), \"\\n                \", HTML.DIV({\n    class: \"row spaced\"\n  }, \"\\n                    \", HTML.DIV({\n    class: \"col-sm-12\"\n  }, \"\\n                        Mentors\\n                        \", Blaze.If(function() {\n    return Spacebars.dataMustache(view.lookup(\"userHasModifyPerm\"), \"mentors\");\n  }, function() {\n    return [ \"\\n                            \", Blaze._TemplateWith(function() {\n      return {\n        id: Spacebars.call(\"select-mentors-\"),\n        id2: Spacebars.call(Spacebars.dot(view.lookup(\"goal\"), \"_id\")),\n        name: Spacebars.call(\"mentors[]\"),\n        placeholder: Spacebars.call(\"Choose mentors...\"),\n        list: Spacebars.call(view.lookup(\"userList\")),\n        selected: Spacebars.call(Spacebars.dot(view.lookup(\"goal\"), \"mentors\"))\n      };\n    }, function() {\n      return Spacebars.include(view.lookupTemplate(\"select_autocomplete\"));\n    }), \"\\n                        \" ];\n  }, function() {\n    return [ \"\\n                            \", HTML.SPAN({\n      class: \"ro-user\"\n    }, Blaze.View(\"lookup:commaListUsers\", function() {\n      return Spacebars.mustache(view.lookup(\"commaListUsers\"), Spacebars.dot(view.lookup(\"goal\"), \"mentors\"));\n    })), \"\\n                        \" ];\n  }), \"\\n                    \"), \"\\n                \"), \"\\n                \", HTML.DIV({\n    class: \"row spaced\"\n  }, \"\\n                    \", HTML.DIV({\n    class: \"col-sm-12\"\n  }, \"\\n                        Managers\\n                        \", Blaze.If(function() {\n    return Spacebars.dataMustache(view.lookup(\"userHasModifyPerm\"), \"admins\");\n  }, function() {\n    return [ \"\\n                            \", Blaze._TemplateWith(function() {\n      return {\n        id: Spacebars.call(\"select-admins-\"),\n        id2: Spacebars.call(Spacebars.dot(view.lookup(\"goal\"), \"_id\")),\n        name: Spacebars.call(\"admins[]\"),\n        placeholder: Spacebars.call(\"Choose managers...\"),\n        list: Spacebars.call(view.lookup(\"userList\")),\n        selected: Spacebars.call(Spacebars.dot(view.lookup(\"goal\"), \"admins\"))\n      };\n    }, function() {\n      return Spacebars.include(view.lookupTemplate(\"select_autocomplete\"));\n    }), \"\\n                        \" ];\n  }, function() {\n    return [ \"\\n                            \", HTML.SPAN({\n      class: \"ro-user\"\n    }, Blaze.View(\"lookup:commaListUsers\", function() {\n      return Spacebars.mustache(view.lookup(\"commaListUsers\"), Spacebars.dot(view.lookup(\"goal\"), \"admins\"));\n    })), \"\\n                        \" ];\n  }), \"\\n                    \"), \"\\n                \"), \"\\n            \"), \"\\n            \", HTML.DIV({\n    class: \"col-sm-6\"\n  }, \"\\n                \", HTML.DIV({\n    class: \"row spaced\"\n  }, \"\\n                    \", HTML.DIV({\n    class: \"col-sm-4 text-right\"\n  }, \"\\n                        \", HTML.LABEL({\n    for: function() {\n      return [ \"input-start-date-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    }\n  }, \"Start\"), \"\\n                    \"), \"\\n                    \", HTML.DIV({\n    class: \"col-sm-8\"\n  }, \"\\n                        \", HTML.INPUT(HTML.Attrs({\n    id: function() {\n      return [ \"input-start-date-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    },\n    type: \"text\",\n    class: \"form-control flat date\",\n    value: function() {\n      return Spacebars.mustache(view.lookup(\"dateField\"), \"startDate\");\n    }\n  }, function() {\n    return Spacebars.attrMustache(view.lookup(\"fldEnabled\"), \"startDate\");\n  })), \"\\n                    \"), \"\\n                \"), \"\\n                \", HTML.DIV({\n    class: \"row spaced\"\n  }, \"\\n                    \", HTML.DIV({\n    class: \"col-sm-4 text-right\"\n  }, \"\\n                        \", HTML.LABEL({\n    for: function() {\n      return [ \"input-date-due-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    }\n  }, \"Due\"), \"\\n                    \"), \"\\n                    \", HTML.DIV({\n    class: \"col-sm-8\"\n  }, \"\\n                        \", HTML.INPUT(HTML.Attrs({\n    id: function() {\n      return [ \"input-date-due-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    },\n    type: \"text\",\n    class: \"form-control flat date\",\n    value: function() {\n      return Spacebars.mustache(view.lookup(\"dateField\"), \"dueDate\");\n    }\n  }, function() {\n    return Spacebars.attrMustache(view.lookup(\"fldEnabled\"), \"dueDate\");\n  })), \"\\n                    \"), \"\\n                \"), \"\\n                \", HTML.DIV({\n    class: \"row spaced\"\n  }, \"\\n                    \", HTML.Raw('<div class=\"col-sm-4 text-right\">\\n                        Review\\n                    </div>'), \"\\n                    \", HTML.DIV({\n    class: \"col-sm-8\"\n  }, \"\\n                        \", HTML.INPUT(HTML.Attrs({\n    id: function() {\n      return [ \"input-date-review-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    },\n    type: \"text\",\n    class: \"form-control flat date\",\n    value: function() {\n      return Spacebars.mustache(view.lookup(\"dateField\"), \"reviewDate\");\n    }\n  }, function() {\n    return Spacebars.attrMustache(view.lookup(\"fldEnabled\"), \"reviewDate\");\n  })), \"\\n                    \"), \"\\n                \"), \"\\n                \", Blaze.Unless(function() {\n    return Spacebars.dataMustache(view.lookup(\"isNew\"), Spacebars.dot(view.lookup(\"goal\"), \"_id\"));\n  }, function() {\n    return [ \"\\n                \", HTML.DIV({\n      class: \"row spaced\"\n    }, \"\\n                    \", HTML.DIV({\n      class: \"col-sm-4 text-right\"\n    }, \"\\n                        Completed\\n                    \"), \"\\n                    \", HTML.DIV({\n      class: \"col-sm-8\"\n    }, \"\\n                        \", HTML.INPUT(HTML.Attrs({\n      id: function() {\n        return [ \"input-date-reached-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n      },\n      type: \"text\",\n      class: \"form-control flat date\",\n      value: function() {\n        return Spacebars.mustache(view.lookup(\"dateField\"), \"reachedDate\");\n      }\n    }, function() {\n      return Spacebars.attrMustache(view.lookup(\"fldEnabled\"), \"reachedDate\");\n    })), \"\\n                    \"), \"\\n                \"), \"\\n                \" ];\n  }), \"\\n            \"), \"\\n        \"), \"\\n\\n        \", HTML.DIV({\n    class: \"row spaced comments details\"\n  }, \"\\n            \", HTML.DIV({\n    class: \"col-sm-6 goal-comments\"\n  }, \"\\n                \", HTML.Raw(\"<h3>Comments</h3>\"), \"\\n                \", HTML.DIV(\"\\n                    \", Blaze.Each(function() {\n    return {\n      _sequence: Spacebars.dataMustache(view.lookup(\"goalComments\"), Spacebars.dot(view.lookup(\"goal\"), \"_id\")),\n      _variable: \"comment\"\n    };\n  }, function() {\n    return [ \"\\n                    \", HTML.DIV({\n      class: \"goal-comment-outer\"\n    }, \"\\n                        \", HTML.DIV({\n      class: \"goal-comment-header row\"\n    }, \"\\n                            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                                \", Blaze.View(\"lookup:getUserName\", function() {\n      return Spacebars.mustache(view.lookup(\"getUserName\"), Spacebars.dot(view.lookup(\"comment\"), \"userId\"));\n    }), \"\\n                                \", HTML.DIV({\n      class: \"float-right\"\n    }, \"\\n                                    \", Blaze.View(\"lookup:formatDate\", function() {\n      return Spacebars.mustache(view.lookup(\"formatDate\"), Spacebars.dot(view.lookup(\"comment\"), \"date\"));\n    }), \"\\n                                \"), \"\\n                            \"), \"\\n                        \"), \"\\n                        \", HTML.DIV({\n      class: \"goal-comment row\"\n    }, \"\\n                            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                                \", Blaze.View(\"lookup:comment.text\", function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"comment\"), \"text\"));\n    }), \"\\n                            \"), \"\\n                        \"), \"\\n                    \"), \"\\n                    \" ];\n  }), \"\\n                \"), \"\\n                \", HTML.DIV({\n    class: \"row spaced comment-add details\"\n  }, \"\\n                    \", HTML.DIV({\n    class: \"col-sm-12\"\n  }, \"\\n                        \", HTML.DIV({\n    class: \"row spaced\"\n  }, \"\\n                            \", HTML.DIV({\n    class: \"col-sm-12\"\n  }, \"\\n                                \", HTML.TEXTAREA({\n    id: function() {\n      return [ \"new-comment-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    },\n    class: \"new-comment form-control\"\n  }), \"\\n                            \"), \"\\n                        \"), \"\\n                        \", HTML.DIV({\n    class: \"row spaced\"\n  }, \"\\n                            \", HTML.DIV({\n    class: \"col-sm-12\"\n  }, \"\\n                                \", HTML.BUTTON({\n    id: function() {\n      return [ \"btn-comment-add-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n    },\n    class: \"btn btn-primary btn-comment-add\",\n    alt: \"Add comment\"\n  }, HTML.Raw('<span class=\"glyphicon glyphicon-pencil\"></span>'), \" Add comment\"), \"\\n                            \"), \"\\n                        \"), \"\\n                    \"), \"\\n                \"), \"\\n            \"), \"\\n            \", HTML.DIV({\n    class: \"col-sm-6 review-comments\"\n  }, \"\\n                \", HTML.Raw(\"<h3>Reviews</h3>\"), \"\\n                \", HTML.DIV(\"\\n                    \", Blaze.Each(function() {\n    return {\n      _sequence: Spacebars.dataMustache(view.lookup(\"reviewComments\"), Spacebars.dot(view.lookup(\"goal\"), \"_id\")),\n      _variable: \"comment\"\n    };\n  }, function() {\n    return [ \"\\n                    \", HTML.DIV({\n      class: \"goal-comment-outer\"\n    }, \"\\n                        \", HTML.DIV({\n      class: \"goal-comment-header row\"\n    }, \"\\n                            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                                \", Blaze.View(\"lookup:getUserName\", function() {\n      return Spacebars.mustache(view.lookup(\"getUserName\"), Spacebars.dot(view.lookup(\"comment\"), \"userId\"));\n    }), \"\\n                                \", HTML.DIV({\n      class: \"float-right\"\n    }, \"\\n                                    \", Blaze.View(\"lookup:formatDate\", function() {\n      return Spacebars.mustache(view.lookup(\"formatDate\"), Spacebars.dot(view.lookup(\"comment\"), \"date\"));\n    }), \"\\n                                \"), \"\\n                            \"), \"\\n                        \"), \"\\n                        \", HTML.DIV({\n      class: \"goal-comment row\"\n    }, \"\\n                            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                                \", Blaze.View(\"lookup:comment.text\", function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"comment\"), \"text\"));\n    }), \"\\n                            \"), \"\\n                        \"), \"\\n                    \"), \"\\n                    \" ];\n  }), \"\\n                \"), \"\\n                \", Blaze.If(function() {\n    return Spacebars.dataMustache(view.lookup(\"userHasModifyPerm\"), \"goalComments\");\n  }, function() {\n    return [ \"\\n                \", HTML.DIV({\n      class: \"row spaced comment-add details\"\n    }, \"\\n                    \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                        \", HTML.DIV({\n      class: \"row spaced\"\n    }, \"\\n                            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                                \", HTML.TEXTAREA({\n      id: function() {\n        return [ \"new-review-comment-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n      },\n      class: \"new-review-comment form-control\"\n    }), \"\\n                            \"), \"\\n                        \"), \"\\n                        \", HTML.DIV({\n      class: \"row spaced\"\n    }, \"\\n                            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                                \", HTML.BUTTON({\n      id: function() {\n        return [ \"btn-review-comment-add-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\")) ];\n      },\n      class: \"btn btn-primary btn-review-comment-add\",\n      alt: \"Add comment\"\n    }, HTML.SPAN({\n      class: \"glyphicon glyphicon-pencil\"\n    }), \" Add comment\"), \"\\n                            \"), \"\\n                        \"), \"\\n                    \"), \"\\n                \"), \"\\n                \" ];\n  }), \"\\n            \"), \"\\n        \"), \"\\n        \", Blaze.If(function() {\n    return Spacebars.dataMustache(view.lookup(\"userHasModifyPerm\"), \"subgoals\");\n  }, function() {\n    return [ \"\\n        \", HTML.DIV({\n      class: \"row spaced details subgoal-add\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                \", HTML.BUTTON({\n      class: \"btn btn-primary btn-sm btn-add-subgoal\",\n      alt: \"Add subgoal\"\n    }, HTML.SPAN({\n      class: \"glyphicon glyphicon-th-list\"\n    }), \" Add subgoal\"), \"\\n            \"), \"\\n        \"), \"\\n        \" ];\n  }), \"\\n        \", Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"hasChildren\"));\n  }, function() {\n    return [ \"\\n        \", HTML.DIV({\n      class: \"row spaced details subgoals\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                \", HTML.DIV({\n      class: \"team-goal-children\"\n    }, \"\\n                    \", HTML.UL(\"\\n                        \", Blaze.Each(function() {\n      return {\n        _sequence: Spacebars.call(view.lookup(\"childGoals\")),\n        _variable: \"childGoal\"\n      };\n    }, function() {\n      return [ \"\\n                        \", HTML.LI(\"\\n                            \", Blaze._TemplateWith(function() {\n        return {\n          goal: Spacebars.call(view.lookup(\"childGoal\"))\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"child_goal_view\"));\n      }), \"\\n                        \"), \"\\n                        \" ];\n    }), \"\\n                    \"), \"\\n                \"), \"\\n            \"), \"\\n        \"), \"\\n        \" ];\n  }), HTML.Raw(\"\\n        <!-- </form> -->\\n    \"));\n}));\n\nTemplate.__checkName(\"child_goal_view\");\nTemplate[\"child_goal_view\"] = new Template(\"Template.child_goal_view\", (function() {\n  var view = this;\n  return [ HTML.DIV({\n    class: \"team-goal-title\",\n    \"data-id\": function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"_id\"));\n    }\n  }, Blaze.View(\"lookup:goal.title\", function() {\n    return Spacebars.mustache(Spacebars.dot(view.lookup(\"goal\"), \"title\"));\n  })), \"\\n    \", Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"hasChildren\"));\n  }, function() {\n    return [ \"\\n    \", HTML.UL(\"\\n        \", Blaze.Each(function() {\n      return {\n        _sequence: Spacebars.call(view.lookup(\"childGoals\")),\n        _variable: \"childGoal\"\n      };\n    }, function() {\n      return [ \"\\n        \", HTML.LI(\"\\n            \", Blaze._TemplateWith(function() {\n        return {\n          goal: Spacebars.call(view.lookup(\"childGoal\"))\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"child_goal_view\"));\n      }), \"\\n        \"), \"\\n        \" ];\n    }), \"\\n    \"), \"\\n    \" ];\n  }) ];\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"team_goals.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/team_goals/team_goals.js                                                                           //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nlet Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 0);\nlet User;\nmodule.watch(require(\"/imports/api/users/users.js\"), {\n  User(v) {\n    User = v;\n  }\n\n}, 1);\nlet TeamGoal;\nmodule.watch(require(\"/imports/api/team_goals/team_goals.js\"), {\n  TeamGoal(v) {\n    TeamGoal = v;\n  }\n\n}, 2);\nmodule.watch(require(\"./team_goals.html\"));\nmodule.watch(require(\"/imports/ui/components/select_autocomplete/select_autocomplete.js\"));\nconst BLANK_GOAL = {\n  _id: \"new\",\n  title: \"\",\n  description: \"\"\n};\n\nlet _hasSubgoalView = new ReactiveVar(false);\n\nlet _subgoalId = new ReactiveVar(\"\");\n\nTemplate.team_goals.onCreated(function () {\n  if (this.data.teamName) {\n    this.teamName = this.data.teamName;\n  } else {\n    this.teamName = FlowRouter.getParam('teamName').split('-').join(' ');\n  }\n\n  Session.set(\"goalReload\", false);\n  Session.set(\"saving\", true);\n  this.userSubscriptionReady = new ReactiveVar(false);\n  this.autorun(() => {\n    this.modalGoalId = FlowRouter.getParam('goalId');\n\n    if (\"undefined\" !== typeof this.modalGoalId && \"\" !== this.modalGoalId) {\n      _hasSubgoalView.set(true);\n\n      _subgoalId.set(FlowRouter.getParam('goalId'));\n\n      $(\"body\").on(\"hidden.bs.modal\", \"#goal-modal-sub\", function () {\n        _hasSubgoalView.set(false);\n\n        _subgoalId.set(\"\");\n\n        FlowRouter.go(\"/teamGoals/\" + FlowRouter.getParam('teamName'));\n      });\n      Meteor.setTimeout(function () {\n        $(\"#goal-modal-sub\").modal(\"show\");\n        $(\"#goal-modal-sub\").find(\"div.team-goal\").removeClass(\"collapsed\");\n      }, 1000);\n    }\n\n    this.subscription = this.subscribe('teamGoalsData', this.teamName, {\n      onStop: function () {\n        console.log(\"Team Goals subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"Team Goals subscription ready! \", arguments, this);\n      }\n    });\n    this.subscription2 = this.subscribe('userList', Meteor.userId(), {\n      onStop: function () {\n        console.log(\"User List subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"User List subscription ready! \", arguments, this);\n      }\n    });\n    console.log(this.subscription2);\n  });\n  Meteor.setTimeout(function () {\n    Session.set(\"saving\", false);\n  }, 2000);\n});\nTemplate.team_goals.onRendered(function () {\n  Meteor.setTimeout(function () {\n    $(\"input.date\").datetimepicker({\n      format: 'YYYY-MM-DD',\n      useCurrent: false,\n      showClear: true,\n      showClose: true\n    });\n  }, 1000);\n  $(\"body\").on(\"hidden.bs.modal\", \"#goal-modal-new\", function () {\n    $newgoal = $(\"#div-goal-new\").detach();\n    $newgoal.data(\"parent-id\", \"\");\n    $(\"#blank-goal\").find(\".col-sm-12\").append($newgoal);\n  });\n});\n\nvar resetNewGoalForm = () => {\n  let valInputs = [\"goal-title-new\", \"goal-description-new\", \"input-date-due-new\", \"input-date-review-new\", \"input-date-reached-new\"];\n\n  for (let i = 0; i < valInputs.length; i++) {\n    $(\"#\" + valInputs[i]).val(\"\");\n  }\n\n  let slzInputs = [\"select-assigned-to-new\", \"select-mentors-new\", \"select-admins-new\"];\n\n  for (let i = 0; i < valInputs.length; i++) {\n    $(\"#\" + valInputs[i]).val(\"\");\n  }\n};\n\nfunction saveGoal(goalId) {\n  let slAssigned = $(\"#select-assigned-to-\" + goalId)[0].selectize;\n  let slMentors = $(\"#select-mentors-\" + goalId)[0].selectize;\n  let slAdmins = $(\"#select-admins-\" + goalId)[0].selectize;\n  let assignList = slAssigned.getValue();\n  let mentorList = slMentors.getValue();\n  let adminList = slAdmins.getValue();\n  let tplTeamName = $(\"[data-team-name]\").data(\"team-name\");\n  Session.set(\"saving\", true);\n  let saveObj = {\n    teamName: tplTeamName,\n    title: $(\"#goal-title-\" + goalId).val(),\n    description: $(\"#goal-description-\" + goalId).val(),\n    assignedTo: assignList,\n    mentors: mentorList,\n    admins: adminList\n  };\n  let startDate = $(\"#input-start-date-\" + goalId).val();\n\n  if (\"\" !== startDate) {\n    saveObj.startDate = new Date(startDate);\n  }\n\n  let dueDate = $(\"#input-date-due-\" + goalId).val();\n\n  if (\"\" !== dueDate) {\n    saveObj.dueDate = new Date(dueDate);\n  }\n\n  let rvwDate = $(\"#input-date-review-\" + goalId).val();\n\n  if (\"\" !== rvwDate) {\n    saveObj.reviewDate = new Date(rvwDate);\n  }\n\n  if (goalId === BLANK_GOAL._id) {\n    let parentId = $(\"#div-goal-new\").data(\"parent-id\");\n\n    if (\"\" !== parentId) {\n      saveObj.parentId = parentId;\n    }\n\n    Meteor.call('teamgoals.createNewGoal', saveObj, function (err, rslt) {\n      console.log(err, rslt);\n    });\n  } else {\n    let g = TeamGoal.findOne({\n      _id: goalId\n    });\n    let reviewedOnDate = $(\"#input-date-reviewed-on-\" + goalId).val();\n\n    if (\"\" !== reviewedOnDate) {\n      saveObj.reviewedOnDate = new Date(reviewedOnDate);\n    }\n\n    let reachedDate = $(\"#input-date-reached-\" + goalId).val();\n\n    if (\"\" !== reachedDate) {\n      saveObj.reachedDate = new Date(reachedDate);\n    }\n\n    g.updateFromObj(saveObj);\n  }\n\n  Meteor.setTimeout(function () {\n    Session.set(\"saving\", false);\n  }, 10000);\n}\n\nfunction goalChanged($g) {\n  $g.find(\".btn-save\").prop(\"disabled\", false);\n  $g.find(\".btn-cancel\").prop(\"disabled\", false);\n}\n\nfunction goalUnchanged($g) {\n  $g.find(\".btn-save\").prop(\"disabled\", true);\n  $g.find(\".btn-cancel\").prop(\"disabled\", true);\n  $g.find(\".changed\").removeClass(\"changed\");\n}\n\nTemplate.team_goals.events({\n  'change input.flat,textarea.flat'(event, instance) {\n    $(event.target).addClass('changed');\n    let $goal = $(event.target).closest(\"[data-goal-id]\");\n\n    if ($goal) {\n      if ($(\"#goal-title-\" + $goal.data(\"goal-id\")).val() != \"\") {//\n      }\n    }\n  },\n\n  'change input,textarea,select'(event, instance) {\n    let $t = $(event.target);\n    let $goal = $(event.target).closest(\"[data-goal-id]\");\n    goalChanged($goal);\n  },\n\n  'keyup input,textarea'(event, instance) {\n    let $t = $(event.target);\n    let $goal = $(event.target).closest(\"[data-goal-id]\");\n    goalChanged($goal);\n  },\n\n  'click button.btn-save'(event, instance) {\n    let $t = $(event.target);\n    let goalId = $t.closest(\"[data-goal-id]\").data(\"goal-id\");\n    saveGoal(goalId);\n    goalUnchanged($(\"#div-goal-\" + goalId));\n    $modalParent = $t.closest(\".modal\");\n\n    if ($modalParent.length) {\n      $modalParent.modal('hide');\n      $newgoal = $(\"#div-goal-new\").detach();\n      $newgoal.data(\"parent-id\", \"\");\n      $(\"#blank-goal\").find(\".col-sm-12\").html($newgoal);\n    }\n\n    if (goalId == BLANK_GOAL._id) {\n      resetNewGoalForm();\n\n      if (!$modalParent.length) {\n        $(\".goal-controls\").show();\n        $(\"#blank-goal\").slideUp();\n      }\n    }\n  },\n\n  'click button.btn-add-subgoal'(event, instance) {\n    let parentId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n    $newgoal = $(\"#div-goal-new\").detach();\n    $newgoal.data(\"parent-id\", parentId);\n    $newgoal.find(\".btn-cancel\").attr(\"disabled\", false);\n    $(\"#goal-modal-new\").find(\".modal-body\").append($newgoal);\n    $(\"#goal-modal-new\").modal(\"show\");\n    $(\"#goal-modal-new\").find(\"div.team-goal\").removeClass(\"collapsed\");\n  },\n\n  'click button.btn-cancel'(event, instance) {\n    let $t = $(event.target);\n    let goalId = $t.closest(\"[data-goal-id]\").data(\"goal-id\");\n    $modalParent = $t.closest(\".modal\");\n\n    if ($modalParent.length) {\n      $modalParent.modal('hide');\n      $newgoal = $(\"#div-goal-new\").detach();\n      $newgoal.data(\"parent-id\", \"\");\n      $(\"#blank-goal\").find(\".col-sm-12\").append($newgoal);\n    }\n\n    if (goalId == BLANK_GOAL._id) {\n      resetNewGoalForm();\n\n      if (!$modalParent.length) {\n        $(\".goal-controls\").show();\n        $(\"#blank-goal\").slideUp();\n      }\n    } else {\n      //forces a reload from the database\n      Session.set(\"goalReload\", true);\n      Meteor.setTimeout(function () {\n        Session.set(\"goalReload\", false);\n      }, 100);\n    }\n  },\n\n  'click button.btn-comment-add'(event, instance) {\n    $btnAdd = $(event.target);\n    let goalId = $btnAdd.closest(\"[data-goal-id]\").data(\"goal-id\");\n    let $comment = $(\"#new-comment-\" + goalId);\n    let newComment = $comment.val();\n    let g = TeamGoal.findOne({\n      _id: goalId\n    });\n    g.addComment(newComment);\n    $comment.val(\"\");\n  },\n\n  'click button.btn-review-comment-add'(event, instance) {\n    $btnAdd = $(event.target);\n    let goalId = $btnAdd.closest(\"[data-goal-id]\").data(\"goal-id\");\n    let $comment = $(\"#new-review-comment-\" + goalId);\n    let newComment = $comment.val();\n    let g = TeamGoal.findOne({\n      _id: goalId\n    });\n    g.addReviewComment(newComment);\n    $comment.val(\"\");\n  },\n\n  'click button#btn-add-goal'(event, instance) {\n    let $btnAdd = $(event.target);\n    $goal = $btnAdd.closest(\"[data-goal-id]\");\n    let goalId = $goal.data(\"goal-id\");\n    $(\".goal-controls\").hide();\n    let $btnCancel = $(\"#blank-goal\").find(\".btn-cancel\");\n    $btnCancel.prop(\"disabled\", false);\n    $(\".team-goal[data-goal-id=\" + goalId + \"]\").removeClass(\"collapsed\");\n    $(\"#blank-goal\").slideDown();\n    $(\"#btn-add-cancel\").fadeIn();\n  },\n\n  'click button#btn-add-cancel'(event, instance) {\n    $(\"#blank-goal\").slideUp();\n    $(\"#btn-add-cancel\").fadeOut();\n  },\n\n  'click button.btn-expand,div.collapsed-summary'(event, instance) {\n    let $target = $(event.target);\n    let $goalContainer = $target.closest(\"[data-goal-id]\");\n    let $targetExpandBtn = $goalContainer.find(\".btn-expand.glyphicon\");\n    $targetExpandBtn.removeClass(\"glyphicon-chevron-up\").addClass(\"glyphicon-chevron-down\");\n\n    if ($goalContainer.hasClass(\"collapsed\")) {\n      $(\".team-goal[data-goal-id]:not(.collapsed)\").slideUp(function () {\n        $(this).addClass(\"collapsed\").css(\"display\", \"block\");\n      });\n      $goalContainer.css(\"display\", \"none\").removeClass(\"collapsed\").slideDown(function () {\n        $('html, body').animate({\n          scrollTop: $goalContainer.offset().top\n        }, 500);\n      });\n      $targetExpandBtn.removeClass(\"glyphicon-chevron-down\");\n      $targetExpandBtn.addClass(\"glyphicon-chevron-up\");\n    } else {\n      $goalContainer.slideUp(function () {\n        $goalContainer.addClass(\"collapsed\").css(\"display\", \"block\");\n      });\n      $targetExpandBtn.removeClass(\"glyphicon-chevron-up\");\n      $targetExpandBtn.addClass(\"glyphicon-chevron-down\");\n    }\n  },\n\n  'keyup textarea.goal-description,input.goal-title': _.debounce(function (event, instance) {\n    let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n\n    if (\"new\" === goalId) {\n      //don't auto-save if creating a new goal\n      return;\n    }\n\n    saveGoal(goalId);\n    goalUnchanged($(\"#div-goal-\" + goalId));\n  }, 2000),\n  'change input,select': _.debounce(function (event, instance) {\n    if (!Session.get(\"saving\")) {\n      let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n\n      if (\"new\" === goalId) {\n        //don't auto-save if creating a new goal\n        return;\n      }\n\n      saveGoal(goalId);\n      goalUnchanged($(\"#div-goal-\" + goalId));\n    }\n  }, 2000),\n  'dp.change': _.debounce(function (event, instance) {\n    if (!Session.get(\"saving\")) {\n      let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n\n      if (\"new\" === goalId) {\n        //don't auto-save if creating a new goal\n        return;\n      }\n\n      saveGoal(goalId);\n      goalUnchanged($(\"#div-goal-\" + goalId));\n    }\n  }, 2000),\n\n  'click div.team-goal-title[data-id]'(event, instance) {\n    if (!Session.get(\"saving\")) {\n      _hasSubgoalView.set(true);\n\n      let gid = $(event.target).data(\"id\");\n\n      _subgoalId.set(gid);\n\n      FlowRouter.go(\"/teamGoals/\" + FlowRouter.getParam('teamName') + \"/\" + gid);\n      $(\"#goal-modal-sub\").prop(\"disabled\", false).modal(\"show\");\n    }\n  }\n\n});\n\nfunction getTeamName() {\n  let teamName = Template.instance().teamName;\n  return teamName;\n}\n\nTemplate.team_goals.helpers({\n  goalReload() {\n    return Session.get(\"goalReload\");\n  },\n\n  hasGoals() {\n    let teamName = getTeamName();\n    let g = TeamGoal.find({\n      teamName: teamName,\n      parentId: '',\n      reachedDate: null\n    }).fetch();\n    return g.length > 0;\n  },\n\n  hasReachedGoals() {\n    let teamName = getTeamName();\n    let g = TeamGoal.find({\n      teamName: teamName,\n      parentId: '',\n      reachedDate: {\n        $ne: null\n      }\n    }).fetch();\n    return g.length > 0;\n  },\n\n  teamGoals() {\n    let teamName = getTeamName();\n    let g = TeamGoal.find({\n      teamName: teamName,\n      parentId: '',\n      reachedDate: null\n    }).fetch();\n    return g;\n  },\n\n  teamReachedGoals() {\n    let teamName = getTeamName();\n    let g = TeamGoal.find({\n      teamName: teamName,\n      parentId: '',\n      reachedDate: {\n        $ne: null\n      }\n    }).fetch();\n    return g;\n  },\n\n  blankGoal() {\n    return Object.assign({\n      teamName: Template.instance().teamName\n    }, BLANK_GOAL);\n  },\n\n  hasSubgoalView() {\n    let hasView = _hasSubgoalView.get();\n\n    let gid = _subgoalId.get();\n\n    if (hasView) {\n      return true;\n    } else {\n      return false;\n    }\n  },\n\n  subgoal() {\n    let hasView = _hasSubgoalView.get();\n\n    let subgoalId = Template.instance().modalGoalId;\n    subgoalId = _subgoalId.get();\n    let g = TeamGoal.findOne({\n      _id: subgoalId\n    });\n\n    if (g) {\n      return g;\n    } else {\n      return {};\n    }\n  },\n\n  team() {\n    return getTeamName();\n  },\n\n  teamSlug() {\n    return getTeamName().split(\" \").join(\"-\");\n  },\n\n  goalComments(goalId) {\n    let g = TeamGoal.findOne({\n      _id: goalId\n    });\n\n    if (!g) {\n      return;\n    }\n\n    let c = g.goalComments;\n    return c;\n  },\n\n  reviewComments(goalId) {\n    let g = TeamGoal.findOne({\n      _id: goalId\n    });\n\n    if (!g) {\n      return;\n    }\n\n    let c = g.reviewComments;\n    return c;\n  },\n\n  formatDate(dateObj) {\n    return dateObj.toLocaleDateString();\n  },\n\n  getUserName(userId) {\n    let u = User.findOne({\n      _id: userId\n    });\n    if (!u) return \"\";\n    let fullName = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n    return fullName;\n  },\n\n  userList() {\n    let list = [{\n      id: 1,\n      name: \"George\"\n    }, {\n      id: 2,\n      name: \"Frank\"\n    }];\n    return list;\n  }\n\n});\nTemplate.goal_view.onRendered(function () {});\nTemplate.goal_view.helpers({\n  childGoals() {\n    let goalId = Template.instance().data.goal._id;\n\n    let children = TeamGoal.find({\n      parentId: goalId\n    }).fetch();\n    return children;\n  },\n\n  hasChildren() {\n    let goalId = Template.instance().data.goal._id;\n\n    let doesHave = TeamGoal.find({\n      parentId: goalId\n    }).fetch().length > 0;\n    return doesHave;\n  },\n\n  goalComments(goalId) {\n    if (goalId === BLANK_GOAL._id) {\n      return;\n    }\n\n    let g = TeamGoal.findOne({\n      _id: goalId\n    });\n\n    if (!g) {\n      return;\n    }\n\n    let c = g.goalComments;\n    return c;\n  },\n\n  reviewComments(goalId) {\n    if (goalId === BLANK_GOAL._id) {\n      return;\n    }\n\n    let g = TeamGoal.findOne({\n      _id: goalId\n    });\n\n    if (!g) {\n      return;\n    }\n\n    let c = g.reviewComments;\n    return c;\n  },\n\n  formatDate(dateObj) {\n    return dateObj.toLocaleDateString();\n  },\n\n  dateField(fld) {\n    let goal = Template.instance().data.goal;\n\n    if (goal._id == BLANK_GOAL._id) {\n      return \"\";\n    }\n\n    let d = goal[fld];\n\n    if (!(d instanceof Date)) {\n      return \"\";\n    }\n\n    let dateText = new Date(d.getTime() - d.getTimezoneOffset() * 60000).toISOString().slice(0, -1);\n    return dateText;\n  },\n\n  getUserName(userId) {\n    let u = User.findOne({\n      _id: userId\n    });\n    if (!u) return \"\";\n    let fullName = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n    return fullName;\n  },\n\n  userList() {\n    let userList = [];\n    let teamRole = {};\n    teamRole[\"roles.\" + Template.instance().data.goal.teamName] = \"member\";\n    User.find(teamRole).forEach(user => {\n      userList.push({\n        text: user.MyProfile.firstName + \" \" + user.MyProfile.lastName,\n        value: user._id\n      });\n    });\n    console.log(teamRole, userList);\n    return userList;\n  },\n\n  progressPct() {\n    let goal = Template.instance().data.goal;\n    let g = TeamGoal.findOne({\n      _id: goal._id\n    });\n    if (!g) return 0;\n\n    if (!g.dueDate || !g.startDate || \"undefined\" === typeof g.dueDate || \"undefined\" === typeof g.startDate) {\n      return 0;\n    }\n\n    let currDt = new Date().getTime();\n    let totalDuration = g.dueDate.getTime() - g.startDate.getTime();\n    let timeSinceStart = currDt - g.startDate.getTime();\n    let pct = timeSinceStart / totalDuration;\n    return Math.min(parseInt(pct * 100), 100);\n  },\n\n  userHasModifyPerm(fld) {\n    let goal = Template.instance().data.goal;\n    let g = TeamGoal.findOne({\n      _id: goal._id\n    });\n    if (!g) return true;\n    return g.hasModifyPerm(fld);\n  },\n\n  fldEnabled(fld) {\n    let goal = Template.instance().data.goal;\n    let g = TeamGoal.findOne({\n      _id: goal._id\n    });\n\n    if (!g) {\n      if (Roles.userIsInRole(Meteor.userId(), 'admin', goal.teamName)) {\n        return \"\";\n      } else {\n        return \"disabled\";\n      }\n    }\n\n    if (g.hasModifyPerm(fld)) {\n      return \"\";\n    } else {\n      return \"disabled\";\n    }\n  },\n\n  commaListUsers(lst) {\n    var nameList = [];\n    let goal = Template.instance().data.goal;\n    let g = TeamGoal.findOne({\n      _id: goal._id\n    });\n\n    for (let i = 0; i < lst.length; i++) {\n      let u = User.findOne({\n        _id: lst[i]\n      });\n      nameList.push(u.MyProfile.firstName + \" \" + u.MyProfile.lastName);\n    }\n\n    return nameList.join(', ');\n  },\n\n  isNew(id) {\n    return BLANK_GOAL._id === id;\n  },\n\n  collapsed(pid) {\n    //if this goal has a parent it is being displayed in a modal and should not be collapsed\n    if (\"\" !== pid) {\n      return \"\";\n    } else {\n      return \"collapsed\";\n    }\n  }\n\n});\nTemplate.child_goal_view.helpers({\n  childGoals() {\n    let goalId = Template.instance().data.goal._id;\n\n    let children = TeamGoal.find({\n      parentId: goalId\n    }).fetch();\n    return children;\n  },\n\n  hasChildren(goalId) {\n    goalId = Template.instance().data.goal._id;\n    let doesHave = TeamGoal.find({\n      parentId: goalId\n    }).count() > 0;\n    return doesHave;\n  }\n\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"user_dashboard\":{\"user_dashboard.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/user_dashboard/user_dashboard.html                                                                 //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.user_dashboard.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.user_dashboard.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/user_dashboard/template.user_dashboard.js                                                          //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"user_dashboard\");\nTemplate[\"user_dashboard\"] = new Template(\"Template.user_dashboard\", (function() {\n  var view = this;\n  return HTML.DIV({\n    class: \"container user-dashboard\"\n  }, \"\\n        \", HTML.DIV({\n    class: \"row\"\n  }, \"\\n            \", Blaze.Each(function() {\n    return {\n      _sequence: Spacebars.call(view.lookup(\"dashboardPanes\")),\n      _variable: \"pane\"\n    };\n  }, function() {\n    return [ \"\\n                \", HTML.DIV({\n      class: function() {\n        return [ \"col-sm-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"pane\"), \"size\")) ];\n      }\n    }, \"\\n                    \", HTML.DIV({\n      class: function() {\n        return [ \"dashboard-pane \", Spacebars.mustache(Spacebars.dot(view.lookup(\"pane\"), \"name\")) ];\n      },\n      \"data-route\": function() {\n        return Spacebars.mustache(Spacebars.dot(view.lookup(\"pane\"), \"route\"));\n      }\n    }, \"\\n                        \", Blaze.View(\"lookup:pane.title\", function() {\n      return Spacebars.mustache(Spacebars.dot(view.lookup(\"pane\"), \"title\"));\n    }), \"\\n                        \", Blaze._TemplateWith(function() {\n      return {\n        template: Spacebars.call(Spacebars.dot(view.lookup(\"pane\"), \"name\")),\n        data: Spacebars.call(Spacebars.dot(view.lookup(\"pane\"), \"data\"))\n      };\n    }, function() {\n      return Spacebars.include(function() {\n        return Spacebars.call(Template.__dynamic);\n      });\n    }), \"\\n                    \"), \"\\n                \"), \"\\n            \" ];\n  }), \"\\n        \"), \"\\n    \");\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"user_dashboard.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/user_dashboard/user_dashboard.js                                                                   //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nlet User;\nmodule.watch(require(\"/imports/api/users/users.js\"), {\n  User(v) {\n    User = v;\n  }\n\n}, 0);\nmodule.watch(require(\"./user_dashboard.html\"));\nmodule.watch(require(\"/imports/ui/pages/learn_share_list/learn_share_list.js\"));\nmodule.watch(require(\"/imports/ui/pages/home/home.js\"));\nTemplate.user_dashboard.onCreated(function () {//\n});\nTemplate.user_dashboard.helpers({\n  dashboardPanes() {\n    let u = User.findOne({\n      _id: Meteor.userId()\n    });\n\n    if (u && \"undefined\" !== typeof u.MyProfile.dashboardPanes && u.MyProfile.dashboardPanes.length > 0) {\n      return u.MyProfile.dashboardPanes;\n    } else {\n      return [{\n        size: 6,\n        name: 'individual_goals',\n        title: 'Goals',\n        route: '/goals',\n        data: {}\n      }, {\n        size: 6,\n        name: 'admin_teams',\n        title: 'Teams',\n        route: '/adminTeams',\n        data: {}\n      }, {\n        size: 6,\n        name: 'learn_share_list',\n        title: 'Learn/Share',\n        route: '/learnShareList',\n        data: {}\n      }, {\n        size: 6,\n        name: 'user_profile',\n        title: 'Profile',\n        route: '/profile',\n        data: {}\n      }, {\n        size: 12,\n        name: 'App_home',\n        title: 'Questions',\n        route: '/',\n        data: {}\n      }];\n    }\n  }\n\n});\nTemplate.user_dashboard.events({\n  'click div.dashboard-pane'(event, instance) {\n    let target = $(event.target).data(\"route\");\n\n    if (\"undefined\" === target) {\n      return;\n    }\n\n    FlowRouter.go(target);\n  }\n\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"user_profile\":{\"user_profile.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/user_profile/user_profile.html                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.user_profile.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.user_profile.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/user_profile/template.user_profile.js                                                              //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"user_profile\");\nTemplate[\"user_profile\"] = new Template(\"Template.user_profile\", (function() {\n  var view = this;\n  return Blaze.If(function() {\n    return Spacebars.call(view.templateInstance().subscriptionsReady());\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      class: \"container user-profile\",\n      style: \"position:relative\"\n    }, \"\\n        \", HTML.A({\n      class: \"a-goals-link\",\n      href: function() {\n        return [ \"/goals/\", Spacebars.mustache(view.lookup(\"userId\")) ];\n      }\n    }, \"Goals\"), \"\\n        \", HTML.FORM({\n      id: \"frm-profile\"\n    }, \"\\n        \", HTML.DIV({\n      id: \"btn-group\",\n      class: \"col-sm-4 text-right btn-group-xs\"\n    }, \"\\n            \", HTML.BUTTON({\n      class: \"btn btn-success btn-save glyphicon glyphicon-ok details\",\n      alt: \"Save changes\"\n    }), \"\\n            \", HTML.BUTTON({\n      class: \"btn btn-warning btn-cancel glyphicon glyphicon-remove details\",\n      alt: \"Discard changes\"\n    }), \"\\n        \"), \"\\n        \", HTML.DIV({\n      class: \"row\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                \", HTML.LABEL({\n      for: \"input-fname\"\n    }, \"First name:\"), \"\\n                \", HTML.DIV({\n      class: \"form-group\"\n    }, \"\\n                    \", HTML.INPUT({\n      id: \"input-fname\",\n      type: \"text\",\n      class: \"form-control flat\",\n      value: function() {\n        return Spacebars.mustache(view.lookup(\"userField\"), \"firstName\");\n      }\n    }), \"\\n                \"), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n      class: \"row\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                \", HTML.LABEL({\n      for: \"input-lname\"\n    }, \"Last name:\"), \"\\n                \", HTML.DIV({\n      class: \"form-group\"\n    }, \"\\n                    \", HTML.INPUT({\n      id: \"input-lname\",\n      type: \"text\",\n      class: \"form-control flat\",\n      value: function() {\n        return Spacebars.mustache(view.lookup(\"userField\"), \"lastName\");\n      }\n    }), \"\\n                \"), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n      class: \"row\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                \", HTML.LABEL({\n      for: \"input-email\"\n    }, \"Email Address:\"), \"\\n                \", HTML.DIV({\n      class: \"form-group\"\n    }, \"\\n                    \", HTML.INPUT({\n      id: \"input-email\",\n      type: \"text\",\n      class: \"form-control flat\",\n      value: function() {\n        return Spacebars.mustache(view.lookup(\"emailAddress\"));\n      }\n    }), \"\\n                \"), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n      class: \"row\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                \", HTML.LABEL({\n      for: \"input-gender\"\n    }, \"Gender:\"), \"\\n                \", HTML.DIV({\n      class: \"form-group\"\n    }, \"\\n                    \", HTML.SELECT({\n      id: \"input-gender\",\n      class: \"form-control flat\",\n      value: function() {\n        return Spacebars.mustache(view.lookup(\"userField\"), \"gender\");\n      }\n    }, \"\\n                        \", HTML.OPTION(), \"\\n                        \", HTML.OPTION(HTML.Attrs({\n      value: \"0\"\n    }, function() {\n      return Spacebars.attrMustache(view.lookup(\"genderSelected\"), \"male\");\n    }), \"Male\"), \"\\n                        \", HTML.OPTION(HTML.Attrs({\n      value: \"1\"\n    }, function() {\n      return Spacebars.attrMustache(view.lookup(\"genderSelected\"), \"female\");\n    }), \"Female\"), \"\\n                    \"), \"\\n                \"), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n      class: \"row\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                \", HTML.LABEL({\n      for: \"input-bdate\"\n    }, \"Birth date:\"), \"\\n                \", HTML.DIV({\n      class: \"form-group\"\n    }, \"\\n                    \", HTML.INPUT({\n      id: \"input-bdate\",\n      type: \"text\",\n      class: \"form-control flat\",\n      value: function() {\n        return Spacebars.mustache(view.lookup(\"userField\"), \"birthDate\");\n      }\n    }), \"\\n                \"), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n      class: \"row\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                \", HTML.LABEL(\"Segments\"), \"\\n                \", Blaze.If(function() {\n      return Spacebars.dataMustache(view.lookup(\"isInRole\"), \"admin\");\n    }, function() {\n      return [ \"\\n                    \", Blaze._TemplateWith(function() {\n        return {\n          id: Spacebars.call(\"select-segments\"),\n          id2: Spacebars.call(\"\"),\n          name: Spacebars.call(\"segments[]\"),\n          placeholder: Spacebars.call(\"User Segments...\"),\n          list: Spacebars.call(view.lookup(\"userSegmentList\")),\n          selected: Spacebars.call(view.lookup(\"assignedUserSegments\")),\n          onItemRemove: Spacebars.call(view.lookup(\"itemRemoveHandler\")),\n          onItemAdd: Spacebars.call(view.lookup(\"itemAddHandler\"))\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"select_autocomplete\"));\n      }), \"\\n                \" ];\n    }, function() {\n      return [ \"\\n                    \", Blaze._TemplateWith(function() {\n        return {\n          items: Spacebars.call(view.lookup(\"assignedUserSegments\")),\n          labelType: Spacebars.call(\"label-warning\")\n        };\n      }, function() {\n        return Spacebars.include(view.lookupTemplate(\"label_list\"));\n      }), \"\\n                \" ];\n    }), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n      class: \"row\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                \", HTML.LABEL(\"Dashboard:\"), \"\\n                \", HTML.DIV({\n      class: \"form-group\"\n    }, \"\\n                    \", HTML.INPUT({\n      type: \"text\",\n      disabled: \"disabled\",\n      class: \"form-control flat\",\n      value: function() {\n        return Spacebars.mustache(view.lookup(\"userField\"), \"dashboardPanes\");\n      }\n    }), \"\\n                \"), \"\\n            \"), \"\\n        \"), \"\\n        \", HTML.DIV({\n      class: \"row\",\n      style: \"padding:15px;background-color:#000\"\n    }, \"\\n            \", HTML.DIV({\n      class: \"col-sm-12\"\n    }, \"\\n                \", Blaze._TemplateWith(function() {\n      return {\n        userId: Spacebars.call(view.lookup(\"userId\"))\n      };\n    }, function() {\n      return Spacebars.include(view.lookupTemplate(\"personality\"));\n    }), \"\\n            \"), \"\\n        \"), \"\\n        \"), \"\\n    \"), \"\\n    \" ];\n  }, function() {\n    return [ \"\\n        \", Spacebars.include(view.lookupTemplate(\"loading\")), \"\\n    \" ];\n  });\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"user_profile.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/user_profile/user_profile.js                                                                       //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nlet User;\nmodule.watch(require(\"/imports/api/users/users.js\"), {\n  User(v) {\n    User = v;\n  }\n\n}, 0);\nlet UserSegment;\nmodule.watch(require(\"/imports/api/user_segments/user_segments.js\"), {\n  UserSegment(v) {\n    UserSegment = v;\n  }\n\n}, 1);\nmodule.watch(require(\"./user_profile.html\"));\nTemplate.user_profile.onCreated(function () {\n  if (this.data.userId) {\n    this.userId = this.data.userId;\n  } else if (FlowRouter.getParam('userId')) {\n    this.userId = FlowRouter.getParam('userId');\n  } else {\n    this.userId = Meteor.userId();\n  }\n\n  this.autorun(() => {\n    this.subscription = this.subscribe('userData', {\n      onStop: function () {\n        console.log(\"User profile subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"User profile subscription ready! \", arguments, this);\n      }\n    });\n    this.subscription2 = this.subscribe('userList', this.userId, {\n      onStop: function () {\n        console.log(\"User List subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"User List subscription ready! \", arguments, this);\n      }\n    });\n    console.log(this.subscription2);\n    this.subscription3 = this.subscribe('segmentList', this.userId, {\n      onStop: function () {\n        console.log(\"Segment List subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"Segment List subscription ready! \", arguments, this);\n      }\n    });\n    console.log(this.subscription3);\n  });\n});\nTemplate.user_profile.onRendered(function () {\n  Meteor.setTimeout(function () {\n    $(\"#input-bdate\").datetimepicker({\n      useCurrent: false,\n      showClear: true,\n      showClose: true,\n      format: 'YYYY-MM-DD'\n    });\n  }, 1000);\n});\nTemplate.user_profile.helpers({\n  userId() {\n    return Template.instance().userId;\n  },\n\n  userSegmentList() {\n    let segList = [];\n    let s = UserSegment.find();\n    s.forEach(m => {\n      segList.push({\n        value: m._id,\n        text: m.name\n      });\n    });\n    return segList;\n  },\n\n  assignedUserSegments() {\n    let uid = Template.instance().userId;\n    let u = User.findOne({\n      _id: uid\n    });\n    let assigned = [];\n\n    if (u) {\n      let segs = u.MyProfile.segments;\n      console.log(segs, segs[0], UserSegment.findOne({\n        _id: segs[0]\n      }));\n\n      for (let i = 0; i < segs.length; i++) {\n        let segTxt = UserSegment.findOne({\n          _id: segs[i]\n        }).name;\n        assigned.push({\n          value: segs[i],\n          text: segTxt\n        });\n      }\n    }\n\n    console.log(\"assigned:\", assigned);\n    return assigned;\n  },\n\n  userField(fldName) {\n    let uid = Template.instance().userId;\n    let u = User.findOne({\n      _id: uid\n    });\n\n    if (u) {\n      switch (fldName) {\n        case 'firstName':\n          return u.MyProfile.firstName;\n          break;\n\n        case 'lastName':\n          return u.MyProfile.lastName;\n          break;\n\n        case 'fullName':\n          return u.MyProfile.fullName();\n          break;\n\n        case 'gender':\n          return u.MyProfile.gender ? 'female' : 'male';\n          break;\n\n        case 'birthDate':\n          let d = u.MyProfile.birthDate;\n          let dateText = new Date(d.getTime() - d.getTimezoneOffset() * 60000).toISOString().slice(0, -1);\n          return dateText;\n          break;\n\n        case 'dashboardPanes':\n          return u.MyProfile.dashboardPanes.length > 0 ? 'Custom' : 'Default';\n          break;\n      }\n\n      return u.MyProfile.fullName();\n    } else {\n      return \"\";\n    }\n  },\n\n  genderSelected(label) {\n    let uid = Template.instance().userId;\n    let u = User.findOne({\n      _id: uid\n    });\n    if (!u) return \"\";\n\n    if ((\"f\" === label.slice(0, 1) || \"F\" === label.slice(0, 1)) && u.MyProfile.gender === true) {\n      return \"selected\";\n    }\n\n    if ((\"m\" === label.slice(0, 1) || \"M\" === label.slice(0, 1)) && u.MyProfile.gender === false) {\n      return \"selected\";\n    }\n\n    return \"\";\n  },\n\n  userName() {\n    let uid = Template.instance().userId;\n    let u = User.findOne({\n      _id: uid\n    });\n\n    if (u) {\n      return u.MyProfile.fullName();\n    } else {\n      return \"\";\n    }\n  },\n\n  emailAddress() {\n    let uid = Template.instance().userId;\n    let u = User.findOne({\n      _id: uid\n    });\n\n    if (u) {\n      emailAddresses = [];\n\n      for (let i = 0; i < u.emails.length; i++) {\n        emailAddresses.push(u.emails[i].address);\n      }\n\n      return emailAddresses.join(',');\n    } else {\n      return \"\";\n    }\n  },\n\n  itemAddHandler() {\n    return (value, $item) => {\n      let participant = {\n        id: value,\n        name: $item.text().slice(0, -1)\n      };\n    };\n  },\n\n  itemRemoveHandler() {\n    return (value, $item) => {//\n    };\n  }\n\n});\nTemplate.user_profile.events({\n  'change input.flat,textarea.flat,select'(event, instance) {\n    $(event.target).addClass('changed');\n    $(\"#btn-group\").fadeIn();\n  },\n\n  'dp.change'(event, instance) {\n    $(event.target).addClass('changed');\n    $(\"#btn-group\").fadeIn();\n  },\n\n  'keyup input,textarea'(event, instance) {\n    let $t = $(event.target);\n    $t.addClass('changed');\n    $(\"#btn-group\").fadeIn();\n  },\n\n  'click button.btn-save'(event, instance) {\n    let $t = $(event.target);\n    $t.closest(\".container\").find(\".changed\").removeClass(\"changed\"); //todo: update database\n\n    let uprofile = {\n      firstName: $(\"#input-fname\").val(),\n      lastName: $(\"#input-lname\").val(),\n      gender: true == $(\"#input-gender\").val(),\n      birthDate: $(\"#input-bdate\").val(),\n      segments: $(\"#select-segments\").val()\n    };\n    let uid = Template.instance().userId;\n    let u = User.findOne({\n      _id: uid\n    });\n\n    if (u) {\n      u.profileUpdate(uprofile);\n    }\n  },\n\n  'click button.btn-cancel'(event, instance) {\n    let $t = $(event.target);\n    $t.closest(\".container\").find(\".changed\").removeClass(\"changed\");\n    $(\"#frm-profile\")[0].reset();\n  }\n\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"user_segments\":{\"user_segments.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/user_segments/user_segments.html                                                                   //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.user_segments.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.user_segments.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/user_segments/template.user_segments.js                                                            //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"user_segments\");\nTemplate[\"user_segments\"] = new Template(\"Template.user_segments\", (function() {\n  var view = this;\n  return Blaze.If(function() {\n    return Spacebars.call(view.templateInstance().subscriptionsReady());\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      class: \"container\"\n    }, \"\\n        \", HTML.TABLE({\n      class: \"table\"\n    }, \"\\n            \", HTML.THEAD(\"\\n                \", HTML.TR(\"\\n                    \", HTML.TH(\"Name\"), \"\\n                    \", HTML.TH(\"Description\"), \"\\n                    \", HTML.TH(HTML.CharRef({\n      html: \"&nbsp;\",\n      str: \"\"\n    })), \"\\n                \"), \"\\n            \"), \"\\n            \", HTML.TBODY(\"\\n                \", Blaze.Each(function() {\n      return {\n        _sequence: Spacebars.call(view.lookup(\"segmentList\")),\n        _variable: \"segment\"\n      };\n    }, function() {\n      return [ \"\\n                    \", HTML.TR({\n        \"data-segid\": function() {\n          return Spacebars.mustache(Spacebars.dot(view.lookup(\"segment\"), \"_id\"));\n        }\n      }, \"\\n                        \", HTML.TD(HTML.INPUT({\n        id: function() {\n          return [ \"seg-name-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"segment\"), \"_id\")) ];\n        },\n        type: \"text\",\n        class: \"flat form-control edit\",\n        value: function() {\n          return Spacebars.mustache(Spacebars.dot(view.lookup(\"segment\"), \"name\"));\n        }\n      })), \"\\n                        \", HTML.TD(HTML.INPUT({\n        id: function() {\n          return [ \"seg-dscr-\", Spacebars.mustache(Spacebars.dot(view.lookup(\"segment\"), \"_id\")) ];\n        },\n        type: \"text\",\n        class: \"flat form-control edit\",\n        value: function() {\n          return Spacebars.mustache(Spacebars.dot(view.lookup(\"segment\"), \"description\"));\n        }\n      })), \"\\n                        \", HTML.TD({\n        class: \"btn-group-xs\"\n      }, \"\\n                            \", HTML.Comment(' <button class=\"btn btn-danger btn-cancel glyphicon glyphicon-remove details\" alt=\"Delete segment\"></button> '), \"\\n                        \"), \"\\n                    \"), \"\\n                \" ];\n    }), \"\\n                \", HTML.TR(\"\\n                    \", HTML.TD(HTML.INPUT({\n      id: \"seg-name-new\",\n      type: \"text\",\n      class: \"flat form-control new\",\n      placeholder: [ HTML.CharRef({\n        html: \"&lt;\",\n        str: \"<\"\n      }), \"New segment name\", HTML.CharRef({\n        html: \"&gt;\",\n        str: \">\"\n      }) ]\n    })), \"\\n                    \", HTML.TD(HTML.INPUT({\n      id: \"seg-dscr-new\",\n      type: \"text\",\n      class: \"flat form-control new\",\n      placeholder: [ HTML.CharRef({\n        html: \"&lt;\",\n        str: \"<\"\n      }), \"New segment description\", HTML.CharRef({\n        html: \"&gt;\",\n        str: \">\"\n      }) ]\n    })), \"\\n                    \", HTML.TD({\n      class: \"btn-group-xs\"\n    }, \"\\n                        \", HTML.BUTTON({\n      id: \"new-seg-save\",\n      class: \"btn btn-success btn-save glyphicon glyphicon-plus details\",\n      alt: \"Delete segment\",\n      disabled: \"\"\n    }), \"\\n                    \"), \"\\n                \"), \"\\n            \"), \"\\n        \"), \"\\n    \"), \"\\n    \" ];\n  }, function() {\n    return [ \"\\n        \", Spacebars.include(view.lookupTemplate(\"loading\")), \"\\n    \" ];\n  });\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"user_segments.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/user_segments/user_segments.js                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nlet UserSegment;\nmodule.watch(require(\"/imports/api/user_segments/user_segments.js\"), {\n  UserSegment(v) {\n    UserSegment = v;\n  }\n\n}, 0);\nmodule.watch(require(\"./user_segments.html\"));\nTemplate.user_segments.onCreated(function () {\n  this.autorun(() => {\n    this.subscription = this.subscribe('segmentList', this.userId, {\n      onStop: function () {\n        console.log(\"Segment List subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"Segment List subscription ready! \", arguments, this);\n      }\n    });\n    console.log(this.subscription);\n  });\n});\nTemplate.user_segments.helpers({\n  segmentList() {\n    let s = UserSegment.find();\n    return s.fetch();\n  }\n\n});\nTemplate.user_segments.events({\n  'keyup input.edit': _.debounce(function (event, instance) {\n    let segid = $(event.target).closest(\"[data-segid]\").data(\"segid\");\n    console.log(segid, $(event.target).closest(\"[data-segid]\"));\n    let s = UserSegment.findOne({\n      _id: segid\n    });\n    let name = $(\"#seg-name-\" + segid).val();\n    let dscr = $(\"#seg-dscr-\" + segid).val();\n    s.update(name, dscr);\n  }, 2000),\n  'keyup input.new': _.debounce(function (event, instance) {\n    if ($(\"#seg-name-new\").val() !== \"\") {\n      $(\"#new-seg-save\").prop(\"disabled\", false);\n    } else {\n      $(\"#new-seg-save\").prop(\"disabled\", true);\n    }\n  }, 2000),\n\n  'click #new-seg-save'(event, instance) {\n    if ($(\"#seg-name-new\").val() !== \"\") {\n      let name = $(\"#seg-name-new\").val();\n      let dscr = $(\"#seg-dscr-new\").val();\n      Meteor.call('segment.createNewSegment', name, dscr);\n      $(\"#seg-name-new\").val(\"\");\n      $(\"#seg-dscr-new\").val(\"\");\n    }\n  }\n\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"verify\":{\"verify.html\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/verify/verify.html                                                                                 //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./template.verify.js\"), {\n  \"*\": module.makeNsSetter(true)\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"template.verify.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/verify/template.verify.js                                                                          //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"verify\");\nTemplate[\"verify\"] = new Template(\"Template.verify\", (function() {\n  var view = this;\n  return HTML.Raw('<div class=\"container\">\\n        <p>\\n        Your email address must be verified before you can access the app.\\n        <a href=\"#\" id=\"resend-verify\">Click here</a> to resend verification email.\\n        </p>\\n        <button type=\"button\" id=\"at-nav-button\" onclick=\"AccountsTemplates.logout()\" class=\"btn btn-default navbar-btn\">Sign Out</button>\\n    </div>');\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"verify.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/ui/pages/verify/verify.js                                                                                   //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nlet User;\nmodule.watch(require(\"/imports/api/users/users.js\"), {\n  User(v) {\n    User = v;\n  }\n\n}, 0);\nmodule.watch(require(\"./verify.html\"));\nTemplate.user_profile.onCreated(function () {\n  this.autorun(() => {\n    this.subscription = this.subscribe('userData', {\n      onStop: function () {\n        console.log(\"User profile subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"User profile subscription ready! \", arguments, this);\n      }\n    });\n  });\n});\nTemplate.verify.events({\n  'click #resend-verify'(event, instance) {\n    event.preventDefault();\n    Meteor.call('user.sendVerificationEmail', () => {\n      console.log('resent');\n    });\n  }\n\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}}}},\"api\":{\"categories\":{\"categories.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/api/categories/categories.js                                                                                //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.export({\n  Category: () => Category,\n  CategoryManager: () => CategoryManager\n});\nlet Class;\nmodule.watch(require(\"meteor/jagi:astronomy\"), {\n  Class(v) {\n    Class = v;\n  }\n\n}, 0);\nlet check;\nmodule.watch(require(\"meteor/check\"), {\n  check(v) {\n    check = v;\n  }\n\n}, 1);\nconst DefaultCategoryID = \"xhKdwhacaWTcBTGPn\";\nconst TypeStats = Class.create({\n  name: 'TypeStats',\n  fields: {\n    num: {\n      type: Number,\n      default: 0\n    }\n  }\n});\nconst Category = Class.create({\n  name: 'Category',\n  collection: new Mongo.Collection('categories'),\n  fields: {\n    name: {\n      type: String,\n      default: \"the Unnamed Category\"\n    },\n    description: {\n      type: String,\n      default: \"this is the default stuff for a Category\"\n    },\n    stats: {\n      type: Object,\n      default: function () {\n        return {};\n      }\n    }\n  },\n  helpers: {\n    addByType(type) {\n      if (!this.getStatsByType(type)) {\n        this.stats[type] = new TypeStats();\n      }\n\n      this.getStatsByType(type).num++;\n      this.save();\n    },\n\n    removeByType(type) {\n      if (!this.getStatsByType(type)) {\n        return false;\n      }\n\n      this.getStatsByType(type).num--;\n      this.save();\n    },\n\n    getStatsByType(type) {\n      return this.stats[type];\n    }\n\n  },\n  meteorMethods: {\n    update(name, dscr) {\n      if (Roles.userIsInRole(Meteor.userId(), 'admin', Roles.GLOBAL_GROUP)) {\n        this.name = name;\n        this.description = dscr;\n        console.log(this.save());\n      }\n    }\n\n  }\n});\nCategory.Default = Category.findOne({\n  _id: DefaultCategoryID\n});\n\nif (typeof Category.Default === \"undefined\") {\n  Category.Default = new Category({\n    _id: DefaultCategoryID\n  });\n\n  if (Meteor.isServer) {\n    Category.Default.save();\n  }\n}\n\nconst CategoryManager = Class.create({\n  name: 'CategoryManager',\n  fields: {\n    Categories: {\n      type: [String],\n      default: function () {\n        return [];\n      }\n    },\n    Type: {\n      type: String,\n      default: \"um... what!?\"\n    }\n  },\n  helpers: {\n    length() {\n      return this.Categories.length;\n    },\n\n    areIntersected(categoryManager) {\n      for (let i = 0; i < this.Categories.length; i++) {\n        for (let j = 0; j < categoryManager.Categories.length; i++) {\n          if (this.Categories[i] == categoryManager.Categories[j]) {\n            return true;\n          }\n        }\n      }\n\n      return false;\n    },\n\n    addCategory(category, type) {\n      if (!type) {\n        type = this.Type;\n      }\n\n      this.Categories.push(category._id);\n      category.addByType(type);\n    },\n\n    hasCategory(category) {\n      if (this.Categories.length == 0) {\n        this.addCategory(Category.Default, this.Type);\n      }\n\n      return _.find(this.Categories, function (catId) {\n        return category._id == catId;\n      });\n    },\n\n    removeCategory(category, type, skipSlice) {\n      let index = -1;\n\n      _.each(this.Categories, function (catId, i) {\n        if (catId == category._id) {\n          index = i;\n        }\n      });\n\n      if (index < 0) {\n        return false;\n      }\n\n      if (!skipSlice) {\n        if (index == 0) {\n          this.Categories.shift();\n        } else if (index == this.Categories.length - 1) {\n          this.Categories.pop();\n        } else {\n          this.Categories = this.Categories.slice(0, index).concat(this.Categories.slice(index + 1));\n        }\n      }\n\n      category.removeByType(type);\n    }\n\n  }\n});\n\nCategoryManager.OfType = function (type) {\n  let c = new CategoryManager();\n  c.Type = type;\n  return c;\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"individual_goals\":{\"individual_goals.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/api/individual_goals/individual_goals.js                                                                    //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.export({\n  IndividualGoal: () => IndividualGoal\n});\nlet Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 0);\nlet Mongo;\nmodule.watch(require(\"meteor/mongo\"), {\n  Mongo(v) {\n    Mongo = v;\n  }\n\n}, 1);\nlet User;\nmodule.watch(require(\"../users/users.js\"), {\n  User(v) {\n    User = v;\n  }\n\n}, 2);\nlet Class, Enum;\nmodule.watch(require(\"meteor/jagi:astronomy\"), {\n  Class(v) {\n    Class = v;\n  },\n\n  Enum(v) {\n    Enum = v;\n  }\n\n}, 3);\nlet UserNotify;\nmodule.watch(require(\"/imports/api/user_notify/user_notify.js\"), {\n  UserNotify(v) {\n    UserNotify = v;\n  }\n\n}, 4);\nlet GoalComment;\nmodule.watch(require(\"/imports/api/team_goals/team_goals.js\"), {\n  GoalComment(v) {\n    GoalComment = v;\n  }\n\n}, 5);\nconst IndividualGoal = Class.create({\n  name: 'IndividualGoal',\n  collection: new Mongo.Collection('individual_goal'),\n  fields: {\n    userId: {\n      type: String,\n      default: ''\n    },\n    title: {\n      type: String,\n      default: ''\n    },\n    description: {\n      type: String,\n      default: ''\n    },\n    parentId: {\n      type: String,\n      default: ''\n    },\n    assignedToStr: {\n      type: String,\n      transient: true\n    },\n    reachedDate: {\n      type: Date,\n      optional: true\n    },\n    startDate: {\n      type: Date,\n      optional: true\n    },\n    dueDate: {\n      type: Date,\n      optional: true\n    },\n    reviewDate: {\n      type: Date,\n      optional: true\n    },\n    reviewedOnDate: {\n      type: Date,\n      optional: true\n    },\n    goalComments: {\n      type: [GoalComment],\n      default: []\n    },\n    reviewComments: {\n      type: [GoalComment],\n      default: []\n    },\n    teamId: {\n      type: String,\n      default: \"\"\n    },\n    privacy: {\n      type: String,\n      default: 'private'\n    },\n    createdBy: {\n      type: String,\n      default: ''\n    }\n  },\n  behaviors: {\n    timestamp: {}\n  },\n  helpers: {\n    getGoalRoleGroup() {\n      return this.teamName + '+' + this._id;\n    },\n\n    userIsAdmin() {\n      if (Roles.userIsInRole(Meteor.userId(), 'admin', this.teamName) || Roles.userIsInRole(Meteor.userId(), 'admin', this.getGoalRoleGroup())) {\n        //user is either a global admin, a team admin, or a goal admin\n        return true;\n      } else {\n        return false;\n      }\n    },\n\n    userIsMentor() {\n      if (Roles.userIsInRole(Meteor.userId(), 'mentor', this.getGoalRoleGroup())) {\n        //user is a mentor for this goal\n        return true;\n      } else {\n        return false;\n      }\n    },\n\n    userIsAssigned() {\n      if (Roles.userIsInRole(Meteor.userId(), 'assigned', this.getGoalRoleGroup())) {\n        //user is assigned to this goal\n        return true;\n      } else {\n        return false;\n      }\n    },\n\n    setDateField(fieldName, rdate) {\n      if (typeof rdate === \"undefined\") {\n        rdate = new Date();\n      } else if (!(rdate instanceof Date)) {\n        return false;\n      }\n\n      this[fieldName] = rdate;\n      return true;\n    },\n\n    getUserFullNameX(userId) {\n      let u = User.findOne({\n        _id: userId\n      });\n\n      if (!u) {\n        return \"Michael\";\n      }\n\n      let name = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n      return name;\n    },\n\n    hasModifyPerm(fieldName) {\n      switch (fieldName) {\n        //admins-only fields\n        case 'dueDate':\n        case 'startDate':\n        case 'reachedDate':\n        case 'reviewDate':\n        case 'title':\n        case 'description':\n        case 'assignedTo':\n        case 'mentors':\n        case 'admins':\n        case 'subgoals':\n          return this.userIsAdmin();\n          break;\n        //admins and mentors\n\n        case 'reviewedOnDate':\n        case 'reviewComments':\n          return this.userIsAdmin() || this.userIsMentor();\n          break;\n        //anyone assigned to the goal\n\n        case 'goalComments':\n          return this.userIsAdmin() || this.userIsMentor() || this.userIsAssigned();\n          break;\n\n        case 'teamId':\n        case 'privacy':\n          return true;\n          break;\n\n        default:\n          return false;\n          break;\n      }\n    },\n\n    notifyNew(oldList, newList) {\n      let diffList = _.difference(newList, oldList);\n\n      for (let i = 0; i < diffList.length; i++) {\n        UserNotify.add({\n          userId: diffList[i],\n          title: 'Goals',\n          body: 'You have been added to goal ' + this.title,\n          action: 'teamgoals:' + this.teamName\n        });\n      }\n    }\n\n  },\n  events: {\n    beforeSave(e) {\n      /*\n      let egoal = e.currentTarget;\n       //any user added to a goal is automatically added to the 'view-goals' role for the team\n      //if they are already in that role, this should just ignore the redundant addUser\n      let flds = [\"assignedTo\",\"mentors\",\"admins\"];\n      for (let i in flds) {\n          if (Array.isArray(egoal[flds[i]]) && egoal[flds[i]].length > 0) {\n              Roles.addUsersToRoles(egoal[flds[i]], 'view-goals', egoal.teamName);\n          }\n      }\n      */\n    }\n\n  },\n  meteorMethods: {\n    setDueDate(rdate) {\n      //admins only\n      if (!this.userIsAdmin()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n\n      if (this.setDateField(\"dueDate\", rdate)) {\n        this.save();\n      } else {\n        throw new Meteor.Error(403, \"Invalid date\");\n      }\n    },\n\n    setGoalReached(rdate) {\n      //admins only\n      if (!this.userIsAdmin()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n\n      if (this.setDateField(\"reachedDate\", rdate)) {\n        this.save();\n      } else {\n        throw new Meteor.Error(403, \"Invalid date\");\n      }\n    },\n\n    setReviewDate(rdate) {\n      //admins only\n      if (!this.userIsAdmin()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n\n      if (this.setDateField(\"reviewDate\", rdate)) {\n        this.save();\n      } else {\n        throw new Meteor.Error(403, \"Invalid date\");\n      }\n    },\n\n    setGoalReviewedOn(rdate) {\n      //mentors and admins\n      if (!this.userIsAdmin() && !this.userIsMentor()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n\n      if (this.setDateField(\"reviewedOnDate\", rdate)) {\n        this.save();\n      } else {\n        throw new Meteor.Error(403, \"Invalid date\");\n      }\n    },\n\n    addComment(commentTxt) {\n      //mentors, admins, and assignees\n      if (!this.userIsAdmin() && !this.userIsMentor() && !this.userIsAssigned()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n\n      this.goalComments.push(new GoalComment({\n        userId: Meteor.userId(),\n        date: new Date(),\n        text: commentTxt\n      }));\n      this.save();\n    },\n\n    addReviewComment(commentTxt) {\n      //mentors and admins\n      if (!this.userIsAdmin() && !this.userIsMentor()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n\n      this.reviewComments.push(new GoalComment({\n        userId: Meteor.userId(),\n        date: new Date(),\n        text: commentTxt\n      }));\n      this.save();\n    },\n\n    createNewGoal() {\n      //admins only\n      if (!this.userIsAdmin()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      } //\n\n    },\n\n    setTitle(title) {\n      //admins only\n      if (!this.userIsAdmin()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n\n      this.title = title;\n      this.save();\n    },\n\n    setDescription(descr) {\n      //admins only\n      if (!this.userIsAdmin()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n\n      this.description = descr;\n      this.save();\n    },\n\n    setAssignedTo(ulist) {\n      //admins only\n      if (!this.userIsAdmin()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n\n      this.notifyNew(this.assignedTo, ulist);\n      this.assignedTo = ulist;\n      this.save();\n    },\n\n    setMentors(ulist) {\n      //admins only\n      if (!this.userIsAdmin()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n\n      this.notifyNew(this.mentors, ulist);\n      this.mentors = ulist;\n      this.save();\n    },\n\n    setAdmins(ulist) {\n      //admins only\n      if (!this.userIsAdmin()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n\n      this.notifyNew(this.admins, ulist);\n      this.admins = ulist;\n      this.save();\n    },\n\n    getUserFullName(userId) {\n      const invocation = DDP._CurrentInvocation.get();\n\n      if (invocation.isSimulation) {\n        return \"George\";\n      }\n\n      let u = User.findOne({\n        _id: userId\n      });\n\n      if (!u) {\n        return \"Michael\";\n      }\n\n      let name = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n      return name;\n    },\n\n    updateFromObj(updObj) {\n      let permError = false;\n\n      for (let fld in updObj) {\n        if (this[fld] !== updObj[fld] || Array.isArray(updObj[fld]) && _.isEqual(this[fld], updObj[fld])) {\n          if (this.hasModifyPerm(fld)) {\n            if (fld === \"assignedTo\" || fld === \"mentors\" || fld === \"admins\") {\n              this.notifyNew(this[fld], updObj[fld]);\n            }\n\n            this[fld] = updObj[fld];\n          } else {\n            permError = true;\n          }\n        }\n      }\n\n      this.save();\n\n      if (permError) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n    }\n\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"learn_share\":{\"learn_share.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/api/learn_share/learn_share.js                                                                              //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.export({\n  LearnShareSession: () => LearnShareSession\n});\nlet Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 0);\nlet Mongo;\nmodule.watch(require(\"meteor/mongo\"), {\n  Mongo(v) {\n    Mongo = v;\n  }\n\n}, 1);\nlet Class, Enum;\nmodule.watch(require(\"meteor/jagi:astronomy\"), {\n  Class(v) {\n    Class = v;\n  },\n\n  Enum(v) {\n    Enum = v;\n  }\n\n}, 2);\nlet User;\nmodule.watch(require(\"/imports/api/users/users.js\"), {\n  User(v) {\n    User = v;\n  }\n\n}, 3);\nlet UserNotify;\nmodule.watch(require(\"/imports/api/user_notify/user_notify.js\"), {\n  UserNotify(v) {\n    UserNotify = v;\n  }\n\n}, 4);\nvar fs = {};\n\nif (Meteor.isServer) {\n  fs = Npm.require('fs');\n}\n\nconst LSUser = Class.create({\n  name: 'LSUser',\n  fields: {\n    id: {\n      type: String,\n      default: ''\n    },\n    name: {\n      type: String,\n      default: 'John Doe'\n    }\n  }\n});\nconst LearnShareSession = Class.create({\n  name: \"LearnShareSession\",\n  collection: new Mongo.Collection('learn_share'),\n  fields: {\n    title: {\n      type: String,\n      default: \"unnamed Learn/Share session\"\n    },\n    notes: {\n      type: String,\n      default: \"duly noted\"\n    },\n    participants: {\n      type: [LSUser],\n      default: []\n    },\n    guests: {\n      type: [LSUser],\n      default: []\n    },\n    presenters: {\n      type: [LSUser],\n      default: []\n    },\n    state: {\n      type: String,\n      default: \"active\"\n    },\n    skypeUrl: {\n      type: String,\n      default: \"\"\n    },\n    teamId: {\n      type: String,\n      default: \"\"\n    }\n  },\n  behaviors: {\n    timestamp: {}\n  },\n  meteorMethods: {\n    addPresenter: function (user) {\n      if (\"locked\" === this.state) {\n        return;\n      }\n\n      var lsUser = new LSUser(user); //check for duplicate\n\n      if (typeof _.find(this.presenters, function (o) {\n        return o.id === lsUser.id;\n      }) !== \"undefined\") {\n        return false;\n      }\n\n      this.presenters.push(lsUser);\n      return this.save();\n    },\n    addParticipant: function (user) {\n      if (\"locked\" === this.state) {\n        return;\n      }\n\n      var lsUser = new LSUser(user); //check for duplicate\n\n      if (typeof _.find(this.participants, function (o) {\n        return o.id === lsUser.id;\n      }) !== \"undefined\") {\n        return false;\n      }\n\n      this.participants.push(lsUser);\n      UserNotify.add({\n        userId: lsUser.id,\n        title: 'Learn/Share',\n        body: 'You have been added to a Learn/Share session',\n        action: 'learnshare:' + this._id\n      });\n      return this.save();\n    },\n    removeParticipant: function (userId) {\n      if (\"locked\" === this.state) {\n        return;\n      }\n\n      this.participants = _.filter(this.participants, function (o) {\n        return o.id !== userId;\n      });\n      return this.save();\n    },\n    removeGuest: function (userId) {\n      if (\"locked\" === this.state) {\n        return;\n      }\n\n      this.guests = _.filter(this.guests, function (o) {\n        return o.id !== userId;\n      });\n      return this.save();\n    },\n    removePresenter: function (userId) {\n      if (\"locked\" === this.state) {\n        return;\n      }\n\n      this.presenters = _.filter(this.presenters, function (o) {\n        return o.id !== userId;\n      });\n      return this.save();\n    },\n    addParticipantSelf: function () {\n      if (\"locked\" === this.state) {\n        return;\n      }\n\n      if (Meteor.userId()) {\n        //check for duplicate\n        if (typeof _.find(this.participants, function (o) {\n          return o.id === Meteor.userId();\n        }) === \"undefined\") {\n          let u = User.findOne({\n            _id: Meteor.userId()\n          });\n\n          if (!u) {\n            throw new Meteor.Error(403, \"You are not authorized\");\n          } else {\n            let lsu = new LSUser({\n              id: Meteor.userId(),\n              name: u.MyProfile.firstName + \" \" + u.MyProfile.lastName\n            });\n            this.participants.push(lsu);\n            this.save();\n          }\n        }\n      } else {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n    },\n    saveGuest: function (guestId, guestName) {\n      if (\"locked\" === this.state) {\n        return;\n      }\n\n      let guestObj = _.find(this.guests, function (o) {\n        return o.id === guestId;\n      });\n\n      if (\"undefined\" !== typeof guestObj) {\n        console.log(\"already a guest\");\n        this.guests = _.filter(this.guests, function (o) {\n          return o.id !== guestId;\n        });\n        guestObj.name = guestName;\n      } else {\n        console.log(\"not a guest\");\n        guestObj = new LSUser({\n          id: guestId,\n          name: guestName\n        });\n      }\n\n      this.guests.push(guestObj);\n      this.save();\n    },\n    saveText: function (title, notes) {\n      if (\"locked\" === this.state) {\n        return;\n      }\n\n      if (Roles.userIsInRole(Meteor.userId(), ['admin', 'learn-share-host'], Roles.GLOBAL_GROUP)) {\n        this.title = title;\n        this.notes = notes;\n        this.save();\n      } else {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n    },\n    lockSession: function (title, notes) {\n      if (Roles.userIsInRole(Meteor.userId(), ['admin', 'learn-share-host'], Roles.GLOBAL_GROUP)) {\n        this.state = \"locked\";\n        this.save();\n      } else {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n    },\n    unlockSession: function (title, notes) {\n      if (Roles.userIsInRole(Meteor.userId(), ['admin', 'learn-share-host'], Roles.GLOBAL_GROUP)) {\n        this.state = \"active\";\n        this.save();\n      } else {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n    },\n    setSkypeUrl: function (url) {\n      if (Roles.userIsInRole(Meteor.userId(), ['admin', 'learn-share-host'], Roles.GLOBAL_GROUP)) {\n        this.skypeUrl = url;\n        this.save();\n      }\n    },\n\n    uploadRecording(fileInfo, fileData) {\n      if (Meteor.isServer && Roles.userIsInRole(Meteor.userId(), ['admin', 'learn-share-host'], Roles.GLOBAL_GROUP)) {\n        let uploadPath = '/uploads/';\n        fs.writeFile(uploadPath + this._id + \".mp4\", fileData, 'binary', err => {\n          console.log(\"File written.\", err);\n        });\n      }\n    }\n\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"questions\":{\"questions.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/api/questions/questions.js                                                                                  //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.export({\n  Question: () => Question,\n  Reading: () => Reading,\n  MyersBriggsCategory: () => MyersBriggsCategory\n});\nlet Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 0);\nlet Mongo;\nmodule.watch(require(\"meteor/mongo\"), {\n  Mongo(v) {\n    Mongo = v;\n  }\n\n}, 1);\nlet Class, Enum;\nmodule.watch(require(\"meteor/jagi:astronomy\"), {\n  Class(v) {\n    Class = v;\n  },\n\n  Enum(v) {\n    Enum = v;\n  }\n\n}, 2);\nlet check;\nmodule.watch(require(\"meteor/check\"), {\n  check(v) {\n    check = v;\n  }\n\n}, 3);\nlet User;\nmodule.watch(require(\"../users/users.js\"), {\n  User(v) {\n    User = v;\n  }\n\n}, 4);\nlet Defaults;\nmodule.watch(require(\"/imports/startup/both/defaults.js\"), {\n  Defaults(v) {\n    Defaults = v;\n  }\n\n}, 5);\nlet UserNotify;\nmodule.watch(require(\"/imports/api/user_notify/user_notify.js\"), {\n  UserNotify(v) {\n    UserNotify = v;\n  }\n\n}, 6);\nconst MyersBriggsCategory = Enum.create({\n  name: 'MyersBriggsCategory',\n  identifiers: ['IE', 'NS', 'TF', 'JP']\n});\nconst Reading = Class.create({\n  name: 'Reading',\n  fields: {\n    Rank: {\n      type: Number,\n      default: 0,\n      validators: [{\n        type: 'lte',\n        resolveParam: function () {\n          return 50;\n        }\n      }, {\n        type: 'gte',\n        resolveParam: function () {\n          return -50;\n        }\n      }]\n    },\n    Text: {\n      type: String,\n      default: 'Well, you feel...'\n    }\n  }\n});\nconst PolarStats = Class.create({\n  name: 'PolarStats',\n  fields: {\n    LeftSum: {\n      type: Number,\n      default: 0\n    },\n    RightSum: {\n      type: Number,\n      default: 0\n    }\n  },\n  helpers: {\n    reset() {\n      this.LeftSum = 0;\n      this.RightSum = 0;\n    }\n\n  }\n});\nconst Question = Class.create({\n  name: \"Question\",\n  collection: new Mongo.Collection('questions'),\n  fields: {\n    Category: {\n      type: MyersBriggsCategory,\n      default: 'IE'\n    },\n    Categories: {\n      type: [MyersBriggsCategory],\n      default: []\n    },\n    Text: {\n      type: String,\n      default: 'Whoa! What we askin\\' here?'\n    },\n    LeftText: {\n      type: String,\n      default: 'Whoa! What we askin\\' here?'\n    },\n    RightText: {\n      type: String,\n      default: 'Whoa! What we askin\\' here?'\n    },\n    Readings: {\n      type: [Reading],\n      default: function () {\n        return [{\n          Rank: -50,\n          Text: \"You will ALWAYS Do this. Doing otherwise is inconceivable to you.\"\n        }, {\n          Rank: -49,\n          Text: \"There may be a possible scenerio where the reverse may apply, but it would be really rare.\"\n        }, {\n          Rank: -40,\n          Text: \"You can think of cases where you have done things the other way, but not under normal circumstances. \"\n        }, {\n          Rank: -30,\n          Text: \"This is your most common behavior, but there are definitely times you've done the opposite.\"\n        }, {\n          Rank: -20,\n          Text: \"This is a good default choice for you, but time and circumstance could easily find you doing the other.\"\n        }, {\n          Rank: -10,\n          Text: \"You don't have much of a preference either way, but this side sounds a bit more likely.\"\n        }, {\n          Rank: 10,\n          Text: \"You don't have much of a preference either way, but this side sounds a bit more likely.\"\n        }, {\n          Rank: 20,\n          Text: \"This is a good default choice for you, but time and circumstance could easily find you doing the other.\"\n        }, {\n          Rank: 30,\n          Text: \"This is your most common behavior, but there are definitely times you've done the opposite.\"\n        }, {\n          Rank: 40,\n          Text: \"You can think of cases where you have done things the other way, but not under normal circumstances. \"\n        }, {\n          Rank: 49,\n          Text: \"There may be a possible scenerio where the reverse may apply, but it would be really rare.\"\n        }, {\n          Rank: 50,\n          Text: \"You will ALWAYS Do this. Doing otherwise is inconceivable to you.\"\n        }];\n      }\n    },\n    segments: {\n      type: [String],\n      default: []\n    },\n    Active: {\n      type: Boolean,\n      default: false\n    },\n    CreatedBy: {\n      type: String,\n      default: function () {\n        return Meteor.userId();\n      }\n    },\n    TimesAnswered: {\n      type: PolarStats,\n      default: function () {\n        return new PolarStats();\n      }\n    },\n    SumOfAnswers: {\n      type: PolarStats,\n      default: function () {\n        return new PolarStats();\n      }\n    }\n  },\n  meteorMethods: {\n    getUser() {\n      let u = User.findOne({\n        _id: this.CreatedBy\n      });\n      return u;\n    }\n\n  },\n  helpers: {\n    addAnswer(answer) {\n      if (answer.Value < 0) {\n        this.TimesAnswered.LeftSum++;\n        this.SumOfAnswers.LeftSum += answer.Value;\n      } else {\n        this.TimesAnswered.RightSum++;\n        this.SumOfAnswers.RightSum += answer.Value;\n      }\n\n      this.save();\n    },\n\n    removeAnswer(answer) {\n      if (answer.Value < 0) {\n        this.TimesAnswered.LeftSum--;\n\n        if (this.TimesAnswered.LeftSum <= 0) {\n          this.TimesAnswered.LeftSum = 0;\n          this.SumOfAnswers.LeftSum = 0;\n        } else {\n          this.SumOfAnswers.LeftSum -= answer.Value;\n        }\n      } else {\n        this.TimesAnswered.RightSum--;\n\n        if (this.TimesAnswered.RightSum <= 0) {\n          this.TimesAnswered.RightSum = 0;\n          this.SumOfAnswers.RightSum = 0;\n        } else {\n          this.SumOfAnswers.RightSum -= answer.Value;\n        }\n      }\n\n      this.save();\n    },\n\n    allAnsweredUsers() {\n      return User.find({\n        'MyProfile.UserType.AnsweredQuestions.QuestionID': {\n          $eq: this._id\n        }\n      });\n    },\n\n    unanswerAll(noSave) {\n      let self = this;\n      self.allAnsweredUsers().forEach(function (user) {\n        let b = user.MyProfile.UserType.AnsweredQuestions.length;\n        user.MyProfile.UserType.unAnswerQuestion(user.MyProfile.UserType.getAnswerForQuestion(self._id), false);\n\n        if (!noSave) {\n          user.save();\n        }\n      });\n      this.reset();\n    },\n\n    reset() {\n      this.TimesAnswered.reset();\n      this.SumOfAnswers.reset();\n      this.save();\n    }\n\n  },\n  behaviors: {\n    timestamp: {},\n    softremove: {}\n  },\n  secured: {\n    update: false\n  },\n  events: {\n    beforeInsert(e) {\n      let u = User.findOne({\n        username: Defaults.user.username\n      });\n      UserNotify.add({\n        userId: u._id,\n        title: 'Questions',\n        body: 'New question added',\n        action: 'questions:' + e.currentTarget._id\n      });\n    },\n\n    beforeUpdate(e) {\n      const allowed = ['updatedAt', 'TimesAnswered', 'TimesAnswered.LeftSum', 'SumOfAnswers', 'SumOfAnswers.LeftSum', 'TimesAnswered.RightSum', 'SumOfAnswers.RightSum'];\n      const doc = e.currentTarget;\n      const fieldNames = doc.getModified();\n\n      _.each(fieldNames, function (fieldName) {\n        if (!Meteor.isServer && allowed.indexOf(fieldName) < 0 && !Roles.userIsInRole(Meteor.userId(), ['admin'], Roles.GLOBAL_GROUP)) {\n          throw new Meteor.Error(403, \"You are not authorized\");\n        }\n      });\n    }\n\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"team_goals\":{\"team_goals.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/api/team_goals/team_goals.js                                                                                //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.export({\n  TeamGoal: () => TeamGoal,\n  GoalComment: () => GoalComment\n});\nlet Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 0);\nlet Mongo;\nmodule.watch(require(\"meteor/mongo\"), {\n  Mongo(v) {\n    Mongo = v;\n  }\n\n}, 1);\nlet User;\nmodule.watch(require(\"../users/users.js\"), {\n  User(v) {\n    User = v;\n  }\n\n}, 2);\nlet Class, Enum;\nmodule.watch(require(\"meteor/jagi:astronomy\"), {\n  Class(v) {\n    Class = v;\n  },\n\n  Enum(v) {\n    Enum = v;\n  }\n\n}, 3);\nlet UserNotify;\nmodule.watch(require(\"/imports/api/user_notify/user_notify.js\"), {\n  UserNotify(v) {\n    UserNotify = v;\n  }\n\n}, 4);\nconst GoalComment = Class.create({\n  name: 'GoalComment',\n  fields: {\n    userId: {\n      type: String,\n      default: function () {\n        return Meteor.userId();\n      }\n    },\n    date: {\n      type: Date,\n      default: function () {\n        return new Date();\n      }\n    },\n    text: {\n      type: String,\n      default: ''\n    }\n  }\n});\nconst TeamGoal = Class.create({\n  name: 'TeamGoal',\n  collection: new Mongo.Collection('team_goal'),\n  fields: {\n    teamName: {\n      type: String,\n      default: ''\n    },\n    title: {\n      type: String,\n      default: ''\n    },\n    description: {\n      type: String,\n      default: ''\n    },\n    parentId: {\n      type: String,\n      default: ''\n    },\n    assignedTo: {\n      type: [String],\n      default: []\n    },\n    mentors: {\n      type: [String],\n      default: []\n    },\n    assignedToStr: {\n      type: String,\n      transient: true\n    },\n    mentorsStr: {\n      type: String,\n      transient: true\n    },\n    adminsStr: {\n      type: String,\n      transient: true\n    },\n    admins: {\n      type: [String],\n      default: []\n    },\n    reachedDate: {\n      type: Date,\n      optional: true\n    },\n    startDate: {\n      type: Date,\n      optional: true\n    },\n    dueDate: {\n      type: Date,\n      optional: true\n    },\n    reviewDate: {\n      type: Date,\n      optional: true\n    },\n    reviewedOnDate: {\n      type: Date,\n      optional: true\n    },\n    goalComments: {\n      type: [GoalComment],\n      default: []\n    },\n    reviewComments: {\n      type: [GoalComment],\n      default: []\n    }\n  },\n  behaviors: {\n    timestamp: {}\n  },\n  helpers: {\n    getGoalRoleGroup() {\n      return this.teamName + '+' + this._id;\n    },\n\n    userIsAdmin() {\n      if (Roles.userIsInRole(Meteor.userId(), 'admin', this.teamName) || Roles.userIsInRole(Meteor.userId(), 'admin', this.getGoalRoleGroup())) {\n        //user is either a global admin, a team admin, or a goal admin\n        return true;\n      } else {\n        return false;\n      }\n    },\n\n    userIsMentor() {\n      if (Roles.userIsInRole(Meteor.userId(), 'mentor', this.getGoalRoleGroup())) {\n        //user is a mentor for this goal\n        return true;\n      } else {\n        return false;\n      }\n    },\n\n    userIsAssigned() {\n      if (Roles.userIsInRole(Meteor.userId(), 'assigned', this.getGoalRoleGroup())) {\n        //user is assigned to this goal\n        return true;\n      } else {\n        return false;\n      }\n    },\n\n    setDateField(fieldName, rdate) {\n      if (typeof rdate === \"undefined\") {\n        rdate = new Date();\n      } else if (!(rdate instanceof Date)) {\n        return false;\n      }\n\n      this[fieldName] = rdate;\n      return true;\n    },\n\n    getUserFullNameX(userId) {\n      let u = User.findOne({\n        _id: userId\n      });\n\n      if (!u) {\n        return \"Michael\";\n      }\n\n      let name = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n      return name;\n    },\n\n    hasModifyPerm(fieldName) {\n      switch (fieldName) {\n        //admins-only fields\n        case 'dueDate':\n        case 'startDate':\n        case 'reachedDate':\n        case 'reviewDate':\n        case 'title':\n        case 'description':\n        case 'assignedTo':\n        case 'mentors':\n        case 'admins':\n        case 'subgoals':\n          return this.userIsAdmin();\n          break;\n        //admins and mentors\n\n        case 'reviewedOnDate':\n        case 'reviewComments':\n          return this.userIsAdmin() || this.userIsMentor();\n          break;\n        //anyone assigned to the goal\n\n        case 'goalComments':\n          return this.userIsAdmin() || this.userIsMentor() || this.userIsAssigned();\n          break;\n\n        default:\n          return false;\n          break;\n      }\n    },\n\n    notifyNew(oldList, newList) {\n      let diffList = _.difference(newList, oldList);\n\n      for (let i = 0; i < diffList.length; i++) {\n        UserNotify.add({\n          userId: diffList[i],\n          title: 'Team Goals',\n          body: 'You have been added to goal ' + this.title,\n          action: 'teamgoals:' + this.teamName\n        });\n      }\n    }\n\n  },\n  events: {\n    beforeSave(e) {\n      let egoal = e.currentTarget; //any user added to a goal is automatically added to the 'view-goals' role for the team\n      //if they are already in that role, this should just ignore the redundant addUser\n\n      let flds = [\"assignedTo\", \"mentors\", \"admins\"];\n\n      for (let i in flds) {\n        if (Array.isArray(egoal[flds[i]]) && egoal[flds[i]].length > 0) {\n          Roles.addUsersToRoles(egoal[flds[i]], 'view-goals', egoal.teamName);\n        }\n      }\n    }\n\n  },\n  meteorMethods: {\n    setDueDate(rdate) {\n      //admins only\n      if (!this.userIsAdmin()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n\n      if (this.setDateField(\"dueDate\", rdate)) {\n        this.save();\n      } else {\n        throw new Meteor.Error(403, \"Invalid date\");\n      }\n    },\n\n    setGoalReached(rdate) {\n      //admins only\n      if (!this.userIsAdmin()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n\n      if (this.setDateField(\"reachedDate\", rdate)) {\n        this.save();\n      } else {\n        throw new Meteor.Error(403, \"Invalid date\");\n      }\n    },\n\n    setReviewDate(rdate) {\n      //admins only\n      if (!this.userIsAdmin()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n\n      if (this.setDateField(\"reviewDate\", rdate)) {\n        this.save();\n      } else {\n        throw new Meteor.Error(403, \"Invalid date\");\n      }\n    },\n\n    setGoalReviewedOn(rdate) {\n      //mentors and admins\n      if (!this.userIsAdmin() && !this.userIsMentor()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n\n      if (this.setDateField(\"reviewedOnDate\", rdate)) {\n        this.save();\n      } else {\n        throw new Meteor.Error(403, \"Invalid date\");\n      }\n    },\n\n    addComment(commentTxt) {\n      //mentors, admins, and assignees\n      if (!this.userIsAdmin() && !this.userIsMentor() && !this.userIsAssigned()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n\n      this.goalComments.push(new GoalComment({\n        userId: Meteor.userId(),\n        date: new Date(),\n        text: commentTxt\n      }));\n      this.save();\n    },\n\n    addReviewComment(commentTxt) {\n      //mentors and admins\n      if (!this.userIsAdmin() && !this.userIsMentor()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n\n      this.reviewComments.push(new GoalComment({\n        userId: Meteor.userId(),\n        date: new Date(),\n        text: commentTxt\n      }));\n      this.save();\n    },\n\n    createNewGoal() {\n      //admins only\n      if (!this.userIsAdmin()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      } //\n\n    },\n\n    setTitle(title) {\n      //admins only\n      if (!this.userIsAdmin()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n\n      this.title = title;\n      this.save();\n    },\n\n    setDescription(descr) {\n      //admins only\n      if (!this.userIsAdmin()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n\n      this.description = descr;\n      this.save();\n    },\n\n    setAssignedTo(ulist) {\n      //admins only\n      if (!this.userIsAdmin()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n\n      this.notifyNew(this.assignedTo, ulist);\n      this.assignedTo = ulist;\n      this.save();\n    },\n\n    setMentors(ulist) {\n      //admins only\n      if (!this.userIsAdmin()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n\n      this.notifyNew(this.mentors, ulist);\n      this.mentors = ulist;\n      this.save();\n    },\n\n    setAdmins(ulist) {\n      //admins only\n      if (!this.userIsAdmin()) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n\n      this.notifyNew(this.admins, ulist);\n      this.admins = ulist;\n      this.save();\n    },\n\n    getUserFullName(userId) {\n      const invocation = DDP._CurrentInvocation.get();\n\n      if (invocation.isSimulation) {\n        return \"George\";\n      }\n\n      let u = User.findOne({\n        _id: userId\n      });\n\n      if (!u) {\n        return \"Michael\";\n      }\n\n      let name = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n      return name;\n    },\n\n    updateFromObj(updObj) {\n      let permError = false;\n\n      for (let fld in updObj) {\n        if (this[fld] !== updObj[fld] || Array.isArray(updObj[fld]) && _.isEqual(this[fld], updObj[fld])) {\n          if (this.hasModifyPerm(fld)) {\n            if (fld === \"assignedTo\" || fld === \"mentors\" || fld === \"admins\") {\n              this.notifyNew(this[fld], updObj[fld]);\n            }\n\n            this[fld] = updObj[fld];\n          } else {\n            permError = true;\n          }\n        }\n      }\n\n      this.save();\n\n      if (permError) {\n        throw new Meteor.Error(403, \"You are not authorized\");\n      }\n    }\n\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"teams\":{\"teams.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/api/teams/teams.js                                                                                          //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.export({\n  Team: () => Team,\n  TeamIcon: () => TeamIcon\n});\nlet Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 0);\nlet Mongo;\nmodule.watch(require(\"meteor/mongo\"), {\n  Mongo(v) {\n    Mongo = v;\n  }\n\n}, 1);\nlet Class, Enum;\nmodule.watch(require(\"meteor/jagi:astronomy\"), {\n  Class(v) {\n    Class = v;\n  },\n\n  Enum(v) {\n    Enum = v;\n  }\n\n}, 2);\nlet check;\nmodule.watch(require(\"meteor/check\"), {\n  check(v) {\n    check = v;\n  }\n\n}, 3);\nlet User;\nmodule.watch(require(\"../users/users.js\"), {\n  User(v) {\n    User = v;\n  }\n\n}, 4);\nlet Defaults;\nmodule.watch(require(\"/imports/startup/both/defaults.js\"), {\n  Defaults(v) {\n    Defaults = v;\n  }\n\n}, 5);\nlet UserNotify;\nmodule.watch(require(\"/imports/api/user_notify/user_notify.js\"), {\n  UserNotify(v) {\n    UserNotify = v;\n  }\n\n}, 6);\nconst DefaultTeamID = \"NCuypCXN47KrSTeXh\";\nconst TeamIcon = Class.create({\n  name: \"TeamIcon\",\n  fields: {\n    data: {\n      type: String,\n      default: ''\n    },\n    contentType: {\n      type: String,\n      default: 'image/png'\n    }\n  }\n});\nconst Team = Class.create({\n  name: \"Team\",\n  collection: new Mongo.Collection('teams'),\n  fields: {\n    Name: {\n      type: String,\n      default: 'Whoa! The no-name team?'\n    },\n    Description: {\n      type: String,\n      default: 'This team is nondescript.'\n    },\n    Icon64: {\n      type: String,\n      default: ''\n    },\n    IconType: {\n      type: String,\n      defaut: 'image/png',\n      optional: true\n    },\n    Icon: {\n      type: TeamIcon,\n      default: function () {\n        return new TeamIcon();\n      }\n    },\n    Public: {\n      type: Boolean,\n      default: true\n    },\n    Members: {\n      type: [String],\n      default: []\n    },\n    Active: {\n      type: Boolean,\n      default: false\n    },\n    CreatedBy: {\n      type: String,\n      default: function () {\n        return this.userId;\n      }\n    }\n  },\n  indexes: {\n    nameIndex: {\n      fields: {\n        Name: 1\n      },\n      options: {\n        unique: true\n      }\n    }\n  },\n  meteorMethods: {\n    userRequestJoin() {\n      Roles.addUsersToRoles(Meteor.userId(), 'user-join-request', this.Name);\n    },\n\n    adminRequestUserJoin(user) {\n      if (Roles.userIsInRole(Meteor.userId(), 'admin', this.Name) && !Roles.userIsInRole(user, 'member', this.Name)) {\n        Roles.addUsersToRoles(user, 'admin-join-request', this.Name);\n\n        for (let i = 0; i < user.length; i++) {\n          UserNotify.add({\n            userId: user[i],\n            title: 'Teams',\n            body: 'Received join request for team ' + this.Name,\n            action: 'teams:' + this.Name.split(' ').join('-')\n          });\n        }\n      }\n    },\n\n    userAcceptJoin() {\n      if (Roles.userIsInRole(Meteor.userId(), 'admin-join-request', this.Name)) {\n        Roles.removeUsersFromRoles(Meteor.userId(), 'admin-join-request', this.Name);\n        this.addUsers(Meteor.userId());\n      }\n    },\n\n    userDeclineJoin() {\n      if (Roles.userIsInRole(Meteor.userId(), 'admin-join-request', this.Name)) {\n        Roles.removeUsersFromRoles(Meteor.userId(), 'admin-join-request', this.Name);\n      }\n    },\n\n    adminAcceptJoin(userId) {\n      if (Roles.userIsInRole(Meteor.userId(), 'admin', this.Name)) {\n        Roles.removeUsersFromRoles(userId, 'user-join-request', this.Name); //Roles.addUsersToRoles(userId, 'member', this.Name);\n\n        this.addUsers(userId);\n      }\n    },\n\n    adminRejectJoin(userId) {\n      if (Roles.userIsInRole(Meteor.userId(), 'admin', this.Name)) {\n        Roles.removeUsersFromRoles(userId, 'user-join-request', this.Name);\n      }\n    },\n\n    addRole(userId, role) {\n      if (Roles.userIsInRole(Meteor.userId(), 'admin', this.Name)) {\n        Roles.addUsersToRoles(userId, role, this.Name);\n      }\n    },\n\n    removeRole(userId, role) {\n      if (Roles.userIsInRole(Meteor.userId(), 'admin', this.Name)) {\n        Roles.removeUsersFromRoles(userId, role, this.Name);\n      }\n    },\n\n    updateFromObj(updObj) {\n      if (Roles.userIsInRole(Meteor.userId(), 'admin', this.Name)) {\n        for (let fld in updObj) {\n          if (\"Icon64\" !== fld && \"IconType\" !== fld && \"Icon\" !== fld) {\n            this[fld] = updObj[fld];\n          }\n        }\n\n        this.save();\n      }\n    },\n\n    uploadIcon(fileInfo, fileData) {\n      if (Meteor.isServer) {\n        var base64Image = new Buffer(fileData, 'binary').toString('base64');\n        this.Icon64 = base64Image;\n        this.IconType = 'image/png';\n        this.save();\n      }\n    }\n\n  },\n  helpers: {\n    addUsers(users) {\n      if (typeof users === 'string') {\n        users = [users];\n      } //admin list has to be filtered because getUsersInRole includes admin in GLOBAL_GROUP\n\n\n      let groupAdminList = Roles.getUsersInRole('admin', this.Name).fetch().filter(user => {\n        return \"undefined\" !== typeof user.roles && \"undefined\" !== typeof user.roles[this.Name] && user.roles[this.Name].indexOf('admin') > -1;\n      });\n\n      for (let i = 0; i < users.length; i++) {\n        if (this.Members.indexOf(users[i]) === -1) {\n          this.Members.push(users[i]);\n        }\n\n        let currUserRoles = ['member']; //Roles.addUsersToRoles(users[i], 'member', this.Name);\n        //if team doesn't have an admin, the first user added becomes admin\n\n        if (i == 0 && groupAdminList.length == 0) {\n          //Roles.addUsersToRoles(users[i], 'admin', this.Name);\n          currUserRoles.push('admin');\n        } else {\n          //Roles.addUsersToRoles(users[i], Defaults.role.name, this.Name);\n          currUserRoles.push(Defaults.role.name);\n        }\n\n        Roles.addUsersToRoles(users[i], currUserRoles, this.Name);\n        /*\n        let u = User.findOne( {_id: users[i]} );\n        if (u && u.teams.indexOf(this.Name) === -1) {\n            u.teams.push(this.Name);\n            u.save();\n        }\n        */\n      }\n\n      this.save();\n    },\n\n    removeUsers(users) {\n      if (typeof users === 'string') {\n        users = [users];\n      }\n\n      for (let i = 0; i < users.length; i++) {}\n    },\n\n    removeUsersFromTeamRoles(users, roles) {\n      if (typeof users === 'string') {\n        users = [users];\n      }\n\n      if (typeof roles === 'string') {\n        roles = [roles];\n      } //if removing the 'member' role from users, completely remove them from all roles and from the group\n\n\n      if (roles.indexOf('member') !== -1) {\n        this.removeUsers(users);\n      }\n\n      for (let i = 0; i < users.length; i++) {}\n    }\n\n  },\n  behaviors: {\n    timestamp: {},\n    softremove: {}\n  },\n  secured: {},\n  events: {\n    afterInit(e) {//\n    },\n\n    beforeSave(e) {\n      console.log(\"before save Team\", e.currentTarget.Name, e.currentTarget.Members);\n    }\n\n  }\n});\nTeam.Default = Team.findOne({\n  _id: DefaultTeamID\n});\n\nif (typeof Team.Default === \"undefined\") {\n  Team.Default = new Team({\n    _id: DefaultTeamID,\n    Name: 'No Team',\n    Active: true\n  });\n\n  if (Meteor.isServer) {\n    Team.Default.CreatedBy = 'kkcDYH3ix4f4Lb5qk'; //console.log(Team.Default);\n    //Team.Default.save();\n  }\n}\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"type_readings\":{\"type_readings.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/api/type_readings/type_readings.js                                                                          //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.export({\n  TypeReading: () => TypeReading,\n  ReadingRange: () => ReadingRange,\n  TypeReadingCategory: () => TypeReadingCategory,\n  TypeReadingCategories: () => TypeReadingCategories\n});\nlet Class;\nmodule.watch(require(\"meteor/jagi:astronomy\"), {\n  Class(v) {\n    Class = v;\n  }\n\n}, 0);\nlet check;\nmodule.watch(require(\"meteor/check\"), {\n  check(v) {\n    check = v;\n  }\n\n}, 1);\nlet Mongo;\nmodule.watch(require(\"meteor/mongo\"), {\n  Mongo(v) {\n    Mongo = v;\n  }\n\n}, 2);\nlet MyersBriggsCategory;\nmodule.watch(require(\"../questions/questions.js\"), {\n  MyersBriggsCategory(v) {\n    MyersBriggsCategory = v;\n  }\n\n}, 3);\nlet Category, CategoryManager;\nmodule.watch(require(\"../categories/categories.js\"), {\n  Category(v) {\n    Category = v;\n  },\n\n  CategoryManager(v) {\n    CategoryManager = v;\n  }\n\n}, 4);\nconst ReadingRange = Class.create({\n  name: \"ReadingRange\",\n  fields: {\n    high: {\n      type: Number,\n      default: 50\n    },\n    low: {\n      type: Number,\n      default: 0\n    },\n    Delta: {\n      type: Number,\n      default: 50\n    }\n  },\n  helpers: {\n    in(val) {\n      return this.low <= val && val <= this.high;\n    },\n\n    setDelta() {\n      this.Delta = this.high - this.low;\n      return this;\n    }\n\n  }\n});\n\nReadingRange.Create = function (high, low) {\n  let m = new ReadingRange();\n  m.high = high;\n  m.low = low;\n  return m.setDelta();\n};\n\nReadingRange.FullHigh = function () {\n  return ReadingRange.Create(50, 0);\n};\n\nReadingRange.FullLow = function () {\n  return ReadingRange.Create(0, -50);\n};\n\nconst TypeReadingCategory = Class.create({\n  name: \"TypeReadingCategory\",\n  fields: {\n    MyersBriggsCategory: {\n      type: MyersBriggsCategory\n    },\n    Range: {\n      type: ReadingRange,\n      default: function () {\n        return ReadingRange.FullHigh;\n      }\n    }\n  }\n});\nconst TypeReadingCategories = Class.create({\n  name: \"TypeReadingCategories\",\n  fields: {\n    0: {\n      type: TypeReadingCategory,\n      optional: true\n    },\n    1: {\n      type: TypeReadingCategory,\n      optional: true\n    },\n    2: {\n      type: TypeReadingCategory,\n      optional: true\n    },\n    3: {\n      type: TypeReadingCategory,\n      optional: true\n    }\n  }\n});\nconst TypeReading = Class.create({\n  name: \"TypeReading\",\n  collection: new Mongo.Collection('type_readings'),\n  fields: {\n    TypeReadingCategories: {\n      type: TypeReadingCategories,\n      default: {}\n    },\n    Categories: {\n      type: CategoryManager,\n      default: function () {\n        return CategoryManager.OfType(\"TypeReading\");\n      }\n    },\n    Header: {\n      type: String,\n      default: \"\"\n    },\n    Body: {\n      type: String,\n      default: \"\"\n    },\n    CreatedBy: {\n      type: String,\n      default: function () {\n        return Meteor.userId();\n      }\n    },\n    Enabled: {\n      type: Boolean,\n      default: false\n    }\n  },\n  helpers: {\n    toggle() {\n      this.Enabled = !this.Enabled;\n      this.save();\n    },\n\n    addTypeCategory(cat) {\n      this.TypeReadingCategories[cat.MyersBriggsCategory] = cat;\n    }\n\n  },\n  events: {\n    beforeSave(e) {\n      _.forEach(e.target.TypeReadingCategories, reading => {\n        if (reading == null) {\n          return;\n        }\n\n        reading.Range.setDelta();\n      });\n\n      if (e.target.Categories.length() < 1) {\n        e.target.Categories.addCategory(Category.Default);\n      }\n    }\n\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"user_feedback\":{\"user_feedback.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/api/user_feedback/user_feedback.js                                                                          //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.export({\n  UserFeedback: () => UserFeedback\n});\nlet Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 0);\nlet Mongo;\nmodule.watch(require(\"meteor/mongo\"), {\n  Mongo(v) {\n    Mongo = v;\n  }\n\n}, 1);\nlet Class, Enum;\nmodule.watch(require(\"meteor/jagi:astronomy\"), {\n  Class(v) {\n    Class = v;\n  },\n\n  Enum(v) {\n    Enum = v;\n  }\n\n}, 2);\nconst UserFeedback = Class.create({\n  name: 'UserFeedback',\n  collection: new Mongo.Collection('user_feedback'),\n  fields: {\n    userId: {\n      type: String,\n      default: ''\n    },\n    source: {\n      type: String,\n      default: ''\n    },\n    context: {\n      type: String,\n      default: ''\n    },\n    comment: {\n      type: String,\n      default: ''\n    },\n    dateCreated: {\n      type: Date,\n      default: function () {\n        return new Date();\n      }\n    }\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"user_notify\":{\"user_notify.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/api/user_notify/user_notify.js                                                                              //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.export({\n  UserNotify: () => UserNotify\n});\nlet Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 0);\nlet Mongo;\nmodule.watch(require(\"meteor/mongo\"), {\n  Mongo(v) {\n    Mongo = v;\n  }\n\n}, 1);\nlet Class, Enum;\nmodule.watch(require(\"meteor/jagi:astronomy\"), {\n  Class(v) {\n    Class = v;\n  },\n\n  Enum(v) {\n    Enum = v;\n  }\n\n}, 2);\nlet User;\nmodule.watch(require(\"../users/users.js\"), {\n  User(v) {\n    User = v;\n  }\n\n}, 3);\nlet Email;\nmodule.watch(require(\"meteor/email\"), {\n  Email(v) {\n    Email = v;\n  }\n\n}, 4);\nlet UserNotify = Class.create({\n  name: \"UserNotify\",\n  collection: new Mongo.Collection('user_notify'),\n  fields: {\n    userId: {\n      type: String,\n      default: ''\n    },\n    isRead: {\n      type: Boolean,\n      default: false\n    },\n    isPushed: {\n      type: Boolean,\n      default: false\n    },\n    isEmailed: {\n      type: Boolean,\n      default: false\n    },\n    title: {\n      type: String,\n      default: ''\n    },\n    body: {\n      type: String,\n      default: ''\n    },\n    action: {\n      type: String,\n      default: ''\n    },\n    createdDate: {\n      type: Date,\n      default: function () {\n        return new Date();\n      }\n    }\n  },\n  meteorMethods: {\n    markRead() {\n      this.isRead = true;\n      this.save();\n    },\n\n    markNotified() {\n      this.isPushed = true;\n      this.save();\n    }\n\n  },\n  helpers: {\n    test() {\n      console.log(\"123\");\n    },\n\n    pushNotify(opts) {\n      let noteOpts = {\n        body: this.body,\n        icon: '/img/panda.png',\n        data: this._id\n      };\n      let browserNote;\n\n      if (!(\"Notification\" in window)) {\n        alert(\"This browser does not support desktop notification\");\n      } // Let's check whether notification permissions have already been granted\n      else if (Notification.permission === \"granted\") {\n          // If it's okay let's create a notification\n          browserNote = new Notification(this.title, noteOpts);\n        } // Otherwise, we need to ask the user for permission\n        else if (Notification.permission !== \"denied\") {\n            Notification.requestPermission(function (permission) {\n              // If the user accepts, let's create a notification\n              if (permission === \"granted\") {\n                browserNote = new Notification(this.title, noteOpts);\n              }\n            });\n          }\n\n      if (Notification.permission === \"granted\" && typeof opts.onclick !== 'undefined') {\n        browserNote.onclick = opts.onclick;\n      }\n    }\n\n  },\n  events: {\n    beforeSave(e) {\n      if (Meteor.isServer) {\n        let note = e.currentTarget;\n\n        if (!note.isEmailed) {\n          let u = User.findOne({\n            _id: note.userId\n          });\n\n          if (u) {\n            let addr = u.emails[0].address;\n            Email.send({\n              to: addr,\n              from: \"wayne@paladinarcher.com\",\n              subject: \"Developer Level Notification - \" + note.title,\n              text: note.body\n            });\n          }\n        }\n      }\n    }\n\n  }\n});\n\nif (Meteor.isClient) {//\n}\n\nUserNotify.add = function (opts) {\n  let notify = new UserNotify(opts);\n  notify.save();\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"user_segments\":{\"user_segments.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/api/user_segments/user_segments.js                                                                          //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.export({\n  UserSegment: () => UserSegment\n});\nlet Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 0);\nlet Mongo;\nmodule.watch(require(\"meteor/mongo\"), {\n  Mongo(v) {\n    Mongo = v;\n  }\n\n}, 1);\nlet Class, Enum;\nmodule.watch(require(\"meteor/jagi:astronomy\"), {\n  Class(v) {\n    Class = v;\n  },\n\n  Enum(v) {\n    Enum = v;\n  }\n\n}, 2);\nconst UserSegment = Class.create({\n  name: 'UserSegment',\n  collection: new Mongo.Collection('user_segments'),\n  fields: {\n    name: {\n      type: String,\n      default: 'Default user segment'\n    },\n    description: {\n      type: String,\n      default: 'The default user segment for relevant content'\n    }\n  }\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"users\":{\"users.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/api/users/users.js                                                                                          //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.export({\n  User: () => User,\n  Profile: () => Profile,\n  UserType: () => UserType,\n  MyersBriggs: () => MyersBriggs,\n  Answer: () => Answer\n});\nlet Class;\nmodule.watch(require(\"meteor/jagi:astronomy\"), {\n  Class(v) {\n    Class = v;\n  }\n\n}, 0);\nlet check;\nmodule.watch(require(\"meteor/check\"), {\n  check(v) {\n    check = v;\n  }\n\n}, 1);\nlet MyersBriggsCategory, Question;\nmodule.watch(require(\"../questions/questions.js\"), {\n  MyersBriggsCategory(v) {\n    MyersBriggsCategory = v;\n  },\n\n  Question(v) {\n    Question = v;\n  }\n\n}, 2);\nlet Category, CategoryManager;\nmodule.watch(require(\"../categories/categories.js\"), {\n  Category(v) {\n    Category = v;\n  },\n\n  CategoryManager(v) {\n    CategoryManager = v;\n  }\n\n}, 3);\nlet Defaults;\nmodule.watch(require(\"../../startup/both/defaults.js\"), {\n  Defaults(v) {\n    Defaults = v;\n  }\n\n}, 4);\nlet Team;\nmodule.watch(require(\"../teams/teams.js\"), {\n  Team(v) {\n    Team = v;\n  }\n\n}, 5);\nlet UserSegment;\nmodule.watch(require(\"../user_segments/user_segments.js\"), {\n  UserSegment(v) {\n    UserSegment = v;\n  }\n\n}, 6);\nconst MyersBriggsBit = Class.create({\n  name: 'MyersBriggsBit',\n  fields: {\n    Value: {\n      type: Number,\n      default: 0\n    },\n    Totals: {\n      type: Number,\n      default: 0\n    },\n    QuestionCount: {\n      type: Number,\n      default: 0\n    }\n  },\n  helpers: {\n    addValue(value) {\n      this.Totals += value;\n      this.QuestionCount++;\n      this.Value = this.QuestionCount == 0 ? 0 : this.Totals / this.QuestionCount;\n    },\n\n    removeValue(value) {\n      this.QuestionCount--;\n\n      if (this.QuestionCount < 0) {\n        this.QuestionCount = 0;\n      }\n\n      if (this.QuestionCount == 0) {\n        this.Totals = this.Value = 0;\n        return;\n      }\n\n      this.Totals -= value;\n      this.Value = this.Totals / this.QuestionCount;\n    },\n\n    reset() {\n      this.Totals = 0;\n      this.QuestionCount = 0;\n      this.Value = 0;\n    }\n\n  }\n});\nconst MyersBriggs = Class.create({\n  name: 'MyersBriggs',\n  fields: {\n    IE: {\n      type: MyersBriggsBit,\n      default: function () {\n        return new MyersBriggsBit();\n      }\n    },\n    NS: {\n      type: MyersBriggsBit,\n      default: function () {\n        return new MyersBriggsBit();\n      }\n    },\n    TF: {\n      type: MyersBriggsBit,\n      default: function () {\n        return new MyersBriggsBit();\n      }\n    },\n    JP: {\n      type: MyersBriggsBit,\n      default: function () {\n        return new MyersBriggsBit();\n      }\n    }\n  },\n  helpers: {\n    addByCategory(category, value) {\n      console.log(category, value);\n      let name = this.getIdentifierById(category);\n      this[name].addValue(value);\n    },\n\n    removeByCategory(category, value) {\n      let name = this.getIdentifierById(category);\n      this[name].removeValue(value);\n    },\n\n    getIdentifierById(categoryId) {\n      if (categoryId === 0) {\n        return 'IE';\n      }\n\n      if (categoryId === 1) {\n        return 'NS';\n      }\n\n      if (categoryId === 2) {\n        return 'TF';\n      }\n\n      return 'JP';\n    },\n\n    getFourLetter() {\n      let IEL = this.IE.Value === 0 ? '_' : this.IE.Value < 0 ? 'I' : 'E';\n      let NSL = this.NS.Value === 0 ? '_' : this.NS.Value < 0 ? 'N' : 'S';\n      let TFL = this.TF.Value === 0 ? '_' : this.TF.Value < 0 ? 'T' : 'F';\n      let JPL = this.JP.Value === 0 ? '_' : this.JP.Value < 0 ? 'J' : 'P';\n      return \"\".concat(IEL).concat(NSL).concat(TFL).concat(JPL);\n    },\n\n    reset() {\n      for (let i = 0; i < 4; i++) {\n        this[this.getIdentifierById(i)].reset();\n      }\n    }\n\n  }\n});\nconst Answer = Class.create({\n  name: 'Answer',\n  fields: {\n    Category: {\n      type: MyersBriggsCategory,\n      default: 0\n    },\n    Categories: {\n      type: [MyersBriggsCategory],\n      default: []\n    },\n    QuestionID: {\n      type: String,\n      default: ''\n    },\n    Reversed: {\n      type: Boolean,\n      default: false\n    },\n    Value: {\n      type: Number,\n      default: 0\n    },\n    AnsweredAt: {\n      type: Date,\n      default: function () {\n        return new Date();\n      }\n    }\n  },\n  helpers: {\n    getQuestion() {\n      let q = Question.findOne({\n        _id: this.QuestionID\n      });\n      return q;\n    },\n\n    unanswer() {\n      this.getQuestion().removeAnswer(this);\n    }\n\n  }\n});\nconst UserType = Class.create({\n  name: 'UserType',\n  fields: {\n    Personality: {\n      type: MyersBriggs,\n      default: function () {\n        return new MyersBriggs();\n      }\n    },\n    AnsweredQuestions: {\n      type: [Answer],\n      default: function () {\n        return [];\n      }\n    },\n    TotalQuestions: {\n      type: Number,\n      default: 0\n    }\n  },\n  helpers: {\n    getAnsweredQuestionsIDs() {\n      let qids = [];\n\n      _.each(this.AnsweredQuestions, function (ans) {\n        qids.push(ans.QuestionID);\n      });\n\n      return qids;\n    },\n\n    setTotalQuestions(totalQuestions) {\n      //console.log(\"user.js totalQuestions\", totalQuestions);\n      this.TotalQuestions = totalQuestions; //console.log(\"user.js totalQuestions2\", this.TotalQuestions);\n    },\n\n    getTotalQuestions() {\n      return this.TotalQuestions;\n    },\n\n    answerQuestion(answer) {\n      this.AnsweredQuestions.push(answer);\n      console.log(this.AnsweredQuestions);\n      console.log(answer.Categories);\n      let contextThis = this;\n\n      _.each(answer.Categories, function (cat) {\n        contextThis.Personality.addByCategory(cat, answer.Value);\n      }); //this.Personality.addByCategory(answer.Category, answer.Value);\n\n    },\n\n    unAnswerQuestion(answer, skipSlice) {\n      let index = this.getAnswerIndexForQuestionID(answer.QuestionID);\n      let before = this.AnsweredQuestions.length;\n\n      if (index < 0) {\n        return;\n      }\n\n      console.log(index);\n\n      if (!skipSlice) {\n        if (index == 0) {\n          this.AnsweredQuestions.shift();\n        } else if (index == this.AnsweredQuestions.length - 1) {\n          this.AnsweredQuestions.pop();\n        } else {\n          this.AnsweredQuestions = this.AnsweredQuestions.slice(0, index).concat(this.AnsweredQuestions.slice(index + 1));\n        }\n      }\n\n      answer.unanswer();\n\n      _.each(answer.Categories, function (cat) {\n        this.Personality.removeByCategory(cat, answer.Value);\n      }); //this.Personality.removeByCategory(answer.Category, answer.Value);\n\n\n      console.log(\"User Answer Count: \" + before + \" => \" + this.AnsweredQuestions.length);\n    },\n\n    getAnswerIndexForQuestionID(questionId) {\n      for (let i = 0; i < this.AnsweredQuestions.length; i++) {\n        if (this.AnsweredQuestions[i].QuestionID == questionId) {\n          return i;\n        }\n      }\n\n      return -1;\n    },\n\n    getAnswerForQuestion(questionId) {\n      return _.find(this.AnsweredQuestions, function (ans, i) {\n        return ans.QuestionID == questionId;\n      });\n    },\n\n    reset() {\n      let self = this;\n\n      _.each(this.AnsweredQuestions, function (ans) {\n        self.unAnswerQuestion(ans, true);\n      });\n\n      this.Personality.reset();\n      this.AnsweredQuestions = [];\n    }\n\n  }\n});\nconst DashboardPane = Class.create({\n  name: 'DashboardPane',\n  fields: {\n    size: {\n      type: Number,\n      default: 4\n    },\n    name: {\n      type: String,\n      default: 'App_home'\n    },\n    title: {\n      type: String,\n      default: 'Personality Questions'\n    },\n    route: {\n      type: String,\n      default: '/'\n    }\n  }\n});\nconst Profile = Class.create({\n  name: 'Profile',\n  fields: {\n    firstName: {\n      type: String,\n      validators: [{\n        type: 'minLength',\n        param: 2\n      }]\n    },\n    lastName: {\n      type: String,\n      validators: [{\n        type: 'minLength',\n        param: 2\n      }]\n    },\n    UserType: {\n      type: UserType,\n      default: function () {\n        return new UserType();\n      }\n    },\n    gender: {\n      type: Boolean,\n      default: false\n    },\n    birthDate: {\n      type: Date,\n      optional: true\n    },\n    Categories: {\n      type: CategoryManager,\n      default: function () {\n        return CategoryManager.OfType(\"User\");\n      }\n    },\n    dashboardPanes: {\n      type: [DashboardPane],\n      default: []\n    },\n    segments: {\n      type: [String],\n      default: []\n    }\n  },\n  helpers: {\n    calculateAge() {\n      if (this.birthDate) {\n        const diff = Date.now() - this.birthDate.getTime();\n        this.age = Math.abs(new Date(diff).getUTCFullYear() - 1970);\n      }\n    },\n\n    fullName(param) {\n      var fullName = this.firstName + ' ' + this.lastName;\n\n      if (param === 'lower') {\n        return fullName.toLowerCase();\n      } else if (param === 'upper') {\n        return fullName.toUpperCase();\n      }\n\n      return fullName;\n    }\n\n  }\n});\nconst User = Class.create({\n  name: 'User',\n  collection: Meteor.users,\n  fields: {\n    createdAt: Date,\n    emails: {\n      type: [Object],\n      default: function () {\n        return [];\n      }\n    },\n    MyProfile: {\n      type: Profile,\n      default: function () {\n        return new Profile();\n      }\n    },\n    teams: {\n      type: [String],\n      default: function () {\n        return [Team.Default.Name];\n      }\n    },\n    roles: {\n      type: Object\n    }\n  },\n\n  resolveError(_ref) {\n    let {\n      nestedName,\n      validator\n    } = _ref;\n    console.log(nestedName, validator);\n  },\n\n  events: {\n    afterInit(e) {\n      e.target.MyProfile.calculateAge();\n    },\n\n    beforeSave(e) {\n      if (e.currentTarget.MyProfile.Categories.length() === 0) {\n        e.currentTarget.MyProfile.Categories.addCategory(Category.Default);\n      }\n\n      if (e.currentTarget.teams.length === 0) {\n        e.currentTarget.addTeam(Team.Default.Name);\n      }\n    }\n\n  },\n  meteorMethods: {\n    create() {\n      return this.save();\n    },\n\n    changeName(firstName, lastName) {\n      check(firstName, String);\n      check(lastName, String);\n      this.MyProfile.firstName = firstName;\n      this.MyProfile.lastName = lastName;\n      return this.save();\n    },\n\n    fullName(param) {\n      return this.MyProfile.fullName(param);\n    },\n\n    addTeam(teamName) {\n      let teamDoc = Team.findOne({\n        \"Name\": teamName\n      });\n\n      if (typeof teamDoc !== \"undefined\") {\n        teamDoc.addUsers(this._id);\n      } else {\n        return false;\n      }\n    },\n\n    profileUpdate(uprofile) {\n      check(uprofile.firstName, String);\n      check(uprofile.lastName, String);\n      check(uprofile.gender, Boolean);\n      this.MyProfile.firstName = uprofile.firstName;\n      this.MyProfile.lastName = uprofile.lastName;\n      this.MyProfile.gender = uprofile.gender;\n      this.MyProfile.segments = uprofile.segments;\n\n      if (\"\" !== uprofile.birthDate) {\n        this.MyProfile.birthDate = new Date(uprofile.birthDate);\n      }\n\n      return this.save();\n    }\n\n  },\n  indexes: {},\n  behaviors: {\n    slug: {\n      fieldName: 'email'\n    },\n    timestamp: {}\n  }\n});\n\nif (Meteor.isServer) {\n  User.extend({\n    fields: {\n      services: Object\n    }\n  });\n}\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}}},\"startup\":{\"both\":{\"at_config.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/startup/both/at_config.js                                                                                   //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nlet User;\nmodule.watch(require(\"/imports/api/users/users.js\"), {\n  User(v) {\n    User = v;\n  }\n\n}, 0);\nlet Team;\nmodule.watch(require(\"/imports/api/teams/teams.js\"), {\n  Team(v) {\n    Team = v;\n  }\n\n}, 1);\nlet Defaults;\nmodule.watch(require(\"/imports/startup/both/defaults.js\"), {\n  Defaults(v) {\n    Defaults = v;\n  }\n\n}, 2);\n\nconst myPostLogout = function () {\n  //example redirect after logout\n  FlowRouter.go('/signin');\n};\n\nconst mySubmitFunc = function (error, state) {\n  if (!error) {\n    if (state === \"signIn\") {// Successfully logged in\n      // ...\n    }\n\n    if (state === \"signUp\") {// Successfully registered\n      // ...\n    }\n  }\n};\n\nfunction myPreSubmitFunc() {\n  console.log(\"Pre:  \", arguments);\n}\n\nfunction myPostSubmitFunc(userId, info) {\n  Accounts.emailTemplates.siteName = \"DeveloperLevel\";\n  Accounts.emailTemplates.from = \"DeveloperLevel <wayne@paladinarcher.com>\";\n  Accounts.emailTemplates.verifyEmail = {\n    subject() {\n      return \"[DeveloperLevel] Verify your email address\";\n    },\n\n    text(user, url) {\n      let emailAddress = user.emails[0].address,\n          urlWithoutHash = url.replace('#/', ''),\n          supportEmail = \"support@developerlevel.com\",\n          emailBody = \"To verify your email address (\".concat(emailAddress, \") visit the following link:\\n\\n\").concat(urlWithoutHash, \"\\n\\n If you did not request this verification, please ignore this email.\");\n      return emailBody;\n    }\n\n  };\n  Accounts.sendVerificationEmail(userId);\n  console.log(\"Post: \", arguments);\n}\n\nAccountsTemplates.configure({\n  // Behavior\n  confirmPassword: true,\n  enablePasswordChange: true,\n  forbidClientAccountCreation: false,\n  overrideLoginErrors: true,\n  sendVerificationEmail: false,\n  lowercaseUsername: false,\n  focusFirstInput: true,\n  // Appearance\n  showAddRemoveServices: false,\n  showForgotPasswordLink: true,\n  showLabels: true,\n  showPlaceholders: true,\n  showResendVerificationEmailLink: false,\n  // Client-side Validation\n  continuousValidation: false,\n  negativeFeedback: false,\n  negativeValidation: true,\n  positiveValidation: true,\n  positiveFeedback: true,\n  showValidating: true,\n  // Privacy Policy and Terms of Use\n  privacyUrl: 'privacy',\n  termsUrl: 'terms-of-use',\n  // Redirects\n  homeRoutePath: '/',\n  redirectTimeout: 4000,\n  // Routing\n  defaultTemplate: 'Auth_page',\n  defaultLayout: 'App_body',\n  defaultContentRegion: 'main',\n  defaultLayoutRegions: {},\n  // Hooks\n  onLogoutHook: myPostLogout,\n  onSubmitHook: mySubmitFunc,\n  preSignUpHook: myPreSubmitFunc,\n  postSignUpHook: myPostSubmitFunc,\n  // Texts\n  texts: {\n    button: {\n      signUp: \"Register Now!\"\n    },\n    socialSignUp: \"Register\",\n    socialIcons: {\n      \"meteor-developer\": \"fa fa-rocket\"\n    },\n    title: {\n      forgotPwd: \"Recover Your Password\"\n    },\n    inputIcons: {\n      isValidating: \"fa fa-spinner fa-spin\",\n      hasSuccess: \"fa fa-check\",\n      hasError: \"fa fa-times\"\n    }\n  }\n}); // Define these routes in a file loaded on both client and server\n\nAccountsTemplates.configureRoute('signIn', {\n  name: 'signin',\n  path: '/signin'\n});\nAccountsTemplates.configureRoute('signUp', {\n  name: 'join',\n  path: '/join'\n});\nAccountsTemplates.configureRoute('forgotPwd');\nAccountsTemplates.configureRoute('resetPwd', {\n  name: 'resetPwd',\n  path: '/reset-password'\n});\nAccountsTemplates.addFields([{\n  _id: \"first_name\",\n  type: \"text\",\n  required: true,\n  displayName: \"First Name\",\n  func: function (value) {\n    //if(Meteor.isClient) {\n    console.log(\"Firstname validation: \", value); //}\n\n    return false;\n  }\n}, {\n  _id: \"last_name\",\n  type: \"text\",\n  required: true,\n  displayName: \"Last Name\",\n  func: function (value) {\n    //if(Meteor.isClient) {\n    console.log(\"Lastname validation: \", value); //}\n\n    return false;\n  }\n}, {\n  _id: \"gender\",\n  type: \"select\",\n  required: true,\n  displayName: \"Gender\",\n  select: [{\n    text: \"Male\",\n    value: \"male\"\n  }, {\n    text: \"Female\",\n    value: \"female\"\n  }]\n}]);\n\nif (Meteor.isServer) {\n  Accounts.onCreateUser((options, user) => {\n    user.slug = options.email;\n    user.updateAt = user.createdAt;\n    user.MyProfile = {\n      firstName: options.profile.first_name,\n      lastName: options.profile.last_name,\n      gender: options.profile.gender === \"female\",\n      UserType: {\n        Personality: {\n          IE: {},\n          NS: {},\n          TF: {},\n          JP: {}\n        },\n        AnsweredQuestions: []\n      },\n      birthDate: undefined,\n      age: undefined\n    };\n    user.teams = [Team.Default.Name];\n    user.roles = {};\n    user.profile = options.profile;\n\n    if (options.isAdmin && options.username === 'admin') {\n      user.roles[Roles.GLOBAL_GROUP] = ['admin'];\n      Roles.addUsersToRoles(user._id, 'admin', Roles.GLOBAL_GROUP);\n    } else {\n      let t = Team.findOne({\n        Name: Team.Default.Name\n      });\n      user.roles[Team.Default.Name] = ['member', Defaults.role.name];\n      t.addUsers(user._id);\n    }\n\n    return user;\n  });\n  Accounts.validateNewUser(function (user) {\n    var loggedInUser;\n\n    try {\n      loggedInUser = Meteor.user();\n    } catch (ex) {\n      console.log(ex);\n    }\n\n    if (!loggedInUser || Roles.userIsInRole(loggedInUser, ['admin', 'manage-users'], Roles.GLOBAL_GROUP)) {\n      // NOTE: This example assumes the user is not using groups.\n      return true;\n    }\n\n    throw new Meteor.Error(403, \"Not authorized to create new users\");\n  });\n}\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"defaults.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/startup/both/defaults.js                                                                                    //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.export({\n  Defaults: () => Defaults\n});\nconst Defaults = {\n  'user': {\n    'username': 'admin',\n    'email': 'admin@mydomain.com',\n    'isAdmin': true,\n    'profile': {\n      'first_name': 'Admin',\n      'last_name': 'Admin',\n      'gender': 'female'\n    }\n  },\n  'team': {\n    'Name': \"No Team\",\n    'Public': true,\n    'Members': [],\n    'Active': true\n  },\n  'role': {\n    'name': 'No-Permissions'\n  }\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/startup/both/index.js                                                                                       //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./at_config.js\"));\n\n// Import modules used by both client and server through a single index entry point\n// e.g. useraccounts configuration file.\nif (Meteor.isClient) {\n  Session.setDefault('refreshQuestions', Math.random());\n}\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}},\"client\":{\"config.js\":function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/startup/client/config.js                                                                                    //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nMeteor.subscribe('userData');\n/*Meteor.subscribe('teamsData', Meteor.userId(), {\n    onReady: function() {\n        console.log(\"teamsData subscription ready\");\n    }\n}); */\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"index.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/startup/client/index.js                                                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"./config.js\"));\nmodule.watch(require(\"./routes.js\"));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"routes.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// imports/startup/client/routes.js                                                                                    //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nlet FlowRouter;\nmodule.watch(require(\"meteor/kadira:flow-router\"), {\n  FlowRouter(v) {\n    FlowRouter = v;\n  }\n\n}, 0);\nlet BlazeLayout;\nmodule.watch(require(\"meteor/kadira:blaze-layout\"), {\n  BlazeLayout(v) {\n    BlazeLayout = v;\n  }\n\n}, 1);\nlet LearnShareSession;\nmodule.watch(require(\"/imports/api/learn_share/learn_share.js\"), {\n  LearnShareSession(v) {\n    LearnShareSession = v;\n  }\n\n}, 2);\nlet UserNotify;\nmodule.watch(require(\"/imports/api/user_notify/user_notify.js\"), {\n  UserNotify(v) {\n    UserNotify = v;\n  }\n\n}, 3);\nmodule.watch(require(\"../../ui/layouts/body/body.js\"));\nmodule.watch(require(\"../../ui/components/header/header.js\"));\nmodule.watch(require(\"../../ui/components/loading/loading.html\"));\nmodule.watch(require(\"../../ui/components/select_feedback/select_feedback.js\"));\nmodule.watch(require(\"../../ui/components/team_icon/team_icon.html\"));\nmodule.watch(require(\"../../ui/components/video_embed/video_embed.js\"));\nmodule.watch(require(\"../../ui/pages/home/home.js\"));\nmodule.watch(require(\"../../ui/pages/add_questions/add_questions.js\"));\nmodule.watch(require(\"../../ui/pages/add_readings/add_readings.js\"));\nmodule.watch(require(\"../../ui/pages/admin_teams/admin_teams.js\"));\nmodule.watch(require(\"../../ui/pages/learn_share/learn_share.js\"));\nmodule.watch(require(\"../../ui/pages/learn_share_list/learn_share_list.js\"));\nmodule.watch(require(\"../../ui/pages/team_goals/team_goals.js\"));\nmodule.watch(require(\"../../ui/pages/individual_goals/individual_goals.js\"));\nmodule.watch(require(\"../../ui/pages/user_dashboard/user_dashboard.js\"));\nmodule.watch(require(\"../../ui/pages/ask_questions/ask_questions.js\"));\nmodule.watch(require(\"../../ui/pages/dash_min/dash_min.js\"));\nmodule.watch(require(\"../../ui/pages/user_profile/user_profile.js\"));\nmodule.watch(require(\"../../ui/pages/not-found/not-found.js\"));\nmodule.watch(require(\"../../ui/pages/verify/verify.js\"));\nmodule.watch(require(\"../../ui/pages/user_segments/user_segments.js\"));\nmodule.watch(require(\"../../ui/layouts/login/login.js\"));\n\nlet ensureEmailVerified = function () {\n  Meteor.setTimeout(() => {\n    console.log(\"tttt\", Meteor.user(), Meteor.user().emails[0].verified);\n\n    if ((typeof Meteor.user().username === \"undefined\" || Meteor.user().username !== \"admin\") && !Meteor.user().emails[0].verified) {\n      FlowRouter.redirect(\"/verify/notverified\");\n    }\n  }, 500);\n}; // Set up all routes in the app\n\n\nFlowRouter.route('/', {\n  triggersEnter: [AccountsTemplates.ensureSignedIn, ensureEmailVerified],\n  name: 'App.home',\n\n  action() {\n    FlowRouter.redirect(\"/dashboard\");\n  }\n\n});\nFlowRouter.route('/dashboard', {\n  triggersEnter: [AccountsTemplates.ensureSignedIn, ensureEmailVerified],\n  name: 'dashboard',\n\n  action() {\n    BlazeLayout.render('App_body', {\n      top: 'header',\n      main: 'dash_min'\n    });\n  }\n\n});\nFlowRouter.route('/controlcenter', {\n  triggersEnter: [AccountsTemplates.ensureSignedIn, ensureEmailVerified],\n  name: 'controlcenter',\n\n  action() {\n    BlazeLayout.render('App_body', {\n      top: 'header',\n      main: 'user_dashboard'\n    });\n  }\n\n});\nFlowRouter.route('/questions', {\n  triggersEnter: [AccountsTemplates.ensureSignedIn, ensureEmailVerified],\n  name: 'ask_questions',\n\n  action() {\n    BlazeLayout.render('App_body', {\n      top: 'header',\n      main: 'ask_questions'\n    });\n  }\n\n});\nFlowRouter.route('/signin', {\n  name: 'signin',\n\n  action() {\n    BlazeLayout.render('Auth_page', {});\n  }\n\n});\nFlowRouter.route('/addQuestions/:category', {\n  triggersEnter: [AccountsTemplates.ensureSignedIn, ensureEmailVerified],\n  name: 'addQuestions',\n\n  action(params, queryParams) {\n    BlazeLayout.render('App_body', {\n      top: 'header',\n      main: 'add_questions'\n    });\n  }\n\n});\nFlowRouter.route('/addTraitDescriptions', {\n  triggersEnter: [AccountsTemplates.ensureSignedIn, ensureEmailVerified],\n  name: 'addTraitDescriptions',\n\n  action(params, queryParams) {\n    BlazeLayout.render('App_body', {\n      top: 'header',\n      main: 'add_readings'\n    });\n  }\n\n});\nFlowRouter.route('/adminTeams', {\n  triggersEnter: [AccountsTemplates.ensureSignedIn, ensureEmailVerified],\n  name: 'adminTeams',\n\n  action(params, queryParams) {\n    BlazeLayout.render('App_body', {\n      top: 'header',\n      main: 'admin_teams'\n    });\n  }\n\n});\nFlowRouter.route('/adminTeams/:teamName', {\n  triggersEnter: [AccountsTemplates.ensureSignedIn, ensureEmailVerified],\n  name: 'adminTeams',\n\n  action(params, queryParams) {\n    BlazeLayout.render('App_body', {\n      top: 'header',\n      main: 'admin_teams'\n    });\n  }\n\n});\nFlowRouter.route('/learnShareList', {\n  triggersEnter: [AccountsTemplates.ensureSignedIn, ensureEmailVerified],\n  name: 'learnShareList',\n\n  action(params, queryParams) {\n    BlazeLayout.render('App_body', {\n      top: 'header',\n      main: 'learn_share_list'\n    });\n  }\n\n});\nFlowRouter.route('/learnShare/:lssid', {\n  //triggersEnter: [AccountsTemplates.ensureSignedIn],\n  name: 'learnShare',\n\n  action(params, queryParams) {\n    BlazeLayout.render('App_body', {\n      top: 'header',\n      main: 'learn_share'\n    });\n  }\n\n});\nFlowRouter.route('/learnShare', {\n  //triggersEnter: [AccountsTemplates.ensureSignedIn],\n  name: 'learnShare',\n\n  action(params, queryParams) {\n    if (sessionStorage.lastLearnShareId) {\n      FlowRouter.go('/learnShare/' + sessionStorage.lastLearnShareId + location.hash);\n    } else {\n      BlazeLayout.render('App_body', {\n        main: 'App_notFound'\n      });\n    }\n  }\n\n});\nFlowRouter.route('/teamGoals/:teamName', {\n  triggersEnter: [AccountsTemplates.ensureSignedIn, ensureEmailVerified],\n  name: 'teamGoals',\n\n  action(params, queryParams) {\n    BlazeLayout.render('App_body', {\n      top: 'header',\n      main: 'team_goals'\n    });\n  }\n\n});\nFlowRouter.route('/teamGoals/:teamName/:goalId', {\n  triggersEnter: [AccountsTemplates.ensureSignedIn, ensureEmailVerified],\n  name: 'teamGoals',\n\n  action(params, queryParams) {\n    BlazeLayout.render('App_body', {\n      top: 'header',\n      main: 'team_goals'\n    });\n  }\n\n});\nFlowRouter.route('/goals', {\n  triggersEnter: [AccountsTemplates.ensureSignedIn, ensureEmailVerified],\n  name: 'individualGoals',\n\n  action(params, queryParams) {\n    BlazeLayout.render('App_body', {\n      top: 'header',\n      main: 'individual_goals'\n    });\n  }\n\n});\nFlowRouter.route('/goals/:userId', {\n  triggersEnter: [AccountsTemplates.ensureSignedIn, ensureEmailVerified],\n  name: 'individualGoals',\n\n  action(params, queryParams) {\n    BlazeLayout.render('App_body', {\n      top: 'header',\n      main: 'individual_goals'\n    });\n  }\n\n});\nFlowRouter.route('/userSegments', {\n  triggersEnter: [AccountsTemplates.ensureSignedIn, ensureEmailVerified],\n  name: 'userSegments',\n\n  action(params, queryParams) {\n    BlazeLayout.render('App_body', {\n      top: 'header',\n      main: 'user_segments'\n    });\n  }\n\n});\nFlowRouter.route('/profile', {\n  triggersEnter: [AccountsTemplates.ensureSignedIn, ensureEmailVerified],\n  name: 'profile',\n\n  action(params, queryParams) {\n    BlazeLayout.render('App_body', {\n      top: 'header',\n      main: 'user_profile'\n    });\n  }\n\n});\nFlowRouter.route('/profile/:userId', {\n  triggersEnter: [AccountsTemplates.ensureSignedIn, ensureEmailVerified],\n  name: 'profile',\n\n  action(params, queryParams) {\n    BlazeLayout.render('App_body', {\n      top: 'header',\n      main: 'user_profile'\n    });\n  }\n\n});\nFlowRouter.route('/verify-email/:token', {\n  name: 'verify-email',\n\n  action(params) {\n    Accounts.verifyEmail(params.token, error => {\n      if (error) {\n        UserNotify.add({\n          userId: Meteor.userId(),\n          title: 'Verification Error',\n          body: 'Error: email address not verified',\n          action: 'verify:error'\n        });\n        FlowRouter.go('/verify/error');\n      } else {\n        UserNotify.add({\n          userId: Meteor.userId(),\n          title: 'Verification Success',\n          body: 'Success: your email address has been verified',\n          action: 'verify:success'\n        });\n        FlowRouter.go('/');\n      }\n    });\n  }\n\n});\nFlowRouter.route('/verify/:vparam', {\n  triggersEnter: [AccountsTemplates.ensureSignedIn],\n\n  action(params, queryParams) {\n    BlazeLayout.render('verify');\n  }\n\n});\nFlowRouter.notFound = {\n  action() {\n    BlazeLayout.render('App_body', {\n      main: 'App_notFound'\n    });\n  }\n\n};\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}}}},\"client\":{\"main.js\":function(require,exports,module){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// client/main.js                                                                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nmodule.watch(require(\"/imports/startup/both\"));\nmodule.watch(require(\"/imports/startup/client\"));\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}}},{\n  \"extensions\": [\n    \".js\",\n    \".json\",\n    \".html\",\n    \".less\"\n  ]\n});\n\nvar exports = require(\"/client/main.js\");","servePath":"/app.js","sourceMap":{"version":3,"sources":["imports/ui/components/header/header.js","imports/ui/components/label_list/label_list.js","imports/ui/components/notification_list/notification_list.js","imports/ui/components/personality/personality.js","imports/ui/components/questions/questions.js","imports/ui/components/select_autocomplete/select_autocomplete.js","imports/ui/components/select_feedback/select_feedback.js","imports/ui/components/video_embed/video_embed.js","imports/ui/layouts/body/body.js","imports/ui/layouts/login/login.js","imports/ui/pages/add_questions/add_questions.js","imports/ui/pages/add_readings/add_readings.js","imports/ui/pages/admin_teams/admin_teams.js","imports/ui/pages/ask_questions/ask_questions.js","imports/ui/pages/dash_min/dash_min.js","imports/ui/pages/home/home.js","imports/ui/pages/individual_goals/individual_goals.js","imports/ui/pages/learn_share/learn_share.js","imports/ui/pages/learn_share_list/learn_share_list.js","imports/ui/pages/not-found/not-found.js","imports/ui/pages/team_goals/team_goals.js","imports/ui/pages/user_dashboard/user_dashboard.js","imports/ui/pages/user_profile/user_profile.js","imports/ui/pages/user_segments/user_segments.js","imports/ui/pages/verify/verify.js","imports/api/categories/categories.js","imports/api/individual_goals/individual_goals.js","imports/api/learn_share/learn_share.js","imports/api/questions/questions.js","imports/api/team_goals/team_goals.js","imports/api/teams/teams.js","imports/api/type_readings/type_readings.js","imports/api/user_feedback/user_feedback.js","imports/api/user_notify/user_notify.js","imports/api/user_segments/user_segments.js","imports/api/users/users.js","imports/startup/both/at_config.js","imports/startup/both/defaults.js","imports/startup/both/index.js","imports/startup/client/config.js","imports/startup/client/index.js","imports/startup/client/routes.js","client/main.js"],"names":["module","watch","require","User","v","FlowRouter","Template","header","onCreated","autorun","subscription","subscribe","teamName","onStop","console","log","arguments","onReady","helpers","userName","u","findOne","_id","Meteor","userId","MyProfile","fullName","events","event","instance","preventDefault","go","label_list","customClass","item","value","slice","UserNotify","notificationClickAct","action","length","notification_list","notifications","MAX_NOTIFICATIONS","n","find","sort","createdDate","noteList","forEach","note","push","title","body","isRead","isPushed","Date","markNotified","pushNotify","onclick","nid","target","data","un","markRead","close","split","when","secondsAgo","parseInt","toLocaleDateString","read","is","hasUnread","fetch","$target","$","$li","closest","noteActionStr","noteAction","Question","Profile","UserType","MyersBriggs","Answer","TypeReading","minQuestionsAnswered","personality","subscription2","readings","tr","user","isMinMet","AnsweredQuestions","remainingMinQCount","rmn","Math","max","opacityByCategory","category","userObj","Personality","getIdentifierById","abs","Value","percentByCategory","round","letterByCategory","identifier","userImageUrl","Gravatar","imageUrl","emails","address","size","default","modal","singleReading","getHSize","reading","count","delta","_","TypeReadingCategories","cat","Range","Delta","Header","questions","Session","get","useg","segments","conditions","$exists","$eq","$in","$or","reversed","index","isRemainingGreaterThan","num","getTemplate","questionTemplate","questionTemplateReversed","answeredQuestionsLength","totalQuestions","total","getTotalQuestions","call","error","result","setTotalQuestions","document","getElementById","innerHTML","parent","values","questionId","isReversed","remove","set","random","question","getReadingsAsJSON","JSON","stringify","Readings","onRendered","updateValue","elem","html","updateBGOpacity","updateReading","curMax","each","i","Rank","Text","m","css","replace","btn","parents","newRGBA","firstNode","noUiSlider","start","step","range","min","on","val","select_autocomplete","self","dat","currentData","list","params","plugins","options","onItemAdd","onItemRemove","readOnly","create","$select","id","id2","selectize","clear","clearOptions","addOption","selected","o","addItem","refreshItems","UserFeedback","selectedText","selectionHandler","$box","window","getSelection","toString","hide","show","select_feedback","onDestroyed","off","commentsMade","uf","source","prop","fbk","context","comment","err","rslt","video_embed","_fileExists","ReactiveVar","fileExists","fname","UserSegment","add_questions","add_questionsOnCreated","_category","getParam","convertCategory","categoryToIndex","categoryCheck","IE","NS","TF","JP","showModal","stuff","Title","Body","CloseText","SaveText","click","SaveFunction","name","fixTabs","active","makeModalStuff","closeText","saveText","saveFunction","createdAt","subscription3","userSegmentList","segList","s","text","assignedUserSegments","q","assigned","seg","x","Categories","questionAuthor","CreatedBy","getFourLetter","getUserName","callMethod","indexToCategory","ind","categoryList","categories","averageAnswer","times","sum","totalAnswers","right","left","canDelete","TimesAnswered","LeftSum","RightSum","newCat","attr","addClass","qid","Active","save","vals","items","LeftText","RightText","dropdown","e","tab","add_readings","add_readingsOnCreated","readingHasCategory","readingCategory","low","high","getRange","isHigh","readingAuthor","rid","hasClass","removeClass","slideDown","slideUp","me","parentData","dataset","hi","mom","view","template","__helpers","Category","High","Low","ReadingId","readingId","Team","TeamIcon","TeamGoal","admin_teams","join","setTimeout","$item","t","Name","addRole","$control","removeRole","specificTeam","teams","t_invited","t_member","t_else","team","Roles","userIsInRole","Members","includes","concat","teamsMemberOf","GLOBAL_GROUP","filter","tm","Default","teamsOther","teamMembers","teamRole","memberList","firstName","lastName","roles","uniqueId","idLength","possible","charAt","floor","teamRequests","requestList","rolesList","getAllRoles","r","users","userAddList","addList","teamChanged","$g","teamUnchanged","saveTeam","teamId","saveObj","Description","updateFromObj","file","currentTarget","files","reader","FileReader","onload","fileLoadEvent","uploadIcon","readAsBinaryString","$team","$t","newTeamName","newTeamDescription","newTeam","fadeOut","stopPropagation","userList","adminRequestUserJoin","toggleClass","userAcceptJoin","userDeclineJoin","userRequestJoin","adminAcceptJoin","adminRejectJoin","role","$teamContainer","$targetExpandBtn","animate","scrollTop","offset","top","uid","team_view","fldEnabled","fld","g","hasModifyPerm","iconData64","Icon64","hasTeamRequests","hasTeamInvites","teamInvites","inviteList","ask_questions","dash_min","IndividualGoal","BLANK_GOAL","description","_hasSubgoalView","_subgoalId","individual_goals","userSubscriptionReady","modalGoalId","getUserId","datetimepicker","format","useCurrent","showClear","showClose","$newgoal","detach","append","resetNewGoalForm","valInputs","saveGoal","goalId","privacy","startDate","dueDate","rvwDate","reviewDate","parentId","reviewedOnDate","reachedDate","goalChanged","goalUnchanged","$goal","$modalParent","$btnAdd","$comment","newComment","addComment","addReviewComment","$btnCancel","fadeIn","$goalContainer","debounce","gid","goalReload","hasGoals","hasGoalsTeam","tid","individualGoals","individualGoalsTeam","ownList","blankGoal","Object","assign","hasSubgoalView","hasView","subgoal","subgoalId","goalComments","c","reviewComments","formatDate","dateObj","teamList","igoal_view","childGoals","goal","children","hasChildren","doesHave","dateField","d","dateText","getTime","getTimezoneOffset","toISOString","progressPct","currDt","totalDuration","timeSinceStart","pct","userHasModifyPerm","isNew","teamSelected","privacySelected","privVal","collapsed","pid","child_igoal_view","LearnShareSession","generateGuestId","app","client_id","meeting","version","initSkypeAPI","sessionStorage","hasToken","test","location","hash","apiAccessToken","hasError","pathParts","pathname","lastLearnShareId","origin","tokenresponse","parseHashParams","access_token","Skype","initialize","apiKey","correlationIds","sessionId","api","application","apiSignIn","paramarray","param","signInManager","signIn","cors","redirect_uri","origins","then","a","createMeeting","conversationsManager","subject","accessLevel","onlineMeetingUri","uri","uriChunks","skypeUser","emlUser","emlDomain","mtgId","url","trigger","learn_share","lssid","gname","lssess","state","addParticipantSelf","selectControl","participants","presenters","not","saveGuest","focus","participant","ls","removeGuest","addParticipant","removeParticipant","canEdit","canEditAdmin","sessionPresenters","sessionParticipants","sessionParticipantItems","participantIds","sessionGuests","guests","sessionGuestItems","guestIds","roParticipantNames","participantList","itemRemoveHandler","numSelected","itemRemoveGuestHandler","itemAddHandler","itemAddGuestHandler","order","idx","sessionActive","notes","skypeUrl","guestName","pickRandom","availableItems","$picking","uploadRecording","pickingId","prevPickingId","$prevPicked","pickedId","picked","$pickedItem","addPresenter","lockSession","unlockSession","setSkypeUrl","learn_share_list","lsSessList","lst","sess","unshift","hasSessions","team_goals","slzInputs","slAssigned","slMentors","slAdmins","assignList","getValue","mentorList","adminList","tplTeamName","assignedTo","mentors","admins","getTeamName","hasReachedGoals","$ne","teamGoals","teamReachedGoals","teamSlug","goal_view","commaListUsers","nameList","child_goal_view","user_dashboard","dashboardPanes","route","user_profile","segs","segTxt","userField","fldName","gender","birthDate","genderSelected","label","emailAddress","emailAddresses","uprofile","profileUpdate","reset","user_segments","segmentList","segid","dscr","update","verify","export","CategoryManager","Class","check","DefaultCategoryID","TypeStats","fields","type","Number","collection","Mongo","Collection","String","stats","addByType","getStatsByType","removeByType","meteorMethods","isServer","Type","areIntersected","categoryManager","j","addCategory","hasCategory","catId","removeCategory","skipSlice","shift","pop","OfType","Enum","GoalComment","assignedToStr","transient","optional","createdBy","behaviors","timestamp","getGoalRoleGroup","userIsAdmin","userIsMentor","userIsAssigned","setDateField","fieldName","rdate","getUserFullNameX","notifyNew","oldList","newList","diffList","difference","add","beforeSave","setDueDate","Error","setGoalReached","setReviewDate","setGoalReviewedOn","commentTxt","date","createNewGoal","setTitle","setDescription","descr","setAssignedTo","ulist","setMentors","setAdmins","getUserFullName","invocation","DDP","_CurrentInvocation","isSimulation","updObj","permError","Array","isArray","isEqual","fs","Npm","LSUser","lsUser","removePresenter","lsu","guestId","guestObj","fileInfo","fileData","uploadPath","writeFile","Reading","MyersBriggsCategory","Defaults","identifiers","validators","resolveParam","PolarStats","Boolean","SumOfAnswers","getUser","addAnswer","answer","removeAnswer","allAnsweredUsers","unanswerAll","noSave","b","unAnswerQuestion","getAnswerForQuestion","softremove","secured","beforeInsert","username","beforeUpdate","allowed","doc","fieldNames","getModified","indexOf","mentorsStr","adminsStr","egoal","flds","addUsersToRoles","DefaultTeamID","contentType","IconType","defaut","Icon","Public","indexes","nameIndex","unique","removeUsersFromRoles","addUsers","base64Image","Buffer","groupAdminList","getUsersInRole","currUserRoles","removeUsers","removeUsersFromTeamRoles","afterInit","ReadingRange","TypeReadingCategory","in","setDelta","Create","FullHigh","FullLow","Enabled","toggle","addTypeCategory","dateCreated","Email","isEmailed","opts","noteOpts","icon","browserNote","alert","Notification","permission","requestPermission","addr","send","to","from","isClient","notify","MyersBriggsBit","Totals","QuestionCount","addValue","removeValue","addByCategory","removeByCategory","categoryId","IEL","NSL","TFL","JPL","QuestionID","Reversed","AnsweredAt","getQuestion","unanswer","TotalQuestions","getAnsweredQuestionsIDs","qids","ans","answerQuestion","contextThis","getAnswerIndexForQuestionID","before","DashboardPane","calculateAge","diff","now","age","getUTCFullYear","toLowerCase","toUpperCase","resolveError","nestedName","validator","addTeam","changeName","teamDoc","slug","extend","services","myPostLogout","mySubmitFunc","myPreSubmitFunc","myPostSubmitFunc","info","Accounts","emailTemplates","siteName","verifyEmail","urlWithoutHash","supportEmail","emailBody","sendVerificationEmail","AccountsTemplates","configure","confirmPassword","enablePasswordChange","forbidClientAccountCreation","overrideLoginErrors","lowercaseUsername","focusFirstInput","showAddRemoveServices","showForgotPasswordLink","showLabels","showPlaceholders","showResendVerificationEmailLink","continuousValidation","negativeFeedback","negativeValidation","positiveValidation","positiveFeedback","showValidating","privacyUrl","termsUrl","homeRoutePath","redirectTimeout","defaultTemplate","defaultLayout","defaultContentRegion","defaultLayoutRegions","onLogoutHook","onSubmitHook","preSignUpHook","postSignUpHook","texts","button","signUp","socialSignUp","socialIcons","forgotPwd","inputIcons","isValidating","hasSuccess","configureRoute","path","addFields","required","displayName","func","select","onCreateUser","email","updateAt","profile","first_name","last_name","undefined","isAdmin","validateNewUser","loggedInUser","ex","setDefault","BlazeLayout","ensureEmailVerified","verified","redirect","triggersEnter","ensureSignedIn","render","main","queryParams","token","notFound"],"mappings":"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","file":"/app.js","sourcesContent":["import './header.html';\nimport { User } from '/imports/api/users/users.js';\n\nimport '../../components/questions/questions.js';\nimport '../../components/personality/personality.js';\nimport '../../components/notification_list/notification_list.js';\n\nimport { FlowRouter } from 'meteor/kadira:flow-router';\n\nTemplate.header.onCreated(function() {\n    this.autorun( () => {\n        this.subscription = this.subscribe('userData', this.teamName, {\n            onStop: function () {\n                console.log(\"User header subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"User header subscription ready! \", arguments, this);\n            }\n        });\n    })\n})\nTemplate.header.helpers({\n    userName() {\n        let u = User.findOne( {_id:Meteor.userId()} );\n        if (u) {\n            return u.MyProfile.fullName('');\n        } else {\n            return \"\";\n        }\n    }\n})\nTemplate.header.events({\n    'click a#nav-answerquestions'(event, instance) {\n        event.preventDefault();\n        FlowRouter.go('/questions');\n    },\n    'click a#nav-addquestions'(event, instance) {\n        event.preventDefault();\n        FlowRouter.go('/addQuestions/IE');\n    },\n    'click a#nav-learnshare'(event, instance) {\n        event.preventDefault();\n        FlowRouter.go('/learnShareList');\n    },\n    'click a#nav-teams'(event, instance) {\n        event.preventDefault();\n        FlowRouter.go('/adminTeams');\n    },\n    'click a#nav-goals'(event, instance) {\n        event.preventDefault();\n        FlowRouter.go('/goals');\n    },\n    'click a#nav-traitdesc'(event, instance) {\n        event.preventDefault();\n        FlowRouter.go('/addTraitDescriptions');\n    },\n    'click a#nav-profile'(event, instance) {\n        event.preventDefault();\n        FlowRouter.go('/profile');\n    },\n    'click a.navbar-brand'(event, instance) {\n        event.preventDefault();\n        FlowRouter.go('/dashboard');\n    }\n});\n","import './label_list.html';\n\nTemplate.label_list.onCreated(function () {\n    //\n});\n\nTemplate.label_list.helpers({\n    customClass(item) {\n        if (\"guest\" === item.value.slice(0,5)) {\n            return \"guest\";\n        } else {\n            return \"\";\n        }\n    }\n})\n","import { UserNotify } from '/imports/api/user_notify/user_notify.js';\nimport './notification_list.html';\n\nfunction notificationClickAct(action) {\n    console.log(action);\n    switch (action[0]) {\n    case \"learnshare\":\n        FlowRouter.go('/learnShare/'+action[1]);\n        break;\n    case \"teams\":\n        if (action.length > 1) {\n            FlowRouter.go('/adminTeams/'+action[1]);\n        } else {\n            FlowRouter.go('/adminTeams');\n        }\n        break;\n    case \"teamgoals\":\n        FlowRouter.go('/teamGoals/'+action[1]);\n        break;\n    }\n}\n\nTemplate.notification_list.onCreated(function () {\n    this.autorun( () => {\n        console.log(\"autorunning notification_list...\");\n        this.subscription = this.subscribe('notificationList', Meteor.userId(), {\n            onStop: function () {\n                console.log(\"Notification List subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"Notification List subscription ready! \", arguments, this);\n            }\n        });\n        console.log(this.subscription);\n    });\n});\n\nTemplate.notification_list.helpers({\n    notifications() {\n        let MAX_NOTIFICATIONS = 6;\n        let n = UserNotify.find(\n            {userId: Meteor.userId()},\n            {sort: {createdDate: -1} }\n        );\n        if (n) {\n            let noteList = [];\n            n.forEach(function (note) {\n                if (noteList.length < MAX_NOTIFICATIONS) {\n                    noteList.push(note);\n                } else if (noteList.length === MAX_NOTIFICATIONS) {\n                    noteList.push({\n                        title: \"\",\n                        body: \"See all notifications...\",\n                        isRead: true,\n                        action: \"notifications:all\"\n                    })\n                }\n                if (!note.isPushed) {\n                    if ( (new Date()) - note.createdDate > 1000*60) {\n                        //too old, don't send push notification\n                        note.markNotified();\n                    } else {\n                        note.pushNotify({onclick: function(event) {\n                            let nid = event.target.data;\n                            let un = UserNotify.findOne( {_id:nid} );\n                            un.markRead();\n                            event.target.close();\n                            notificationClickAct(un.action.split(\":\"));\n                        }});\n                        note.markNotified();\n                    }\n                }\n            });\n            return noteList;\n        } else {\n            return [];\n        }\n    },\n    when(note) {\n        let secondsAgo = ( (new Date()) - note.createdDate ) / 1000;\n        if (secondsAgo < 2) {\n            return \"Just now\";\n        } else if (secondsAgo < 60) {\n            return \"s\";\n        } else if (secondsAgo < 60*60) {\n            return parseInt(secondsAgo/60) + \"m\";\n        } else if (secondsAgo < 60*60*24) {\n            return parseInt(secondsAgo/(60*60)) + \"h\";\n        } else if (typeof note.createdDate !== 'undefined'){\n            return note.createdDate.toLocaleDateString(\"en-US\");\n        } else {\n            return \"\";\n        }\n    },\n    read(is) {\n        if (is) {\n            //return \"list-group-item-secondary\";\n            return \"\";\n        } else {\n            return \"list-group-item-info\";\n        }\n    },\n    hasUnread() {\n        let n = UserNotify.find( {userId: Meteor.userId(), isRead: false} );\n        if (n && n.fetch().length) {\n            return \"unread\";\n        } else {\n            return \"\";\n        }\n    }\n});\n\nTemplate.notification_list.events({\n    'click a.notification'(event, instance) {\n        event.preventDefault();\n        let $target = $(event.target);\n        let $li = $target.closest(\"[data-action]\");\n        let noteActionStr = $li.data(\"action\");\n        let nid = $li.data(\"nid\");\n        let noteAction = noteActionStr.split(\":\");\n\n        let un = UserNotify.findOne( {_id:nid} );\n        un.markRead();\n\n        notificationClickAct(noteAction);\n    }\n});\n","import { Question } from '/imports/api/questions/questions.js';\nimport { User, Profile, UserType, MyersBriggs, Answer } from '/imports/api/users/users.js';\nimport { TypeReading } from '/imports/api/type_readings/type_readings.js';\nimport { Meteor } from 'meteor/meteor';\nimport './personality.html';\n\nvar minQuestionsAnswered = 72;\n\nTemplate.personality.onCreated(function () {\n    if (this.data.userId) {\n        this.userId = this.data.userId;\n    } else {\n        this.userId = Meteor.userId();\n    }\n    this.autorun( () => { console.log(\"autorunning...\");\n        this.subscription = this.subscribe('userData', this.userId, {\n            onStop: function () {\n                console.log(\"Subscription stopped! \", arguments, this);\n            }, onReady: function () {\n                console.log(\"Subscription ready! \", arguments, this);\n            }\n        });\n        console.log(this.subscription);\n        this.subscription2 = this.subscribe('typereadings.myReadings', this.userId, {\n            onStop: function () {\n                console.log(\"Readings subscription stopped! \", arguments, this);\n            }, onReady: function () {\n                console.log(\"Readings subscription ready! \", arguments, this);\n            }\n        });\n        console.log(this.subscription2);\n    });\n});\n\nTemplate.personality.helpers({\n    readings() {\n        let tr = TypeReading.find({});\n        console.log(\"1234\",tr.fetch());\n        return tr;\n    },\n    user() {\n        return User.findOne({_id:Template.instance().userId});\n    },\n    isMinMet() {\n        let u = User.findOne({_id:Template.instance().userId});\n        if (!u) return false;\n        console.log(u);\n        if (u.MyProfile.UserType.AnsweredQuestions.length >= minQuestionsAnswered) {\n            return true;\n        } else {\n            return false;\n        }\n        return false;\n    },\n    remainingMinQCount() {\n        let u = User.findOne({_id:Template.instance().userId});\n        console.log(u);\n        if (!u) return -1;\n        let rmn = Math.max(0, (minQuestionsAnswered - u.MyProfile.UserType.AnsweredQuestions.length));\n        console.log(\"yyyyy\",minQuestionsAnswered, u.MyProfile.UserType.AnsweredQuestions.length, rmn);\n        //let rmn = 0;\n        return rmn;\n    },\n    opacityByCategory(category, userObj) {\n        //console.log(category, userObj); //return;\n        if (typeof userObj === \"undefined\") return false;\n        var value = userObj.MyProfile.UserType.Personality[userObj.MyProfile.UserType.Personality.getIdentifierById(category)];\n        //console.log(value);\n        return (Math.abs(value.Value) * 2) / 100;\n    },\n    percentByCategory(category, userObj) {\n        if (typeof userObj === \"undefined\") return false;\n        var value = userObj.MyProfile.UserType.Personality[userObj.MyProfile.UserType.Personality.getIdentifierById(category)];\n        console.log(\"555555\",value);\n        return Math.round(Math.abs(value.Value) * 2);\n    },\n    letterByCategory(category, userObj) {\n        //console.log(category, userObj); //return;\n        if (typeof userObj === \"undefined\") return false;\n        var identifier = userObj.MyProfile.UserType.Personality.getIdentifierById(category);\n        var value = userObj.MyProfile.UserType.Personality[identifier].Value;\n        console.log(category, value, identifier);\n        if (userObj.MyProfile.UserType.AnsweredQuestions.length >= minQuestionsAnswered) {\n            return (value === 0 ? \"?\" : (value < 0 ? identifier.slice(0,1) : identifier.slice(1,2)));\n        } else {\n            return \"?\";\n        }\n    },\n    userImageUrl(userObj) {\n        if (typeof userObj === \"undefined\") return false;\n        return Gravatar.imageUrl(userObj.emails[0].address, { size: 50, default: 'mm' });\n    }\n});\n\nTemplate.personality.events({\n    'click div.personality-display'(event, instance) {\n        console.log('click div.personality-display =>', event, instance);\n        $('#personality-readings').modal('show');\n        //$('.Selected-Category').html(newCat);\n    }\n});\n\nTemplate.singleReading.helpers({\n    getHSize(reading) {\n        console.log(\"asdf\",reading);\n        let count = delta = 0;\n        _.forEach(reading.TypeReadingCategories, (cat) => {\n            if(cat == null) { return; }\n            count++;\n            delta += cat.Range.Delta;\n        });\n        delta /= count;\n        if(!reading.Header) { return \"\"; }\n        if(delta >= 50) { return \"<h1>\"+reading.Header+\"</h1>\"; }\n        if(delta >= 40) { return \"<h2>\"+reading.Header+\"</h2>\"; }\n        if(delta >= 30) { return \"<h3>\"+reading.Header+\"</h3>\"; }\n        if(delta >= 20) { return \"<h4>\"+reading.Header+\"</h4>\"; }\n        if(delta >= 10) { return \"<h5>\"+reading.Header+\"</h5>\"; }\n        return \"<h6>\"+reading.Header+\"</h6>\";\n    }\n});\n","import { Question } from '/imports/api/questions/questions.js';\nimport { User, Profile, UserType, MyersBriggs, Answer } from '/imports/api/users/users.js';\nimport { Meteor } from 'meteor/meteor';\nimport './questions.html';\n\nvar minQuestionsAnswered = 72;\n\nTemplate.questions.onCreated(function () {\n    if (this.data.userId) {\n        this.userId = this.data.userId;\n    } else {\n        this.userId = Meteor.userId();\n    }\n\n    this.autorun( () => { console.log(\"autorunning...\");\n        this.subscription = this.subscribe('questions.toanswer', Meteor.userId(), Session.get('refreshQuestions'), {\n            onStop: function () {\n                console.log(\"Subscription stopped! \", arguments, this);\n            }, onReady: function () {\n                console.log(\"Subscription ready! \", arguments, this);\n            }\n        });\n        console.log(this.subscription);\n    });\n});\n\nTemplate.questions.helpers({\n    questions() {\n        let u = User.findOne({_id:Template.instance().userId});\n        let useg = u.MyProfile.segments;\n        let conditions = [\n            {segments: {$exists:false}},\n            {segments: {$eq:[]}}\n        ];\n        if (useg) {\n            conditions.push({segments: {$in:useg}});\n        }\n        if (!u) return [];\n        console.log(\"kkkkkkkkkkkkkkkk\",u);\n        return Question.find( {$or: conditions} );\n    },\n    reversed(index) {\n        return index % 2;\n    },\n    remainingMinQCount() {\n        let u = User.findOne({_id:Template.instance().userId});\n        console.log(u);\n        console.log(Template.instance().userId);\n        if (!u) return -1;\n        let rmn = Math.max(0, (minQuestionsAnswered - u.MyProfile.UserType.AnsweredQuestions.length));\n        console.log(\"yyyyy\",minQuestionsAnswered, u.MyProfile.UserType.AnsweredQuestions.length, rmn);\n        //let rmn = 0;\n        return rmn;\n    },\n    isRemainingGreaterThan(num) {\n        let u = User.findOne({_id:Template.instance().userId});\n        if (!u) return true;\n        let rmn = Math.max(0, (minQuestionsAnswered - u.MyProfile.UserType.AnsweredQuestions.length));\n        return rmn > num;\n    },\n    getTemplate() { //console.log(this.index, arguments, this);\n        return (this.index % 2) ? Template.questionTemplate : Template.questionTemplateReversed;\n    },\n    answeredQuestionsLength() {\n        let u = User.findOne({_id:Template.instance().userId});\n        let length = u.MyProfile.UserType.AnsweredQuestions.length;\n        //console.log(\"answeredQuestionsLengthhhhhhhhh\", length);\n        return length\n    },\n    totalQuestions() {\n        let u = User.findOne({_id:Template.instance().userId});\n        //console.log(\"myUserID\", u._id);\n        let total = u.MyProfile.UserType.getTotalQuestions();\n        //console.log(\"preTotalQuestions\", total);\n        Meteor.call('question.countQuestions', u._id, (error, result) => {\n            if (error) {\n                //console.log(\"EEERRR0r: \", error);\n            } else {\n                //success\n                //console.log(\"myUserID2\", u._id);\n                total = u.MyProfile.UserType.getTotalQuestions();\n                u.MyProfile.UserType.setTotalQuestions(total);\n                //console.log(\"uiquestionsjstotal\", total);\n                document.getElementById(\"allQuestions\").innerHTML = \"Total questions: \" + result;\n            }\n        });\n        return total;\n    }\n});\n\nTemplate.questions.events({\n    'click button.answer-button'(event, instance) {\n        event.preventDefault();\n        console.log('click button.answer-button => ', event, instance);\n\n        const target = event.target;\n        const parent = $(target).closest('div.answer-question');\n        const values = {\n            'questionId':parent.data('id'),\n            'value':parent.data('value'),\n            'isReversed':!!parent.data('reversed')\n        };\n        console.log(values);\n\n        Meteor.call('question.answer', values.questionId, values.value, values.isReversed, (error) => {\n            if (error) {\n                console.log(\"EEEEEERRRORRRRR: \", error);\n            } else {\n                parent.remove();\n                if($('div.answer-question').length < 1) {\n                    Session.set('refreshQuestions', Math.random());\n                }\n            }\n        });\n    }\n});\nTemplate.question.helpers({\n    getReadingsAsJSON(question) {\n        return JSON.stringify(question.Readings);\n    }\n});\nTemplate.question.onRendered(function() {\n    console.log(\"onRendered\", this);\n    let updateValue = function(elem, value) {\n        let parent = $(elem).data('value', value);\n        parent.find('div.left-option span.percent').html(Math.abs(Math.round(value) - 50)+\"%\");\n        parent.find('div.right-option span.percent').html((Math.round(value) + 50)+\"%\");\n        updateBGOpacity($(elem).find('.left-option'), 0.5 - (value / 100));\n        updateBGOpacity($(elem).find('.right-option'), 0.5 + (value / 100));\n        updateReading(parent, value);\n    };\n    let updateReading = function(elem, value) {\n        let readings = $(elem).data('readings');\n        let index = -1;\n        let curMax = (value < 0 ? -100 : 100);\n        $.each(readings, function (i, reading) {\n            if((value < 0 && reading.Rank <= value && reading.Rank > curMax) || (value > 0 && reading.Rank >= value && reading.Rank < curMax)) {\n                index = i;\n                curMax = reading.Rank;\n            }\n        });\n        if(index < 0) { return; }\n        $(elem).find('div.reading').html(readings[index].Text);\n    };\n    let updateBGOpacity = function(elem, value) {\n        let m;\n        m = $(elem).css('background-color').replace(/^rgba?\\(|\\s+|\\)$/g,'').split(',');\n        let btn = $(elem).parents('div.answer-question').find('button.answer-button');\n        let reading = $(elem).parents('div.answer-question').find('div.reading');\n        reading.css('visibility', 'visible');\n        btn.css('visibility','visible');\n        if(value > 0.5) {\n            $(elem).css('color','white');\n        } else if(value == 0.5) {\n            $(elem).css('color','Grey');\n            btn.css('visibility','hidden');\n            reading.css('visibility','hidden');\n            value = 0.1;\n        } else {\n            $(elem).css('color','black');\n        }\n        let newRGBA = \"rgba(\"+m[0]+\", \"+m[1]+\", \"+m[2]+\", \"+value+\")\";\n        $(elem).css('background-color', newRGBA);\n        //console.log($(elem).css('background-color'), m, newRGBA, value);\n    }\n    $('.slider', this.firstNode).each(function () {\n        $(this).noUiSlider({\n            start: $(this).data('value'),\n            step:1,\n            range: {\n                min:-50,\n                max:50\n            }\n        }).on('slide', function(event, val){ //console.log(arguments);\n            updateValue($(event.target).closest('.answer-question'), val);\n        }).on('set', function(event, val){\n            updateValue($(event.target).closest('.answer-question'), val);\n        });\n        updateValue($(this).closest('.answer-question'), $(this).data('value'));\n    });\n});\n","import './select_autocomplete.html';\n\nTemplate.select_autocomplete.onCreated(function () {\n    //\n});\n\nTemplate.select_autocomplete.onRendered(function () {\n    var self = this;\n    self.autorun( function () {\n        console.log(\"select_autocomplete autorun\");\n        var dat = Template.currentData();\n\n        if (!dat.list || dat.list.length < 1) {\n            return;\n        }\n        var params = {\n            plugins: ['remove_button'],\n            options: dat.list\n        }\n        if (typeof dat.onItemAdd !== \"undefined\") {\n            params.onItemAdd = dat.onItemAdd;\n        }\n        if (typeof dat.onItemRemove !== \"undefined\") {\n            params.onItemRemove = dat.onItemRemove;\n        }\n        if (typeof dat.readOnly !== \"undefined\") {\n            params.readOnly = true;\n            params.plugins = [];\n        }\n        if (typeof dat.create !== \"undefined\") {\n            params.create = true;\n        }\n        let $select = $('#'+dat.id+dat.id2).selectize(params);\n        $select[0].selectize.clear(true);\n        $select[0].selectize.clearOptions();\n        $select[0].selectize.addOption(dat.list);\n        if (\"undefined\" !== typeof dat.selected) {\n\t\tfor (let i in dat.selected) {\n\t\t    let id = dat.selected[i];\n\t\t    if (\"string\" !== typeof id) {\n\t\t        id = id.value;\n\t\t    }\n\t\t    if (\"undefined\" === typeof _.find(dat.list,function(o){return o.value===id})) {\n\t\t        $select[0].selectize.addOption(dat.selected[i]);\n\t\t        $select[0].selectize.addItem(id,true);\n\t\t    } else {\n\t\t        $select[0].selectize.addItem(id,true);\n\t\t    }\n\t\t}\n        }\n        $select[0].selectize.refreshItems();\n    });\n});\n","import { Meteor } from 'meteor/meteor';\nimport { UserFeedback } from '/imports/api/user_feedback/user_feedback.js';\nimport './select_feedback.html';\n\nvar selectedText;\nfunction selectionHandler(event) {\n    if ($(event.target).closest(\".feedback-box\").length) {\n        //click happened inside feedback box, ignore\n        return;\n    }\n    let $box = $(\".feedback-box:visible\");\n    selectedText = window.getSelection().toString();\n    console.log(selectedText);\n    $box.find(\".sf-feedback-context\").html(selectedText);\n    if (selectedText === \"\") {\n        $box.find(\".sf-instruction-selected\").hide();\n        $box.find(\".sf-instruction-begin\").show();\n    } else {\n        $box.find(\".sf-instruction-selected\").show();\n        $box.find(\".sf-instruction-begin\").hide();\n    }\n}\n\nTemplate.select_feedback.onCreated(function () {\n    $(document).on('mouseup', selectionHandler);\n    this.autorun( () => {\n        console.log(\"autorun\", this);\n        this.subscription = this.subscribe('feedback.userComments', {\n            onStop: function () {\n                console.log(\"Subscription stopped! \", arguments, this);\n            }, onReady: function () {\n                console.log(\"Subscription ready! \", arguments, this);\n            }\n        });\n    });\n});\n\nTemplate.select_feedback.onDestroyed(function () {\n    $(document).off('mouseup', selectionHandler);\n});\n\nTemplate.select_feedback.helpers({\n    commentsMade() {\n        let uf = UserFeedback.find({userId:Meteor.userId(),source:Template.instance().data.source}).fetch();\n        console.log(uf);\n        return uf;\n    }\n});\n\nTemplate.select_feedback.events({\n    'keyup .mytextarea'(event, instance) {\n        let $box = $(\".feedback-box:visible\");\n        console.log($box);\n        $box.find(\".feedback-save\").prop(\"disabled\",false);\n    },\n    'click button.feedback-cancel'(event, instance) {\n        console.log(\"cancel\");\n        let $box = $(\".feedback-box:visible\");\n        $box.find(\".sf-instruction-selected\").hide();\n        $box.find(\".sf-instruction-begin\").show();\n    },\n    'click button.feedback-save'(event, instance) {\n        console.log(Template.instance());\n        let $box = $(\".feedback-box:visible\");\n        let fbk = {\n            source: Template.instance().data.source,\n            context: selectedText,\n            comment: $box.find(\".mytextarea\").val()\n        };\n        Meteor.call('feedback.createNewFeedback', fbk, (err,rslt) => {\n            console.log(err,rslt);\n        });\n        $box.find(\".sf-instruction-selected\").hide();\n        $box.find(\".sf-instruction-begin\").show();\n    }\n});\n","import './video_embed.html';\n\nTemplate.video_embed.onCreated(function () {\n    this._fileExists = new ReactiveVar(false);\n    console.log(this.data);\n    this.autorun( () => {\n        Meteor.call('learnshare.recordingExists',this.data.id, (err,rslt) => {\n            this._fileExists.set(rslt);\n        });\n    });\n});\n\nTemplate.video_embed.helpers({\n    fileExists(fname) {\n        return Template.instance()._fileExists.get();\n    }\n});\n","import './body.html';\n","import './login.html';","import { Question } from '/imports/api/questions/questions.js';\nimport { User } from '/imports/api/users/users.js';\nimport { FlowRouter } from 'meteor/kadira:flow-router';\nimport { Meteor } from 'meteor/meteor';\nimport { TypeReading } from '/imports/api/type_readings/type_readings.js';\nimport { UserSegment } from '/imports/api/user_segments/user_segments.js';\nimport './add_questions.html';\n\nTemplate.add_questions.onCreated(function add_questionsOnCreated() {\n    this._category = new ReactiveVar(FlowRouter.getParam('category'));\n    this.category = () => this._category.get();\n    this.convertCategory = (cat) => {\n        if(cat === 'IE') { return 0; }\n        if(cat === 'NS') { return 1; }\n        if(cat === 'TF') { return 2; }\n        if(cat === 'JP') { return 3; }\n        return -1;\n    };\n    this.categoryToIndex = new ReactiveVar(this.convertCategory(this._category.get()));\n    this.categoryCheck = () => {\n        return {\n            IE: this.category() === 'IE',\n            NS: this.category() === 'NS',\n            TF: this.category() === 'TF',\n            JP: this.category() === 'JP'\n        };\n    };\n\n    this.showModal = function(stuff) {\n        let m = $('#tempModal');\n        m.find('h4.modal-title').html(stuff.Title);\n        m.find('div.modal-body').html(stuff.Body);\n        m.find('div.modal-footer button.closebtn').html(stuff.CloseText);\n        m.find('div.modal-footer button.savebtn').html(stuff.SaveText).click(stuff.SaveFunction);\n        _.each(stuff.data, function (name, val) {\n            m.data(name, val);\n        });\n        m.modal('show');\n    };\n    this.fixTabs = () => {\n        let active = $('li[role=presentation].active a').data('type');\n        console.log(active);\n        $('tbody.edit-body').hide();\n        $('#'+active+\"Table\").show();\n    };\n    this.makeModalStuff = function(title, body, closeText, saveText, saveFunction, data) {\n        return {\n            Title: title,\n            Body: body,\n            CloseText: closeText,\n            SaveText: saveText,\n            SaveFunction: saveFunction,\n            data: data\n        };\n    };\n    this.autorun( () => { console.log(\"autorunning...\", this.categoryToIndex.get());\n        this.subscription = this.subscribe('questions.bycategory', this.categoryToIndex.get(), {\n            onStop: function () {\n                console.log(\"Subscription stopped! \", arguments, this);\n            }, onReady: function () {\n                console.log(\"Subscription ready! \", arguments, this);\n            },\n            sort: {createdAt: -1}\n        });\n        console.log(this.subscription);\n        this.subscription3 = this.subscribe('segmentList', this.userId, {\n            onStop: function () {\n                console.log(\"Segment List subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"Segment List subscription ready! \", arguments, this);\n            }\n        });\n        console.log(this.subscription3);\n    });\n});\n\nTemplate.add_questions.helpers({\n    category() {\n        return Template.instance().category();\n    },\n    categoryCheck() {\n        return Template.instance().categoryCheck();\n    },\n    userSegmentList() {\n        let segList = [];\n        let s = UserSegment.find( );\n\n        s.forEach((m) => {\n            segList.push( {\n                value: m._id,\n                text: m.name\n            });\n        });\n        return segList;\n    },\n    assignedUserSegments(q) {\n        console.log(\"sssssssssssss\",q);\n        if (typeof q === \"undefined\") {\n            return [];\n        }\n        let assigned = [];\n\n        for (let i = 0; i < q.segments.length; i++) {\n            let seg = UserSegment.findOne( {_id:q.segments[i]} );\n            assigned.push( {\n                value: q.segments[i],\n                text: seg.name\n            } );\n        }\n        return assigned;\n    },\n    questions() {\n        let x = Question.find({\n            Categories:parseInt(Template.instance().categoryToIndex.get())\n        },{ sort: { createdAt: -1 } });\n        return x;\n    },\n    questionAuthor(question) {\n        let u = User.findOne(question.CreatedBy);\n        return \"<span style='white-space:nowrap;'>\"+u.MyProfile.fullName()+\" <span class='label label-warning'>\"+u.MyProfile.UserType.Personality.getFourLetter()+\"</span></span>\";\n    },\n    getUserName(userId) {\n        let u = User.findOne({_id:userId});\n        u.callMethod('fullName', (err, result) => {\n            console.log(err, result);\n            return result;\n        });\n        //return u.fullName();\n    },\n    indexToCategory(ind) {\n        if(ind === 0) { return 'IE'; }\n        if(ind === 1) { return 'NS'; }\n        if(ind === 2) { return 'TF'; }\n        if(ind === 3) { return 'JP'; }\n        return 'UN';\n    },\n    categoryToIndex(cat) {\n        if(cat === 'IE') { return 0; }\n        if(cat === 'NS') { return 1; }\n        if(cat === 'TF') { return 2; }\n        if(cat === 'JP') { return 3; }\n        return -1;\n    },\n    categoryList() {\n        let categories = [\n            {text:'IE', value:0},\n            {text:'NS', value:1},\n            {text:'TF', value:2},\n            {text:'JP', value:3}\n        ];\n        return categories;\n    },\n    averageAnswer(times, sum) {\n        if(times === 0) { return 0; }\n        return Math.round((Math.abs(sum) / times));\n    },\n    totalAnswers(right, left) {\n        return right + left;\n    },\n    canDelete(question) {\n        return (question.TimesAnswered.LeftSum + question.TimesAnswered.RightSum) < 1;\n    }\n});\n\nTemplate.add_questions.events({\n    'click button.quest-cat-select'(event, instance) {\n        console.log('click button.quest-cat-select =>', event, instance);\n        let newCat = $(event.target).data('category');\n        FlowRouter.go(\"/addQuestions/\"+newCat);\n        instance._category.set(newCat);\n        instance.categoryToIndex.set(instance.convertCategory(newCat));\n        instance.fixTabs();\n    },\n    'click button.dropdown-toggle'(event, instance) {\n        event.preventDefault();\n        console.log('click button.dropdown-toggle => ',event, instance);\n    },\n    'click ul.dropdown-menu li a'(event, instance) {\n        event.preventDefault();\n        console.log('click ul.dropdown-menu li a => ', event, instance);\n        let newCat = $(event.target).html();\n        FlowRouter.go($(event.target).attr('href'));\n        instance._category.set(newCat);\n        instance.categoryToIndex.set(instance.convertCategory(newCat));\n        //$('.Selected-Category').html(newCat);\n        $('[name=Category]').val($(event.target).data('value'));\n        $('button.quest-cat-select.cat-'+newCat).addClass('active');\n        instance.fixTabs();\n    },\n    'click span.toggle-enable'(event, instance) {\n        console.log('click span.toggle-enable => ', event, instance);\n        let qid = $(event.target).closest('tr').data('id');\n        let q = Question.findOne({_id:qid});\n        q.Active = !q.Active;\n        q.save();\n    },\n    'click span.delete'(event, instance) {\n        event.preventDefault();\n        console.log('click span.delete => ', event, instance);\n        const target = event.target;\n        let qid = $(target).data('qid');\n        let vals = instance.makeModalStuff(\"Are you really sure?\", \"<h5>Do you really want to delete the question:</h5><table class='table table-bordered'><tr>\"+$(\"#\"+qid).html()+\"</tr></table>\", \"No!\", \"I guess...\", function (event) {\n            $('#tempModal').modal('hide');\n            $(this).off(event);\n            Meteor.call('question.delete', qid, (error)=> {\n                if(error) { console.log(\"Error on delete: \", error); }\n                else {\n                    console.log(qid+\" should be deleted...\");\n                }\n            });\n        }, {qid:qid});\n        instance.showModal(vals);\n    },\n    'submit #newQuestion'(event, instance) {\n        event.preventDefault();\n        console.log('submit #newQuestion => ', event, instance);\n\n        const target = event.target;\n        const values = {\n            //'Category':target.Category.value,\n            'Categories':$(target).find(\"#select-categories\")[0].selectize.items,\n            'Text':target.Text.value,\n            'LeftText':target.LeftText.value,\n            'RightText':target.RightText.value,\n            'segments':($(target).find(\"#select-segments\")[0].selectize ? $(target).find(\"#select-segments\")[0].selectize.items : [])\n        };\n        console.log(values);\n\n        Meteor.call('question.insert', values.Categories, values.Text, values.LeftText, values.RightText, values.segments, (error) => {\n            if (error) {\n                console.log(\"EEEEEERRRORRRRR: \", error);\n            } else {\n                target.Text.value = '';\n                target.LeftText.value = '';\n                target.RightText.value = '';\n            }\n        });\n    }\n});\n\nTemplate.add_questions.onRendered(function() {\n    $('.dropdown-toggle').dropdown();\n    $('ul.nav-tabs li a').click(function (e) { e.preventDefault(); $(this).tab('show'); $('tbody.edit-body').hide(); $('#'+$(this).data('type')+\"Table\").show(); });\n});\n","import { Question } from '/imports/api/questions/questions.js';\nimport { User } from '/imports/api/users/users.js';\nimport { FlowRouter } from 'meteor/kadira:flow-router';\nimport { Meteor } from 'meteor/meteor';\nimport { TypeReading } from '/imports/api/type_readings/type_readings.js';\nimport './add_readings.html';\n\nTemplate.add_readings.onCreated(function add_readingsOnCreated() {\n        \n    this.showModal = function(stuff) {\n        let m = $('#tempModal');\n        m.find('h4.modal-title').html(stuff.Title);\n        m.find('div.modal-body').html(stuff.Body);\n        m.find('div.modal-footer button.closebtn').html(stuff.CloseText);\n        m.find('div.modal-footer button.savebtn').html(stuff.SaveText).click(stuff.SaveFunction);\n        _.each(stuff.data, function (name, val) {\n            m.data(name, val);\n        });\n        m.modal('show');\n    };\n    this.makeModalStuff = function(title, body, closeText, saveText, saveFunction, data) {\n        return { \n            Title: title,\n            Body: body,\n            CloseText: closeText,\n            SaveText: saveText, \n            SaveFunction: saveFunction,\n            data: data\n        };\n    };\n    this.autorun( () => { \n        this.subscription = this.subscribe('typereadings.getAll', {\n            onStop: function () {\n                console.log(\"Subscription stopped! \", arguments, this);\n            }, onReady: function () {\n                console.log(\"Subscription ready! \", arguments, this);\n            },\n            sort: { \"TypeReadingCategories.Range.Delta\": -1 }\n        });\n        console.log(this.subscription);\n    });\n});\n\nTemplate.add_readings.helpers({\n    readings() {\n        return TypeReading.find({ },{ sort: { \"TypeReadingCategories.Range.low\": 1, \"TypeReadingCategories.Range.Delta\": -1 } });\n    },\n    indexToCategory(ind) {\n        if(ind === 0) { return 'IE'; }\n        if(ind === 1) { return 'NS'; }\n        if(ind === 2) { return 'TF'; }\n        if(ind === 3) { return 'JP'; }\n        return 'UN';\n    },\n    categoryToIndex(cat) {\n        if(cat === 'IE') { return 0; }\n        if(cat === 'NS') { return 1; }\n        if(cat === 'TF') { return 2; }\n        if(cat === 'JP') { return 3; }\n        return -1;\n    },\n    readingHasCategory(reading, category) {\n        return (!!reading.TypeReadingCategories[category]);\n    },\n    readingCategory(reading, category) {\n        if(!reading.TypeReadingCategories[category]) {\n            return \"-\";\n        } else {\n            return \"from \"+reading.TypeReadingCategories[category].Range.low + \" to \" + reading.TypeReadingCategories[category].Range.high;\n        }\n    },\n    getRange(reading, category, isHigh) {\n        if(!reading.TypeReadingCategories[category]) {\n            return \"\";\n        }\n        return (isHigh ? reading.TypeReadingCategories[category].Range.high : reading.TypeReadingCategories[category].Range.low);\n    },\n    readingAuthor(reading) {\n        let u = User.findOne(reading.CreatedBy);\n        return u.MyProfile.fullName()+\" <span class='label label-warning'>\"+u.MyProfile.UserType.Personality.getFourLetter()+\"</span>\";\n    },\n    getUserName(userId) {\n        let u = User.findOne({_id:userId});\n        u.callMethod('fullName', (err, result) => {\n            console.log(err, result);\n            return result;\n        });\n        //return u.fullName();\n    }\n});\n\nTemplate.add_readings.events({\n    'click span.toggle-enable-reading'(event, instance) {\n        console.log('click span.toggle-enable-reading => ', event, instance);\n        let rid = $(event.target).closest('tr').data('id');\n        Meteor.call('typereadings.toggle', rid, (error) => {\n            if(error) { console.log(\"Error on toggle reading: \",error); }\n            else { console.log(rid+\" should be toggled.\"); }\n        });\n    },\n    'click span.delete-reading'(event, instance) {\n        event.preventDefault();\n        console.log('click span.delete-reading => ', event, instance);\n        const target = event.target;\n        let rid = $(target).data('rid');\n        let vals = instance.makeModalStuff(\"Are you really sure?\", \"<h5>Do you really want to delete the reading:</h5><table class='table table-bordered'><tr>\"+$(\"#\"+rid).html()+\"</tr></table>\", \"No!\", \"I guess...\", function (event) {\n            $('#tempModal').modal('hide');\n            $(this).off(event);\n            Meteor.call('typereadings.delete', rid, (error)=> {\n                if(error) { console.log(\"Error on delete: \", error); }\n                else {\n                    console.log(rid+\" should be deleted...\");\n                }\n            });\n        }, {rid:rid});\n        instance.showModal(vals);\n    },\n    'click #addTypeReadingLink'(event, instance) {\n        event.preventDefault();\n        if($('span', event.target).hasClass('glyphicon-chevron-down')) {\n            $('span', event.target).removeClass('glyphicon-chevron-down').addClass('glyphicon-chevron-up');\n            $('div.add-type-reading').slideDown(300);\n        } else {\n            $('span', event.target).removeClass('glyphicon-chevron-up').addClass('glyphicon-chevron-down');\n            $('div.add-type-reading').slideUp(300);\n        }\n    },\n    'click a.readingCategoryLink'(event, instance) {\n        event.preventDefault();\n        var me = $(event.target);\n        var parentData = me.parent().get(0).dataset;\n        var cat = parseInt(parentData.category);\n        var hi  = parentData.high;\n        var low = parentData.low;\n        var mom = me.parents('div.row:first');\n        mom.find('input[name=Category]').val(cat);\n        mom.find('span.readingCategoryDisplay').html(instance.view.template.__helpers[\" indexToCategory\"](cat));\n        mom.find('input[name=Low]').val(low);\n        mom.find('input[name=High]').val(hi);\n        if(!mom.find('.expansion-drawer').is(':visible')) {\n            $('.expansion-drawer').slideUp(300);\n            mom.find('.expansion-drawer').slideDown(300);\n        }\n    },\n    'submit #newReading'(event, instance) {\n        event.preventDefault();\n        console.log('submit #newReading => ', event, instance);\n        \n        const target = event.target;\n        const values = {\n            'Header':target.Header.value,\n            'Body':target.Body.value,\n        };\n        console.log(values);\n\n        Meteor.call('typereadings.insert', values.Header, values.Body, (error) => {\n            if (error) {\n                console.log(\"EEEEEERRRORRRRR: \", error);\n            } else {\n                target.Header.value = '';\n                target.Body.value = '';\n            }\n        });\n    },\n    'submit form.addCategoryToReadingForm'(event, instance) {\n        event.preventDefault();\n        const target = event.target;\n        const values = {\n            Category: target.Category.value,\n            High: target.High.value,\n            Low: target.Low.value,\n            ReadingId: target.readingId.value\n        };\n        Meteor.call('typereadings.addCategoryToReading', values.ReadingId, values.Category, values.High, values.Low, (error) => {\n            if(error) {\n                console.log(\"EEEEEEEEEEERRRRRRRRRRROOOOOOOOORRRRR: \", error);\n            } else {\n                console.log(\"We good, man!\");\n                target.Low.value = '';\n                target.High.value = '';\n            }\n        });\n    }\n});\n\nTemplate.add_readings.onRendered(function() {\n    \n});","import { Team,TeamIcon } from '/imports/api/teams/teams.js';\nimport { TeamGoal } from '/imports/api/team_goals/team_goals.js';\nimport { User } from '/imports/api/users/users.js';\nimport { FlowRouter } from 'meteor/kadira:flow-router';\nimport { Meteor } from 'meteor/meteor';\nimport './admin_teams.html';\nimport '../team_goals/team_goals.js';\nimport '/imports/ui/components/select_autocomplete/select_autocomplete.js';\n\nTemplate.admin_teams.onCreated(function () {\n    if (this.data.teamName) {\n        this.teamName = this.data.teamName;\n    } else if (FlowRouter.getParam('teamName')){\n        this.teamName = FlowRouter.getParam('teamName').split('-').join(' ');\n    } else {\n        this.teamName = '';\n    }\n    console.log(this.teamName,FlowRouter.getParam('teamName'),\"bbbbbbbbbbbbbb\");\n\n    this.autorun( () => {\n        console.log(\"autorunning admin_teams...\");\n        this.subscription = this.subscribe('userList', Meteor.userId(), {\n            onStop: function () {\n                console.log(\"User List subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"User List subscription ready! \", arguments, this);\n            }\n        });\n        console.log(this.subscription);\n        this.subscription2 = this.subscribe('teamMemberList', Meteor.userId(), {\n            onStop: function () {\n                console.log(\"Team Member subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"Team Member subscription ready! \", arguments, this);\n            }\n        });\n        console.log(this.subscription2);\n        this.subscription3 = this.subscribe('teamsData', Meteor.userId(), {\n            onStop: function () {\n                console.log(\"teamsData subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"teamsData subscription ready! \", arguments, this);\n                console.log(Team.find().fetch());\n            }\n        });\n        console.log(this.subscription3);\n    });\n});\n\nTemplate.admin_teams.onRendered(function () {\n    Meteor.setTimeout( function () {\n        $(\"table.table select.selectized\").each(function (s) {\n            this.selectize.on('item_add', function(val, $item) {\n                let userId = $item.closest(\"[data-user-id]\").data(\"user-id\");\n                let teamName = $item.closest(\"[data-team-name]\").data(\"team-name\");\n\n                let t = Team.findOne( {Name: teamName} );\n                t.addRole(userId, val);\n            });\n            this.selectize.on('item_remove', function(val, $item) {\n                let userId = this.$control.closest(\"[data-user-id]\").data(\"user-id\");\n                let teamName = this.$control.closest(\"[data-team-name]\").data(\"team-name\");\n\n                let t = Team.findOne( {Name: teamName} );\n                t.removeRole(userId, val);\n            });\n        });\n    }, 1000);\n});\n\nTemplate.admin_teams.helpers({\n    specificTeam() {\n        if (typeof Template.instance().teamName === 'undefined' || Template.instance().teamName === '') {\n            return false;\n        } else {\n            return true;\n        }\n    },\n    teams() {\n        if (typeof Team === 'undefined') {\n            return false;\n        }\n        let t;\n        if (typeof Template.instance().teamName === 'undefined' || Template.instance().teamName === '') {\n            t = Team.find(  );//.fetch();\n        } else {\n            t = Team.find( {Name:Template.instance().teamName} );//.fetch();\n        }\n        console.log(Template.instance().teamName, t, \"rrrrrrrrrrrr\");\n        let t_invited = [], t_member = [], t_else = [];\n        t.forEach( (team)=> {\n            if (Roles.userIsInRole(Meteor.userId(), 'admin-join-request', team.Name)) {\n                t_invited.push(team);\n            } else if (team.Members.includes(Meteor.userId()) ) {\n                t_member.push(team);\n            } else {\n                t_else.push(team);\n            }\n        });\n        return t_invited.concat(t_member, t_else);\n    },\n    teamsMemberOf() {\n        if (typeof Team === 'undefined') {\n            return false;\n        }\n        let t = Team.find(  );//.fetch();\n        let t_invited = [], t_member = [], t_else = [];\n        t.forEach( (team)=> {\n            if (Roles.userIsInRole(Meteor.userId(), 'admin-join-request', team.Name)) {\n                t_invited.push(team);\n            } else if (team.Members.includes(Meteor.userId()) ) {\n                t_member.push(team);\n            } else {\n                //t_else.push(team);\n            }\n        });\n        if (t_member.length > 1 && !Roles.userIsInRole(Meteor.userId(), 'admin', Roles.GLOBAL_GROUP)) {\n            //if regular user is a member of a team other than \"No Team\", hide \"No Team\" from this view\n            t_member = t_member.filter( (tm) => {\n                return tm.Name !== Team.Default.Name;\n            } );\n        } else {\n            //\n        }\n        return t_invited.concat(t_member, t_else);\n    },\n    teamsOther() {\n        if (typeof Team === 'undefined') {\n            return false;\n        }\n        let t = Team.find(  );//.fetch();\n        let t_invited = [], t_member = [], t_else = [];\n        t.forEach( (team)=> {\n            if (Roles.userIsInRole(Meteor.userId(), 'admin-join-request', team.Name)) {\n                //t_invited.push(team);\n            } else if (team.Members.includes(Meteor.userId()) ) {\n                //t_member.push(team);\n            } else {\n                t_else.push(team);\n            }\n        });\n        return t_invited.concat(t_member, t_else);\n    },\n    teamMembers(teamName) {\n        let teamRole = {};\n        teamRole[\"roles.\"+teamName] = \"member\";\n        let u = User.find( teamRole );\n        if (typeof u === \"undefined\") {\n            return false;\n        }\n        let memberList = [];\n        u.forEach((m) => {\n            memberList.push( {\n                _id: m._id,\n                firstName: m.MyProfile.firstName,\n                lastName: m.MyProfile.lastName,\n                roles: m.roles[teamName]\n            });\n        });\n        return memberList;\n    },\n    uniqueId() {\n        var text = \"\";\n        var idLength = 10;\n        var possible = \"acdeghijklmnopqrstuvwxyzACDEGHIJKLMNOPQRSTUVWXYZ0123456789\";\n\n        for (var i = 0; i < idLength; i++) {\n            text += possible.charAt(Math.floor(Math.random() * possible.length));\n        }\n\n        return text;\n    },\n    teamRequests(teamName) {\n        let teamRole = {};\n        teamRole[\"roles.\"+teamName] = \"user-join-request\";\n        let u = User.find( teamRole );\n\n        if (!u) {\n            return [];\n        }\n\n        let requestList = [];\n        u.forEach((m) => {\n            requestList.push( {\n                _id: m._id,\n                firstName: m.MyProfile.firstName,\n                lastName: m.MyProfile.lastName,\n                roles: \"user-join-request\"\n            })\n        });\n        return requestList;\n    },\n    rolesList() {\n        let roles = [];\n        Roles.getAllRoles().forEach(function (r) {\n            roles.push( {\n                text: r.name,\n                value: r.name\n            } );\n        });\n        return roles;\n    },\n    users() {\n        return User.find().fetch();\n    },\n    userAddList(teamName) {\n        let t = Team.findOne( {Name: teamName} );\n        let memberList = [];\n        if (t) {\n            memberList = t.Members;\n        }\n        let u = User.find({_id: {'$nin': memberList}});\n        let addList = [];\n        u.forEach((m) => {\n            addList.push( {\n                value: m._id,\n                text: m.MyProfile.firstName + \" \" + m.MyProfile.lastName\n            });\n        });\n        return addList;\n    },\n});\n\nfunction teamChanged($g) {\n    $g.find(\".btn-save\").prop(\"disabled\",false);\n    $g.find(\".btn-cancel\").prop(\"disabled\",false);\n}\nfunction teamUnchanged($g) {\n    $g.find(\".btn-save\").prop(\"disabled\",true);\n    $g.find(\".btn-cancel\").prop(\"disabled\",true);\n    $g.find(\".changed\").removeClass(\"changed\");\n}\nfunction saveTeam(teamId) {\n    let saveObj = {\n        Name: $(\"#team-title-\"+teamId).val(),\n        Description: $(\"#team-description-\"+teamId).val()\n    };\n    let t = Team.findOne( {_id:teamId} );\n    if (t) {\n        t.updateFromObj(saveObj);\n    }\n}\n\nTemplate.admin_teams.events({\n    'change .file-upload-input'(event, instance) {\n        var file = event.currentTarget.files[0];\n        var reader = new FileReader();\n        reader.onload = function(fileLoadEvent) {\n            let teamId = $(event.target).closest(\"[data-team-id]\").data(\"team-id\");\n            let t = Team.findOne({_id: teamId});\n            t.uploadIcon(file, reader.result);\n        };\n        reader.readAsBinaryString(file);\n    },\n    'change input.flat,textarea.flat'(event, instance) {\n        $(event.target).addClass('changed');\n        let $team = $(event.target).closest(\"[data-team-id]\");\n    },\n    'change input,textarea,select'(event, instance) {\n        let $t = $(event.target);\n        let $team = $(event.target).closest(\"[data-team-id]\");\n        teamChanged($team);\n    },\n    'keyup input,textarea'(event, instance) {\n        let $t = $(event.target);\n        let $team = $(event.target).closest(\"[data-team-id]\");\n        teamChanged($team);\n    },\n    'click button.btn-save'(event, instance) {\n        let $t = $(event.target);\n        let teamId = $t.closest(\"[data-team-id]\").data(\"team-id\");\n        saveTeam(teamId);\n        teamUnchanged($(\"#div-team-\"+teamId));\n    },\n    'click button#btn-create-team'(event, instance) {\n        let newTeamName = $(\"#input-new-team-name\").val();\n        if (\"\" === newTeamName) {\n            $(\"#msg-create\").removeClass(\"alert-success\").addClass(\"alert-danger\").html(\"Team name required\").css(\"display\",\"inline-block\");\n            return;\n        }\n        let newTeamDescription = $(\"#input-new-team-description\").val();\n        let newTeam = { Name: newTeamName, Description: newTeamDescription };\n        Meteor.call('team.createNewTeam', newTeam, function (err, rslt) {\n            if (!err) {\n                $(\"#div-new-team-details\").slideUp();\n                $(\"#input-new-team-name\").val(\"\");\n                $(\"#msg-create\").removeClass(\"alert-danger\").addClass(\"alert-success\").html(\"Team created!\").css(\"display\",\"inline-block\");\n                $(\"#input-new-team-name\").closest(\".input-group\").removeClass(\"has-error\").removeClass(\"has-feedback\");\n            } else {\n                console.log(err);\n                $(\"#input-new-team-name\").closest(\".input-group\").addClass(\"has-error\").addClass(\"has-feedback\");\n                $(\"#msg-create\").removeClass(\"alert-success\").addClass(\"alert-danger\").html(\"Duplicate team name\").css(\"display\",\"inline-block\");\n                if (err.error === 409) {\n                    console.log(\"duplicate\");\n                }\n            }\n            Meteor.setTimeout(function () {\n                $(\"#msg-create\").fadeOut();\n            }, 5000);\n        });\n    },\n    'focus #form-new-team'(event, instance) {\n        $(\"#div-new-team-details\").slideDown();\n    },\n    'blur #form-new-team'(event, instance) {\n        console.log(\"triggered div blur\");\n    },\n    'click .dropdown-menu.add-users'(event, instance) {\n        event.stopPropagation();\n    },\n    'click button.btn-add-users-save'(event, instance) {\n        let $select = $(event.target).closest(\".dropdown-menu\").find(\".selectized\");\n        let teamId = $(event.target).closest(\"[data-team-id]\").data(\"team-id\");\n        let t = Team.findOne({_id: teamId});\n        let userList = $select[0].selectize.items;\n\n        t.adminRequestUserJoin(userList);\n\n        $select[0].selectize.clear(true);\n        $(event.target).closest(\".dropdown\").toggleClass('open');\n    },\n    'click button.btn-add-users-cancel'(event, instance) {\n        let $select = $(event.target).closest(\".dropdown-menu\").find(\".selectized\");\n        $select[0].selectize.clear(true);\n        $(event.target).closest(\".dropdown\").toggleClass('open');\n    },\n    'click button.btn-add-users'(event, instance) {\n        //show add-user widget\n    },\n    'click button.btn-accept-join'(event, instance) {\n        let teamId = $(event.target).data(\"team-id\");\n        let t = Team.findOne({_id: teamId});\n        t.userAcceptJoin();\n    },\n    'click button.btn-decline-join'(event, instance) {\n        let teamId = $(event.target).data(\"team-id\");\n        let t = Team.findOne({_id: teamId});\n        t.userDeclineJoin();\n    },\n    'click a.btn-admin-request-join'(event, instance) {\n        event.preventDefault();\n        let userId = $(event.target).closest(\"[data-user-id]\").data(\"user-id\");\n        let teamId = $(event.target).closest(\"[data-team-id]\").data(\"team-id\");\n        let t = Team.findOne({_id: teamId});\n        t.adminRequestUserJoin(userId);\n    },\n    'click button.btn-user-request-join'(event, instance) {\n        event.preventDefault();\n        let teamId = $(event.target).data(\"team-id\");\n        let t = Team.findOne({_id: teamId});\n        t.userRequestJoin();\n    },\n    'click a.btn-approve-join'(event, instance) {\n        event.preventDefault();\n        let userId = $(event.target).data(\"user-id\");\n        let teamId = $(event.target).closest(\"[data-team-id]\").data(\"team-id\");\n        let t = Team.findOne( {_id: teamId} );\n        t.adminAcceptJoin(userId);\n    },\n    'click a.btn-decline-join'(event, instance) {\n        event.preventDefault();\n        let userId = $(event.target).data(\"user-id\");\n        let teamId = $(event.target).closest(\"[data-team-id]\").data(\"team-id\");\n        let t = Team.findOne( {_id: teamId} );\n        t.adminRejectJoin(userId);\n    },\n    'click button.btn-remove-user-role'(event, instance) {\n        event.preventDefault();\n        let userId = $(event.target).closest(\"[data-user-id]\").data(\"user-id\");\n        let teamId = $(event.target).closest(\"[data-team-id]\").data(\"team-id\");\n        let role = $(event.target).closest(\"[data-role]\").data(\"role\");\n    },\n    'click div.team-goal-quick-list'(event, instance) {\n        let teamName = $(event.target).closest(\"[data-team-name]\").data(\"team-name\");\n        if (teamName) {\n            FlowRouter.go(\"/teamGoals/\"+teamName.split(\" \").join(\"-\"));\n        }\n    },\n    'click button.btn-expand,div.collapsed-summary'(event, instance) {\n        let $target = $(event.target);\n        let $teamContainer = $target.closest(\"[data-team-id]\");\n        let $targetExpandBtn = $teamContainer.find(\".btn-expand.glyphicon\");\n\n        $targetExpandBtn.removeClass(\"glyphicon-chevron-up\")\n            .addClass(\"glyphicon-chevron-down\");\n\n        if ($teamContainer.hasClass(\"collapsed\")) {\n            $(\".team-view[data-team-id]:not(.collapsed)\").slideUp(function() {\n                $(this).addClass(\"collapsed\").css(\"display\",\"block\");\n            });\n            $teamContainer.css(\"display\",\"none\").removeClass(\"collapsed\").slideDown(function () {\n                $('html, body').animate({\n                    scrollTop: ($teamContainer.offset().top)\n                },500);\n            });\n            $targetExpandBtn.removeClass(\"glyphicon-chevron-down\");\n            $targetExpandBtn.addClass(\"glyphicon-chevron-up\");\n        } else {\n            $teamContainer.slideUp(function() {\n                $teamContainer.addClass(\"collapsed\").css(\"display\",\"block\");\n            });\n            $targetExpandBtn.removeClass(\"glyphicon-chevron-up\");\n            $targetExpandBtn.addClass(\"glyphicon-chevron-down\");\n        }\n    },\n    'click tr[data-user-id]'(event, instance) {\n        if (!$(event.target).closest(\".selectize-control\").length) {\n            let $target = $(event.target).closest(\"[data-user-id]\");\n            let uid = $target.data(\"user-id\");\n            FlowRouter.go(\"/profile/\"+uid);\n        }\n    }\n});\n\nTemplate.team_view.helpers ({\n    fldEnabled(fld) {\n        let team = Template.instance().data.team;\n        //let t = TeamGoal.findOne( {_id: team._id} );\n\n        //if (!t) {\n            if (Roles.userIsInRole(Meteor.userId(), 'admin', team.Name)) {\n                return \"\";\n            } else {\n                return \"disabled\";\n            }\n        //}\n\n        if (g.hasModifyPerm(fld)) {\n            return \"\";\n        } else {\n            return \"disabled\";\n        }\n    },\n    iconData64() {\n        let team = Template.instance().data.team;\n        let t = Team.findOne( {_id: team._id} );\n        return team.Icon64;\n    },\n    teamMembers(teamName) {\n        let teamRole = {};\n        teamRole[\"roles.\"+teamName] = \"member\";\n        let u = User.find( teamRole );\n        if (typeof u === \"undefined\") {\n            return false;\n        }\n        let memberList = [];\n        u.forEach((m) => {\n            memberList.push( {\n                _id: m._id,\n                firstName: m.MyProfile.firstName,\n                lastName: m.MyProfile.lastName,\n                roles: m.roles[teamName]\n            });\n        });\n        return memberList;\n    },\n    hasTeamRequests(teamName) {\n        let teamRole = {};\n        teamRole[\"roles.\"+teamName] = \"user-join-request\";\n        let u = User.find( teamRole );\n\n        if (!u || u.count() == 0) {\n            return false;\n        } else {\n            return true;\n        }\n    },\n    teamRequests(teamName) {\n        let teamRole = {};\n        teamRole[\"roles.\"+teamName] = \"user-join-request\";\n        let u = User.find( teamRole );\n\n        if (!u) {\n            return [];\n        }\n\n        let requestList = [];\n        u.forEach((m) => {\n            requestList.push( {\n                _id: m._id,\n                firstName: m.MyProfile.firstName,\n                lastName: m.MyProfile.lastName,\n                roles: \"user-join-request\"\n            })\n        });\n        return requestList;\n    },\n    hasTeamInvites(teamName) {\n        let teamRole = {};\n        teamRole[\"roles.\"+teamName] = \"admin-join-request\"\n        let u = User.find( teamRole );\n\n        if (!u || u.count() == 0) {\n            return false;\n        } else {\n            return true;\n        }\n    },\n    teamInvites(teamName) {\n        let teamRole = {};\n        teamRole[\"roles.\"+teamName] = \"admin-join-request\"\n        let u = User.find( teamRole );\n\n        if (!u) {\n            return [];\n        }\n\n        let inviteList = [];\n        u.forEach((m) => {\n            inviteList.push( {\n                _id: m._id,\n                firstName: m.MyProfile.firstName,\n                lastName: m.MyProfile.lastName,\n                roles: \"admin-join-request\"\n            })\n        });\n        return inviteList;\n    },\n    rolesList() {\n        let roles = [];\n        Roles.getAllRoles().forEach(function (r) {\n            roles.push( {\n                text: r.name,\n                value: r.name\n            } );\n        });\n        return roles;\n    },\n    uniqueId() {\n        var text = \"\";\n        var idLength = 10;\n        var possible = \"acdeghijklmnopqrstuvwxyzACDEGHIJKLMNOPQRSTUVWXYZ0123456789\";\n\n        for (var i = 0; i < idLength; i++) {\n            text += possible.charAt(Math.floor(Math.random() * possible.length));\n        }\n\n        return text;\n    },\n    userAddList(teamName) {\n        let t = Team.findOne( {Name: teamName} );\n        let memberList = [];\n        if (t) {\n            memberList = t.Members;\n        }\n        let u = User.find({_id: {'$nin': memberList}});\n        let addList = [];\n        u.forEach((m) => {\n            addList.push( {\n                value: m._id,\n                text: m.MyProfile.firstName + \" \" + m.MyProfile.lastName\n            });\n        });\n        return addList;\n    },\n\n});\n","import { Question } from '/imports/api/questions/questions.js';\nimport { User, Profile, UserType, MyersBriggs, Answer } from '/imports/api/users/users.js';\nimport { Meteor } from 'meteor/meteor';\nimport './ask_questions.html';\nimport '../../components/questions/questions.js';\nimport '../../components/personality/personality.js';\n\n\n\n\nTemplate.ask_questions.helpers({\n    answeredQuestionsLength() {\n        let u = User.findOne({_id:Template.instance().userId});\n        return u.MyProfile.UserType.AnsweredQuestions.length;\n    }\n});\n","import './dash_min.html';\n\nTemplate.dash_min.events({\n    'click button.questions'(event, instance) {\n        FlowRouter.go('/questions');\n    },\n    'click button.learnshare'(event, instance) {\n        FlowRouter.go('/learnShareList');\n    },\n    'click button.user-segments'(event, instance) {\n        FlowRouter.go('/userSegments');\n    }\n});\n","import './home.html';\n\nimport '../../components/questions/questions.js';\nimport '../../components/personality/personality.js';\n","import { Meteor } from 'meteor/meteor';\nimport { User } from '/imports/api/users/users.js';\nimport { Team } from '/imports/api/teams/teams.js';\nimport { IndividualGoal } from '/imports/api/individual_goals/individual_goals.js';\nimport './individual_goals.html';\nimport '/imports/ui/components/select_autocomplete/select_autocomplete.js';\n\nconst BLANK_GOAL = {\n    _id: \"new\",\n    title: \"\",\n    description: \"\"\n};\n\nlet _hasSubgoalView = new ReactiveVar(false);\nlet _subgoalId = new ReactiveVar(\"\");\nTemplate.individual_goals.onCreated(function () {\n    if (FlowRouter.getParam('userId')) {\n        this.userId = FlowRouter.getParam('userId');\n    } else {\n        this.userId = Meteor.userId();\n    }\n    Session.set(\"goal_user_id\",this.userId);\n    Session.set(\"goalReload\",false);\n\n    this.userSubscriptionReady = new ReactiveVar( false );\n    this.autorun( () => {\n        this.modalGoalId = FlowRouter.getParam('goalId');\n        if (\"undefined\" !== typeof this.modalGoalId && \"\" !== this.modalGoalId) {\n            _hasSubgoalView.set(true);\n            _subgoalId.set(FlowRouter.getParam('goalId'));\n            $(\"body\").on(\"hidden.bs.modal\", \"#goal-modal-sub\", function () {\n                _hasSubgoalView.set(false);\n                _subgoalId.set(\"\");\n                FlowRouter.go(\"/individualGoals/\"+FlowRouter.getParam('teamName'));\n            });\n            Meteor.setTimeout(function () {\n                $(\"#goal-modal-sub\").modal(\"show\");\n                $(\"#goal-modal-sub\").find(\"div.team-goal\").removeClass(\"collapsed\");\n            }, 1000);\n        }\n        this.subscription = this.subscribe('individualGoalsData', getUserId(), {\n            onStop: function () {\n                console.log(\"Team Goals subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"Team Goals subscription ready! \", arguments, this);\n            }\n        });\n        this.subscription2 = this.subscribe('userList', Meteor.userId(), {\n            onStop: function () {\n                console.log(\"User List subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"User List subscription ready! \", arguments, this);\n            }\n        });\n        this.subscription3 = this.subscribe('teamsMemberOfList', getUserId(), {\n            onStop: function () {\n                console.log(\"Team Member Of List subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"Team Member Of List subscription ready! \", arguments, this);\n            }\n        });\n        console.log(this.subscription2);\n    });\n});\nTemplate.individual_goals.onRendered(function () {\n    Meteor.setTimeout(function() {\n        $(\"input.date\").datetimepicker({\n            format:'YYYY-MM-DD',\n            useCurrent:false,\n            showClear:true,\n            showClose:true\n        });\n    }, 1000);\n    $(\"body\").on(\"hidden.bs.modal\", \"#goal-modal-new\", function () {\n        $newgoal = $(\"#div-goal-new\").detach();\n        $newgoal.data(\"parent-id\",\"\");\n        $(\"#blank-goal\").find(\".col-sm-12\").append($newgoal);\n    });\n});\n\nvar resetNewGoalForm = () => {\n    let valInputs = [\n        \"goal-title-new\",\n        \"goal-description-new\",\n        \"input-date-due-new\",\n        \"input-date-review-new\",\n        \"input-date-reached-new\",\n    ];\n    for (let i = 0; i < valInputs.length; i++) {\n        $(\"#\"+valInputs[i]).val(\"\");\n    }\n};\n\nfunction saveGoal(goalId) {\n    let saveObj = {\n        title: $(\"#goal-title-\"+goalId).val(),\n        description: $(\"#goal-description-\"+goalId).val(),\n        userId: getUserId(),\n        teamId: $(\"#select-team-\"+goalId).val(),\n        privacy: $(\"#select-privacy-\"+goalId).val()\n    };\n    let startDate = $(\"#input-start-date-\"+goalId).val();\n    if (\"\" !== startDate) {\n        saveObj.startDate = new Date(startDate);\n    }\n    let dueDate = $(\"#input-date-due-\"+goalId).val();\n    if (\"\" !== dueDate) {\n        saveObj.dueDate = new Date(dueDate);\n    }\n    let rvwDate = $(\"#input-date-review-\"+goalId).val();\n    if (\"\" !== rvwDate) {\n        saveObj.reviewDate = new Date(rvwDate);\n    }\n\n    if (goalId === BLANK_GOAL._id) {\n        let parentId = $(\"#div-goal-new\").data(\"parent-id\");\n        if (\"\" !== parentId) {\n            saveObj.parentId = parentId;\n        }\n        Meteor.call('individualgoals.createNewGoal', saveObj, function (err, rslt) {\n            console.log(err, rslt);\n        });\n    } else {\n        let g = IndividualGoal.findOne( {_id: goalId} );\n        let reviewedOnDate = $(\"#input-date-reviewed-on-\"+goalId).val();\n        if (\"\" !== reviewedOnDate) {\n            saveObj.reviewedOnDate = new Date(reviewedOnDate);\n        }\n        let reachedDate = $(\"#input-date-reached-\"+goalId).val();\n        if (\"\" !== reachedDate) {\n            saveObj.reachedDate = new Date(reachedDate);\n        }\n\n        g.updateFromObj(saveObj);\n    }\n}\n\nfunction goalChanged($g) {\n    $g.find(\".btn-save\").prop(\"disabled\",false);\n    $g.find(\".btn-cancel\").prop(\"disabled\",false);\n}\nfunction goalUnchanged($g) {\n    $g.find(\".btn-save\").prop(\"disabled\",true);\n    $g.find(\".btn-cancel\").prop(\"disabled\",true);\n    $g.find(\".changed\").removeClass(\"changed\");\n}\n\nTemplate.individual_goals.events({\n    'change input.flat,textarea.flat'(event, instance) {\n        $(event.target).addClass('changed');\n        let $goal = $(event.target).closest(\"[data-goal-id]\");\n        if ($goal) {\n            if ($(\"#goal-title-\"+$goal.data(\"goal-id\")).val() != \"\") {\n                //\n            }\n        }\n    },\n    'change input,textarea,select'(event, instance) {\n        let $t = $(event.target);\n        let $goal = $(event.target).closest(\"[data-goal-id]\");\n        goalChanged($goal);\n    },\n    'keyup input,textarea'(event, instance) {\n        let $t = $(event.target);\n        let $goal = $(event.target).closest(\"[data-goal-id]\");\n        goalChanged($goal);\n    },\n    'click button.btn-save'(event, instance) {\n        let $t = $(event.target);\n        let goalId = $t.closest(\"[data-goal-id]\").data(\"goal-id\");\n        saveGoal(goalId);\n        goalUnchanged($(\"#div-goal-\"+goalId));\n\n        $modalParent = $t.closest(\".modal\");\n        if ($modalParent.length) {\n            $modalParent.modal('hide');\n            $newgoal = $(\"#div-goal-new\").detach();\n            $newgoal.data(\"parent-id\",\"\");\n            $(\"#blank-goal\").find(\".col-sm-12\").html($newgoal);\n        }\n        if (goalId == BLANK_GOAL._id) {\n            resetNewGoalForm();\n            if ( ! $modalParent.length ) {\n                $(\".goal-controls\").show();\n                $(\"#blank-goal\").slideUp();\n            }\n        }\n    },\n    'click button.btn-add-subgoal'(event, instance) {\n        let parentId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n        $newgoal = $(\"#div-goal-new\").detach();\n        $newgoal.data(\"parent-id\",parentId);\n        $newgoal.find(\".btn-cancel\").attr(\"disabled\",false);\n        $(\"#goal-modal-new\").find(\".modal-body\").append($newgoal);\n        $(\"#goal-modal-new\").modal(\"show\");\n        $(\"#goal-modal-new\").find(\"div.team-goal\").removeClass(\"collapsed\");\n    },\n    'click button.btn-cancel'(event, instance) {\n        let $t = $(event.target);\n        let goalId = $t.closest(\"[data-goal-id]\").data(\"goal-id\");\n\n        $modalParent = $t.closest(\".modal\");\n        if ($modalParent.length) {\n            $modalParent.modal('hide');\n            $newgoal = $(\"#div-goal-new\").detach();\n            $newgoal.data(\"parent-id\",\"\");\n            $(\"#blank-goal\").find(\".col-sm-12\").append($newgoal);\n        }\n\n        if (goalId == BLANK_GOAL._id) {\n            resetNewGoalForm();\n            if ( ! $modalParent.length ) {\n                $(\".goal-controls\").show();\n                $(\"#blank-goal\").slideUp();\n            }\n        } else {\n            //forces a reload from the database\n            Session.set(\"goalReload\",true);\n            Meteor.setTimeout(function () {\n                Session.set(\"goalReload\",false);\n            }, 100);\n        }\n    },\n    'click button.btn-comment-add'(event, instance) {\n        $btnAdd = $(event.target);\n\n        let goalId = $btnAdd.closest(\"[data-goal-id]\").data(\"goal-id\");\n        let $comment = $(\"#new-comment-\"+goalId);\n        let newComment = $comment.val();\n        let g = IndividualGoal.findOne( {_id: goalId} );\n        g.addComment(newComment);\n        $comment.val(\"\");\n    },\n    'click button.btn-review-comment-add'(event, instance) {\n        $btnAdd = $(event.target);\n\n        let goalId = $btnAdd.closest(\"[data-goal-id]\").data(\"goal-id\");\n        let $comment = $(\"#new-review-comment-\"+goalId);\n        let newComment = $comment.val();\n        let g = IndividualGoal.findOne( {_id: goalId} );\n        g.addReviewComment(newComment);\n        $comment.val(\"\");\n    },\n    'click button#btn-add-goal'(event, instance) {\n        let $btnAdd = $(event.target);\n        $goal = $btnAdd.closest(\"[data-goal-id]\")\n        let goalId = $goal.data(\"goal-id\");\n\n        $(\".goal-controls\").hide();\n        let $btnCancel = $(\"#blank-goal\").find(\".btn-cancel\")\n        $btnCancel.prop(\"disabled\",false);\n        $(\".team-goal[data-goal-id=\"+goalId+\"]\").removeClass(\"collapsed\");\n        $(\"#blank-goal\").slideDown();\n        $(\"#btn-add-cancel\").fadeIn();\n    },\n    'click button#btn-add-cancel'(event, instance) {\n        $(\"#blank-goal\").slideUp();\n        $(\"#btn-add-cancel\").fadeOut();\n    },\n    'click button.btn-expand,div.collapsed-summary'(event, instance) {\n        let $target = $(event.target);\n        let $goalContainer = $target.closest(\"[data-goal-id]\");\n        let $targetExpandBtn = $goalContainer.find(\".btn-expand.glyphicon\");\n\n        $targetExpandBtn.removeClass(\"glyphicon-chevron-up\")\n            .addClass(\"glyphicon-chevron-down\");\n\n        if ($goalContainer.hasClass(\"collapsed\")) {\n            $(\".team-goal[data-goal-id]:not(.collapsed)\").slideUp(function() {\n                $(this).addClass(\"collapsed\").css(\"display\",\"block\");\n            });\n            $goalContainer.css(\"display\",\"none\").removeClass(\"collapsed\").slideDown(function () {\n                $('html, body').animate({\n                    scrollTop: ($goalContainer.offset().top)\n                },500);\n            });\n            $targetExpandBtn.removeClass(\"glyphicon-chevron-down\");\n            $targetExpandBtn.addClass(\"glyphicon-chevron-up\");\n        } else {\n            $goalContainer.slideUp(function() {\n                $goalContainer.addClass(\"collapsed\").css(\"display\",\"block\");\n            });\n            $targetExpandBtn.removeClass(\"glyphicon-chevron-up\");\n            $targetExpandBtn.addClass(\"glyphicon-chevron-down\");\n        }\n    },\n    'keyup textarea.goal-description,input.goal-title':_.debounce(function (event, instance) {\n        let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n        if (\"new\" === goalId) {\n            //don't auto-save if creating a new goal\n            return;\n        }\n        saveGoal(goalId);\n        goalUnchanged($(\"#div-goal-\"+goalId));\n    }, 2000),\n    'change input,select':_.debounce(function (event, instance) {\n        if (!Session.get(\"saving\")) {\n            let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n            if (\"new\" === goalId) {\n                //don't auto-save if creating a new goal\n                return;\n            }\n            saveGoal(goalId);\n            goalUnchanged($(\"#div-goal-\"+goalId));\n        }\n    }, 2000),\n    'dp.change':_.debounce(function (event, instance) {\n        if (!Session.get(\"saving\")) {\n            let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n            if (\"new\" === goalId) {\n                //don't auto-save if creating a new goal\n                return;\n            }\n            saveGoal(goalId);\n            goalUnchanged($(\"#div-goal-\"+goalId));\n        }\n    }, 2000),\n    'click div.team-goal-title[data-id]'(event, instance) {\n        _hasSubgoalView.set(true);\n        let gid = $(event.target).data(\"id\");\n        _subgoalId.set(gid);\n        FlowRouter.go(\"/individualGoals/\"+FlowRouter.getParam('teamName')+\"/\"+gid);\n        $(\"#goal-modal-sub\").prop(\"disabled\",false).modal(\"show\");\n    }\n});\n\nfunction getUserId() {\n    return Session.get(\"goal_user_id\");\n}\nTemplate.individual_goals.helpers({\n    goalReload() {\n        return Session.get(\"goalReload\");\n    },\n    hasGoals() {\n        let uid = getUserId();\n        let g = IndividualGoal.find( {userId: uid, parentId: ''} ).fetch();\n        return g.length > 0;\n    },\n    hasGoalsTeam(tid) {\n        let uid = getUserId();\n        let g = IndividualGoal.find( {userId: uid, parentId: '', teamId: tid} ).fetch();\n        return g.length > 0;\n    },\n    individualGoals() {\n        let uid = getUserId();\n        let g = IndividualGoal.find( {userId: uid, parentId: ''} ).fetch();\n        return g;\n    },\n    individualGoalsTeam(tid) {\n        let uid = getUserId();\n        let g = IndividualGoal.find( {userId: uid, parentId: '', teamId: tid} ).fetch();\n        return g;\n    },\n    ownList() {\n        //check to see if the user logged in is the owner of the goals currently displayed\n        return (Meteor.userId() === getUserId());\n    },\n    blankGoal() {\n        return Object.assign({userId: getUserId()}, BLANK_GOAL);\n    },\n    hasSubgoalView() {\n        let hasView = _hasSubgoalView.get();\n        let gid = _subgoalId.get();\n        if (hasView) {\n            return true;\n        } else {\n            return false;\n        }\n    },\n    subgoal() {\n        let hasView = _hasSubgoalView.get();\n        let subgoalId = Template.instance().modalGoalId;\n        subgoalId = _subgoalId.get();\n        let g = IndividualGoal.findOne( {_id: subgoalId} );\n        if (g) {\n            return g;\n        } else {\n            return {};\n        }\n    },\n    goalComments(goalId) {\n        let g = IndividualGoal.findOne( {_id: goalId} );\n        if (!g) {\n            return;\n        }\n        let c = g.goalComments;\n        return c;\n    },\n    reviewComments(goalId) {\n        let g = IndividualGoal.findOne( {_id: goalId} );\n        if (!g) {\n            return;\n        }\n        let c = g.reviewComments;\n        return c;\n    },\n    formatDate(dateObj) {\n        return dateObj.toLocaleDateString();\n    },\n    getUserName(userId) {\n        let u = User.findOne( {_id: userId} );\n        if (!u) return \"\";\n        let fullName = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n        return fullName;\n    },\n    userList() {\n        let list = [\n            {id: 1, name: \"George\"},\n            {id: 2, name: \"Frank\"}\n        ];\n        return list;\n    },\n    teamList() {\n        //list of teams the user is a member of\n        let t = Team.find( {Members: getUserId()} );\n        if (!t) {\n            return [];\n        }\n        return t.fetch();\n    },\n});\n\n//Template.igoal_view.onRendered(function () {\n//});\n\nTemplate.igoal_view.helpers({\n    childGoals() {\n        let goalId = Template.instance().data.goal._id;\n        let children = IndividualGoal.find( {parentId: goalId} ).fetch();\n        return children;\n    },\n    hasChildren() {\n        let goalId = Template.instance().data.goal._id;\n        let doesHave = IndividualGoal.find( {parentId: goalId} ).fetch().length > 0;\n        return doesHave;\n    },\n    goalComments(goalId) {\n        if (goalId === BLANK_GOAL._id) {\n            return;\n        }\n        let g = IndividualGoal.findOne( {_id: goalId} );\n        if (!g) {\n            return;\n        }\n        let c = g.goalComments;\n        return c;\n    },\n    reviewComments(goalId) {\n        if (goalId === BLANK_GOAL._id) {\n            return;\n        }\n        let g = IndividualGoal.findOne( {_id: goalId} );\n        if (!g) {\n            return;\n        }\n        let c = g.reviewComments;\n        return c;\n    },\n    formatDate(dateObj) {\n        return dateObj.toLocaleDateString();\n    },\n    dateField(fld) {\n        let goal = Template.instance().data.goal;\n        if (goal._id == BLANK_GOAL._id) {\n            return \"\";\n        }\n        let d = goal[fld];\n        if ( !(d instanceof Date) ) {\n            return \"\";\n        }\n        let dateText = new Date(d.getTime() - d.getTimezoneOffset()*60000).toISOString().slice(0,-1);\n        return dateText;\n    },\n    getUserName(userId) {\n        let u = User.findOne( {_id: userId} );\n        if (!u) return \"\";\n        let fullName = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n        return fullName;\n    },\n    userList() {\n        let userList = [];\n        User.find( {} ).forEach( (user) => {\n            userList.push({\n                text: user.MyProfile.firstName + \" \" + user.MyProfile.lastName,\n                value: user._id\n            })\n        });\n        return userList;\n    },\n    progressPct() {\n        let goal = Template.instance().data.goal;\n        let g = IndividualGoal.findOne( {_id: goal._id} );\n        if (!g) return 0;\n\n        if (!g.dueDate || !g.startDate || \"undefined\" === typeof g.dueDate || \"undefined\" === typeof g.startDate) {\n            return 0;\n        }\n        let currDt = new Date().getTime();\n        let totalDuration = g.dueDate.getTime() - g.startDate.getTime();\n        let timeSinceStart = currDt - g.startDate.getTime();\n        let pct = (timeSinceStart / totalDuration);\n        return Math.min(parseInt(pct*100),100);\n    },\n    ownList() {\n        //check to see if the user logged in is the owner of the goals currently displayed\n        return (Meteor.userId() === getUserId());\n    },\n    userHasModifyPerm(fld) {\n        let goal = Template.instance().data.goal;\n        let g = IndividualGoal.findOne( {_id: goal._id} );\n        if (!g) return true;\n        return g.hasModifyPerm(fld);\n    },\n    fldEnabled(fld) {\n        let goal = Template.instance().data.goal;\n        let g = IndividualGoal.findOne( {_id: goal._id} );\n\n        if (!g) {\n            if (Roles.userIsInRole(Meteor.userId(), 'admin', goal.teamName)) {\n                return \"\";\n            } else {\n                return \"disabled\";\n            }\n        }\n\n        if (g.hasModifyPerm(fld)) {\n            return \"\";\n        } else {\n            return \"disabled\";\n        }\n    },\n    isNew(id) {\n        return BLANK_GOAL._id === id;\n    },\n    teamList() {\n        //list of teams the user is a member of\n        let t = Team.find(  );\n        if (!t) {\n            return [];\n        }\n        return t.fetch();\n    },\n    teamSelected(teamId) {\n        let goal = Template.instance().data.goal;\n        let g = IndividualGoal.findOne( {_id: goal._id} );\n        if (!g) {\n            return;\n        }\n        if (g.teamId === teamId) {\n            return \"selected\";\n        } else {\n            return \"\";\n        }\n    },\n    privacySelected(privVal) {\n        let goal = Template.instance().data.goal;\n        let g = IndividualGoal.findOne( {_id: goal._id} );\n        if (!g) {\n            return;\n        }\n        if (g.privacy === privVal) {\n            return \"selected\";\n        } else {\n            return \"\";\n        }\n    },\n    collapsed(pid) {\n        //if this goal has a parent it is being displayed in a modal and should not be collapsed\n        if (\"\" !== pid) {\n            return \"\";\n        } else {\n            return \"collapsed\";\n        }\n    }\n})\nTemplate.child_igoal_view.helpers({\n    childGoals() {\n        let goalId = Template.instance().data.goal._id;\n        let children = IndividualGoal.find( {parentId: goalId} ).fetch();\n        return children;\n    },\n    hasChildren(goalId) {\n        goalId = Template.instance().data.goal._id;\n        let doesHave = IndividualGoal.find( {parentId: goalId} ).count() > 0;\n        return doesHave;\n    }\n});\n","import { User } from '/imports/api/users/users.js';\nimport { LearnShareSession } from '/imports/api/learn_share/learn_share.js';\nimport { Team } from '/imports/api/teams/teams.js';\nimport './learn_share.html';\nimport '/imports/ui/components/label_list/label_list.js';\n\nvar generateGuestId = () => {\n    var text = \"guest-\";\n    var idLength = 11;\n    var possible = \"acdeghijklmnopqrstuvwxyzACDEGHIJKLMNOPQRSTUVWXYZ0123456789\";\n\n    for (var i = 0; i < idLength; i++) {\n        text += possible.charAt(Math.floor(Math.random() * possible.length));\n    }\n\n    return text;\n}\n\nvar app;\nvar client_id = '8e7e8c57-117c-454a-bf71-7ec493ab82b1';\nvar meeting;\nvar version = \"appdeveloperlevel/0.59\";\n\nfunction initSkypeAPI() {\n    console.log(sessionStorage);\n    debugger;\n    var hasToken = /^#access_token=/.test(location.hash) || !!sessionStorage.apiAccessToken;\n    var hasError = /^#error=/.test(location.hash);\n    if (!hasToken && !hasError) {\n        let pathParts = location.pathname.split('/');\n        sessionStorage.lastLearnShareId = pathParts[pathParts.length-1];\n        console.log(sessionStorage);\n        location.assign('https://login.microsoftonline.com/common/oauth2/authorize?response_type=token' +\n            '&client_id=' + client_id +\n            '&redirect_uri=' + location.origin + '/learnShare' +\n            '&resource=https://webdir.online.lync.com');\n    } else {\n        if (!sessionStorage.apiAccessToken) {\n            var tokenresponse = parseHashParams(window.location.hash);\n            sessionStorage.apiAccessToken = tokenresponse.access_token;\n            window.location.hash = '#';\n        }\n        Skype.initialize(\n            {\n                apiKey: 'a42fcebd-5b43-4b89-a065-74450fb91255',\n                correlationIds: {\n                    sessionId: 'mySession123', // Necessary for troubleshooting requests, should be unique per session\n                }\n            },\n            function (api) {\n                console.log(\"wwwwwwwwwwwwwwwwwwwwwww\");\n                app = new api.application();\n                console.log(app);\n                apiSignIn();\n            }\n        );\n    }\n}\nfunction parseHashParams(hash) {\n    var params = hash.slice(1).split('&');\n\n    var paramarray = {};\n    params.forEach(function(param) {\n        param = param.split('=');\n        paramarray[param[0]] = param[1];\n    });\n\n    return paramarray;\n}\nfunction apiSignIn() {\n    console.log(1234,app);\n    var application = app;\n    // the SDK will get its own access token\n    app.signInManager.signIn({\n        client_id: client_id,\n        cors: true,\n        redirect_uri: '/learnShare',\n        origins: [ \"https://webdir.online.lync.com/autodiscover/autodiscoverservice.svc/root\" ],\n        version: version // Necessary for troubleshooting requests; identifies your application in our telemetry\n    }).then(\n        function(a) {\n            console.log(\"signed in\", a);\n            createMeeting();\n        },\n        function(err) {\n            $(\"#span-create-skype\").html(\"(<a href='#' id='a-create-call'>Create skype meeting</a>)\");\n            console.log(\"sign in error\", err);\n        }\n    )\n}\nfunction createMeeting() {\n    meeting = app.conversationsManager.createMeeting();\n    meeting.subject('LearnShare Meeting');\n    meeting.accessLevel('Everyone');\n    console.log('0',meeting);\n    meeting.onlineMeetingUri.get().then(\n        function(uri) {\n            console.log('1',uri);\n            //var conversation = app.conversationsManager.getConversationByUri(uri);\n            //console.log(\"what?\",conversation);\n            let uriChunks = uri.split(':');\n            let skypeUser = uriChunks[1].split(';')[0];\n            let emlUser = skypeUser.split('@')[0];\n            let emlDomain = skypeUser.split('@')[1];\n            let mtgId = uriChunks[uriChunks.length-1];\n            let url = 'https://meet.lync.com/'+emlDomain+'/'+emlUser+'/'+mtgId;\n            console.log(url);\n            $(\"#input-skype-url\").val(url);\n            $(\"#span-create-skype\").html(\"(<a href='#' id='a-create-call'>Create skype meeting</a>)\");\n            $(\"#input-skype-url\").trigger(\"change\");\n        },\n        function(err) {\n            $(\"#span-create-skype\").html(\"(<a href='#' id='a-create-call'>Create skype meeting</a>)\");\n            console.log(err);\n        }\n    );\n}\n\nTemplate.learn_share.onCreated(function () {\n    this.lssid = FlowRouter.getParam('lssid');\n    if (!Meteor.user()) {\n        //user not logged in, treat as guest\n        let gname = Session.get(\"guestName\");\n        if (\"undefined\" === typeof gname) {\n            let gid = generateGuestId();\n            //Session.setPersistent(\"guestName\", 'lurker'+gid.slice(5,10));\n            //Session.setPersistent(\"guestId\", gid);\n        }\n    }\n\n    this.autorun( () => {\n        console.log(\"autorunning learn_share...\");\n\n        this.subscription = this.subscribe('userList', Meteor.userId(), {\n            onStop: function () {\n                console.log(\"User List subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"User List subscription ready! \", arguments, this);\n\n                let userList = [];\n\n                User.find().forEach( (user) => {\n                    userList.push({\n                        text: user.MyProfile.firstName + \" \" + user.MyProfile.lastName,\n                        value: user._id\n                    });\n                });\n            }\n        });\n        console.log(this.subscription);\n\n        this.subscription2 = this.subscribe('learnShareDetails', this.lssid, {\n            onStop: function () {\n                console.log(\"LearnShare List subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"LearnShare List subscription ready! \", arguments, this);\n                let lssess = LearnShareSession.findOne( {_id: this.params[0]} );\n                if (\"locked\" !== lssess.state) {\n                    if (Meteor.user()) {\n                        lssess.addParticipantSelf();\n                        lssess = LearnShareSession.findOne( {_id: this.params[0]} );\n                        let selectControl = $(\"#select-participants\")[0].selectize;\n                        for (let i = 0; i < lssess.participants.length; i++) {\n                            selectControl.addItem(lssess.participants[i].id);\n                        }\n                        for (let i = 0; i < lssess.presenters.length; i++) {\n                            $(\".item[data-value=\"+lssess.presenters[i].id+\"]\").addClass(\"picked\");\n                        }\n                        if ($(\".item[data-value]\").not(\".picked\").length === 0) {\n                            $(\"#btn-pick-first\").prop(\"disabled\", true);\n                        } else {\n                            $(\"#btn-pick-first\").prop(\"disabled\", false);\n                        }\n                    } else {\n                        lssess.saveGuest(Session.get(\"guestId\"),Session.get(\"guestName\"));\n                    }\n                }\n            }\n        });\n        console.log(this.subscription2);\n\n        this.subscription3 = this.subscribe('teamsData', Meteor.userId(), {\n            onStop: function () {\n                console.log(\"teamsData subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"teamsData subscription ready! \", arguments, this);\n            }\n        });\n        console.log(this.subscription3);\n    });\n\n});\n\nTemplate.learn_share.onRendered( () => {\n    Meteor.setTimeout(() => {\n        if (/^#access_token=/.test(location.hash)) {\n            console.log(\"hhhhhhhhhhhhhhhhhhhhhhhhhhhhhh\");\n            $(\"#a-skype-url-edit\").trigger(\"click\");\n            Meteor.setTimeout(() => {\n                $(\"#a-create-call\").trigger(\"click\");\n            }, 500);\n        }\n        $('#modal-edit-name').on('shown.bs.modal', function () {\n            $('#input-guest-name').focus();\n        });\n        $(document).on('click','#selectize-outer-select-guests .selectize-input .item', function (event) {\n            let $target = $(event.target);\n            let participant = {\n                id: $target.data(\"value\"),\n                name: $target.text().slice(0,-1)\n            };\n            let lssid = $(\"#select-participants\").closest(\"[data-lssid]\").data(\"lssid\");\n            let ls = LearnShareSession.findOne( {_id: lssid} );\n            if (!ls) {\n                return;\n            }\n            ls.removeGuest(participant.id);\n            ls.addParticipant(participant);\n        });\n        $(document).on('click','#selectize-outer-select-participants .selectize-input .item', function (event) {\n            let $target = $(event.target);\n            let participant = {\n                id: $target.data(\"value\"),\n                name: $target.text().slice(0,-1)\n            };\n            let lssid = $(\"#select-participants\").closest(\"[data-lssid]\").data(\"lssid\");\n            let ls = LearnShareSession.findOne( {_id: lssid} );\n            if (!ls) {\n                return;\n            }\n            ls.saveGuest(participant);\n            ls.removeParticipant(participant.id);\n        });\n    }, 500);\n});\n\nTemplate.learn_share.helpers({\n    userList() {\n        let u = User.find().fetch();\n        return u;\n    },\n    canEdit() {\n        let lssid = Template.instance().lssid;\n        let lssess = LearnShareSession.findOne( {_id:lssid} );\n        if (!lssess) {\n            return false;\n        }\n        if (lssess.state === \"locked\" || !Meteor.user()) {\n            return false;\n        }\n        return true;\n    },\n    canEditAdmin() {\n        let lssid = Template.instance().lssid;\n        let lssess = LearnShareSession.findOne( {_id:lssid} );\n        if (!lssess) {\n            return false;\n        }\n        if (lssess.state === \"locked\" || !Roles.userIsInRole(Meteor.userId(), ['admin','learn-share-host'], Roles.GLOBAL_GROUP)) {\n            return false;\n        }\n        return true;\n    },\n    sessionPresenters() {\n        let lssid = Template.instance().lssid;\n        let lssess = LearnShareSession.findOne( {_id:lssid} );\n        if (!lssess) {\n            return [];\n        } else {\n            return lssess.presenters;\n        }\n    },\n    sessionParticipants() {\n        let lssid = Template.instance().lssid;\n        let lssess = LearnShareSession.findOne( {_id:lssid} );\n        if (!lssess) {\n            return [];\n        } else {\n            return lssess.participants;\n        }\n    },\n    sessionParticipantItems() {\n        let lssid = Template.instance().lssid;\n        let lssess = LearnShareSession.findOne( {_id:lssid} );\n\n        if (!lssess) {\n            return [];\n        }\n\n        let participants = lssess.participants;\n        let participantIds = [];\n        for (let i = 0; i < participants.length; i++) {\n            participantIds.push({value: participants[i].id, text: participants[i].name});\n        }\n        return participantIds;\n    },\n    sessionGuests() {\n        let lssid = Template.instance().lssid;\n        let lssess = LearnShareSession.findOne( {_id:lssid} );\n        if (!lssess) {\n            return [];\n        } else {\n            return lssess.guests;\n        }\n    },\n    sessionGuestItems() {\n        let lssid = Template.instance().lssid;\n        let lssess = LearnShareSession.findOne( {_id:lssid} );\n\n        if (!lssess) {\n            return [];\n        }\n\n        let guests = lssess.guests;\n        let guestIds = [];\n        for (let i = 0; i < guests.length; i++) {\n            guestIds.push({value: guests[i].id, text: guests[i].name});\n        }\n        return guestIds;\n    },\n    roParticipantNames() {\n        let lssid = Template.instance().lssid;\n        let lssess = LearnShareSession.findOne( {_id:lssid} );\n\n        if (!lssess) {\n            return [];\n        }\n\n        let participants = lssess.participants;\n        let participantList = [];\n        for (let i = 0; i < participants.length; i++) {\n            participantList.push(participants[i].name);\n        }\n        return participantList;\n    },\n    userAddList(teamName) {\n        let u = User.find( );\n        let addList = [];\n        u.forEach((m) => {\n            addList.push( {\n                value: m._id,\n                text: m.MyProfile.firstName + \" \" + m.MyProfile.lastName\n            });\n        });\n        return addList;\n    },\n    itemRemoveHandler() {\n        return (value, $item) => {\n            let numSelected = $(\"#select-participants\")[0].selectize.items.length;\n            if (numSelected === 0) {\n                $(\"#btn-pick-first\").attr(\"disabled\", true);\n            }\n            let lssid = $(\"#select-participants\").closest(\"[data-lssid]\").data(\"lssid\");\n            let ls = LearnShareSession.findOne( {_id: lssid} );\n            if (!ls) {\n                return;\n            }\n            ls.removeParticipant(value);\n        }\n    },\n    itemRemoveGuestHandler() {\n        return (value, $item) => {\n            let lssid = $(\"#select-guests\").closest(\"[data-lssid]\").data(\"lssid\");\n            let ls = LearnShareSession.findOne( {_id: lssid} );\n            if (!ls) {\n                return;\n            }\n            ls.removeGuest(value);\n        }\n    },\n    itemAddHandler() {\n        return (value, $item) => {\n            $(\"#btn-pick-first\").prop(\"disabled\",false);\n            let participant = {\n                id: value,\n                name: $item.text().slice(0,-1)\n            };\n            let id = $item.closest('[data-lssid]').data('lssid');\n            let ls = LearnShareSession.findOne( {_id: id} );\n            if (!ls) {\n                return;\n            }\n            if (typeof _.find(ls.presenters, function(o) {return o.id===participant.id}) !== \"undefined\") {\n                //if added user is in the list of presenters, mark it\n                $item.addClass(\"picked\");\n            }\n            if (\"guest\" === participant.id.slice(0,5)) {\n                $item.addClass(\"guest\");\n            }\n            ls.addParticipant(participant);\n        }\n    },\n    itemAddGuestHandler() {\n        return (value, $item) => {\n            $(\"#btn-pick-first\").prop(\"disabled\",false);\n            let participant = {\n                id: value,\n                name: $item.text().slice(0,-1)\n            };\n            let id = $item.closest('[data-lssid]').data('lssid');\n            let ls = LearnShareSession.findOne( {_id: id} );\n            if (!ls) {\n                return;\n            }\n            if (typeof _.find(ls.presenters, function(o) {return o.id===participant.id}) !== \"undefined\") {\n                //if added user is in the list of presenters, mark it\n                $item.addClass(\"picked\");\n            }\n            if (\"guest\" === participant.id.slice(0,5)) {\n                $item.addClass(\"guest\");\n            }\n            ls.saveGuest(participant);\n        }\n    },\n    order(idx) {\n        return idx + 1;\n    },\n    lssid() {\n        return Template.instance().lssid;\n    },\n    title() {\n        let lssid = Template.instance().lssid;\n        let lssess = LearnShareSession.findOne( {_id:lssid} );\n        if (lssess) {\n            return lssess.title;\n        }\n    },\n    teamId() {\n        let lssid = Template.instance().lssid;\n        let lssess = LearnShareSession.findOne( {_id:lssid} );\n        if (lssess) {\n            return lssess.teamId;\n        } else {\n            return \"\";\n        }\n    },\n    team() {\n        let lssid = Template.instance().lssid;\n        let lssess = LearnShareSession.findOne( {_id:lssid} );\n        if (lssess) {\n            return Team.findOne( {_id:lssess.teamId} );\n        } else {\n            return \"\";\n        }\n    },\n    teamName() {\n        let lssid = Template.instance().lssid;\n        let lssess = LearnShareSession.findOne( {_id:lssid} );\n        if (lssess) {\n            return Team.findOne( {_id:lssess.teamId} ).Name;\n        } else {\n            return \"\";\n        }\n    },\n    sessionActive() {\n        let lssid = Template.instance().lssid;\n        let lssess = LearnShareSession.findOne( {_id:lssid} );\n        if (lssess) {\n            if (lssess.state == \"locked\") {\n                return false;\n            } else {\n                return true;\n            }\n        }\n    },\n    notes() {\n        let lssid = Template.instance().lssid;\n        let lssess = LearnShareSession.findOne( {_id:lssid} );\n        if (lssess) {\n            return lssess.notes;\n        }\n    },\n    skypeUrl() {\n        let lssid = Template.instance().lssid;\n        let lssess = LearnShareSession.findOne( {_id:lssid} );\n        if (lssess) {\n            return lssess.skypeUrl;\n        }\n    },\n    guestName() {\n        return Session.get(\"guestName\").split('-')[1];\n    }\n});\n\nvar pickRandom = () => {\n    let selectControl = $(\"#select-participants\")[0].selectize;\n\n    let availableItems = [];\n    for (let i = 0; i < selectControl.items.length; i++) {\n        let $item = $(\".item[data-value=\"+selectControl.items[i]+\"]\");\n        if (!$item.hasClass(\"picked\") && !$item.hasClass(\"picking\")) {\n            availableItems.push($item);\n        }\n    }\n    if (availableItems.length === 0) {\n        //don't pick the same item twice in a row unless it's the last one\n        $item = $(\".item.picking[data-value]\");\n        if ($item.length && !$item.hasClass(\"picked\")) {\n            availableItems.push($(\".item.picking[data-value]\"));\n        }\n    }\n\n    if (availableItems.length <= 1) {\n        $(\"#btn-pick-first\").prop(\"disabled\", true);\n    }\n\n    if (availableItems.length === 0) {\n        //none left to pick\n        return '';\n    }\n    var $picking = availableItems[Math.floor(Math.random()*availableItems.length)];\n    $(\"#p-on-deck-info\").data(\"picking\", $picking.data(\"value\"));\n    $(\"#p-on-deck-info\").html($picking.text().slice(0,-1));\n    $picking.addClass(\"picking\");\n    return $picking.data(\"value\");\n}\nTemplate.learn_share.events({\n    'change .file-upload-input'(event, instance) {\n        var file = event.currentTarget.files[0];\n        var reader = new FileReader();\n        reader.onload = function(fileLoadEvent) {\n            let lssid = $(\".container[data-lssid]\").data(\"lssid\");\n            let lssess = LearnShareSession.findOne( {_id:lssid} );\n            lssess.uploadRecording(file, reader.result);\n        };\n        reader.readAsBinaryString(file);\n    },\n    'click button#btn-pick-first'(event, instance) {\n        var pickingId = pickRandom();\n        if (pickingId !== '') {\n            $(\"#p-on-deck\").show();\n            $(\"#p-pick-first\").hide();\n        }\n    },\n    'click button#btn-pick-again'(event, instance) {\n        let prevPickingId = $(\"#p-on-deck-info\").data(\"picking\");\n        var pickingId = pickRandom();\n\n        if (prevPickingId != pickingId) {\n            let $prevPicked = $(\".item[data-value=\"+prevPickingId+\"]\");\n            $prevPicked.removeClass(\"picking\");\n        }\n    },\n    'click button#btn-pick-accept'(event, instance) {\n        let pickedId = $(\"#p-on-deck-info\").data(\"picking\");\n        let picked = {};\n        let $pickedItem = $(\".item[data-value=\"+pickedId+\"]\");\n        picked.id = $pickedItem.data(\"value\");\n        picked.name = $pickedItem.text().slice(0,-1);\n        $pickedItem.removeClass(\"picking\").addClass(\"picked\");\n        $(\"#p-on-deck-info\").data(\"picking\",\"\");\n        $(\"#p-on-deck-info\").html(\"\");\n        $(\"#p-on-deck\").hide();\n        $(\"#p-pick-first\").show();\n        if ($(\".item[data-value]\").not(\".picked\").length === 0) {\n            $(\"#btn-pick-first\").attr(\"disabled\", true);\n        }\n\n        let lssid = Template.instance().lssid;\n        let lssess = LearnShareSession.findOne( {_id:lssid} );\n        lssess.addPresenter(picked);\n    },\n    'keypress #input-notes,#input-title'(event, instance) {\n        if (!Roles.userIsInRole(Meteor.userId(), ['admin','learn-share-host'], Roles.GLOBAL_GROUP)) {\n            event.preventDefault();\n        }\n    },\n    'keyup #input-notes,#input-title':_.debounce(function (event, instance) {\n        if (Roles.userIsInRole(Meteor.userId(), ['admin','learn-share-host'], Roles.GLOBAL_GROUP)) {\n            let lssid = $(\".container[data-lssid]\").data(\"lssid\");\n            let lssess = LearnShareSession.findOne( {_id:lssid} );\n            lssess.saveText($(\"#input-title\").val(), $(\"#input-notes\").val());\n        }\n    }, 2000),\n    'click button#modal-save-name'(event, instance) {\n        let lssid = $(\".container[data-lssid]\").data(\"lssid\");\n        let lssess = LearnShareSession.findOne( {_id:lssid} );\n        let guestName = \"guest-\"+$(\"#input-guest-name\").val();\n        //Session.setPersistent(\"guestName\",guestName);\n        lssess.saveGuest(Session.get(\"guestId\"), guestName);\n        $(\"#modal-edit-name\").modal(\"hide\");\n    },\n    'click a#lockSession'(event,instance) {\n        event.preventDefault();\n        let lssid = $(\".container[data-lssid]\").data(\"lssid\");\n        let lssess = LearnShareSession.findOne( {_id:lssid} );\n        lssess.saveText($(\"#input-title\").val(), $(\"#input-notes\").val());\n        lssess.lockSession();\n    },\n    'click a#unlockSession'(event,instance) {\n        event.preventDefault();\n        if (Roles.userIsInRole(Meteor.userId(), ['admin','learn-share-host'], Roles.GLOBAL_GROUP)) {\n            let lssid = $(\".container[data-lssid]\").data(\"lssid\");\n            let lssess = LearnShareSession.findOne( {_id:lssid} );\n            lssess.unlockSession();\n        }\n    },\n    'click a#a-skype-url-edit'(event,instance) {\n        event.preventDefault();\n        if (Roles.userIsInRole(Meteor.userId(), ['admin','learn-share-host'], Roles.GLOBAL_GROUP)) {\n            $(\"#a-skype-url\").hide();\n            $(\"#a-skype-url-edit\").hide();\n            $(\"#input-skype-url\").show();\n            $(\"#span-create-skype\").show();\n        }\n    },\n    'click a#a-create-call'(event,instance) {\n        event.preventDefault();\n        console.log(\"click create call\");\n        $(\"#span-create-skype\").html(\"<img src='/img/loading.gif' style='height:20px;width:20px;' /><span style='font-size:xx-small;'>contacting Skype</span>\")\n        initSkypeAPI();\n    },\n    'change input#input-skype-url'(event,instance) {\n        let lssid = $(\".container[data-lssid]\").data(\"lssid\");\n        let lssess = LearnShareSession.findOne( {_id:lssid} );\n        lssess.setSkypeUrl($(\"#input-skype-url\").val());\n        $(\"#a-skype-url\").show();\n        $(\"#a-skype-url-edit\").show();\n        $(\"#input-skype-url\").hide();\n        $(\"#span-create-skype\").hide();\n    }\n});\n","import { LearnShareSession } from '/imports/api/learn_share/learn_share.js';\nimport { Team } from '/imports/api/teams/teams.js';\nimport './learn_share_list.html';\n\nTemplate.learn_share_list.onCreated( function () {\n    this.autorun( () => {\n        console.log(\"autorunning learn_share_list...\");\n        this.subscription = this.subscribe('userList', Meteor.userId(), {\n            onStop: function () {\n                console.log(\"User List subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"User List subscription ready! \", arguments, this);\n            }\n        });\n        console.log(this.subscription);\n\n        this.subscription2 = this.subscribe('learnShareList', Meteor.userId(), {\n            onStop: function () {\n                console.log(\"LearnShare List subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"LearnShare List subscription ready! \", arguments, this);\n            }\n        });\n        console.log(this.subscription2);\n\n        this.subscription3 = this.subscribe('teamsMemberOfList', Meteor.userId(), {\n            onStop: function () {\n                console.log(\"Team Member Of List subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"Team Member Of List subscription ready! \", arguments, this);\n            }\n        });\n        console.log(this.subscription3);\n    });\n});\n\nTemplate.learn_share_list.helpers({\n    lsSessList(teamId) {\n        let lst = [];\n        let filter = {};\n        if (typeof teamId === \"string\" && teamId != \"\") {\n            filter.teamId = teamId;\n        } else {\n            filter.teamId = {'$in': [null,'']};\n        }\n        LearnShareSession.find( filter ).forEach(function (sess) {\n            //sorting with { sort: {createdAt:-1} } had no effect, so unshift used to reverse order instead\n            lst.unshift(sess);\n        });\n        return lst;\n    },\n    hasSessions(teamId) {\n        let ls = LearnShareSession.find( {teamId: teamId} );\n\n        if (!ls || ls.count() == 0) {\n            return false;\n        } else {\n            return true;\n        }\n    },\n    teamList() {\n        //list of teams the user is a member of\n        let t = Team.find( {Members: Meteor.userId()} );\n        if (!t) {\n            return [];\n        }\n        let lst = t.fetch();\n        return lst;\n    }\n});\n\nTemplate.learn_share_list.events({\n    'click button#btn-create-new'(event, instance) {\n        Meteor.call('learnshare.createNewSession', $(\"#sess-title\").val(), $(\"#select-team\").val(), (error, result) => {\n            if (error) {\n                console.log(\"can't create new Learn/Share session\", error);\n            } else {\n                FlowRouter.go(\"/learnShare/\"+result);\n            }\n        });\n    }\n});\n","import './not-found.html';\n","import { Meteor } from 'meteor/meteor';\nimport { User } from '/imports/api/users/users.js';\nimport { TeamGoal } from '/imports/api/team_goals/team_goals.js';\nimport './team_goals.html';\nimport '/imports/ui/components/select_autocomplete/select_autocomplete.js';\n\nconst BLANK_GOAL = {\n    _id: \"new\",\n    title: \"\",\n    description: \"\"\n};\n\nlet _hasSubgoalView = new ReactiveVar(false);\nlet _subgoalId = new ReactiveVar(\"\");\nTemplate.team_goals.onCreated(function () {\n    if (this.data.teamName) {\n        this.teamName = this.data.teamName;\n    } else {\n        this.teamName = FlowRouter.getParam('teamName').split('-').join(' ');\n    }\n\n    Session.set(\"goalReload\",false);\n    Session.set(\"saving\",true);\n\n    this.userSubscriptionReady = new ReactiveVar( false );\n    this.autorun( () => {\n        this.modalGoalId = FlowRouter.getParam('goalId');\n        if (\"undefined\" !== typeof this.modalGoalId && \"\" !== this.modalGoalId) {\n            _hasSubgoalView.set(true);\n            _subgoalId.set(FlowRouter.getParam('goalId'));\n            $(\"body\").on(\"hidden.bs.modal\", \"#goal-modal-sub\", function () {\n                _hasSubgoalView.set(false);\n                _subgoalId.set(\"\");\n                FlowRouter.go(\"/teamGoals/\"+FlowRouter.getParam('teamName'));\n            });\n            Meteor.setTimeout(function () {\n                $(\"#goal-modal-sub\").modal(\"show\");\n                $(\"#goal-modal-sub\").find(\"div.team-goal\").removeClass(\"collapsed\");\n            }, 1000);\n        }\n        this.subscription = this.subscribe('teamGoalsData', this.teamName, {\n            onStop: function () {\n                console.log(\"Team Goals subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"Team Goals subscription ready! \", arguments, this);\n            }\n        });\n        this.subscription2 = this.subscribe('userList', Meteor.userId(), {\n            onStop: function () {\n                console.log(\"User List subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"User List subscription ready! \", arguments, this);\n            }\n        });\n        console.log(this.subscription2);\n    });\n    Meteor.setTimeout(function () {\n        Session.set(\"saving\",false);\n    }, 2000);\n});\nTemplate.team_goals.onRendered(function () {\n    Meteor.setTimeout(function() {\n        $(\"input.date\").datetimepicker({\n            format:'YYYY-MM-DD',\n            useCurrent:false,\n            showClear:true,\n            showClose:true\n        });\n    }, 1000);\n    $(\"body\").on(\"hidden.bs.modal\", \"#goal-modal-new\", function () {\n        $newgoal = $(\"#div-goal-new\").detach();\n        $newgoal.data(\"parent-id\",\"\");\n        $(\"#blank-goal\").find(\".col-sm-12\").append($newgoal);\n    });\n});\n\nvar resetNewGoalForm = () => {\n    let valInputs = [\n        \"goal-title-new\",\n        \"goal-description-new\",\n        \"input-date-due-new\",\n        \"input-date-review-new\",\n        \"input-date-reached-new\",\n    ];\n    for (let i = 0; i < valInputs.length; i++) {\n        $(\"#\"+valInputs[i]).val(\"\");\n    }\n\n    let slzInputs = [\n        \"select-assigned-to-new\",\n        \"select-mentors-new\",\n        \"select-admins-new\"\n    ];\n    for (let i = 0; i < valInputs.length; i++) {\n        $(\"#\"+valInputs[i]).val(\"\");\n    }\n};\n\nfunction saveGoal(goalId) {\n    let slAssigned = $(\"#select-assigned-to-\"+goalId)[0].selectize;\n    let slMentors = $(\"#select-mentors-\"+goalId)[0].selectize;\n    let slAdmins = $(\"#select-admins-\"+goalId)[0].selectize;\n    let assignList = slAssigned.getValue();\n    let mentorList = slMentors.getValue();\n    let adminList = slAdmins.getValue();\n    let tplTeamName = $(\"[data-team-name]\").data(\"team-name\");\n\n    Session.set(\"saving\",true);\n    let saveObj = {\n        teamName: tplTeamName,\n        title: $(\"#goal-title-\"+goalId).val(),\n        description: $(\"#goal-description-\"+goalId).val(),\n        assignedTo: assignList,\n        mentors: mentorList,\n        admins: adminList\n    };\n    let startDate = $(\"#input-start-date-\"+goalId).val();\n    if (\"\" !== startDate) {\n        saveObj.startDate = new Date(startDate);\n    }\n    let dueDate = $(\"#input-date-due-\"+goalId).val();\n    if (\"\" !== dueDate) {\n        saveObj.dueDate = new Date(dueDate);\n    }\n    let rvwDate = $(\"#input-date-review-\"+goalId).val();\n    if (\"\" !== rvwDate) {\n        saveObj.reviewDate = new Date(rvwDate);\n    }\n\n    if (goalId === BLANK_GOAL._id) {\n        let parentId = $(\"#div-goal-new\").data(\"parent-id\");\n        if (\"\" !== parentId) {\n            saveObj.parentId = parentId;\n        }\n        Meteor.call('teamgoals.createNewGoal', saveObj, function (err, rslt) {\n            console.log(err, rslt);\n        });\n    } else {\n        let g = TeamGoal.findOne( {_id: goalId} );\n        let reviewedOnDate = $(\"#input-date-reviewed-on-\"+goalId).val();\n        if (\"\" !== reviewedOnDate) {\n            saveObj.reviewedOnDate = new Date(reviewedOnDate);\n        }\n        let reachedDate = $(\"#input-date-reached-\"+goalId).val();\n        if (\"\" !== reachedDate) {\n            saveObj.reachedDate = new Date(reachedDate);\n        }\n\n        g.updateFromObj(saveObj);\n    }\n    Meteor.setTimeout(function () {\n        Session.set(\"saving\",false);\n    }, 10000);\n}\n\nfunction goalChanged($g) {\n    $g.find(\".btn-save\").prop(\"disabled\",false);\n    $g.find(\".btn-cancel\").prop(\"disabled\",false);\n}\nfunction goalUnchanged($g) {\n    $g.find(\".btn-save\").prop(\"disabled\",true);\n    $g.find(\".btn-cancel\").prop(\"disabled\",true);\n    $g.find(\".changed\").removeClass(\"changed\");\n}\n\nTemplate.team_goals.events({\n    'change input.flat,textarea.flat'(event, instance) {\n        $(event.target).addClass('changed');\n        let $goal = $(event.target).closest(\"[data-goal-id]\");\n        if ($goal) {\n            if ($(\"#goal-title-\"+$goal.data(\"goal-id\")).val() != \"\") {\n                //\n            }\n        }\n    },\n    'change input,textarea,select'(event, instance) {\n        let $t = $(event.target);\n        let $goal = $(event.target).closest(\"[data-goal-id]\");\n        goalChanged($goal);\n    },\n    'keyup input,textarea'(event, instance) {\n        let $t = $(event.target);\n        let $goal = $(event.target).closest(\"[data-goal-id]\");\n        goalChanged($goal);\n    },\n    'click button.btn-save'(event, instance) {\n        let $t = $(event.target);\n        let goalId = $t.closest(\"[data-goal-id]\").data(\"goal-id\");\n        saveGoal(goalId);\n        goalUnchanged($(\"#div-goal-\"+goalId));\n\n        $modalParent = $t.closest(\".modal\");\n        if ($modalParent.length) {\n            $modalParent.modal('hide');\n            $newgoal = $(\"#div-goal-new\").detach();\n            $newgoal.data(\"parent-id\",\"\");\n            $(\"#blank-goal\").find(\".col-sm-12\").html($newgoal);\n        }\n        if (goalId == BLANK_GOAL._id) {\n            resetNewGoalForm();\n            if ( ! $modalParent.length ) {\n                $(\".goal-controls\").show();\n                $(\"#blank-goal\").slideUp();\n            }\n        }\n    },\n    'click button.btn-add-subgoal'(event, instance) {\n        let parentId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n        $newgoal = $(\"#div-goal-new\").detach();\n        $newgoal.data(\"parent-id\",parentId);\n        $newgoal.find(\".btn-cancel\").attr(\"disabled\",false);\n        $(\"#goal-modal-new\").find(\".modal-body\").append($newgoal);\n        $(\"#goal-modal-new\").modal(\"show\");\n        $(\"#goal-modal-new\").find(\"div.team-goal\").removeClass(\"collapsed\");\n    },\n    'click button.btn-cancel'(event, instance) {\n        let $t = $(event.target);\n        let goalId = $t.closest(\"[data-goal-id]\").data(\"goal-id\");\n\n        $modalParent = $t.closest(\".modal\");\n        if ($modalParent.length) {\n            $modalParent.modal('hide');\n            $newgoal = $(\"#div-goal-new\").detach();\n            $newgoal.data(\"parent-id\",\"\");\n            $(\"#blank-goal\").find(\".col-sm-12\").append($newgoal);\n        }\n\n        if (goalId == BLANK_GOAL._id) {\n            resetNewGoalForm();\n            if ( ! $modalParent.length ) {\n                $(\".goal-controls\").show();\n                $(\"#blank-goal\").slideUp();\n            }\n        } else {\n            //forces a reload from the database\n            Session.set(\"goalReload\",true);\n            Meteor.setTimeout(function () {\n                Session.set(\"goalReload\",false);\n            }, 100);\n        }\n    },\n    'click button.btn-comment-add'(event, instance) {\n        $btnAdd = $(event.target);\n\n        let goalId = $btnAdd.closest(\"[data-goal-id]\").data(\"goal-id\");\n        let $comment = $(\"#new-comment-\"+goalId);\n        let newComment = $comment.val();\n        let g = TeamGoal.findOne( {_id: goalId} );\n        g.addComment(newComment);\n        $comment.val(\"\");\n    },\n    'click button.btn-review-comment-add'(event, instance) {\n        $btnAdd = $(event.target);\n\n        let goalId = $btnAdd.closest(\"[data-goal-id]\").data(\"goal-id\");\n        let $comment = $(\"#new-review-comment-\"+goalId);\n        let newComment = $comment.val();\n        let g = TeamGoal.findOne( {_id: goalId} );\n        g.addReviewComment(newComment);\n        $comment.val(\"\");\n    },\n    'click button#btn-add-goal'(event, instance) {\n        let $btnAdd = $(event.target);\n        $goal = $btnAdd.closest(\"[data-goal-id]\")\n        let goalId = $goal.data(\"goal-id\");\n\n        $(\".goal-controls\").hide();\n        let $btnCancel = $(\"#blank-goal\").find(\".btn-cancel\")\n        $btnCancel.prop(\"disabled\",false);\n        $(\".team-goal[data-goal-id=\"+goalId+\"]\").removeClass(\"collapsed\");\n        $(\"#blank-goal\").slideDown();\n        $(\"#btn-add-cancel\").fadeIn();\n    },\n    'click button#btn-add-cancel'(event, instance) {\n        $(\"#blank-goal\").slideUp();\n        $(\"#btn-add-cancel\").fadeOut();\n    },\n    'click button.btn-expand,div.collapsed-summary'(event, instance) {\n        let $target = $(event.target);\n        let $goalContainer = $target.closest(\"[data-goal-id]\");\n        let $targetExpandBtn = $goalContainer.find(\".btn-expand.glyphicon\");\n\n        $targetExpandBtn.removeClass(\"glyphicon-chevron-up\")\n            .addClass(\"glyphicon-chevron-down\");\n\n        if ($goalContainer.hasClass(\"collapsed\")) {\n            $(\".team-goal[data-goal-id]:not(.collapsed)\").slideUp(function() {\n                $(this).addClass(\"collapsed\").css(\"display\",\"block\");\n            });\n            $goalContainer.css(\"display\",\"none\").removeClass(\"collapsed\").slideDown(function () {\n                $('html, body').animate({\n                    scrollTop: ($goalContainer.offset().top)\n                },500);\n            });\n            $targetExpandBtn.removeClass(\"glyphicon-chevron-down\");\n            $targetExpandBtn.addClass(\"glyphicon-chevron-up\");\n        } else {\n            $goalContainer.slideUp(function() {\n                $goalContainer.addClass(\"collapsed\").css(\"display\",\"block\");\n            });\n            $targetExpandBtn.removeClass(\"glyphicon-chevron-up\");\n            $targetExpandBtn.addClass(\"glyphicon-chevron-down\");\n        }\n    },\n    'keyup textarea.goal-description,input.goal-title':_.debounce(function (event, instance) {\n        let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n        if (\"new\" === goalId) {\n            //don't auto-save if creating a new goal\n            return;\n        }\n        saveGoal(goalId);\n        goalUnchanged($(\"#div-goal-\"+goalId));\n    }, 2000),\n    'change input,select':_.debounce(function (event, instance) {\n        if (!Session.get(\"saving\")) {\n            let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n            if (\"new\" === goalId) {\n                //don't auto-save if creating a new goal\n                return;\n            }\n            saveGoal(goalId);\n            goalUnchanged($(\"#div-goal-\"+goalId));\n        }\n    }, 2000),\n    'dp.change':_.debounce(function (event, instance) {\n        if (!Session.get(\"saving\")) {\n            let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n            if (\"new\" === goalId) {\n                //don't auto-save if creating a new goal\n                return;\n            }\n            saveGoal(goalId);\n            goalUnchanged($(\"#div-goal-\"+goalId));\n        }\n    }, 2000),\n    'click div.team-goal-title[data-id]'(event, instance) {\n        if (!Session.get(\"saving\")) {\n            _hasSubgoalView.set(true);\n            let gid = $(event.target).data(\"id\");\n            _subgoalId.set(gid);\n            FlowRouter.go(\"/teamGoals/\"+FlowRouter.getParam('teamName')+\"/\"+gid);\n            $(\"#goal-modal-sub\").prop(\"disabled\",false).modal(\"show\");\n        }\n    }\n});\n\nfunction getTeamName() {\n    let teamName = Template.instance().teamName;\n    return teamName;\n}\nTemplate.team_goals.helpers({\n    goalReload() {\n        return Session.get(\"goalReload\");\n    },\n    hasGoals() {\n        let teamName = getTeamName();\n        let g = TeamGoal.find( {teamName: teamName, parentId: '', reachedDate: null} ).fetch();\n        return g.length > 0;\n    },\n    hasReachedGoals() {\n        let teamName = getTeamName();\n        let g = TeamGoal.find( {teamName: teamName, parentId: '', reachedDate: {$ne:null}} ).fetch();\n        return g.length > 0;\n    },\n    teamGoals() {\n        let teamName = getTeamName();\n        let g = TeamGoal.find( {teamName: teamName, parentId: '', reachedDate: null} ).fetch();\n        return g;\n    },\n    teamReachedGoals() {\n        let teamName = getTeamName();\n        let g = TeamGoal.find( {teamName: teamName, parentId: '', reachedDate: {$ne:null}} ).fetch();\n        return g;\n    },\n    blankGoal() {\n        return Object.assign({teamName: Template.instance().teamName}, BLANK_GOAL);\n    },\n    hasSubgoalView() {\n        let hasView = _hasSubgoalView.get();\n        let gid = _subgoalId.get();\n        if (hasView) {\n            return true;\n        } else {\n            return false;\n        }\n    },\n    subgoal() {\n        let hasView = _hasSubgoalView.get();\n        let subgoalId = Template.instance().modalGoalId;\n        subgoalId = _subgoalId.get();\n        let g = TeamGoal.findOne( {_id: subgoalId} );\n        if (g) {\n            return g;\n        } else {\n            return {};\n        }\n    },\n    team() {\n        return getTeamName();\n    },\n    teamSlug() {\n        return getTeamName().split(\" \").join(\"-\");\n    },\n    goalComments(goalId) {\n        let g = TeamGoal.findOne( {_id: goalId} );\n        if (!g) {\n            return;\n        }\n        let c = g.goalComments;\n        return c;\n    },\n    reviewComments(goalId) {\n        let g = TeamGoal.findOne( {_id: goalId} );\n        if (!g) {\n            return;\n        }\n        let c = g.reviewComments;\n        return c;\n    },\n    formatDate(dateObj) {\n        return dateObj.toLocaleDateString();\n    },\n    getUserName(userId) {\n        let u = User.findOne( {_id: userId} );\n        if (!u) return \"\";\n        let fullName = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n        return fullName;\n    },\n    userList() {\n        let list = [\n            {id: 1, name: \"George\"},\n            {id: 2, name: \"Frank\"}\n        ];\n        return list;\n    }\n});\n\nTemplate.goal_view.onRendered(function () {\n});\n\nTemplate.goal_view.helpers({\n    childGoals() {\n        let goalId = Template.instance().data.goal._id;\n        let children = TeamGoal.find( {parentId: goalId} ).fetch();\n        return children;\n    },\n    hasChildren() {\n        let goalId = Template.instance().data.goal._id;\n        let doesHave = TeamGoal.find( {parentId: goalId} ).fetch().length > 0;\n        return doesHave;\n    },\n    goalComments(goalId) {\n        if (goalId === BLANK_GOAL._id) {\n            return;\n        }\n        let g = TeamGoal.findOne( {_id: goalId} );\n        if (!g) {\n            return;\n        }\n        let c = g.goalComments;\n        return c;\n    },\n    reviewComments(goalId) {\n        if (goalId === BLANK_GOAL._id) {\n            return;\n        }\n        let g = TeamGoal.findOne( {_id: goalId} );\n        if (!g) {\n            return;\n        }\n        let c = g.reviewComments;\n        return c;\n    },\n    formatDate(dateObj) {\n        return dateObj.toLocaleDateString();\n    },\n    dateField(fld) {\n        let goal = Template.instance().data.goal;\n        if (goal._id == BLANK_GOAL._id) {\n            return \"\";\n        }\n        let d = goal[fld];\n        if ( !(d instanceof Date) ) {\n            return \"\";\n        }\n        let dateText = new Date(d.getTime() - d.getTimezoneOffset()*60000).toISOString().slice(0,-1);\n        return dateText;\n    },\n    getUserName(userId) {\n        let u = User.findOne( {_id: userId} );\n        if (!u) return \"\";\n        let fullName = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n        return fullName;\n    },\n    userList() {\n        let userList = [];\n        let teamRole = {};\n        teamRole[\"roles.\"+Template.instance().data.goal.teamName] = \"member\";\n        User.find( teamRole ).forEach( (user) => {\n            userList.push({\n                text: user.MyProfile.firstName + \" \" + user.MyProfile.lastName,\n                value: user._id\n            })\n        });\n        console.log(teamRole, userList);\n        return userList;\n    },\n    progressPct() {\n        let goal = Template.instance().data.goal;\n        let g = TeamGoal.findOne( {_id: goal._id} );\n        if (!g) return 0;\n\n        if (!g.dueDate || !g.startDate || \"undefined\" === typeof g.dueDate || \"undefined\" === typeof g.startDate) {\n            return 0;\n        }\n        let currDt = new Date().getTime();\n        let totalDuration = g.dueDate.getTime() - g.startDate.getTime();\n        let timeSinceStart = currDt - g.startDate.getTime();\n        let pct = (timeSinceStart / totalDuration);\n        return Math.min(parseInt(pct*100),100);\n    },\n    userHasModifyPerm(fld) {\n        let goal = Template.instance().data.goal;\n        let g = TeamGoal.findOne( {_id: goal._id} );\n        if (!g) return true;\n        return g.hasModifyPerm(fld);\n    },\n    fldEnabled(fld) {\n        let goal = Template.instance().data.goal;\n        let g = TeamGoal.findOne( {_id: goal._id} );\n\n        if (!g) {\n            if (Roles.userIsInRole(Meteor.userId(), 'admin', goal.teamName)) {\n                return \"\";\n            } else {\n                return \"disabled\";\n            }\n        }\n\n        if (g.hasModifyPerm(fld)) {\n            return \"\";\n        } else {\n            return \"disabled\";\n        }\n    },\n    commaListUsers(lst) {\n        var nameList = [];\n\n        let goal = Template.instance().data.goal;\n        let g = TeamGoal.findOne( {_id: goal._id} );\n\n        for (let i = 0; i < lst.length; i++) {\n            let u = User.findOne( {_id: lst[i]} );\n            nameList.push(u.MyProfile.firstName + \" \" + u.MyProfile.lastName);\n        }\n        return nameList.join(', ');\n    },\n    isNew(id) {\n        return BLANK_GOAL._id === id;\n    },\n    collapsed(pid) {\n        //if this goal has a parent it is being displayed in a modal and should not be collapsed\n        if (\"\" !== pid) {\n            return \"\";\n        } else {\n            return \"collapsed\";\n        }\n    }\n})\nTemplate.child_goal_view.helpers({\n    childGoals() {\n        let goalId = Template.instance().data.goal._id;\n        let children = TeamGoal.find( {parentId: goalId} ).fetch();\n        return children;\n    },\n    hasChildren(goalId) {\n        goalId = Template.instance().data.goal._id;\n        let doesHave = TeamGoal.find( {parentId: goalId} ).count() > 0;\n        return doesHave;\n    }\n});\n","import { User } from '/imports/api/users/users.js';\nimport './user_dashboard.html';\nimport '/imports/ui/pages/learn_share_list/learn_share_list.js';\nimport '/imports/ui/pages/home/home.js';\n\nTemplate.user_dashboard.onCreated(function () {\n    //\n});\n\nTemplate.user_dashboard.helpers({\n    dashboardPanes() {\n        let u = User.findOne( {_id: Meteor.userId()} );\n        if (u && \"undefined\" !== typeof u.MyProfile.dashboardPanes && u.MyProfile.dashboardPanes.length > 0) {\n            return u.MyProfile.dashboardPanes;\n        } else {\n            return [\n                {\n                    size: 6,\n                    name: 'individual_goals',\n                    title: 'Goals',\n                    route: '/goals',\n                    data: {}\n                },\n                {\n                    size: 6,\n                    name: 'admin_teams',\n                    title: 'Teams',\n                    route: '/adminTeams',\n                    data: {}\n                },\n                {\n                    size: 6,\n                    name: 'learn_share_list',\n                    title: 'Learn/Share',\n                    route: '/learnShareList',\n                    data: {}\n                },\n                {\n                    size: 6,\n                    name: 'user_profile',\n                    title: 'Profile',\n                    route: '/profile',\n                    data: {}\n                },\n                {\n                    size: 12,\n                    name: 'App_home',\n                    title: 'Questions',\n                    route: '/',\n                    data: {}\n                },\n            ];\n        }\n    }\n})\n\nTemplate.user_dashboard.events({\n    'click div.dashboard-pane'(event, instance) {\n        let target = $(event.target).data(\"route\");\n        if (\"undefined\" === target) {\n            return;\n        }\n        FlowRouter.go(target);\n    }\n});\n","import { User } from '/imports/api/users/users.js';\nimport { UserSegment } from '/imports/api/user_segments/user_segments.js';\nimport './user_profile.html';\n\nTemplate.user_profile.onCreated(function () {\n    if (this.data.userId) {\n        this.userId = this.data.userId;\n    } else if (FlowRouter.getParam('userId')) {\n        this.userId = FlowRouter.getParam('userId');\n    } else {\n        this.userId = Meteor.userId();\n    }\n    this.autorun( () => {\n        this.subscription = this.subscribe('userData', {\n            onStop: function () {\n                console.log(\"User profile subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"User profile subscription ready! \", arguments, this);\n            }\n        });\n        this.subscription2 = this.subscribe('userList', this.userId, {\n            onStop: function () {\n                console.log(\"User List subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"User List subscription ready! \", arguments, this);\n            }\n        });\n        console.log(this.subscription2);\n        this.subscription3 = this.subscribe('segmentList', this.userId, {\n            onStop: function () {\n                console.log(\"Segment List subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"Segment List subscription ready! \", arguments, this);\n            }\n        });\n        console.log(this.subscription3);\n    });\n});\nTemplate.user_profile.onRendered(function () {\n    Meteor.setTimeout(function() {\n        $(\"#input-bdate\").datetimepicker({\n            useCurrent:false,\n            showClear:true,\n            showClose:true,\n            format:'YYYY-MM-DD'\n        });\n    }, 1000);\n});\n\nTemplate.user_profile.helpers({\n    userId() {\n        return Template.instance().userId;\n    },\n    userSegmentList() {\n        let segList = [];\n        let s = UserSegment.find( );\n\n        s.forEach((m) => {\n            segList.push( {\n                value: m._id,\n                text: m.name\n            });\n        });\n        return segList;\n    },\n    assignedUserSegments() {\n        let uid = Template.instance().userId;\n        let u = User.findOne( {_id:uid} );\n\n        let assigned = [];\n\n        if (u) {\n            let segs = u.MyProfile.segments;\n            console.log(segs, segs[0], UserSegment.findOne( {_id:segs[0]} ));\n            for (let i = 0; i < segs.length; i++) {\n                let segTxt = UserSegment.findOne( {_id:segs[i]} ).name;\n                assigned.push( {\n                    value: segs[i],\n                    text: segTxt\n                });\n            }\n        }\n        console.log(\"assigned:\", assigned);\n        return assigned;\n    },\n    userField(fldName) {\n        let uid = Template.instance().userId;\n        let u = User.findOne( {_id:uid} );\n        if (u) {\n            switch (fldName) {\n            case 'firstName':\n                return u.MyProfile.firstName;\n                break;\n            case 'lastName':\n                return u.MyProfile.lastName;\n                break;\n            case 'fullName':\n                return u.MyProfile.fullName();\n                break;\n            case 'gender':\n                return (u.MyProfile.gender ? 'female' : 'male');\n                break;\n            case 'birthDate':\n                let d = u.MyProfile.birthDate;\n                let dateText = new Date(d.getTime() - d.getTimezoneOffset()*60000).toISOString().slice(0,-1);\n                return dateText;\n                break;\n            case 'dashboardPanes':\n                return (u.MyProfile.dashboardPanes.length > 0 ? 'Custom' : 'Default');\n                break;\n            }\n            return u.MyProfile.fullName();\n        } else {\n            return \"\";\n        }\n    },\n    genderSelected(label) {\n        let uid = Template.instance().userId;\n        let u = User.findOne( {_id:uid} );\n        if (!u) return \"\";\n        if (\n            (\"f\" === label.slice(0,1) || \"F\" === label.slice(0,1)) &&\n            u.MyProfile.gender === true\n        ) {\n            return \"selected\";\n        }\n        if (\n            (\"m\" === label.slice(0,1) || \"M\" === label.slice(0,1)) &&\n            u.MyProfile.gender === false\n        ) {\n            return \"selected\";\n        }\n        return \"\";\n    },\n    userName() {\n        let uid = Template.instance().userId;\n        let u = User.findOne( {_id:uid} );\n        if (u) {\n            return u.MyProfile.fullName();\n        } else {\n            return \"\";\n        }\n    },\n    emailAddress() {\n        let uid = Template.instance().userId;\n        let u = User.findOne( {_id:uid} );\n        if (u) {\n            emailAddresses = [];\n            for (let i = 0; i < u.emails.length; i++) {\n                emailAddresses.push(u.emails[i].address);\n            }\n            return emailAddresses.join(',');\n        } else {\n            return \"\";\n        }\n    },\n    itemAddHandler() {\n        return (value, $item) => {\n            let participant = {\n                id: value,\n                name: $item.text().slice(0,-1)\n            };\n        }\n    },\n    itemRemoveHandler() {\n        return (value, $item) => {\n            //\n        }\n    },\n});\n\nTemplate.user_profile.events({\n    'change input.flat,textarea.flat,select'(event, instance) {\n        $(event.target).addClass('changed');\n        $(\"#btn-group\").fadeIn();\n    },\n    'dp.change'(event, instance) {\n        $(event.target).addClass('changed');\n        $(\"#btn-group\").fadeIn();\n    },\n    'keyup input,textarea'(event, instance) {\n        let $t = $(event.target);\n        $t.addClass('changed');\n        $(\"#btn-group\").fadeIn( );\n    },\n    'click button.btn-save'(event, instance) {\n        let $t = $(event.target);\n        $t.closest(\".container\").find(\".changed\").removeClass(\"changed\");\n        //todo: update database\n        let uprofile = {\n            firstName: $(\"#input-fname\").val(),\n            lastName: $(\"#input-lname\").val(),\n            gender: (true == $(\"#input-gender\").val()),\n            birthDate: $(\"#input-bdate\").val(),\n            segments: $(\"#select-segments\").val()\n        };\n        let uid = Template.instance().userId;\n        let u = User.findOne( {_id:uid} );\n        if (u) {\n            u.profileUpdate(uprofile);\n        }\n    },\n    'click button.btn-cancel'(event, instance) {\n        let $t = $(event.target);\n        $t.closest(\".container\").find(\".changed\").removeClass(\"changed\");\n        $(\"#frm-profile\")[0].reset();\n    },\n});\n","import { UserSegment } from '/imports/api/user_segments/user_segments.js';\nimport './user_segments.html';\n\nTemplate.user_segments.onCreated(function () {\n    this.autorun( () => {\n        this.subscription = this.subscribe('segmentList', this.userId, {\n            onStop: function () {\n                console.log(\"Segment List subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"Segment List subscription ready! \", arguments, this);\n            }\n        });\n        console.log(this.subscription);\n    });\n});\n\nTemplate.user_segments.helpers({\n    segmentList() {\n        let s = UserSegment.find();\n        return s.fetch();\n    }\n});\n\nTemplate.user_segments.events({\n    'keyup input.edit':_.debounce(function (event, instance) {\n        let segid = $(event.target).closest(\"[data-segid]\").data(\"segid\");\n        console.log(segid, $(event.target).closest(\"[data-segid]\"));\n        let s = UserSegment.findOne( {_id:segid} );\n        let name = $(\"#seg-name-\"+segid).val();\n        let dscr = $(\"#seg-dscr-\"+segid).val();\n        s.update(name, dscr);\n    }, 2000),\n    'keyup input.new':_.debounce(function (event, instance) {\n        if ($(\"#seg-name-new\").val() !== \"\") {\n            $(\"#new-seg-save\").prop(\"disabled\", false);\n        } else {\n            $(\"#new-seg-save\").prop(\"disabled\", true);\n        }\n    }, 2000),\n    'click #new-seg-save'(event, instance) {\n        if ($(\"#seg-name-new\").val() !== \"\") {\n            let name = $(\"#seg-name-new\").val();\n            let dscr = $(\"#seg-dscr-new\").val();\n            Meteor.call('segment.createNewSegment', name, dscr);\n            $(\"#seg-name-new\").val(\"\");\n            $(\"#seg-dscr-new\").val(\"\");\n        }\n    }\n});\n","import { User } from '/imports/api/users/users.js';\nimport './verify.html';\n\nTemplate.user_profile.onCreated(function () {\n    this.autorun( () => {\n        this.subscription = this.subscribe('userData', {\n            onStop: function () {\n                console.log(\"User profile subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"User profile subscription ready! \", arguments, this);\n            }\n        });\n    });\n});\n\nTemplate.verify.events({\n    'click #resend-verify'(event, instance) {\n        event.preventDefault();\n        Meteor.call( 'user.sendVerificationEmail', () => {\n            console.log('resent');\n        });\n    }\n});\n","import { Class } from 'meteor/jagi:astronomy';\nimport { check } from 'meteor/check';\nconst DefaultCategoryID = \"xhKdwhacaWTcBTGPn\";\nconst TypeStats = Class.create({\n    name: 'TypeStats',\n    fields: {\n        num: {\n            type: Number,\n            default: 0\n        }\n    }\n});\nconst Category = Class.create({\n    name: 'Category',\n    collection: new Mongo.Collection('categories'),\n    fields: {\n        name: {\n            type: String,\n            default: \"the Unnamed Category\"\n        },\n        description: {\n            type: String,\n            default: \"this is the default stuff for a Category\"\n        },\n        stats: {\n            type: Object,\n            default: function () { return {}; }\n        }\n    },\n    helpers: {\n        addByType(type) {\n            if(!this.getStatsByType(type)) { this.stats[type] = new TypeStats(); }\n            this.getStatsByType(type).num++;\n            this.save();\n        },\n        removeByType(type) {\n            if(!this.getStatsByType(type)) { return false; }\n            this.getStatsByType(type).num--;\n            this.save();\n        },\n        getStatsByType(type) {\n            return this.stats[type];\n        }\n    },\n    meteorMethods: {\n        update(name, dscr) {\n            if (Roles.userIsInRole(Meteor.userId(), 'admin', Roles.GLOBAL_GROUP)) {\n                this.name = name;\n                this.description = dscr;\n                console.log(this.save());\n            }\n        }\n    }\n});\nCategory.Default = Category.findOne({_id:DefaultCategoryID});\nif (typeof Category.Default === \"undefined\") {\n    Category.Default = new Category({_id:DefaultCategoryID});\n    if (Meteor.isServer) {\n        Category.Default.save();\n    }\n}\n\nconst CategoryManager = Class.create({\n    name: 'CategoryManager',\n    fields: {\n        Categories: {\n            type: [String],\n            default: function () {\n                return [];\n            }\n        },\n        Type: {\n            type: String,\n            default: \"um... what!?\"\n        }\n    },\n    helpers: {\n        length() {\n            return this.Categories.length;\n        },\n        areIntersected(categoryManager) {\n            for(let i = 0; i < this.Categories.length; i++) {\n                for(let j = 0; j < categoryManager.Categories.length; i++) {\n                    if(this.Categories[i] == categoryManager.Categories[j]) { return true; }\n                }\n            }\n            return false;\n        },\n        addCategory(category, type) {\n            if(!type) { type = this.Type; }\n            this.Categories.push(category._id);\n            category.addByType(type);\n        },\n        hasCategory(category) {\n            if(this.Categories.length == 0) {\n                this.addCategory(Category.Default, this.Type);\n            }\n            return _.find(this.Categories, function (catId) {\n                return category._id == catId;\n            });\n        },\n        removeCategory(category, type, skipSlice) {\n            let index = -1;\n            _.each(this.Categories, function (catId, i) {\n                if(catId == category._id) {\n                    index = i;\n                }\n            });\n            if(index < 0) { return false; }\n            if(!skipSlice) {\n                if(index == 0) {\n                    this.Categories.shift();\n                } else if(index == this.Categories.length - 1) {\n                    this.Categories.pop();\n                } else {\n                    this.Categories = this.Categories.slice(0,index).concat(this.Categories.slice(index+1));\n                }\n            }\n            category.removeByType(type);\n        }\n    }\n});\nCategoryManager.OfType = function (type) {\n    let c = new CategoryManager();\n    c.Type = type;\n    return c;\n}\n\nexport { Category, CategoryManager };\n","import { Meteor } from 'meteor/meteor';\nimport { Mongo } from 'meteor/mongo';\nimport { User } from '../users/users.js';\nimport { Class, Enum } from 'meteor/jagi:astronomy';\nimport { UserNotify } from '/imports/api/user_notify/user_notify.js';\nimport { GoalComment } from '/imports/api/team_goals/team_goals.js';\n\nconst IndividualGoal = Class.create({\n    name: 'IndividualGoal',\n    collection: new Mongo.Collection('individual_goal'),\n    fields: {\n        userId: {\n            type: String,\n            default: ''\n        },\n        title: {\n            type: String,\n            default: ''\n        },\n        description: {\n            type: String,\n            default: ''\n        },\n        parentId: {\n            type: String,\n            default: ''\n        },\n        assignedToStr: {\n            type: String,\n            transient: true\n        },\n        reachedDate: {\n            type: Date,\n            optional: true\n        },\n        startDate: {\n            type: Date,\n            optional: true\n        },\n        dueDate: {\n            type: Date,\n            optional: true\n        },\n        reviewDate: {\n            type: Date,\n            optional: true\n        },\n        reviewedOnDate: {\n            type: Date,\n            optional: true\n        },\n        goalComments: {\n            type: [GoalComment],\n            default: []\n        },\n        reviewComments: {\n            type: [GoalComment],\n            default: []\n        },\n        teamId: {\n            type: String,\n            default: \"\"\n        },\n        privacy: {\n            type: String,\n            default: 'private'\n        },\n        createdBy: {\n            type: String,\n            default: ''\n        }\n    },\n    behaviors: {\n        timestamp: {}\n    },\n    helpers: {\n        getGoalRoleGroup() {\n            return this.teamName + '+' + this._id;\n        },\n        userIsAdmin() {\n            if (\n              Roles.userIsInRole(Meteor.userId(), 'admin', this.teamName)\n             ||\n              Roles.userIsInRole(Meteor.userId(), 'admin', this.getGoalRoleGroup())\n            ) {\n                //user is either a global admin, a team admin, or a goal admin\n                return true;\n            } else {\n                return false;\n            }\n        },\n        userIsMentor() {\n            if (\n                Roles.userIsInRole(Meteor.userId(), 'mentor', this.getGoalRoleGroup())\n            ) {\n                //user is a mentor for this goal\n                return true;\n            } else {\n                return false;\n            }\n        },\n        userIsAssigned() {\n            if (\n                Roles.userIsInRole(Meteor.userId(), 'assigned', this.getGoalRoleGroup())\n            ) {\n                //user is assigned to this goal\n                return true;\n            } else {\n                return false;\n            }\n        },\n        setDateField(fieldName, rdate) {\n            if ( typeof rdate === \"undefined\") {\n                rdate = new Date();\n            } else if ( !(rdate instanceof Date) ) {\n                return false;\n            }\n            this[fieldName] = rdate;\n            return true;\n        },\n        getUserFullNameX(userId) {\n            let u = User.findOne( {_id: userId} );\n            if (!u) {\n                return \"Michael\";\n            }\n            let name = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n            return name;\n        },\n        hasModifyPerm(fieldName) {\n            switch (fieldName) {\n            //admins-only fields\n            case 'dueDate':\n            case 'startDate':\n            case 'reachedDate':\n            case 'reviewDate':\n            case 'title':\n            case 'description':\n            case 'assignedTo':\n            case 'mentors':\n            case 'admins':\n            case 'subgoals':\n                return this.userIsAdmin();\n                break;\n            //admins and mentors\n            case 'reviewedOnDate':\n            case 'reviewComments':\n                return this.userIsAdmin() || this.userIsMentor();\n                break;\n            //anyone assigned to the goal\n            case 'goalComments':\n                return this.userIsAdmin() || this.userIsMentor() || this.userIsAssigned();\n                break;\n            case 'teamId':\n            case 'privacy':\n                return true;\n                break;\n            default:\n                return false;\n                break;\n            }\n        },\n        notifyNew(oldList,newList) {\n            let diffList = _.difference(newList,oldList);\n            for (let i = 0; i < diffList.length; i++) {\n                UserNotify.add({\n                    userId: diffList[i],\n                    title: 'Goals',\n                    body: 'You have been added to goal '+this.title,\n                    action: 'teamgoals:'+this.teamName\n                });\n            }\n        }\n    },\n    events: {\n        beforeSave(e) {\n            /*\n            let egoal = e.currentTarget;\n\n            //any user added to a goal is automatically added to the 'view-goals' role for the team\n            //if they are already in that role, this should just ignore the redundant addUser\n            let flds = [\"assignedTo\",\"mentors\",\"admins\"];\n            for (let i in flds) {\n                if (Array.isArray(egoal[flds[i]]) && egoal[flds[i]].length > 0) {\n                    Roles.addUsersToRoles(egoal[flds[i]], 'view-goals', egoal.teamName);\n                }\n            }\n            */\n        },\n    },\n    meteorMethods: {\n        setDueDate(rdate) {\n            //admins only\n            if ( !this.userIsAdmin() ) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n\n            if ( this.setDateField(\"dueDate\", rdate) ) {\n                this.save();\n            } else {\n                throw new Meteor.Error(403, \"Invalid date\");\n            }\n        },\n        setGoalReached(rdate) {\n            //admins only\n            if ( !this.userIsAdmin() ) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n\n            if ( this.setDateField(\"reachedDate\", rdate) ) {\n                this.save();\n            } else {\n                throw new Meteor.Error(403, \"Invalid date\");\n            }\n        },\n        setReviewDate(rdate) {\n            //admins only\n            if ( !this.userIsAdmin() ) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n\n            if ( this.setDateField(\"reviewDate\", rdate) ) {\n                this.save();\n            } else {\n                throw new Meteor.Error(403, \"Invalid date\");\n            }\n        },\n        setGoalReviewedOn(rdate) {\n            //mentors and admins\n            if ( !this.userIsAdmin() && !this.userIsMentor()) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n\n            if ( this.setDateField(\"reviewedOnDate\", rdate) ) {\n                this.save();\n            } else {\n                throw new Meteor.Error(403, \"Invalid date\");\n            }\n        },\n        addComment(commentTxt) {\n            //mentors, admins, and assignees\n            if ( !this.userIsAdmin() && !this.userIsMentor() && !this.userIsAssigned() ) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n\n            this.goalComments.push(\n                new GoalComment( {\n                    userId: Meteor.userId(),\n                    date: new Date(),\n                    text: commentTxt,\n                } )\n            );\n            this.save();\n        },\n        addReviewComment(commentTxt) {\n            //mentors and admins\n            if ( !this.userIsAdmin() && !this.userIsMentor() ) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n\n            this.reviewComments.push(\n                new GoalComment( {\n                    userId: Meteor.userId(),\n                    date: new Date(),\n                    text: commentTxt,\n                } )\n            );\n            this.save();\n        },\n        createNewGoal() {\n            //admins only\n            if ( !this.userIsAdmin() ) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n\n            //\n        },\n        setTitle(title) {\n            //admins only\n            if ( !this.userIsAdmin() ) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n\n            this.title = title;\n            this.save();\n        },\n        setDescription(descr) {\n            //admins only\n            if ( !this.userIsAdmin() ) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n\n            this.description = descr;\n            this.save();\n        },\n        setAssignedTo(ulist) {\n            //admins only\n            if ( !this.userIsAdmin() ) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n\n            this.notifyNew(this.assignedTo,ulist);\n            this.assignedTo = ulist;\n            this.save();\n        },\n        setMentors(ulist) {\n            //admins only\n            if ( !this.userIsAdmin() ) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n            this.notifyNew(this.mentors,ulist);\n            this.mentors = ulist;\n            this.save();\n        },\n        setAdmins(ulist) {\n            //admins only\n            if ( !this.userIsAdmin() ) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n\n            this.notifyNew(this.admins,ulist);\n            this.admins = ulist;\n            this.save();\n        },\n        getUserFullName(userId) {\n            const invocation = DDP._CurrentInvocation.get();\n            if (invocation.isSimulation) {\n                return \"George\";\n            }\n            let u = User.findOne( {_id: userId} );\n            if (!u) {\n                return \"Michael\";\n            }\n            let name = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n            return name;\n        },\n        updateFromObj(updObj) {\n            let permError = false;\n\n            for (let fld in updObj) {\n                if (\n                  this[fld] !== updObj[fld] ||\n                  (Array.isArray(updObj[fld]) && _.isEqual(this[fld], updObj[fld]))\n                ) {\n                    if (this.hasModifyPerm(fld)) {\n                        if (fld === \"assignedTo\" || fld === \"mentors\" || fld === \"admins\") {\n                            this.notifyNew(this[fld],updObj[fld]);\n                        }\n                        this[fld] = updObj[fld];\n                    } else {\n                        permError = true;\n                    }\n                }\n            }\n            this.save();\n            if (permError) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n        }\n    }\n});\n\nexport { IndividualGoal };\n","import { Meteor } from 'meteor/meteor';\nimport { Mongo } from 'meteor/mongo';\nimport { Class, Enum } from 'meteor/jagi:astronomy';\nimport { User } from '/imports/api/users/users.js';\nimport { UserNotify } from '/imports/api/user_notify/user_notify.js';\n\nvar fs = {};\nif (Meteor.isServer) {\n    fs = Npm.require('fs');\n}\n\nconst LSUser = Class.create({\n    name: 'LSUser',\n    fields: {\n        id: {\n            type: String,\n            default: ''\n        },\n        name: {\n            type: String,\n            default: 'John Doe'\n        }\n    }\n});\n\nconst LearnShareSession = Class.create({\n    name: \"LearnShareSession\",\n    collection: new Mongo.Collection('learn_share'),\n    fields: {\n        title: {\n            type: String,\n            default: \"unnamed Learn/Share session\"\n        },\n        notes: {\n            type: String,\n            default: \"duly noted\"\n        },\n        participants: {\n            type: [LSUser],\n            default: []\n        },\n        guests: {\n            type: [LSUser],\n            default: []\n        },\n        presenters: {\n            type: [LSUser],\n            default: []\n        },\n        state: {\n            type: String,\n            default: \"active\"\n        },\n        skypeUrl: {\n            type: String,\n            default: \"\"\n        },\n        teamId: {\n            type: String,\n            default: \"\"\n        }\n    },\n    behaviors: {\n        timestamp: {}\n    },\n    meteorMethods: {\n        addPresenter: function (user) {\n            if (\"locked\" === this.state) {\n                return;\n            }\n            var lsUser = new LSUser(user);\n\n            //check for duplicate\n            if (typeof _.find(this.presenters, function(o) {return o.id===lsUser.id;}) !== \"undefined\") {\n                return false;\n            }\n            this.presenters.push(lsUser);\n            return this.save();\n        },\n        addParticipant: function (user) {\n            if (\"locked\" === this.state) {\n                return;\n            }\n            var lsUser = new LSUser(user);\n\n            //check for duplicate\n            if (typeof _.find(this.participants, function(o) {return o.id===lsUser.id;}) !== \"undefined\") {\n                return false;\n            }\n            this.participants.push(lsUser);\n            UserNotify.add({\n                userId: lsUser.id,\n                title: 'Learn/Share',\n                body: 'You have been added to a Learn/Share session',\n                action: 'learnshare:'+this._id\n            });\n            return this.save();\n        },\n        removeParticipant: function (userId) {\n            if (\"locked\" === this.state) {\n                return;\n            }\n            this.participants = _.filter(this.participants, function (o) {return o.id!==userId});\n            return this.save();\n        },\n        removeGuest: function (userId) {\n            if (\"locked\" === this.state) {\n                return;\n            }\n            this.guests = _.filter(this.guests, function (o) {return o.id!==userId});\n            return this.save();\n        },\n        removePresenter: function (userId) {\n            if (\"locked\" === this.state) {\n                return;\n            }\n            this.presenters = _.filter(this.presenters, function (o) {return o.id!==userId});\n            return this.save();\n        },\n        addParticipantSelf: function () {\n            if (\"locked\" === this.state) {\n                return;\n            }\n            if (Meteor.userId()) {\n                //check for duplicate\n                if (typeof _.find(this.participants, function(o) {return o.id===Meteor.userId();}) === \"undefined\") {\n                    let u = User.findOne( {_id: Meteor.userId()} );\n                    if (!u) {\n                        throw new Meteor.Error(403, \"You are not authorized\");\n                    } else {\n                        let lsu = new LSUser({\n                            id: Meteor.userId(),\n                            name: u.MyProfile.firstName + \" \" + u.MyProfile.lastName\n                        })\n                        this.participants.push(lsu);\n                        this.save();\n                    }\n                }\n            } else {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n        },\n        saveGuest: function(guestId, guestName) {\n            if (\"locked\" === this.state) {\n                return;\n            }\n            let guestObj = _.find(this.guests, function(o) {return o.id===guestId;});\n            if (\"undefined\" !== typeof guestObj) {\n                console.log(\"already a guest\");\n                this.guests = _.filter(this.guests, function(o) {return o.id!==guestId});\n                guestObj.name = guestName;\n            } else {\n                console.log(\"not a guest\");\n                guestObj = new LSUser({id: guestId, name: guestName});\n            }\n            this.guests.push(guestObj);\n            this.save();\n        },\n        saveText: function (title, notes) {\n            if (\"locked\" === this.state) {\n                return;\n            }\n            if (Roles.userIsInRole(Meteor.userId(), ['admin','learn-share-host'], Roles.GLOBAL_GROUP)) {\n                this.title = title;\n                this.notes = notes;\n                this.save();\n            } else {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n        },\n        lockSession: function (title, notes) {\n            if (Roles.userIsInRole(Meteor.userId(), ['admin','learn-share-host'], Roles.GLOBAL_GROUP)) {\n                this.state = \"locked\";\n                this.save();\n            } else {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n        },\n        unlockSession: function (title, notes) {\n            if (Roles.userIsInRole(Meteor.userId(), ['admin','learn-share-host'], Roles.GLOBAL_GROUP)) {\n                this.state = \"active\";\n                this.save();\n            } else {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n        },\n        setSkypeUrl: function (url) {\n            if (Roles.userIsInRole(Meteor.userId(), ['admin','learn-share-host'], Roles.GLOBAL_GROUP)) {\n                this.skypeUrl = url;\n                this.save();\n            }\n        },\n        uploadRecording(fileInfo, fileData) {\n            if (Meteor.isServer && Roles.userIsInRole(Meteor.userId(), ['admin','learn-share-host'], Roles.GLOBAL_GROUP)) {\n                let uploadPath = '/uploads/';\n                fs.writeFile(uploadPath+this._id+\".mp4\", fileData, 'binary', (err) => {\n                    console.log(\"File written.\", err);\n                });\n            }\n        }\n    }\n});\n\nexport { LearnShareSession };\n","// Definition of the questions collection\n\nimport { Meteor } from 'meteor/meteor';\nimport { Mongo } from 'meteor/mongo';\nimport { Class, Enum } from 'meteor/jagi:astronomy';\nimport { check } from 'meteor/check';\nimport { User } from '../users/users.js';\nimport { Defaults } from '/imports/startup/both/defaults.js';\nimport { UserNotify } from '/imports/api/user_notify/user_notify.js';\n\nconst MyersBriggsCategory = Enum.create({\n    name: 'MyersBriggsCategory',\n    identifiers: ['IE','NS','TF','JP']\n});\nconst Reading = Class.create({\n    name:'Reading',\n    fields: {\n        Rank: {\n            type: Number,\n            default: 0,\n            validators: [{\n                type: 'lte',\n                resolveParam: function () { return 50; }\n            },{\n                type: 'gte',\n                resolveParam: function () { return -50; }\n            }]\n        },\n        Text: {\n            type:String,\n            default: 'Well, you feel...'\n        }\n    }\n});\nconst PolarStats = Class.create({\n    name: 'PolarStats',\n    fields: {\n        LeftSum: {\n            type: Number,\n            default: 0\n        },\n        RightSum: {\n            type: Number,\n            default: 0\n        }\n    },\n    helpers: {\n        reset() {\n            this.LeftSum = 0;\n            this.RightSum = 0;\n        }\n    }\n});\nconst Question = Class.create({\n    name: \"Question\",\n    collection: new Mongo.Collection('questions'),\n    fields: {\n        Category: {\n            type: MyersBriggsCategory,\n            default: 'IE'\n        },\n        Categories: {\n            type: [MyersBriggsCategory],\n            default: []\n        },\n        Text: {\n            type: String,\n            default: 'Whoa! What we askin\\' here?'\n        },\n        LeftText: {\n            type: String,\n            default: 'Whoa! What we askin\\' here?'\n        },\n        RightText: {\n            type: String,\n            default: 'Whoa! What we askin\\' here?'\n        },\n        Readings: {\n            type: [Reading],\n            default: function () {\n                return [\n                    { Rank: -50, Text: \"You will ALWAYS Do this. Doing otherwise is inconceivable to you.\"},\n                    { Rank: -49, Text: \"There may be a possible scenerio where the reverse may apply, but it would be really rare.\"},\n                    { Rank: -40, Text: \"You can think of cases where you have done things the other way, but not under normal circumstances. \"},\n                    { Rank: -30, Text: \"This is your most common behavior, but there are definitely times you've done the opposite.\"},\n                    { Rank: -20, Text: \"This is a good default choice for you, but time and circumstance could easily find you doing the other.\"},\n                    { Rank: -10, Text: \"You don't have much of a preference either way, but this side sounds a bit more likely.\"},\n                    { Rank: 10, Text: \"You don't have much of a preference either way, but this side sounds a bit more likely.\"},\n                    { Rank: 20, Text: \"This is a good default choice for you, but time and circumstance could easily find you doing the other.\"},\n                    { Rank: 30, Text: \"This is your most common behavior, but there are definitely times you've done the opposite.\"},\n                    { Rank: 40, Text: \"You can think of cases where you have done things the other way, but not under normal circumstances. \"},\n                    { Rank: 49, Text: \"There may be a possible scenerio where the reverse may apply, but it would be really rare.\"},\n                    { Rank: 50, Text: \"You will ALWAYS Do this. Doing otherwise is inconceivable to you.\"}\n                ];\n            }\n        },\n        segments: {\n            type: [String],\n            default: []\n        },\n        Active: {\n            type: Boolean,\n            default: false\n        },\n        CreatedBy: {\n            type: String,\n            default: function() { return Meteor.userId(); }\n        },\n        TimesAnswered: {\n            type: PolarStats,\n            default: function () { return new PolarStats(); }\n        },\n        SumOfAnswers: {\n            type: PolarStats,\n            default: function () { return new PolarStats(); }\n        }\n    },\n    meteorMethods: {\n        getUser() {\n            let u = User.findOne({_id:this.CreatedBy});\n            return u;\n        }\n    },\n    helpers: {\n        addAnswer(answer) {\n            if(answer.Value < 0) {\n                this.TimesAnswered.LeftSum++;\n                this.SumOfAnswers.LeftSum += answer.Value;\n            } else {\n                this.TimesAnswered.RightSum++;\n                this.SumOfAnswers.RightSum += answer.Value;\n            }\n            this.save();\n        },\n        removeAnswer(answer) {\n            if(answer.Value < 0) {\n                this.TimesAnswered.LeftSum--;\n                if(this.TimesAnswered.LeftSum <= 0) { this.TimesAnswered.LeftSum = 0; this.SumOfAnswers.LeftSum = 0; }\n                else { this.SumOfAnswers.LeftSum -= answer.Value; }\n            } else {\n                this.TimesAnswered.RightSum--;\n                if(this.TimesAnswered.RightSum <= 0) { this.TimesAnswered.RightSum = 0; this.SumOfAnswers.RightSum = 0; }\n                else { this.SumOfAnswers.RightSum -= answer.Value; }\n            }\n            this.save();\n        },\n        allAnsweredUsers() {\n            return User.find({ 'MyProfile.UserType.AnsweredQuestions.QuestionID':{ $eq: this._id } });\n        },\n        unanswerAll(noSave) {\n            let self = this;\n            self.allAnsweredUsers().forEach(function (user) {\n                let b = user.MyProfile.UserType.AnsweredQuestions.length;\n                user.MyProfile.UserType.unAnswerQuestion(user.MyProfile.UserType.getAnswerForQuestion(self._id), false);\n                if(!noSave) { user.save(); }\n            });\n            this.reset();\n        },\n        reset() {\n            this.TimesAnswered.reset();\n            this.SumOfAnswers.reset();\n            this.save();\n        }\n    },\n    behaviors: {\n        timestamp: {},\n        softremove: {}\n    },\n    secured: {\n        update: false\n    },\n    events: {\n        beforeInsert(e) {\n            let u = User.findOne( {username:Defaults.user.username} );\n            UserNotify.add({\n                userId: u._id,\n                title: 'Questions',\n                body: 'New question added',\n                action: 'questions:'+e.currentTarget._id\n            });\n        },\n        beforeUpdate(e) {\n            const allowed = [ 'updatedAt', 'TimesAnswered', 'TimesAnswered.LeftSum', 'SumOfAnswers', 'SumOfAnswers.LeftSum', 'TimesAnswered.RightSum', 'SumOfAnswers.RightSum' ];\n            const doc = e.currentTarget;\n            const fieldNames = doc.getModified();\n            _.each(fieldNames, function (fieldName) {\n                if(!Meteor.isServer && allowed.indexOf(fieldName) < 0 && !Roles.userIsInRole(Meteor.userId(), ['admin'], Roles.GLOBAL_GROUP)) {\n                    throw new Meteor.Error(403, \"You are not authorized\");\n                }\n            });\n        }\n    }\n});\n\nexport { Question, Reading, MyersBriggsCategory };\n","import { Meteor } from 'meteor/meteor';\nimport { Mongo } from 'meteor/mongo';\nimport { User } from '../users/users.js';\nimport { Class, Enum } from 'meteor/jagi:astronomy';\nimport { UserNotify } from '/imports/api/user_notify/user_notify.js';\n\nconst GoalComment = Class.create({\n    name: 'GoalComment',\n    fields: {\n        userId: {\n            type: String,\n            default: function() { return Meteor.userId(); }\n        },\n        date: {\n            type: Date,\n            default: function() { return new Date(); }\n        },\n        text: {\n            type: String,\n            default: ''\n        }\n    }\n});\n\nconst TeamGoal = Class.create({\n    name: 'TeamGoal',\n    collection: new Mongo.Collection('team_goal'),\n    fields: {\n        teamName: {\n            type: String,\n            default: ''\n        },\n        title: {\n            type: String,\n            default: ''\n        },\n        description: {\n            type: String,\n            default: ''\n        },\n        parentId: {\n            type: String,\n            default: ''\n        },\n        assignedTo: {\n            type: [String],\n            default: []\n        },\n        mentors: {\n            type: [String],\n            default: []\n        },\n        assignedToStr: {\n            type: String,\n            transient: true\n        },\n        mentorsStr: {\n            type: String,\n            transient: true\n        },\n        adminsStr: {\n            type: String,\n            transient: true\n        },\n        admins: {\n            type: [String],\n            default: []\n        },\n        reachedDate: {\n            type: Date,\n            optional: true\n        },\n        startDate: {\n            type: Date,\n            optional: true\n        },\n        dueDate: {\n            type: Date,\n            optional: true\n        },\n        reviewDate: {\n            type: Date,\n            optional: true\n        },\n        reviewedOnDate: {\n            type: Date,\n            optional: true\n        },\n        goalComments: {\n            type: [GoalComment],\n            default: []\n        },\n        reviewComments: {\n            type: [GoalComment],\n            default: []\n        }\n    },\n    behaviors: {\n        timestamp: {}\n    },\n    helpers: {\n        getGoalRoleGroup() {\n            return this.teamName + '+' + this._id;\n        },\n        userIsAdmin() {\n            if (\n              Roles.userIsInRole(Meteor.userId(), 'admin', this.teamName)\n             ||\n              Roles.userIsInRole(Meteor.userId(), 'admin', this.getGoalRoleGroup())\n            ) {\n                //user is either a global admin, a team admin, or a goal admin\n                return true;\n            } else {\n                return false;\n            }\n        },\n        userIsMentor() {\n            if (\n                Roles.userIsInRole(Meteor.userId(), 'mentor', this.getGoalRoleGroup())\n            ) {\n                //user is a mentor for this goal\n                return true;\n            } else {\n                return false;\n            }\n        },\n        userIsAssigned() {\n            if (\n                Roles.userIsInRole(Meteor.userId(), 'assigned', this.getGoalRoleGroup())\n            ) {\n                //user is assigned to this goal\n                return true;\n            } else {\n                return false;\n            }\n        },\n        setDateField(fieldName, rdate) {\n            if ( typeof rdate === \"undefined\") {\n                rdate = new Date();\n            } else if ( !(rdate instanceof Date) ) {\n                return false;\n            }\n            this[fieldName] = rdate;\n            return true;\n        },\n        getUserFullNameX(userId) {\n            let u = User.findOne( {_id: userId} );\n            if (!u) {\n                return \"Michael\";\n            }\n            let name = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n            return name;\n        },\n        hasModifyPerm(fieldName) {\n            switch (fieldName) {\n            //admins-only fields\n            case 'dueDate':\n            case 'startDate':\n            case 'reachedDate':\n            case 'reviewDate':\n            case 'title':\n            case 'description':\n            case 'assignedTo':\n            case 'mentors':\n            case 'admins':\n            case 'subgoals':\n                return this.userIsAdmin();\n                break;\n            //admins and mentors\n            case 'reviewedOnDate':\n            case 'reviewComments':\n                return this.userIsAdmin() || this.userIsMentor();\n                break;\n            //anyone assigned to the goal\n            case 'goalComments':\n                return this.userIsAdmin() || this.userIsMentor() || this.userIsAssigned();\n                break;\n            default:\n                return false;\n                break;\n            }\n        },\n        notifyNew(oldList,newList) {\n            let diffList = _.difference(newList,oldList);\n            for (let i = 0; i < diffList.length; i++) {\n                UserNotify.add({\n                    userId: diffList[i],\n                    title: 'Team Goals',\n                    body: 'You have been added to goal '+this.title,\n                    action: 'teamgoals:'+this.teamName\n                });\n            }\n        }\n    },\n    events: {\n        beforeSave(e) {\n            let egoal = e.currentTarget;\n\n            //any user added to a goal is automatically added to the 'view-goals' role for the team\n            //if they are already in that role, this should just ignore the redundant addUser\n            let flds = [\"assignedTo\",\"mentors\",\"admins\"];\n            for (let i in flds) {\n                if (Array.isArray(egoal[flds[i]]) && egoal[flds[i]].length > 0) {\n                    Roles.addUsersToRoles(egoal[flds[i]], 'view-goals', egoal.teamName);\n                }\n            }\n        },\n    },\n    meteorMethods: {\n        setDueDate(rdate) {\n            //admins only\n            if ( !this.userIsAdmin() ) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n\n            if ( this.setDateField(\"dueDate\", rdate) ) {\n                this.save();\n            } else {\n                throw new Meteor.Error(403, \"Invalid date\");\n            }\n        },\n        setGoalReached(rdate) {\n            //admins only\n            if ( !this.userIsAdmin() ) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n\n            if ( this.setDateField(\"reachedDate\", rdate) ) {\n                this.save();\n            } else {\n                throw new Meteor.Error(403, \"Invalid date\");\n            }\n        },\n        setReviewDate(rdate) {\n            //admins only\n            if ( !this.userIsAdmin() ) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n\n            if ( this.setDateField(\"reviewDate\", rdate) ) {\n                this.save();\n            } else {\n                throw new Meteor.Error(403, \"Invalid date\");\n            }\n        },\n        setGoalReviewedOn(rdate) {\n            //mentors and admins\n            if ( !this.userIsAdmin() && !this.userIsMentor()) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n\n            if ( this.setDateField(\"reviewedOnDate\", rdate) ) {\n                this.save();\n            } else {\n                throw new Meteor.Error(403, \"Invalid date\");\n            }\n        },\n        addComment(commentTxt) {\n            //mentors, admins, and assignees\n            if ( !this.userIsAdmin() && !this.userIsMentor() && !this.userIsAssigned() ) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n\n            this.goalComments.push(\n                new GoalComment( {\n                    userId: Meteor.userId(),\n                    date: new Date(),\n                    text: commentTxt,\n                } )\n            );\n            this.save();\n        },\n        addReviewComment(commentTxt) {\n            //mentors and admins\n            if ( !this.userIsAdmin() && !this.userIsMentor() ) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n\n            this.reviewComments.push(\n                new GoalComment( {\n                    userId: Meteor.userId(),\n                    date: new Date(),\n                    text: commentTxt,\n                } )\n            );\n            this.save();\n        },\n        createNewGoal() {\n            //admins only\n            if ( !this.userIsAdmin() ) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n\n            //\n        },\n        setTitle(title) {\n            //admins only\n            if ( !this.userIsAdmin() ) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n\n            this.title = title;\n            this.save();\n        },\n        setDescription(descr) {\n            //admins only\n            if ( !this.userIsAdmin() ) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n\n            this.description = descr;\n            this.save();\n        },\n        setAssignedTo(ulist) {\n            //admins only\n            if ( !this.userIsAdmin() ) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n\n            this.notifyNew(this.assignedTo,ulist);\n            this.assignedTo = ulist;\n            this.save();\n        },\n        setMentors(ulist) {\n            //admins only\n            if ( !this.userIsAdmin() ) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n            this.notifyNew(this.mentors,ulist);\n            this.mentors = ulist;\n            this.save();\n        },\n        setAdmins(ulist) {\n            //admins only\n            if ( !this.userIsAdmin() ) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n\n            this.notifyNew(this.admins,ulist);\n            this.admins = ulist;\n            this.save();\n        },\n        getUserFullName(userId) {\n            const invocation = DDP._CurrentInvocation.get();\n            if (invocation.isSimulation) {\n                return \"George\";\n            }\n            let u = User.findOne( {_id: userId} );\n            if (!u) {\n                return \"Michael\";\n            }\n            let name = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n            return name;\n        },\n        updateFromObj(updObj) {\n            let permError = false;\n\n            for (let fld in updObj) {\n                if (\n                  this[fld] !== updObj[fld] ||\n                  (Array.isArray(updObj[fld]) && _.isEqual(this[fld], updObj[fld]))\n                ) {\n                    if (this.hasModifyPerm(fld)) {\n                        if (fld === \"assignedTo\" || fld === \"mentors\" || fld === \"admins\") {\n                            this.notifyNew(this[fld],updObj[fld]);\n                        }\n                        this[fld] = updObj[fld];\n                    } else {\n                        permError = true;\n                    }\n                }\n            }\n            this.save();\n            if (permError) {\n                throw new Meteor.Error(403, \"You are not authorized\");\n            }\n        }\n    }\n});\n\nexport { TeamGoal, GoalComment };\n","import { Meteor } from 'meteor/meteor';\nimport { Mongo } from 'meteor/mongo';\nimport { Class, Enum } from 'meteor/jagi:astronomy';\nimport { check } from 'meteor/check';\nimport { User } from '../users/users.js';\nimport { Defaults } from '/imports/startup/both/defaults.js';\nimport { UserNotify } from '/imports/api/user_notify/user_notify.js';\nconst DefaultTeamID = \"NCuypCXN47KrSTeXh\";\n\nconst TeamIcon = Class.create({\n    name: \"TeamIcon\",\n    fields: {\n        data: {\n            type: String,\n            default: ''\n        },\n        contentType: {\n            type: String,\n            default: 'image/png'\n        }\n    }\n});\n\nconst Team = Class.create({\n    name: \"Team\",\n    collection: new Mongo.Collection('teams'),\n    fields: {\n        Name: {\n            type: String,\n            default: 'Whoa! The no-name team?'\n        },\n        Description: {\n        \ttype: String,\n        \tdefault: 'This team is nondescript.'\n        },\n        Icon64: {\n            type: String,\n            default: ''\n        },\n        IconType: {\n            type: String,\n            defaut: 'image/png',\n            optional: true\n        },\n        Icon: {\n            type: TeamIcon,\n            default: function() { return new TeamIcon(); }\n        },\n        Public: {\n            type: Boolean,\n            default: true\n        },\n        Members: {\n            type: [String],\n            default: []\n        },\n        Active: {\n            type: Boolean,\n            default: false\n        },\n        CreatedBy: {\n            type: String,\n            default: function() { return this.userId; }\n        },\n    },\n    indexes: {\n        nameIndex: {\n            fields: {\n                Name: 1\n            },\n            options: {\n                unique: true\n            },\n        }\n    },\n    meteorMethods: {\n        userRequestJoin() {\n            Roles.addUsersToRoles(Meteor.userId(), 'user-join-request', this.Name);\n        },\n        adminRequestUserJoin(user) {\n            if (Roles.userIsInRole(Meteor.userId(), 'admin', this.Name) && !Roles.userIsInRole(user, 'member', this.Name)) {\n                Roles.addUsersToRoles(user, 'admin-join-request', this.Name);\n                for (let i = 0; i < user.length; i++) {\n                    UserNotify.add({\n                        userId: user[i],\n                        title: 'Teams',\n                        body: 'Received join request for team ' + this.Name,\n                        action: 'teams:'+this.Name.split(' ').join('-')\n                    });\n                }\n            }\n        },\n        userAcceptJoin() {\n            if (Roles.userIsInRole(Meteor.userId(), 'admin-join-request', this.Name)) {\n                Roles.removeUsersFromRoles(Meteor.userId(), 'admin-join-request', this.Name);\n                this.addUsers(Meteor.userId());\n            }\n        },\n        userDeclineJoin() {\n            if (Roles.userIsInRole(Meteor.userId(), 'admin-join-request', this.Name)) {\n                Roles.removeUsersFromRoles(Meteor.userId(), 'admin-join-request', this.Name);\n            }\n        },\n        adminAcceptJoin(userId) {\n            if (Roles.userIsInRole(Meteor.userId(), 'admin', this.Name)) {\n                Roles.removeUsersFromRoles(userId, 'user-join-request', this.Name);\n                //Roles.addUsersToRoles(userId, 'member', this.Name);\n                this.addUsers(userId);\n            }\n        },\n        adminRejectJoin(userId) {\n            if (Roles.userIsInRole(Meteor.userId(), 'admin', this.Name)) {\n                Roles.removeUsersFromRoles(userId, 'user-join-request', this.Name);\n            }\n        },\n        addRole(userId, role) {\n            if (Roles.userIsInRole(Meteor.userId(), 'admin', this.Name)) {\n                Roles.addUsersToRoles(userId, role, this.Name);\n            }\n        },\n        removeRole(userId, role) {\n            if (Roles.userIsInRole(Meteor.userId(), 'admin', this.Name)) {\n                Roles.removeUsersFromRoles(userId, role, this.Name);\n            }\n        },\n        updateFromObj(updObj) {\n            if (Roles.userIsInRole(Meteor.userId(), 'admin', this.Name)) {\n                for (let fld in updObj) {\n                    if (\"Icon64\" !== fld && \"IconType\" !== fld && \"Icon\" !== fld) {\n                        this[fld] = updObj[fld];\n                    }\n                }\n                this.save();\n            }\n        },\n        uploadIcon(fileInfo, fileData) {\n            if (Meteor.isServer) {\n                var base64Image = new Buffer(fileData, 'binary').toString('base64');\n                this.Icon64 = base64Image;\n                this.IconType = 'image/png';\n                this.save();\n            }\n        }\n    },\n    helpers: {\n        addUsers(users) {\n            if (typeof users === 'string') {\n                users = [users];\n            }\n\n            //admin list has to be filtered because getUsersInRole includes admin in GLOBAL_GROUP\n            let groupAdminList = Roles.getUsersInRole('admin', this.Name).fetch().filter( (user) => {\n                return (\n                    \"undefined\" !== typeof user.roles &&\n                    \"undefined\" !== typeof user.roles[this.Name] &&\n                    user.roles[this.Name].indexOf('admin') > -1\n                );\n            });\n\n            for (let i = 0; i < users.length; i++) {\n                if (this.Members.indexOf(users[i]) === -1) {\n                    this.Members.push( users[i] );\n                }\n                let currUserRoles = ['member'];\n                //Roles.addUsersToRoles(users[i], 'member', this.Name);\n\n                //if team doesn't have an admin, the first user added becomes admin\n                if (i == 0 && groupAdminList.length == 0) {\n                    //Roles.addUsersToRoles(users[i], 'admin', this.Name);\n                    currUserRoles.push('admin');\n                } else {\n                    //Roles.addUsersToRoles(users[i], Defaults.role.name, this.Name);\n                    currUserRoles.push(Defaults.role.name);\n                }\n                Roles.addUsersToRoles(users[i], currUserRoles, this.Name);\n                /*\n                let u = User.findOne( {_id: users[i]} );\n                if (u && u.teams.indexOf(this.Name) === -1) {\n                    u.teams.push(this.Name);\n                    u.save();\n                }\n                */\n            }\n            this.save();\n        },\n        removeUsers(users) {\n            if (typeof users === 'string') {\n                users = [users];\n            }\n\n            for (let i = 0; i < users.length; i++) {\n            }\n        },\n        removeUsersFromTeamRoles(users, roles) {\n            if (typeof users === 'string') {\n                users = [users];\n            }\n            if (typeof roles === 'string') {\n                roles = [roles];\n            }\n\n            //if removing the 'member' role from users, completely remove them from all roles and from the group\n            if (roles.indexOf('member') !== -1) {\n                this.removeUsers(users)\n            }\n\n            for (let i = 0; i < users.length; i++) {\n            }\n        }\n    },\n    behaviors: {\n        timestamp: {},\n        softremove: {}\n    },\n    secured: {\n    },\n    events: {\n        afterInit(e) {\n            //\n        },\n        beforeSave(e) {\n            console.log(\"before save Team\", e.currentTarget.Name, e.currentTarget.Members);\n        }\n    }\n});\n\nTeam.Default = Team.findOne({_id:DefaultTeamID});\nif (typeof Team.Default === \"undefined\") {\n    Team.Default = new Team({\n        _id:DefaultTeamID,\n        Name: 'No Team',\n        Active: true\n    });\n    if (Meteor.isServer) {\n        Team.Default.CreatedBy = 'kkcDYH3ix4f4Lb5qk';\n        //console.log(Team.Default);\n        //Team.Default.save();\n    }\n}\n\nexport { Team,TeamIcon };\n","import { Class } from 'meteor/jagi:astronomy';\nimport { check } from 'meteor/check';\nimport { Mongo } from 'meteor/mongo';\nimport { MyersBriggsCategory } from '../questions/questions.js';\nimport { Category, CategoryManager } from '../categories/categories.js';\n\nconst ReadingRange = Class.create({\n    name: \"ReadingRange\",\n    fields: {\n        high: {\n            type: Number,\n            default: 50\n        },\n        low: {\n            type: Number,\n            default: 0\n        },\n        Delta: {\n            type: Number,\n            default: 50\n        }\n    },\n    helpers: {\n        in(val) {\n            return this.low <= val && val <= this.high;\n        },\n        setDelta() {\n            this.Delta = this.high - this.low;\n            return this;\n        }\n    }\n});\nReadingRange.Create = function(high, low) {\n    let m = new ReadingRange();\n    m.high = high;\n    m.low = low;\n    return m.setDelta();\n}\nReadingRange.FullHigh = function () {\n    return ReadingRange.Create(50, 0);\n}\nReadingRange.FullLow = function () {\n    return ReadingRange.Create(0, -50);\n}\nconst TypeReadingCategory = Class.create({\n    name: \"TypeReadingCategory\",\n    fields: {\n        MyersBriggsCategory: {\n            type: MyersBriggsCategory\n        },\n        Range: {\n            type: ReadingRange,\n            default: function () {\n                return ReadingRange.FullHigh;\n            }\n        }\n    }\n});\nconst TypeReadingCategories = Class.create({\n    name: \"TypeReadingCategories\",\n    fields: {\n        0: {\n            type:TypeReadingCategory,\n            optional: true\n        },\n        1: {\n            type:TypeReadingCategory,\n            optional: true\n        },\n        2: {\n            type:TypeReadingCategory,\n            optional: true\n        },\n        3: {\n            type:TypeReadingCategory,\n            optional: true\n        }\n    }\n});\nconst TypeReading = Class.create({\n    name: \"TypeReading\",\n    collection: new Mongo.Collection('type_readings'),\n    fields: {\n        TypeReadingCategories: {\n            type: TypeReadingCategories,\n            default: {}\n        },\n        Categories: {\n            type: CategoryManager,\n            default: function () {\n                return CategoryManager.OfType(\"TypeReading\");\n            }\n        },\n        Header: {\n            type: String,\n            default: \"\"\n        },\n        Body: {\n            type: String,\n            default: \"\"\n        },\n        CreatedBy: {\n            type: String,\n            default: function() { return Meteor.userId(); }\n        },\n        Enabled: {\n            type: Boolean,\n            default: false\n        }\n    },\n    helpers: {\n        toggle() {\n            this.Enabled = !this.Enabled;\n            this.save();\n        },\n        addTypeCategory(cat) {\n            this.TypeReadingCategories[cat.MyersBriggsCategory] = cat;\n        }\n    },\n    events: {\n        beforeSave(e) {\n            _.forEach(e.target.TypeReadingCategories, (reading) => { \n                if(reading == null) { return; }\n                reading.Range.setDelta();\n            });\n            if(e.target.Categories.length() < 1) {\n                e.target.Categories.addCategory(Category.Default);\n            }\n        }\n    }\n});\n\nexport { TypeReading, ReadingRange, TypeReadingCategory, TypeReadingCategories };","import { Meteor } from 'meteor/meteor';\nimport { Mongo } from 'meteor/mongo';\nimport { Class, Enum } from 'meteor/jagi:astronomy';\n\nconst UserFeedback = Class.create({\n    name: 'UserFeedback',\n    collection: new Mongo.Collection('user_feedback'),\n    fields: {\n        userId: {\n            type: String,\n            default: ''\n        },\n        source: {\n            type: String,\n            default: ''\n        },\n        context: {\n            type: String,\n            default: ''\n        },\n        comment: {\n            type: String,\n            default: ''\n        },\n        dateCreated: {\n            type: Date,\n            default: function() { return new Date(); }\n        }\n    }\n});\n\nexport { UserFeedback };\n","import { Meteor } from 'meteor/meteor';\nimport { Mongo } from 'meteor/mongo';\nimport { Class, Enum } from 'meteor/jagi:astronomy';\nimport { User } from '../users/users.js';\nimport { Email } from 'meteor/email';\n\nlet UserNotify = Class.create({\n    name: \"UserNotify\",\n    collection: new Mongo.Collection('user_notify'),\n    fields: {\n        userId: {\n            type: String,\n            default: ''\n        },\n        isRead: {\n            type: Boolean,\n            default: false\n        },\n        isPushed: {\n            type: Boolean,\n            default: false\n        },\n        isEmailed: {\n            type: Boolean,\n            default: false\n        },\n        title: {\n            type: String,\n            default: ''\n        },\n        body: {\n            type: String,\n            default: ''\n        },\n        action: {\n            type: String,\n            default: ''\n        },\n        createdDate: {\n            type: Date,\n            default: function () { return new Date(); }\n        }\n    },\n    meteorMethods: {\n        markRead() {\n            this.isRead = true;\n            this.save();\n        },\n        markNotified() {\n            this.isPushed = true;\n            this.save();\n        }\n    },\n    helpers: {\n        test() {\n            console.log(\"123\");\n        },\n        pushNotify(opts) {\n            let noteOpts = {\n                body: this.body,\n                icon: '/img/panda.png',\n                data: this._id\n            }\n            let browserNote;\n\n            if (!(\"Notification\" in window)) {\n                alert(\"This browser does not support desktop notification\");\n            }\n\n            // Let's check whether notification permissions have already been granted\n            else if (Notification.permission === \"granted\") {\n                // If it's okay let's create a notification\n                browserNote = new Notification(this.title, noteOpts);\n            }\n\n            // Otherwise, we need to ask the user for permission\n            else if (Notification.permission !== \"denied\") {\n                Notification.requestPermission(function (permission) {\n                    // If the user accepts, let's create a notification\n                    if (permission === \"granted\") {\n                        browserNote = new Notification(this.title, noteOpts);\n                    }\n                });\n            }\n            if (Notification.permission === \"granted\" && typeof opts.onclick !== 'undefined') {\n                browserNote.onclick = opts.onclick;\n            }\n        }\n    },\n    events: {\n        beforeSave(e) {\n            if (Meteor.isServer) {\n                let note = e.currentTarget;\n                if (!note.isEmailed) {\n                    let u = User.findOne( {_id:note.userId} );\n                    if (u) {\n                        let addr = u.emails[0].address;\n                        Email.send({\n                            to: addr,\n                            from: \"wayne@paladinarcher.com\",\n                            subject: \"Developer Level Notification - \"+note.title,\n                            text: note.body\n                        });\n                    }\n                }\n            }\n        }\n    }\n});\n\nif (Meteor.isClient) {\n    //\n}\n\nUserNotify.add = function(opts) {\n    let notify = new UserNotify(opts);\n    notify.save();\n}\n\nexport { UserNotify };\n","import { Meteor } from 'meteor/meteor';\nimport { Mongo } from 'meteor/mongo';\nimport { Class, Enum } from 'meteor/jagi:astronomy';\n\nconst UserSegment = Class.create({\n    name: 'UserSegment',\n    collection: new Mongo.Collection('user_segments'),\n    fields: {\n        name: {\n            type: String,\n            default: 'Default user segment'\n        },\n        description: {\n            type: String,\n            default: 'The default user segment for relevant content'\n        }\n    }\n});\n\nexport { UserSegment };\n","import { Class } from 'meteor/jagi:astronomy';\nimport { check } from 'meteor/check';\nimport { MyersBriggsCategory, Question } from '../questions/questions.js';\nimport { Category, CategoryManager } from '../categories/categories.js';\nimport { Defaults } from '../../startup/both/defaults.js';\nimport { Team } from '../teams/teams.js';\nimport { UserSegment } from '../user_segments/user_segments.js';\n\nconst MyersBriggsBit = Class.create({\n    name: 'MyersBriggsBit',\n    fields: {\n        Value: {\n            type: Number,\n            default: 0\n        },\n        Totals: {\n            type: Number,\n            default: 0\n        },\n        QuestionCount: {\n            type: Number,\n            default: 0\n        }\n    },\n    helpers: {\n        addValue(value) {\n            this.Totals += value;\n            this.QuestionCount ++;\n            this.Value = (this.QuestionCount == 0 ? 0 :this.Totals / this.QuestionCount);\n        },\n        removeValue(value) {\n            this.QuestionCount --;\n            if(this.QuestionCount < 0) { this.QuestionCount = 0; }\n            if(this.QuestionCount == 0) { this.Totals = this.Value = 0; return; }\n            this.Totals -= value;\n            this.Value = this.Totals / this.QuestionCount;\n        },\n        reset() {\n            this.Totals = 0;\n            this.QuestionCount = 0;\n            this.Value = 0;\n        }\n    }\n});\nconst MyersBriggs = Class.create({\n    name: 'MyersBriggs',\n    fields: {\n        IE: {\n            type: MyersBriggsBit,\n            default: function () { return new MyersBriggsBit(); }\n        },\n        NS: {\n            type: MyersBriggsBit,\n            default: function () { return new MyersBriggsBit(); }\n        },\n        TF: {\n            type: MyersBriggsBit,\n            default: function () { return new MyersBriggsBit(); }\n        },\n        JP: {\n            type: MyersBriggsBit,\n            default: function () { return new MyersBriggsBit(); }\n        }\n    },\n    helpers: {\n        addByCategory(category, value) {\n            console.log(category, value);\n            let name = this.getIdentifierById(category);\n            this[name].addValue(value);\n        },\n        removeByCategory(category, value) {\n            let name = this.getIdentifierById(category);\n            this[name].removeValue(value);\n        },\n        getIdentifierById(categoryId) {\n            if(categoryId === 0) { return 'IE'; }\n            if(categoryId === 1) { return 'NS'; }\n            if(categoryId === 2) { return 'TF'; }\n            return 'JP';\n        },\n        getFourLetter() {\n            let IEL = (this.IE.Value === 0 ? '_' : (this.IE.Value < 0 ? 'I' : 'E'));\n            let NSL = (this.NS.Value === 0 ? '_' : (this.NS.Value < 0 ? 'N' : 'S'));\n            let TFL = (this.TF.Value === 0 ? '_' : (this.TF.Value < 0 ? 'T' : 'F'));\n            let JPL = (this.JP.Value === 0 ? '_' : (this.JP.Value < 0 ? 'J' : 'P'));\n            return `${IEL}${NSL}${TFL}${JPL}`;\n        },\n        reset() {\n            for(let i = 0; i < 4; i++) {\n                this[this.getIdentifierById(i)].reset();\n            }\n        }\n    }\n});\nconst Answer = Class.create({\n    name: 'Answer',\n    fields: {\n        Category: {\n            type:MyersBriggsCategory,\n            default:0\n        },\n        Categories: {\n            type: [MyersBriggsCategory],\n            default: []\n        },\n        QuestionID: {\n            type: String,\n            default:''\n        },\n        Reversed: {\n            type: Boolean,\n            default:false\n        },\n        Value: {\n            type: Number,\n            default:0\n        },\n        AnsweredAt: {\n            type: Date,\n            default: function () { return new Date(); }\n        }\n    },\n    helpers: {\n        getQuestion() {\n            let q = Question.findOne({_id:this.QuestionID});\n            return q;\n        },\n        unanswer() {\n            this.getQuestion().removeAnswer(this);\n        }\n    }\n});\nconst UserType = Class.create({\n    name: 'UserType',\n    fields: {\n        Personality: {\n            type: MyersBriggs,\n            default: function () { return new MyersBriggs(); }\n        },\n        AnsweredQuestions: {\n            type: [Answer],\n            default: function() { return []; }\n        },\n        TotalQuestions: {\n            type: Number,\n            default:0\n        }\n    },\n    helpers: {\n        getAnsweredQuestionsIDs() {\n            let qids = [];\n            _.each(this.AnsweredQuestions, function (ans) {\n                qids.push(ans.QuestionID);\n            });\n            return qids;\n        },\n        setTotalQuestions(totalQuestions) {\n            //console.log(\"user.js totalQuestions\", totalQuestions);\n            this.TotalQuestions = totalQuestions;\n            //console.log(\"user.js totalQuestions2\", this.TotalQuestions);\n        },\n        getTotalQuestions() {\n          return this.TotalQuestions;\n        },\n        answerQuestion(answer) {\n            this.AnsweredQuestions.push(answer);\n            console.log(this.AnsweredQuestions);\n            console.log(answer.Categories);\n            let contextThis = this;\n            _.each(answer.Categories, function (cat) {\n                contextThis.Personality.addByCategory(cat, answer.Value);\n            });\n            //this.Personality.addByCategory(answer.Category, answer.Value);\n        },\n        unAnswerQuestion(answer, skipSlice) {\n            let index = this.getAnswerIndexForQuestionID(answer.QuestionID);\n            let before = this.AnsweredQuestions.length;\n\n            if(index < 0) { return; }\n            console.log(index);\n            if(!skipSlice) {\n                if(index == 0) {\n                    this.AnsweredQuestions.shift();\n                } else if(index == this.AnsweredQuestions.length - 1) {\n                    this.AnsweredQuestions.pop();\n                } else {\n                    this.AnsweredQuestions = this.AnsweredQuestions.slice(0,index).concat(this.AnsweredQuestions.slice(index+1));\n                }\n            }\n            answer.unanswer();\n            _.each(answer.Categories, function (cat) {\n                this.Personality.removeByCategory(cat, answer.Value);\n            });\n            //this.Personality.removeByCategory(answer.Category, answer.Value);\n            console.log(\"User Answer Count: \"+before+\" => \"+this.AnsweredQuestions.length);\n        },\n        getAnswerIndexForQuestionID(questionId) {\n            for(let i = 0; i < this.AnsweredQuestions.length; i++) {\n                if(this.AnsweredQuestions[i].QuestionID == questionId) { return i; }\n            }\n            return -1;\n        },\n        getAnswerForQuestion(questionId) {\n            return _.find(this.AnsweredQuestions, function (ans, i) {\n                return ans.QuestionID == questionId;\n            });\n        },\n        reset() {\n            let self = this;\n            _.each(this.AnsweredQuestions, function (ans) {\n                self.unAnswerQuestion(ans, true);\n            });\n            this.Personality.reset();\n            this.AnsweredQuestions = [];\n        }\n    }\n});\n\nconst DashboardPane = Class.create({\n    name: 'DashboardPane',\n    fields: {\n        size: {\n            type: Number,\n            default: 4\n        },\n        name: {\n            type: String,\n            default: 'App_home'\n        },\n        title: {\n            type: String,\n            default: 'Personality Questions'\n        },\n        route: {\n            type: String,\n            default: '/'\n        }\n    }\n})\n\nconst Profile = Class.create({\n    name: 'Profile',\n    fields: {\n        firstName: {\n            type: String,\n            validators: [{\n              type: 'minLength',\n              param: 2\n            }]\n        },\n        lastName: {\n            type: String,\n            validators: [{\n              type: 'minLength',\n              param: 2\n            }]\n        },\n        UserType: {\n            type: UserType,\n            default: function () { return new UserType(); }\n        },\n        gender: {\n            type: Boolean,\n            default: false\n        },\n        birthDate: {\n            type: Date,\n            optional: true\n        },\n        Categories: {\n            type: CategoryManager,\n            default: function() {\n                return CategoryManager.OfType(\"User\");\n            }\n        },\n        dashboardPanes: {\n            type: [DashboardPane],\n            default: []\n        },\n        segments: {\n            type: [String],\n            default: []\n        }\n    },\n    helpers: {\n        calculateAge() {\n            if (this.birthDate) {\n                const diff = Date.now() - this.birthDate.getTime();\n                this.age = Math.abs((new Date(diff)).getUTCFullYear() - 1970);\n            }\n        },\n        fullName(param) {\n            var fullName = this.firstName + ' ' + this.lastName;\n            if (param === 'lower') { return fullName.toLowerCase(); }\n            else if (param === 'upper') { return fullName.toUpperCase(); }\n            return fullName;\n        }\n    },\n});\n\nconst User = Class.create({\n    name: 'User',\n    collection: Meteor.users,\n    fields:{\n        createdAt: Date,\n        emails: {\n            type: [Object],\n            default: function() { return []; }\n        },\n        MyProfile: {\n            type: Profile,\n            default: function() { return new Profile(); }\n        },\n        teams: {\n        \ttype: [String],\n        \tdefault: function() { return [ Team.Default.Name ]; }\n        },\n        roles: {\n            type: Object\n        }\n    },\n    resolveError({ nestedName, validator }) {\n        console.log(nestedName, validator);\n    },\n    events: {\n        afterInit(e) {\n            e.target.MyProfile.calculateAge();\n        },\n        beforeSave(e) {\n            if (e.currentTarget.MyProfile.Categories.length() === 0) {\n                e.currentTarget.MyProfile.Categories.addCategory(Category.Default);\n            }\n            if (e.currentTarget.teams.length === 0) {\n            \te.currentTarget.addTeam( Team.Default.Name );\n            }\n        }\n    },\n    meteorMethods: {\n        create() {\n            return this.save();\n        },\n        changeName(firstName, lastName) {\n            check(firstName, String);\n            check(lastName, String);\n            this.MyProfile.firstName = firstName;\n            this.MyProfile.lastName = lastName;\n            return this.save();\n        },\n        fullName(param) {\n            return this.MyProfile.fullName(param);\n        },\n        addTeam(teamName) {\n        \tlet teamDoc = Team.findOne({ \"Name\" : teamName});\n        \tif (typeof teamDoc !== \"undefined\") {\n                teamDoc.addUsers(this._id);\n        \t} else {\n                return false;\n            }\n        },\n        profileUpdate(uprofile) {\n            check(uprofile.firstName, String);\n            check(uprofile.lastName, String);\n            check(uprofile.gender, Boolean);\n\n            this.MyProfile.firstName = uprofile.firstName;\n            this.MyProfile.lastName = uprofile.lastName;\n            this.MyProfile.gender = uprofile.gender;\n            this.MyProfile.segments = uprofile.segments;\n            if (\"\" !== uprofile.birthDate) {\n                this.MyProfile.birthDate = new Date(uprofile.birthDate);\n            }\n            return this.save();\n        }\n    },\n    indexes: {\n    },\n    behaviors: {\n        slug: {\n            fieldName: 'email'\n        },\n        timestamp: {}\n    }\n});\n\nif (Meteor.isServer) {\n  User.extend({\n    fields: {\n      services: Object\n    }\n  });\n}\n\nexport { User, Profile, UserType, MyersBriggs, Answer };\n","import { User } from '/imports/api/users/users.js';\nimport { Team } from '/imports/api/teams/teams.js';\nimport { Defaults } from '/imports/startup/both/defaults.js';\n\nconst myPostLogout = function(){\n    //example redirect after logout\n    FlowRouter.go('/signin');\n};\nconst mySubmitFunc = function(error, state){\n  if (!error) {\n    if (state === \"signIn\") {\n      // Successfully logged in\n      // ...\n    }\n    if (state === \"signUp\") {\n      // Successfully registered\n      // ...\n    }\n  }\n};\nfunction myPreSubmitFunc()  { console.log(\"Pre:  \", arguments); }\n\nfunction myPostSubmitFunc(userId, info) {\n    Accounts.emailTemplates.siteName = \"DeveloperLevel\";\n    Accounts.emailTemplates.from     = \"DeveloperLevel <wayne@paladinarcher.com>\";\n\n    Accounts.emailTemplates.verifyEmail = {\n        subject() {\n            return \"[DeveloperLevel] Verify your email address\";\n        },\n        text( user, url ) {\n            let emailAddress   = user.emails[0].address,\n                urlWithoutHash = url.replace( '#/', '' ),\n                supportEmail   = \"support@developerlevel.com\",\n                emailBody      = `To verify your email address (${emailAddress}) visit the following link:\\n\\n${urlWithoutHash}\\n\\n If you did not request this verification, please ignore this email.`;\n\n            return emailBody;\n        }\n    };\n    Accounts.sendVerificationEmail( userId );\n    console.log(\"Post: \", arguments);\n}\n\nAccountsTemplates.configure({\n    // Behavior\n    confirmPassword: true,\n    enablePasswordChange: true,\n    forbidClientAccountCreation: false,\n    overrideLoginErrors: true,\n    sendVerificationEmail: false,\n    lowercaseUsername: false,\n    focusFirstInput: true,\n\n    // Appearance\n    showAddRemoveServices: false,\n    showForgotPasswordLink: true,\n    showLabels: true,\n    showPlaceholders: true,\n    showResendVerificationEmailLink: false,\n\n    // Client-side Validation\n\n    continuousValidation: false,\n    negativeFeedback: false,\n    negativeValidation: true,\n    positiveValidation: true,\n    positiveFeedback: true,\n    showValidating: true,\n\n\n    // Privacy Policy and Terms of Use\n    privacyUrl: 'privacy',\n    termsUrl: 'terms-of-use',\n\n    // Redirects\n    homeRoutePath: '/',\n    redirectTimeout: 4000,\n\n    // Routing\n\n    defaultTemplate: 'Auth_page',\n    defaultLayout: 'App_body',\n    defaultContentRegion: 'main',\n    defaultLayoutRegions: {},\n\n    // Hooks\n    onLogoutHook: myPostLogout,\n    onSubmitHook: mySubmitFunc,\n    preSignUpHook: myPreSubmitFunc,\n    postSignUpHook: myPostSubmitFunc,\n\n    // Texts\n    texts: {\n      button: {\n          signUp: \"Register Now!\"\n      },\n      socialSignUp: \"Register\",\n      socialIcons: {\n          \"meteor-developer\": \"fa fa-rocket\"\n      },\n      title: {\n          forgotPwd: \"Recover Your Password\"\n      },\n      inputIcons: {\n          isValidating: \"fa fa-spinner fa-spin\",\n          hasSuccess: \"fa fa-check\",\n          hasError: \"fa fa-times\",\n      }\n    },\n});\n\n// Define these routes in a file loaded on both client and server\nAccountsTemplates.configureRoute('signIn', {\n  name: 'signin',\n  path: '/signin'\n});\nAccountsTemplates.configureRoute('signUp', {\n  name: 'join',\n  path: '/join'\n});\nAccountsTemplates.configureRoute('forgotPwd');\nAccountsTemplates.configureRoute('resetPwd', {\n  name: 'resetPwd',\n  path: '/reset-password'\n});\n\nAccountsTemplates.addFields([{\n    _id: \"first_name\",\n    type: \"text\",\n    required: true,\n    displayName: \"First Name\",\n    func: function(value) {\n        //if(Meteor.isClient) {\n            console.log(\"Firstname validation: \", value);\n\n        //}\n        return false;\n    }},{\n    _id: \"last_name\",\n    type: \"text\",\n    required: true,\n    displayName: \"Last Name\",\n    func: function(value) {\n        //if(Meteor.isClient) {\n            console.log(\"Lastname validation: \", value);\n\n        //}\n        return false;\n    }},{\n    _id: \"gender\",\n    type: \"select\",\n    required: true,\n    displayName: \"Gender\",\n    select: [\n        {\n            text: \"Male\",\n            value: \"male\",\n        },\n        {\n            text: \"Female\",\n            value: \"female\",\n        },\n    ],\n}]);\nif(Meteor.isServer) {\n    Accounts.onCreateUser((options, user) => {\n        user.slug = options.email;\n        user.updateAt = user.createdAt;\n        user.MyProfile = {\n            firstName: options.profile.first_name,\n            lastName: options.profile.last_name,\n            gender: (options.profile.gender === \"female\"),\n            UserType: {\n                Personality: {\n                    IE: {},\n                    NS: {},\n                    TF: {},\n                    JP: {}\n                },\n                AnsweredQuestions: []\n            },\n            birthDate: undefined,\n            age: undefined\n        };\n        user.teams = [ Team.Default.Name ];\n        user.roles = {};\n        user.profile = options.profile;\n        if(options.isAdmin && options.username === 'admin') {\n            user.roles[Roles.GLOBAL_GROUP] = ['admin'];\n            Roles.addUsersToRoles(user._id, 'admin', Roles.GLOBAL_GROUP);\n        } else {\n            let t = Team.findOne( {Name: Team.Default.Name} );\n            user.roles[Team.Default.Name] = ['member', Defaults.role.name];\n            t.addUsers( user._id );\n\t\t}\n        return user;\n    });\n    Accounts.validateNewUser(function (user) {\n        var loggedInUser;\n        try { loggedInUser = Meteor.user(); }\n        catch(ex) {\n            console.log(ex);\n        }\n\n        if (!loggedInUser || Roles.userIsInRole(loggedInUser, ['admin','manage-users'], Roles.GLOBAL_GROUP)) {\n          // NOTE: This example assumes the user is not using groups.\n          return true;\n        }\n\n        throw new Meteor.Error(403, \"Not authorized to create new users\");\n    });\n}\n","const Defaults = {\n\t'user': {\n\t\t'username': 'admin',\n\t\t'email': 'admin@mydomain.com',\n\t\t'isAdmin': true,\n\t\t'profile': {\n\t\t\t'first_name': 'Admin',\n\t\t\t'last_name': 'Admin',\n\t\t\t'gender': 'female'\n\t\t}\n\t},\n\t'team': {\n\t\t'Name': \"No Team\",\n\t\t'Public': true,\n\t\t'Members': [],\n\t\t'Active': true,\n\t},\n\t'role': {\n\t\t'name': 'No-Permissions'\n\t}\n}\n\nexport { Defaults };","// Import modules used by both client and server through a single index entry point\n// e.g. useraccounts configuration file.\nif(Meteor.isClient) { Session.setDefault('refreshQuestions', Math.random()); }\nimport './at_config.js';","Meteor.subscribe('userData');\n/*Meteor.subscribe('teamsData', Meteor.userId(), {\n    onReady: function() {\n        console.log(\"teamsData subscription ready\");\n    }\n}); */\n","// Import client startup through a single index entry point\n\nimport './config.js';\nimport './routes.js';\n","import { FlowRouter } from 'meteor/kadira:flow-router';\nimport { BlazeLayout } from 'meteor/kadira:blaze-layout';\nimport { LearnShareSession } from '/imports/api/learn_share/learn_share.js';\nimport { UserNotify } from '/imports/api/user_notify/user_notify.js';\n\n// Import needed templates\nimport '../../ui/layouts/body/body.js';\nimport '../../ui/components/header/header.js';\nimport '../../ui/components/loading/loading.html';\nimport '../../ui/components/select_feedback/select_feedback.js';\nimport '../../ui/components/team_icon/team_icon.html';\nimport '../../ui/components/video_embed/video_embed.js';\nimport '../../ui/pages/home/home.js';\nimport '../../ui/pages/add_questions/add_questions.js';\nimport '../../ui/pages/add_readings/add_readings.js';\nimport '../../ui/pages/admin_teams/admin_teams.js';\nimport '../../ui/pages/learn_share/learn_share.js';\nimport '../../ui/pages/learn_share_list/learn_share_list.js';\nimport '../../ui/pages/team_goals/team_goals.js';\nimport '../../ui/pages/individual_goals/individual_goals.js';\nimport '../../ui/pages/user_dashboard/user_dashboard.js';\nimport '../../ui/pages/ask_questions/ask_questions.js';\nimport '../../ui/pages/dash_min/dash_min.js';\nimport '../../ui/pages/user_profile/user_profile.js';\nimport '../../ui/pages/not-found/not-found.js';\nimport '../../ui/pages/verify/verify.js';\nimport '../../ui/pages/user_segments/user_segments.js';\nimport '../../ui/layouts/login/login.js';\n\nlet ensureEmailVerified = function() {\n\tMeteor.setTimeout(() => {\n\t\tconsole.log(\"tttt\", Meteor.user(), Meteor.user().emails[0].verified);\n\t\tif ((typeof Meteor.user().username === \"undefined\" || Meteor.user().username !== \"admin\") && !Meteor.user().emails[0].verified) {\n\t\t\tFlowRouter.redirect(\"/verify/notverified\");\n\t\t}\n\t},500);\n}\n\n// Set up all routes in the app\nFlowRouter.route('/', {\n\ttriggersEnter: [AccountsTemplates.ensureSignedIn,ensureEmailVerified],\n    name: 'App.home',\n    action() {\n      FlowRouter.redirect(\"/dashboard\");\n    },\n});\nFlowRouter.route('/dashboard', {\n\ttriggersEnter: [AccountsTemplates.ensureSignedIn,ensureEmailVerified],\n    name: 'dashboard',\n    action() {\n      BlazeLayout.render('App_body', { top: 'header', main: 'dash_min' });\n    },\n});\nFlowRouter.route('/controlcenter', {\n\ttriggersEnter: [AccountsTemplates.ensureSignedIn,ensureEmailVerified],\n    name: 'controlcenter',\n    action() {\n      BlazeLayout.render('App_body', { top: 'header', main: 'user_dashboard' });\n    },\n});\nFlowRouter.route('/questions', {\n\ttriggersEnter: [AccountsTemplates.ensureSignedIn,ensureEmailVerified],\n    name: 'ask_questions',\n    action() {\n      BlazeLayout.render('App_body', { top: 'header', main: 'ask_questions' });\n    },\n});\nFlowRouter.route('/signin', {\n    name: 'signin',\n    action() {\n        BlazeLayout.render('Auth_page', { });\n    }\n});\nFlowRouter.route('/addQuestions/:category', {\n\ttriggersEnter: [AccountsTemplates.ensureSignedIn,ensureEmailVerified],\n    name: 'addQuestions',\n    action(params, queryParams) {\n        BlazeLayout.render('App_body', { top: 'header', main: 'add_questions' });\n    }\n});\nFlowRouter.route('/addTraitDescriptions', {\n\ttriggersEnter: [AccountsTemplates.ensureSignedIn,ensureEmailVerified],\n    name: 'addTraitDescriptions',\n    action(params, queryParams) {\n        BlazeLayout.render('App_body', { top: 'header', main: 'add_readings' });\n    }\n});\nFlowRouter.route('/adminTeams', {\n\ttriggersEnter: [AccountsTemplates.ensureSignedIn,ensureEmailVerified],\n    name: 'adminTeams',\n    action(params, queryParams) {\n        BlazeLayout.render('App_body', { top: 'header', main: 'admin_teams' });\n    }\n});\nFlowRouter.route('/adminTeams/:teamName', {\n\ttriggersEnter: [AccountsTemplates.ensureSignedIn,ensureEmailVerified],\n    name: 'adminTeams',\n    action(params, queryParams) {\n        BlazeLayout.render('App_body', { top: 'header', main: 'admin_teams' });\n    }\n});\nFlowRouter.route('/learnShareList', {\n\ttriggersEnter: [AccountsTemplates.ensureSignedIn,ensureEmailVerified],\n    name: 'learnShareList',\n    action(params, queryParams) {\n        BlazeLayout.render('App_body', { top: 'header', main: 'learn_share_list' });\n    }\n});\nFlowRouter.route('/learnShare/:lssid', {\n    //triggersEnter: [AccountsTemplates.ensureSignedIn],\n    name: 'learnShare',\n    action(params, queryParams) {\n        BlazeLayout.render('App_body', { top: 'header', main: 'learn_share' });\n    }\n});\nFlowRouter.route('/learnShare', {\n    //triggersEnter: [AccountsTemplates.ensureSignedIn],\n    name: 'learnShare',\n    action(params, queryParams) {\n\t\tif (sessionStorage.lastLearnShareId) {\n\t\t\tFlowRouter.go('/learnShare/'+sessionStorage.lastLearnShareId+location.hash);\n\t\t} else {\n\t\t\tBlazeLayout.render('App_body', { main: 'App_notFound' });\n\t\t}\n    }\n});\nFlowRouter.route('/teamGoals/:teamName', {\n\ttriggersEnter: [AccountsTemplates.ensureSignedIn,ensureEmailVerified],\n    name: 'teamGoals',\n    action(params, queryParams) {\n        BlazeLayout.render('App_body', { top: 'header', main: 'team_goals' });\n    }\n});\nFlowRouter.route('/teamGoals/:teamName/:goalId', {\n\ttriggersEnter: [AccountsTemplates.ensureSignedIn,ensureEmailVerified],\n    name: 'teamGoals',\n    action(params, queryParams) {\n        BlazeLayout.render('App_body', { top: 'header', main: 'team_goals' });\n    }\n});\nFlowRouter.route('/goals', {\n\ttriggersEnter: [AccountsTemplates.ensureSignedIn,ensureEmailVerified],\n    name: 'individualGoals',\n    action(params, queryParams) {\n        BlazeLayout.render('App_body', { top: 'header', main: 'individual_goals' });\n    }\n});\nFlowRouter.route('/goals/:userId', {\n\ttriggersEnter: [AccountsTemplates.ensureSignedIn,ensureEmailVerified],\n    name: 'individualGoals',\n    action(params, queryParams) {\n        BlazeLayout.render('App_body', { top: 'header', main: 'individual_goals' });\n    }\n});\nFlowRouter.route('/userSegments', {\n\ttriggersEnter: [AccountsTemplates.ensureSignedIn,ensureEmailVerified],\n    name: 'userSegments',\n    action(params, queryParams) {\n        BlazeLayout.render('App_body', { top: 'header', main: 'user_segments' });\n    }\n});\nFlowRouter.route('/profile', {\n\ttriggersEnter: [AccountsTemplates.ensureSignedIn,ensureEmailVerified],\n    name: 'profile',\n    action(params, queryParams) {\n        BlazeLayout.render('App_body', { top: 'header', main: 'user_profile' });\n    }\n});\nFlowRouter.route('/profile/:userId', {\n\ttriggersEnter: [AccountsTemplates.ensureSignedIn,ensureEmailVerified],\n    name: 'profile',\n    action(params, queryParams) {\n        BlazeLayout.render('App_body', { top: 'header', main: 'user_profile' });\n    }\n});\nFlowRouter.route( '/verify-email/:token', {\n\tname: 'verify-email',\n\taction( params ) {\n\t\tAccounts.verifyEmail( params.token, ( error ) =>{\n\t\t\tif ( error ) {\n\t\t\t\tUserNotify.add({\n\t\t\t\t\tuserId: Meteor.userId(),\n\t\t\t\t\ttitle: 'Verification Error',\n\t\t\t\t\tbody: 'Error: email address not verified',\n\t\t\t\t\taction: 'verify:error'\n\t\t\t\t});\n\t\t\t\tFlowRouter.go( '/verify/error' );\n\t\t\t} else {\n\t\t\t\tUserNotify.add({\n\t\t\t\t\tuserId: Meteor.userId(),\n\t\t\t\t\ttitle: 'Verification Success',\n\t\t\t\t\tbody: 'Success: your email address has been verified',\n\t\t\t\t\taction: 'verify:success'\n\t\t\t\t});\n\t\t\t\tFlowRouter.go( '/' );\n\t\t\t}\n\t\t});\n\t}\n});\nFlowRouter.route('/verify/:vparam', {\n\ttriggersEnter: [AccountsTemplates.ensureSignedIn],\n\taction(params, queryParams) {\n\t\tBlazeLayout.render('verify');\n\t}\n});\nFlowRouter.notFound = {\n    action() {\n        BlazeLayout.render('App_body', { main: 'App_notFound' });\n    },\n};\n","// Client entry point, imports all client code\n\nimport '/imports/startup/both';\nimport '/imports/startup/client';\n"]}}]