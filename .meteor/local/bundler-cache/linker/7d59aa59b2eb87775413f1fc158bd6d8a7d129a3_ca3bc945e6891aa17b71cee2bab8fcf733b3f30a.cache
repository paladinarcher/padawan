[{"type":"js","data":"//////////////////////////////////////////////////////////////////////////\n//                                                                      //\n// This is a generated file. You can view the original                  //\n// source in your browser if your browser supports source maps.         //\n// Source maps are supported by all recent versions of Chrome, Safari,  //\n// and Firefox, and by Internet Explorer 11.                            //\n//                                                                      //\n//////////////////////////////////////////////////////////////////////////\n\n\n(function () {\n\n/* Imports */\nvar Meteor = Package.meteor.Meteor;\nvar global = Package.meteor.global;\nvar meteorEnv = Package.meteor.meteorEnv;\nvar Tracker = Package.tracker.Tracker;\nvar Deps = Package.tracker.Deps;\nvar ServiceConfiguration = Package['service-configuration'].ServiceConfiguration;\nvar Accounts = Package['accounts-base'].Accounts;\nvar _ = Package.underscore._;\nvar Template = Package['templating-runtime'].Template;\nvar Session = Package.session.Session;\nvar Blaze = Package.blaze.Blaze;\nvar UI = Package.blaze.UI;\nvar Handlebars = Package.blaze.Handlebars;\nvar Spacebars = Package.spacebars.Spacebars;\nvar HTML = Package.htmljs.HTML;\n\n/* Package-scope variables */\nvar passwordSignupFields, displayName, getLoginServices, hasPasswordService, dropdown, validateUsername, validateEmail, validatePassword;\n\n(function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// packages/accounts-ui-unstyled/accounts_ui.js                                                                        //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n/**\n * @summary Accounts UI\n * @namespace\n * @memberOf Accounts\n * @importFromPackage accounts-base\n */\nAccounts.ui = {};\n\nAccounts.ui._options = {\n  requestPermissions: {},\n  requestOfflineToken: {},\n  forceApprovalPrompt: {}\n};\n\n// XXX refactor duplicated code in this function\n\n/**\n * @summary Configure the behavior of [`{{> loginButtons}}`](#accountsui).\n * @locus Client\n * @param {Object} options\n * @param {Object} options.requestPermissions Which [permissions](#requestpermissions) to request from the user for each external service.\n * @param {Object} options.requestOfflineToken To ask the user for permission to act on their behalf when offline, map the relevant external service to `true`. Currently only supported with Google. See [Meteor.loginWithExternalService](#meteor_loginwithexternalservice) for more details.\n * @param {Object} options.forceApprovalPrompt If true, forces the user to approve the app's permissions, even if previously approved. Currently only supported with Google.\n * @param {String} options.passwordSignupFields Which fields to display in the user creation form. One of '`USERNAME_AND_EMAIL`', '`USERNAME_AND_OPTIONAL_EMAIL`', '`USERNAME_ONLY`', or '`EMAIL_ONLY`' (default).\n * @importFromPackage accounts-base\n */\nAccounts.ui.config = function(options) {\n  // validate options keys\n  var VALID_KEYS = ['passwordSignupFields', 'requestPermissions', 'requestOfflineToken', 'forceApprovalPrompt'];\n  _.each(_.keys(options), function (key) {\n    if (!_.contains(VALID_KEYS, key))\n      throw new Error(\"Accounts.ui.config: Invalid key: \" + key);\n  });\n\n  // deal with `passwordSignupFields`\n  if (options.passwordSignupFields) {\n    if (_.contains([\n      \"USERNAME_AND_EMAIL\",\n      \"USERNAME_AND_OPTIONAL_EMAIL\",\n      \"USERNAME_ONLY\",\n      \"EMAIL_ONLY\"\n    ], options.passwordSignupFields)) {\n      if (Accounts.ui._options.passwordSignupFields)\n        throw new Error(\"Accounts.ui.config: Can't set `passwordSignupFields` more than once\");\n      else\n        Accounts.ui._options.passwordSignupFields = options.passwordSignupFields;\n    } else {\n      throw new Error(\"Accounts.ui.config: Invalid option for `passwordSignupFields`: \" + options.passwordSignupFields);\n    }\n  }\n\n  // deal with `requestPermissions`\n  if (options.requestPermissions) {\n    _.each(options.requestPermissions, function (scope, service) {\n      if (Accounts.ui._options.requestPermissions[service]) {\n        throw new Error(\"Accounts.ui.config: Can't set `requestPermissions` more than once for \" + service);\n      } else if (!(scope instanceof Array)) {\n        throw new Error(\"Accounts.ui.config: Value for `requestPermissions` must be an array\");\n      } else {\n        Accounts.ui._options.requestPermissions[service] = scope;\n      }\n    });\n  }\n\n  // deal with `requestOfflineToken`\n  if (options.requestOfflineToken) {\n    _.each(options.requestOfflineToken, function (value, service) {\n      if (service !== 'google')\n        throw new Error(\"Accounts.ui.config: `requestOfflineToken` only supported for Google login at the moment.\");\n\n      if (Accounts.ui._options.requestOfflineToken[service]) {\n        throw new Error(\"Accounts.ui.config: Can't set `requestOfflineToken` more than once for \" + service);\n      } else {\n        Accounts.ui._options.requestOfflineToken[service] = value;\n      }\n    });\n  }\n\n  // deal with `forceApprovalPrompt`\n  if (options.forceApprovalPrompt) {\n    _.each(options.forceApprovalPrompt, function (value, service) {\n      if (service !== 'google')\n        throw new Error(\"Accounts.ui.config: `forceApprovalPrompt` only supported for Google login at the moment.\");\n\n      if (Accounts.ui._options.forceApprovalPrompt[service]) {\n        throw new Error(\"Accounts.ui.config: Can't set `forceApprovalPrompt` more than once for \" + service);\n      } else {\n        Accounts.ui._options.forceApprovalPrompt[service] = value;\n      }\n    });\n  }\n};\n\npasswordSignupFields = function () {\n  return Accounts.ui._options.passwordSignupFields || \"EMAIL_ONLY\";\n};\n\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n\n\n\n\n(function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// packages/accounts-ui-unstyled/template.login_buttons.js                                                             //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"loginButtons\");\nTemplate[\"loginButtons\"] = new Template(\"Template.loginButtons\", (function() {\n  var view = this;\n  return HTML.DIV({\n    id: \"login-buttons\",\n    class: function() {\n      return [ \"login-buttons-dropdown-align-\", Spacebars.mustache(view.lookup(\"align\")) ];\n    }\n  }, \"\\n    \", Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"currentUser\"));\n  }, function() {\n    return [ \"\\n      \", Blaze.If(function() {\n      return Spacebars.call(view.lookup(\"loggingInOrOut\"));\n    }, function() {\n      return [ \"\\n        \\n        \", Blaze.If(function() {\n        return Spacebars.call(view.lookup(\"dropdown\"));\n      }, function() {\n        return [ \"\\n          \", Spacebars.include(view.lookupTemplate(\"_loginButtonsLoggingIn\")), \"\\n        \" ];\n      }, function() {\n        return [ \"\\n          \", HTML.DIV({\n          class: \"login-buttons-with-only-one-button\"\n        }, \"\\n            \", Spacebars.include(view.lookupTemplate(\"_loginButtonsLoggingInSingleLoginButton\")), \"\\n          \"), \"\\n        \" ];\n      }), \"\\n      \" ];\n    }, function() {\n      return [ \"\\n        \", Spacebars.include(view.lookupTemplate(\"_loginButtonsLoggedIn\")), \"\\n      \" ];\n    }), \"\\n    \" ];\n  }, function() {\n    return [ \"\\n      \", Spacebars.include(view.lookupTemplate(\"_loginButtonsLoggedOut\")), \"\\n    \" ];\n  }), \"\\n  \");\n}));\n\nTemplate.__checkName(\"_loginButtonsLoggedIn\");\nTemplate[\"_loginButtonsLoggedIn\"] = new Template(\"Template._loginButtonsLoggedIn\", (function() {\n  var view = this;\n  return Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"dropdown\"));\n  }, function() {\n    return [ \"\\n    \", Spacebars.include(view.lookupTemplate(\"_loginButtonsLoggedInDropdown\")), \"\\n  \" ];\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      class: \"login-buttons-with-only-one-button\"\n    }, \"\\n      \", Spacebars.include(view.lookupTemplate(\"_loginButtonsLoggedInSingleLogoutButton\")), \"\\n    \"), \"\\n  \" ];\n  });\n}));\n\nTemplate.__checkName(\"_loginButtonsLoggedOut\");\nTemplate[\"_loginButtonsLoggedOut\"] = new Template(\"Template._loginButtonsLoggedOut\", (function() {\n  var view = this;\n  return Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"services\"));\n  }, function() {\n    return [ \" \\n    \", Blaze.If(function() {\n      return Spacebars.call(view.lookup(\"configurationLoaded\"));\n    }, function() {\n      return [ \"\\n      \", Blaze.If(function() {\n        return Spacebars.call(view.lookup(\"dropdown\"));\n      }, function() {\n        return [ \" \\n        \", Spacebars.include(view.lookupTemplate(\"_loginButtonsLoggedOutDropdown\")), \"\\n      \" ];\n      }, function() {\n        return [ \"\\n        \", Spacebars.With(function() {\n          return Spacebars.call(view.lookup(\"singleService\"));\n        }, function() {\n          return [ \" \\n          \", HTML.DIV({\n            class: \"login-buttons-with-only-one-button\"\n          }, \"\\n            \", Blaze.If(function() {\n            return Spacebars.call(view.lookup(\"loggingIn\"));\n          }, function() {\n            return [ \"\\n              \", Spacebars.include(view.lookupTemplate(\"_loginButtonsLoggingInSingleLoginButton\")), \"\\n            \" ];\n          }, function() {\n            return [ \"\\n              \", Spacebars.include(view.lookupTemplate(\"_loginButtonsLoggedOutSingleLoginButton\")), \"\\n            \" ];\n          }), \"\\n          \"), \"\\n        \" ];\n        }), \"\\n      \" ];\n      }), \"\\n    \" ];\n    }), \"\\n  \" ];\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      class: \"no-services\"\n    }, \"No login services configured\"), \"\\n  \" ];\n  });\n}));\n\nTemplate.__checkName(\"_loginButtonsMessages\");\nTemplate[\"_loginButtonsMessages\"] = new Template(\"Template._loginButtonsMessages\", (function() {\n  var view = this;\n  return [ Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"errorMessage\"));\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      class: \"message error-message\"\n    }, Blaze.View(\"lookup:errorMessage\", function() {\n      return Spacebars.mustache(view.lookup(\"errorMessage\"));\n    })), \"\\n  \" ];\n  }), \"\\n  \", Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"infoMessage\"));\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      class: \"message info-message\"\n    }, Blaze.View(\"lookup:infoMessage\", function() {\n      return Spacebars.mustache(view.lookup(\"infoMessage\"));\n    })), \"\\n  \" ];\n  }) ];\n}));\n\nTemplate.__checkName(\"_loginButtonsLoggingIn\");\nTemplate[\"_loginButtonsLoggingIn\"] = new Template(\"Template._loginButtonsLoggingIn\", (function() {\n  var view = this;\n  return [ Spacebars.include(view.lookupTemplate(\"_loginButtonsLoggingInPadding\")), HTML.Raw('\\n  <div class=\"loading\">&nbsp;</div>\\n  '), Spacebars.include(view.lookupTemplate(\"_loginButtonsLoggingInPadding\")) ];\n}));\n\nTemplate.__checkName(\"_loginButtonsLoggingInPadding\");\nTemplate[\"_loginButtonsLoggingInPadding\"] = new Template(\"Template._loginButtonsLoggingInPadding\", (function() {\n  var view = this;\n  return Blaze.Unless(function() {\n    return Spacebars.call(view.lookup(\"dropdown\"));\n  }, function() {\n    return [ \"\\n    \\n    \", HTML.DIV({\n      class: \"login-buttons-padding\"\n    }, \"\\n      \", HTML.DIV({\n      class: \"login-button single-login-button\",\n      style: \"visibility: hidden;\",\n      id: \"login-buttons-logout\"\n    }, HTML.CharRef({\n      html: \"&nbsp;\",\n      str: \" \"\n    })), \"\\n    \"), \"\\n  \" ];\n  }, function() {\n    return [ \"\\n    \\n    \", HTML.DIV({\n      class: \"login-buttons-padding\"\n    }), \"\\n  \" ];\n  });\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n\n\n\n\n(function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// packages/accounts-ui-unstyled/template.login_buttons_single.js                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"_loginButtonsLoggedOutSingleLoginButton\");\nTemplate[\"_loginButtonsLoggedOutSingleLoginButton\"] = new Template(\"Template._loginButtonsLoggedOutSingleLoginButton\", (function() {\n  var view = this;\n  return HTML.DIV({\n    class: \"login-text-and-button\"\n  }, \"\\n    \", HTML.DIV({\n    class: function() {\n      return [ \"login-button single-login-button \", Blaze.Unless(function() {\n        return Spacebars.call(view.lookup(\"configured\"));\n      }, function() {\n        return \"configure-button\";\n      }) ];\n    },\n    id: function() {\n      return [ \"login-buttons-\", Spacebars.mustache(view.lookup(\"name\")) ];\n    }\n  }, \"\\n      \", Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"cannotConfigure\"));\n  }, function() {\n    return [ \"\\n        \", HTML.SPAN({\n      class: \"\"\n    }, Blaze.View(\"lookup:capitalizedName\", function() {\n      return Spacebars.mustache(view.lookup(\"capitalizedName\"));\n    }), \" not configured\"), \"\\n      \" ];\n  }, function() {\n    return [ \"\\n        \", HTML.DIV({\n      class: \"login-image\",\n      id: function() {\n        return [ \"login-buttons-image-\", Spacebars.mustache(view.lookup(\"name\")) ];\n      }\n    }), \"\\n        \", Blaze.If(function() {\n      return Spacebars.call(view.lookup(\"configured\"));\n    }, function() {\n      return [ \"\\n          \", HTML.SPAN({\n        class: function() {\n          return [ \"text-besides-image sign-in-text-\", Spacebars.mustache(view.lookup(\"name\")) ];\n        }\n      }, \"Sign in with \", Blaze.View(\"lookup:capitalizedName\", function() {\n        return Spacebars.mustache(view.lookup(\"capitalizedName\"));\n      })), \"\\n        \" ];\n    }, function() {\n      return [ \"\\n            \", HTML.SPAN({\n        class: function() {\n          return [ \"text-besides-image configure-text-\", Spacebars.mustache(view.lookup(\"name\")) ];\n        }\n      }, \"Configure \", Blaze.View(\"lookup:capitalizedName\", function() {\n        return Spacebars.mustache(view.lookup(\"capitalizedName\"));\n      }), \" Login\"), \"\\n        \" ];\n    }), \"\\n      \" ];\n  }), \"\\n    \"), \"\\n  \");\n}));\n\nTemplate.__checkName(\"_loginButtonsLoggingInSingleLoginButton\");\nTemplate[\"_loginButtonsLoggingInSingleLoginButton\"] = new Template(\"Template._loginButtonsLoggingInSingleLoginButton\", (function() {\n  var view = this;\n  return HTML.DIV({\n    class: \"login-text-and-button\"\n  }, \"\\n    \", Spacebars.include(view.lookupTemplate(\"_loginButtonsLoggingIn\")), \"\\n  \");\n}));\n\nTemplate.__checkName(\"_loginButtonsLoggedInSingleLogoutButton\");\nTemplate[\"_loginButtonsLoggedInSingleLogoutButton\"] = new Template(\"Template._loginButtonsLoggedInSingleLogoutButton\", (function() {\n  var view = this;\n  return HTML.DIV({\n    class: \"login-text-and-button\"\n  }, \"\\n    \", HTML.DIV({\n    class: \"login-display-name\"\n  }, \"\\n      \", Blaze.View(\"lookup:displayName\", function() {\n    return Spacebars.mustache(view.lookup(\"displayName\"));\n  }), \"\\n    \"), HTML.Raw('\\n    <div class=\"login-button single-login-button\" id=\"login-buttons-logout\">Sign Out</div>\\n  '));\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n\n\n\n\n(function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// packages/accounts-ui-unstyled/template.login_buttons_dropdown.js                                                    //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.__checkName(\"_loginButtonsLoggedInDropdown\");\nTemplate[\"_loginButtonsLoggedInDropdown\"] = new Template(\"Template._loginButtonsLoggedInDropdown\", (function() {\n  var view = this;\n  return HTML.DIV({\n    class: \"login-link-and-dropdown-list\"\n  }, \"\\n    \", HTML.A({\n    class: \"login-link-text\",\n    id: \"login-name-link\"\n  }, \"\\n      \", Blaze.View(\"lookup:displayName\", function() {\n    return Spacebars.mustache(view.lookup(\"displayName\"));\n  }), \" ▾\\n    \"), \"\\n\\n    \", Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"dropdownVisible\"));\n  }, function() {\n    return [ \"\\n      \", HTML.DIV({\n      id: \"login-dropdown-list\",\n      class: \"accounts-dialog\"\n    }, \"\\n        \", HTML.A({\n      class: \"login-close-text\"\n    }, \"Close\"), \"\\n        \", HTML.DIV({\n      class: \"login-close-text-clear\"\n    }), \"\\n\\n        \", Blaze.If(function() {\n      return Spacebars.call(view.lookup(\"inMessageOnlyFlow\"));\n    }, function() {\n      return [ \"\\n          \", Spacebars.include(view.lookupTemplate(\"_loginButtonsMessages\")), \"\\n        \" ];\n    }, function() {\n      return [ \"\\n          \", Blaze.If(function() {\n        return Spacebars.call(view.lookup(\"inChangePasswordFlow\"));\n      }, function() {\n        return [ \"\\n            \", Spacebars.include(view.lookupTemplate(\"_loginButtonsChangePassword\")), \"\\n          \" ];\n      }, function() {\n        return [ \"\\n            \", Spacebars.include(view.lookupTemplate(\"_loginButtonsLoggedInDropdownActions\")), \"\\n          \" ];\n      }), \"\\n        \" ];\n    }), \"\\n      \"), \"\\n    \" ];\n  }), \"\\n  \");\n}));\n\nTemplate.__checkName(\"_loginButtonsLoggedInDropdownActions\");\nTemplate[\"_loginButtonsLoggedInDropdownActions\"] = new Template(\"Template._loginButtonsLoggedInDropdownActions\", (function() {\n  var view = this;\n  return [ Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"allowChangingPassword\"));\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      class: \"login-button\",\n      id: \"login-buttons-open-change-password\"\n    }, \"\\n      Change password\\n    \"), \"\\n  \" ];\n  }), HTML.Raw('\\n\\n  <div class=\"login-button\" id=\"login-buttons-logout\">\\n    Sign out\\n  </div>\\n\\n  '), Spacebars.include(view.lookupTemplate(\"_loginButtonsMessages\")) ];\n}));\n\nTemplate.__checkName(\"_loginButtonsLoggedOutDropdown\");\nTemplate[\"_loginButtonsLoggedOutDropdown\"] = new Template(\"Template._loginButtonsLoggedOutDropdown\", (function() {\n  var view = this;\n  return HTML.DIV({\n    class: function() {\n      return [ \"login-link-and-dropdown-list \", Spacebars.mustache(view.lookup(\"additionalClasses\")) ];\n    }\n  }, \"\\n    \", Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"dropdownVisible\"));\n  }, function() {\n    return [ \"\\n      \\n      \", HTML.A({\n      class: \"login-link-text\",\n      id: \"login-sign-in-link\"\n    }, \"Sign in ▾\"), \"\\n      \", HTML.DIV({\n      id: \"login-dropdown-list\",\n      class: \"accounts-dialog\"\n    }, \"\\n        \", HTML.A({\n      class: \"login-close-text\"\n    }, \"Close\"), \"\\n        \", Blaze.If(function() {\n      return Spacebars.call(view.lookup(\"loggingIn\"));\n    }, function() {\n      return [ \"\\n          \", Spacebars.include(view.lookupTemplate(\"_loginButtonsLoggingIn\")), \"\\n        \" ];\n    }), \"\\n        \", HTML.DIV({\n      class: \"login-close-text-clear\"\n    }), \"\\n        \", Spacebars.include(view.lookupTemplate(\"_loginButtonsLoggedOutAllServices\")), \"\\n      \"), \"\\n    \" ];\n  }, function() {\n    return [ \"\\n      \", Blaze.If(function() {\n      return Spacebars.call(view.lookup(\"loggingIn\"));\n    }, function() {\n      return [ \"\\n        \\n        \", Spacebars.include(view.lookupTemplate(\"_loginButtonsLoggingIn\")), \"\\n      \" ];\n    }, function() {\n      return [ \"\\n        \", HTML.A({\n        class: \"login-link-text\",\n        id: \"login-sign-in-link\"\n      }, \"Sign in ▾\"), \"\\n      \" ];\n    }), \"\\n    \" ];\n  }), \"\\n  \");\n}));\n\nTemplate.__checkName(\"_loginButtonsLoggedOutAllServices\");\nTemplate[\"_loginButtonsLoggedOutAllServices\"] = new Template(\"Template._loginButtonsLoggedOutAllServices\", (function() {\n  var view = this;\n  return [ Blaze.Each(function() {\n    return Spacebars.call(view.lookup(\"services\"));\n  }, function() {\n    return [ \"\\n    \", Blaze.If(function() {\n      return Spacebars.call(view.lookup(\"isPasswordService\"));\n    }, function() {\n      return [ \"\\n      \", Blaze.If(function() {\n        return Spacebars.call(view.lookup(\"hasOtherServices\"));\n      }, function() {\n        return [ \" \\n        \", Spacebars.include(view.lookupTemplate(\"_loginButtonsLoggedOutPasswordServiceSeparator\")), \"\\n      \" ];\n      }), \"\\n      \", Spacebars.include(view.lookupTemplate(\"_loginButtonsLoggedOutPasswordService\")), \"\\n    \" ];\n    }, function() {\n      return [ \"\\n      \", Spacebars.include(view.lookupTemplate(\"_loginButtonsLoggedOutSingleLoginButton\")), \"\\n    \" ];\n    }), \"\\n  \" ];\n  }), \"\\n\\n  \", Blaze.Unless(function() {\n    return Spacebars.call(view.lookup(\"hasPasswordService\"));\n  }, function() {\n    return [ \"\\n    \", Spacebars.include(view.lookupTemplate(\"_loginButtonsMessages\")), \"\\n  \" ];\n  }) ];\n}));\n\nTemplate.__checkName(\"_loginButtonsLoggedOutPasswordServiceSeparator\");\nTemplate[\"_loginButtonsLoggedOutPasswordServiceSeparator\"] = new Template(\"Template._loginButtonsLoggedOutPasswordServiceSeparator\", (function() {\n  var view = this;\n  return HTML.Raw('<div class=\"or\">\\n    <span class=\"hline\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>\\n    <span class=\"or-text\">or</span>\\n    <span class=\"hline\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>\\n  </div>');\n}));\n\nTemplate.__checkName(\"_loginButtonsLoggedOutPasswordService\");\nTemplate[\"_loginButtonsLoggedOutPasswordService\"] = new Template(\"Template._loginButtonsLoggedOutPasswordService\", (function() {\n  var view = this;\n  return Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"inForgotPasswordFlow\"));\n  }, function() {\n    return [ \"\\n    \", Spacebars.include(view.lookupTemplate(\"_forgotPasswordForm\")), \"\\n  \" ];\n  }, function() {\n    return [ \"\\n    \", HTML.FORM({\n      class: \"login-form login-password-form\"\n    }, \"\\n      \", Blaze.Each(function() {\n      return Spacebars.call(view.lookup(\"fields\"));\n    }, function() {\n      return [ \"\\n        \", Spacebars.include(view.lookupTemplate(\"_loginButtonsFormField\")), \"\\n      \" ];\n    }), \"\\n\\n      \", Spacebars.include(view.lookupTemplate(\"_loginButtonsMessages\")), \"\\n\\n      \", HTML.BUTTON({\n      class: \"login-button login-button-form-submit\",\n      id: \"login-buttons-password\"\n    }, \"\\n        \", Blaze.If(function() {\n      return Spacebars.call(view.lookup(\"inSignupFlow\"));\n    }, function() {\n      return \"\\n          Create account\\n        \";\n    }, function() {\n      return \"\\n          Sign in\\n        \";\n    }), \"\\n      \"), \"\\n\\n      \", Blaze.If(function() {\n      return Spacebars.call(view.lookup(\"inLoginFlow\"));\n    }, function() {\n      return [ \"\\n        \", Blaze.If(function() {\n        return Spacebars.call(view.lookup(\"showCreateAccountLink\"));\n      }, function() {\n        return [ \"\\n          \", HTML.DIV({\n          class: \"additional-link-container\"\n        }, \"\\n            \", HTML.A({\n          id: \"signup-link\",\n          class: \"additional-link\"\n        }, \"Create account\"), \"\\n          \"), \"\\n        \" ];\n      }), \"\\n\\n        \", Blaze.If(function() {\n        return Spacebars.call(view.lookup(\"showForgotPasswordLink\"));\n      }, function() {\n        return [ \"\\n          \", HTML.DIV({\n          class: \"additional-link-container\"\n        }, \"\\n            \", HTML.A({\n          id: \"forgot-password-link\",\n          class: \"additional-link\"\n        }, \"Forgot password\"), \"\\n          \"), \"\\n        \" ];\n      }), \"\\n      \" ];\n    }), \"\\n\\n      \", Blaze.If(function() {\n      return Spacebars.call(view.lookup(\"inSignupFlow\"));\n    }, function() {\n      return [ \"\\n        \", Spacebars.include(view.lookupTemplate(\"_loginButtonsBackToLoginLink\")), \"\\n      \" ];\n    }), \"\\n    \"), \"\\n  \" ];\n  });\n}));\n\nTemplate.__checkName(\"_forgotPasswordForm\");\nTemplate[\"_forgotPasswordForm\"] = new Template(\"Template._forgotPasswordForm\", (function() {\n  var view = this;\n  return HTML.DIV({\n    class: \"login-form\"\n  }, HTML.Raw('\\n    <div id=\"forgot-password-email-label-and-input\"> \\n      <label id=\"forgot-password-email-label\" for=\"forgot-password-email\">Email</label>\\n      <input id=\"forgot-password-email\" type=\"email\">\\n    </div>\\n\\n    '), Spacebars.include(view.lookupTemplate(\"_loginButtonsMessages\")), HTML.Raw('\\n\\n    <div class=\"login-button login-button-form-submit\" id=\"login-buttons-forgot-password\">\\n      Reset password\\n    </div>\\n\\n    '), Spacebars.include(view.lookupTemplate(\"_loginButtonsBackToLoginLink\")), \"\\n  \");\n}));\n\nTemplate.__checkName(\"_loginButtonsBackToLoginLink\");\nTemplate[\"_loginButtonsBackToLoginLink\"] = new Template(\"Template._loginButtonsBackToLoginLink\", (function() {\n  var view = this;\n  return HTML.Raw('<div class=\"additional-link-container\">\\n    <a id=\"back-to-login-link\" class=\"additional-link\">Sign in</a>\\n  </div>');\n}));\n\nTemplate.__checkName(\"_loginButtonsFormField\");\nTemplate[\"_loginButtonsFormField\"] = new Template(\"Template._loginButtonsFormField\", (function() {\n  var view = this;\n  return Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"visible\"));\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      id: function() {\n        return [ \"login-\", Spacebars.mustache(view.lookup(\"fieldName\")), \"-label-and-input\" ];\n      }\n    }, \"\\n      \", HTML.LABEL({\n      id: function() {\n        return [ \"login-\", Spacebars.mustache(view.lookup(\"fieldName\")), \"-label\" ];\n      },\n      for: function() {\n        return [ \"login-\", Spacebars.mustache(view.lookup(\"fieldName\")) ];\n      }\n    }, \"\\n        \", Blaze.View(\"lookup:fieldLabel\", function() {\n      return Spacebars.mustache(view.lookup(\"fieldLabel\"));\n    }), \"\\n      \"), \"\\n      \", HTML.INPUT({\n      id: function() {\n        return [ \"login-\", Spacebars.mustache(view.lookup(\"fieldName\")) ];\n      },\n      type: function() {\n        return Spacebars.mustache(view.lookup(\"inputType\"));\n      }\n    }), \"\\n    \"), \"\\n  \" ];\n  });\n}));\n\nTemplate.__checkName(\"_loginButtonsChangePassword\");\nTemplate[\"_loginButtonsChangePassword\"] = new Template(\"Template._loginButtonsChangePassword\", (function() {\n  var view = this;\n  return [ Blaze.Each(function() {\n    return Spacebars.call(view.lookup(\"fields\"));\n  }, function() {\n    return [ \"\\n    \", Spacebars.include(view.lookupTemplate(\"_loginButtonsFormField\")), \"\\n  \" ];\n  }), \"\\n\\n  \", Spacebars.include(view.lookupTemplate(\"_loginButtonsMessages\")), HTML.Raw('\\n\\n  <div class=\"login-button login-button-form-submit\" id=\"login-buttons-do-change-password\">\\n    Change password\\n  </div>') ];\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n\n\n\n\n(function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// packages/accounts-ui-unstyled/template.login_buttons_dialogs.js                                                     //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n\nTemplate.body.addContent((function() {\n  var view = this;\n  return [ Spacebars.include(view.lookupTemplate(\"_resetPasswordDialog\")), \"\\n  \", Spacebars.include(view.lookupTemplate(\"_justResetPasswordDialog\")), \"\\n  \", Spacebars.include(view.lookupTemplate(\"_enrollAccountDialog\")), \"\\n  \", Spacebars.include(view.lookupTemplate(\"_justVerifiedEmailDialog\")), \"\\n  \", Spacebars.include(view.lookupTemplate(\"_configureLoginServiceDialog\")), \"\\n  \", Spacebars.include(view.lookupTemplate(\"_configureLoginOnDesktopDialog\")), \"\\n\\n  \\n  \", Spacebars.include(view.lookupTemplate(\"_loginButtonsMessagesDialog\")) ];\n}));\nMeteor.startup(Template.body.renderToDocument);\n\nTemplate.__checkName(\"_resetPasswordDialog\");\nTemplate[\"_resetPasswordDialog\"] = new Template(\"Template._resetPasswordDialog\", (function() {\n  var view = this;\n  return Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"inResetPasswordFlow\"));\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      class: \"hide-background\"\n    }), \"\\n\\n    \", HTML.DIV({\n      class: \"accounts-dialog accounts-centered-dialog\"\n    }, \"\\n      \", HTML.LABEL({\n      id: \"reset-password-new-password-label\",\n      for: \"reset-password-new-password\"\n    }, \"\\n        New password\\n      \"), \"\\n\\n      \", HTML.DIV({\n      class: \"reset-password-new-password-wrapper\"\n    }, \"\\n        \", HTML.INPUT({\n      id: \"reset-password-new-password\",\n      type: \"password\"\n    }), \"\\n      \"), \"\\n\\n      \", Spacebars.include(view.lookupTemplate(\"_loginButtonsMessages\")), \"\\n\\n      \", HTML.DIV({\n      class: \"login-button login-button-form-submit\",\n      id: \"login-buttons-reset-password-button\"\n    }, \"\\n        Set password\\n      \"), \"\\n\\n      \", HTML.A({\n      class: \"accounts-close\",\n      id: \"login-buttons-cancel-reset-password\"\n    }, HTML.CharRef({\n      html: \"&times;\",\n      str: \"×\"\n    })), \"\\n    \"), \"\\n  \" ];\n  });\n}));\n\nTemplate.__checkName(\"_justResetPasswordDialog\");\nTemplate[\"_justResetPasswordDialog\"] = new Template(\"Template._justResetPasswordDialog\", (function() {\n  var view = this;\n  return Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"visible\"));\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      class: \"accounts-dialog accounts-centered-dialog\"\n    }, \"\\n      Password reset.\\n      You are now logged in as \", Blaze.View(\"lookup:displayName\", function() {\n      return Spacebars.mustache(view.lookup(\"displayName\"));\n    }), \".\\n      \", HTML.DIV({\n      class: \"login-button\",\n      id: \"just-verified-dismiss-button\"\n    }, \"Dismiss\"), \"\\n    \"), \"\\n  \" ];\n  });\n}));\n\nTemplate.__checkName(\"_enrollAccountDialog\");\nTemplate[\"_enrollAccountDialog\"] = new Template(\"Template._enrollAccountDialog\", (function() {\n  var view = this;\n  return Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"inEnrollAccountFlow\"));\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      class: \"hide-background\"\n    }), \"\\n\\n    \", HTML.DIV({\n      class: \"accounts-dialog accounts-centered-dialog\"\n    }, \"\\n      \", HTML.LABEL({\n      id: \"enroll-account-password-label\",\n      for: \"enroll-account-password\"\n    }, \"\\n        Choose a password\\n      \"), \"\\n\\n      \", HTML.DIV({\n      class: \"enroll-account-password-wrapper\"\n    }, \"\\n        \", HTML.INPUT({\n      id: \"enroll-account-password\",\n      type: \"password\"\n    }), \"\\n      \"), \"\\n\\n      \", Spacebars.include(view.lookupTemplate(\"_loginButtonsMessages\")), \"\\n\\n      \", HTML.DIV({\n      class: \"login-button login-button-form-submit\",\n      id: \"login-buttons-enroll-account-button\"\n    }, \"\\n        Create account\\n      \"), \"\\n\\n      \", HTML.A({\n      class: \"accounts-close\",\n      id: \"login-buttons-cancel-enroll-account\"\n    }, HTML.CharRef({\n      html: \"&times;\",\n      str: \"×\"\n    })), \"\\n    \"), \"\\n  \" ];\n  });\n}));\n\nTemplate.__checkName(\"_justVerifiedEmailDialog\");\nTemplate[\"_justVerifiedEmailDialog\"] = new Template(\"Template._justVerifiedEmailDialog\", (function() {\n  var view = this;\n  return Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"visible\"));\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      class: \"accounts-dialog accounts-centered-dialog\"\n    }, \"\\n      Email verified.\\n      You are now logged in as \", Blaze.View(\"lookup:displayName\", function() {\n      return Spacebars.mustache(view.lookup(\"displayName\"));\n    }), \".\\n      \", HTML.DIV({\n      class: \"login-button\",\n      id: \"just-verified-dismiss-button\"\n    }, \"Dismiss\"), \"\\n    \"), \"\\n  \" ];\n  });\n}));\n\nTemplate.__checkName(\"_configureLoginServiceDialog\");\nTemplate[\"_configureLoginServiceDialog\"] = new Template(\"Template._configureLoginServiceDialog\", (function() {\n  var view = this;\n  return Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"visible\"));\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      id: \"configure-login-service-dialog\",\n      class: \"accounts-dialog accounts-centered-dialog\"\n    }, \"\\n      \", Spacebars.include(view.lookupTemplate(\"configurationSteps\")), \"\\n\\n      \", HTML.P(\"\\n        Now, copy over some details.\\n      \"), \"\\n      \", HTML.P(\"\\n        \", HTML.TABLE(\"\\n          \", HTML.COLGROUP(\"\\n            \", HTML.COL({\n      span: \"1\",\n      class: \"configuration_labels\"\n    }), \"\\n            \", HTML.COL({\n      span: \"1\",\n      class: \"configuration_inputs\"\n    }), \"\\n          \"), \"\\n          \", Blaze.Each(function() {\n      return Spacebars.call(view.lookup(\"configurationFields\"));\n    }, function() {\n      return [ \"\\n            \", HTML.TR(\"\\n              \", HTML.TD(\"\\n                \", HTML.LABEL({\n        for: function() {\n          return [ \"configure-login-service-dialog-\", Spacebars.mustache(view.lookup(\"property\")) ];\n        }\n      }, Blaze.View(\"lookup:label\", function() {\n        return Spacebars.mustache(view.lookup(\"label\"));\n      })), \"\\n              \"), \"\\n              \", HTML.TD(\"\\n                \", HTML.INPUT({\n        id: function() {\n          return [ \"configure-login-service-dialog-\", Spacebars.mustache(view.lookup(\"property\")) ];\n        },\n        type: \"text\"\n      }), \"\\n              \"), \"\\n            \"), \"\\n          \" ];\n    }), \"\\n        \"), \"\\n      \"), \"\\n      \", HTML.P({\n      class: \"new-section\"\n    }, \"\\n        Choose the login style:\\n      \"), \"\\n      \", HTML.P(\"\\n        \", HTML.CharRef({\n      html: \"&emsp;\",\n      str: \" \"\n    }), HTML.INPUT({\n      id: \"configure-login-service-dialog-popupBasedLogin\",\n      type: \"radio\",\n      checked: \"checked\",\n      name: \"loginStyle\",\n      value: \"popup\"\n    }), \"\\n        \", HTML.LABEL({\n      for: \"configure-login-service-dialog-popupBasedLogin\"\n    }, \"Popup-based login (recommended for most applications)\"), \"\\n\\n        \", HTML.BR(), HTML.CharRef({\n      html: \"&emsp;\",\n      str: \" \"\n    }), HTML.INPUT({\n      id: \"configure-login-service-dialog-redirectBasedLogin\",\n      type: \"radio\",\n      name: \"loginStyle\",\n      value: \"redirect\"\n    }), \"\\n        \", HTML.LABEL({\n      for: \"configure-login-service-dialog-redirectBasedLogin\"\n    }, \"\\n          Redirect-based login (special cases explained\\n          \", HTML.A({\n      href: \"https://github.com/meteor/meteor/wiki/OAuth-for-mobile-Meteor-clients#popup-versus-redirect-flow\",\n      target: \"_blank\"\n    }, \"here\"), \")\\n        \"), \"\\n      \"), \"\\n      \", HTML.DIV({\n      class: \"new-section\"\n    }, \"\\n        \", HTML.DIV({\n      class: \"login-button configure-login-service-dismiss-button\"\n    }, \"\\n          I'll do this later\\n        \"), \"\\n        \", HTML.A({\n      class: \"accounts-close configure-login-service-dismiss-button\"\n    }, HTML.CharRef({\n      html: \"&times;\",\n      str: \"×\"\n    })), \"\\n\\n        \", HTML.DIV({\n      class: function() {\n        return [ \"login-button login-button-configure \", Blaze.If(function() {\n          return Spacebars.call(view.lookup(\"saveDisabled\"));\n        }, function() {\n          return \"login-button-disabled\";\n        }) ];\n      },\n      id: \"configure-login-service-dialog-save-configuration\"\n    }, \"\\n          Save Configuration\\n        \"), \"\\n      \"), \"\\n    \"), \"\\n  \" ];\n  });\n}));\n\nTemplate.__checkName(\"_loginButtonsMessagesDialog\");\nTemplate[\"_loginButtonsMessagesDialog\"] = new Template(\"Template._loginButtonsMessagesDialog\", (function() {\n  var view = this;\n  return Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"visible\"));\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      class: \"accounts-dialog accounts-centered-dialog\",\n      id: \"login-buttons-message-dialog\"\n    }, \"\\n      \", Spacebars.include(view.lookupTemplate(\"_loginButtonsMessages\")), \"\\n      \", HTML.DIV({\n      class: \"login-button\",\n      id: \"messages-dialog-dismiss-button\"\n    }, \"Dismiss\"), \"\\n    \"), \"\\n  \" ];\n  });\n}));\n\nTemplate.__checkName(\"_configureLoginOnDesktopDialog\");\nTemplate[\"_configureLoginOnDesktopDialog\"] = new Template(\"Template._configureLoginOnDesktopDialog\", (function() {\n  var view = this;\n  return Blaze.If(function() {\n    return Spacebars.call(view.lookup(\"visible\"));\n  }, function() {\n    return [ \"\\n    \", HTML.DIV({\n      class: \"accounts-dialog accounts-centered-dialog\",\n      id: \"configure-on-desktop-dialog\"\n    }, \"\\n      \", HTML.P(\"\\n        Please configure login on a desktop browser.\\n      \"), \"\\n      \", HTML.DIV({\n      class: \"login-button\",\n      id: \"configure-on-desktop-dismiss-button\"\n    }, \"Dismiss\"), \"\\n    \"), \"\\n  \" ];\n  });\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n\n\n\n\n(function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// packages/accounts-ui-unstyled/login_buttons_session.js                                                              //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\nvar VALID_KEYS = [\n  'dropdownVisible',\n\n  // XXX consider replacing these with one key that has an enum for values.\n  'inSignupFlow',\n  'inForgotPasswordFlow',\n  'inChangePasswordFlow',\n  'inMessageOnlyFlow',\n\n  'errorMessage',\n  'infoMessage',\n\n  // dialogs with messages (info and error)\n  'resetPasswordToken',\n  'enrollAccountToken',\n  'justVerifiedEmail',\n  'justResetPassword',\n\n  'configureLoginServiceDialogVisible',\n  'configureLoginServiceDialogServiceName',\n  'configureLoginServiceDialogSaveDisabled',\n  'configureOnDesktopVisible'\n];\n\nvar validateKey = function (key) {\n  if (!_.contains(VALID_KEYS, key))\n    throw new Error(\"Invalid key in loginButtonsSession: \" + key);\n};\n\nvar KEY_PREFIX = \"Meteor.loginButtons.\";\n\n// XXX This should probably be package scope rather than exported\n// (there was even a comment to that effect here from before we had\n// namespacing) but accounts-ui-viewer uses it, so leave it as is for\n// now\nAccounts._loginButtonsSession = {\n  set: function(key, value) {\n    validateKey(key);\n    if (_.contains(['errorMessage', 'infoMessage'], key))\n      throw new Error(\"Don't set errorMessage or infoMessage directly. Instead, use errorMessage() or infoMessage().\");\n\n    this._set(key, value);\n  },\n\n  _set: function(key, value) {\n    Session.set(KEY_PREFIX + key, value);\n  },\n\n  get: function(key) {\n    validateKey(key);\n    return Session.get(KEY_PREFIX + key);\n  },\n\n  closeDropdown: function () {\n    this.set('inSignupFlow', false);\n    this.set('inForgotPasswordFlow', false);\n    this.set('inChangePasswordFlow', false);\n    this.set('inMessageOnlyFlow', false);\n    this.set('dropdownVisible', false);\n    this.resetMessages();\n  },\n\n  infoMessage: function(message) {\n    this._set(\"errorMessage\", null);\n    this._set(\"infoMessage\", message);\n    this.ensureMessageVisible();\n  },\n\n  errorMessage: function(message) {\n    this._set(\"errorMessage\", message);\n    this._set(\"infoMessage\", null);\n    this.ensureMessageVisible();\n  },\n\n  // is there a visible dialog that shows messages (info and error)\n  isMessageDialogVisible: function () {\n    return this.get('resetPasswordToken') ||\n      this.get('enrollAccountToken') ||\n      this.get('justVerifiedEmail');\n  },\n\n  // ensure that somethings displaying a message (info or error) is\n  // visible.  if a dialog with messages is open, do nothing;\n  // otherwise open the dropdown.\n  //\n  // notably this doesn't matter when only displaying a single login\n  // button since then we have an explicit message dialog\n  // (_loginButtonsMessageDialog), and dropdownVisible is ignored in\n  // this case.\n  ensureMessageVisible: function () {\n    if (!this.isMessageDialogVisible())\n      this.set(\"dropdownVisible\", true);\n  },\n\n  resetMessages: function () {\n    this._set(\"errorMessage\", null);\n    this._set(\"infoMessage\", null);\n  },\n\n  configureService: function (name) {\n    if (Meteor.isCordova) {\n      this.set('configureOnDesktopVisible', true);\n    } else {\n      this.set('configureLoginServiceDialogVisible', true);\n      this.set('configureLoginServiceDialogServiceName', name);\n      this.set('configureLoginServiceDialogSaveDisabled', true);\n    }\n  }\n};\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n\n\n\n\n(function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// packages/accounts-ui-unstyled/login_buttons.js                                                                      //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n// for convenience\nvar loginButtonsSession = Accounts._loginButtonsSession;\n\n// shared between dropdown and single mode\nTemplate.loginButtons.events({\n  'click #login-buttons-logout': function() {\n    Meteor.logout(function () {\n      loginButtonsSession.closeDropdown();\n    });\n  }\n});\n\nTemplate.registerHelper('loginButtons', function () {\n  throw new Error(\"Use {{> loginButtons}} instead of {{loginButtons}}\");\n});\n\n//\n// helpers\n//\n\ndisplayName = function () {\n  var user = Meteor.user();\n  if (!user)\n    return '';\n\n  if (user.profile && user.profile.name)\n    return user.profile.name;\n  if (user.username)\n    return user.username;\n  if (user.emails && user.emails[0] && user.emails[0].address)\n    return user.emails[0].address;\n\n  return '';\n};\n\n// returns an array of the login services used by this app. each\n// element of the array is an object (eg {name: 'facebook'}), since\n// that makes it useful in combination with handlebars {{#each}}.\n//\n// don't cache the output of this function: if called during startup (before\n// oauth packages load) it might not include them all.\n//\n// NOTE: It is very important to have this return password last\n// because of the way we render the different providers in\n// login_buttons_dropdown.html\ngetLoginServices = function () {\n  var self = this;\n\n  // First look for OAuth services.\n  var services = Package['accounts-oauth'] ? Accounts.oauth.serviceNames() : [];\n\n  // Be equally kind to all login services. This also preserves\n  // backwards-compatibility. (But maybe order should be\n  // configurable?)\n  services.sort();\n\n  // Add password, if it's there; it must come last.\n  if (hasPasswordService())\n    services.push('password');\n\n  return _.map(services, function(name) {\n    return {name: name};\n  });\n};\n\nhasPasswordService = function () {\n  return !!Package['accounts-password'];\n};\n\ndropdown = function () {\n  return hasPasswordService() || getLoginServices().length > 1;\n};\n\n// XXX improve these. should this be in accounts-password instead?\n//\n// XXX these will become configurable, and will be validated on\n// the server as well.\nvalidateUsername = function (username) {\n  if (username.length >= 3) {\n    return true;\n  } else {\n    loginButtonsSession.errorMessage(\"Username must be at least 3 characters long\");\n    return false;\n  }\n};\nvalidateEmail = function (email) {\n  if (passwordSignupFields() === \"USERNAME_AND_OPTIONAL_EMAIL\" && email === '')\n    return true;\n\n  if (email.indexOf('@') !== -1) {\n    return true;\n  } else {\n    loginButtonsSession.errorMessage(\"Invalid email\");\n    return false;\n  }\n};\nvalidatePassword = function (password) {\n  if (password.length >= 6) {\n    return true;\n  } else {\n    loginButtonsSession.errorMessage(\"Password must be at least 6 characters long\");\n    return false;\n  }\n};\n\n//\n// loginButtonLoggedOut template\n//\n\nTemplate._loginButtonsLoggedOut.helpers({\n  dropdown: dropdown,\n  services: getLoginServices,\n  singleService: function () {\n    var services = getLoginServices();\n    if (services.length !== 1)\n      throw new Error(\n        \"Shouldn't be rendering this template with more than one configured service\");\n    return services[0];\n  },\n  configurationLoaded: function () {\n    return Accounts.loginServicesConfigured();\n  }\n});\n\n\n//\n// loginButtonsLoggedIn template\n//\n\n  // decide whether we should show a dropdown rather than a row of\n  // buttons\nTemplate._loginButtonsLoggedIn.helpers({\n  dropdown: dropdown\n});\n\n\n\n//\n// loginButtonsLoggedInSingleLogoutButton template\n//\n\nTemplate._loginButtonsLoggedInSingleLogoutButton.helpers({\n  displayName: displayName\n});\n\n\n\n//\n// loginButtonsMessage template\n//\n\nTemplate._loginButtonsMessages.helpers({\n  errorMessage: function () {\n    return loginButtonsSession.get('errorMessage');\n  }\n});\n\nTemplate._loginButtonsMessages.helpers({\n  infoMessage: function () {\n    return loginButtonsSession.get('infoMessage');\n  }\n});\n\n\n//\n// loginButtonsLoggingInPadding template\n//\n\nTemplate._loginButtonsLoggingInPadding.helpers({\n  dropdown: dropdown\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n\n\n\n\n(function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// packages/accounts-ui-unstyled/login_buttons_single.js                                                               //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n// for convenience\nvar loginButtonsSession = Accounts._loginButtonsSession;\n\n\nvar loginResultCallback = function (serviceName, err) {\n  if (!err) {\n    loginButtonsSession.closeDropdown();\n  } else if (err instanceof Accounts.LoginCancelledError) {\n    // do nothing\n  } else if (err instanceof ServiceConfiguration.ConfigError) {\n    if (Template._configureLoginServiceDialog.templateForService(serviceName)) {\n      loginButtonsSession.configureService(serviceName);\n    } else {\n      loginButtonsSession.errorMessage(\n        \"No configuration for \" + capitalize(serviceName) + \".\\n\" +\n        \"Use `ServiceConfiguration` to configure it or \" +\n        \"install the `\" +serviceName + \"-config-ui` package.\"\n      );\n    }\n  } else {\n    loginButtonsSession.errorMessage(err.reason || \"Unknown error\");\n  }\n};\n\n\n// In the login redirect flow, we'll have the result of the login\n// attempt at page load time when we're redirected back to the\n// application.  Register a callback to update the UI (i.e. to close\n// the dialog on a successful login or display the error on a failed\n// login).\n//\nAccounts.onPageLoadLogin(function (attemptInfo) {\n  // Ignore if we have a left over login attempt for a service that is no longer registered.\n  if (_.contains(_.pluck(getLoginServices(), \"name\"), attemptInfo.type))\n    loginResultCallback(attemptInfo.type, attemptInfo.error);\n});\n\n\nTemplate._loginButtonsLoggedOutSingleLoginButton.events({\n  'click .login-button': function () {\n    var serviceName = this.name;\n    loginButtonsSession.resetMessages();\n\n    // XXX Service providers should be able to specify their\n    // `Meteor.loginWithX` method name.\n    var loginWithService = Meteor[\"loginWith\" +\n                                  (serviceName === 'meteor-developer' ?\n                                   'MeteorDeveloperAccount' :\n                                   capitalize(serviceName))];\n\n    var options = {}; // use default scope unless specified\n    if (Accounts.ui._options.requestPermissions[serviceName])\n      options.requestPermissions = Accounts.ui._options.requestPermissions[serviceName];\n    if (Accounts.ui._options.requestOfflineToken[serviceName])\n      options.requestOfflineToken = Accounts.ui._options.requestOfflineToken[serviceName];\n    if (Accounts.ui._options.forceApprovalPrompt[serviceName])\n      options.forceApprovalPrompt = Accounts.ui._options.forceApprovalPrompt[serviceName];\n\n    loginWithService(options, function (err) {\n      loginResultCallback(serviceName, err);\n    });\n  }\n});\n\nTemplate._loginButtonsLoggedOutSingleLoginButton.helpers({\n  // not configured and has no config UI\n  cannotConfigure: function() {\n    return !ServiceConfiguration.configurations.findOne({service: this.name})\n      && !Template._configureLoginServiceDialog.templateForService(this.name);\n  },\n  configured: function () {\n    return !!ServiceConfiguration.configurations.findOne({service: this.name});\n  },\n  capitalizedName: function () {\n    if (this.name === 'github')\n      // XXX we should allow service packages to set their capitalized name\n      return 'GitHub';\n    else if (this.name === 'meteor-developer')\n      return 'Meteor';\n    else\n      return capitalize(this.name);\n  }\n});\n\n// XXX from http://epeli.github.com/underscore.string/lib/underscore.string.js\nvar capitalize = function(str){\n  str = str == null ? '' : String(str);\n  return str.charAt(0).toUpperCase() + str.slice(1);\n};\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n\n\n\n\n(function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// packages/accounts-ui-unstyled/login_buttons_dropdown.js                                                             //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n// for convenience\nvar loginButtonsSession = Accounts._loginButtonsSession;\n\n// events shared between loginButtonsLoggedOutDropdown and\n// loginButtonsLoggedInDropdown\nTemplate.loginButtons.events({\n  'click #login-name-link, click #login-sign-in-link': function () {\n    loginButtonsSession.set('dropdownVisible', true);\n  },\n  'click .login-close-text': function () {\n    loginButtonsSession.closeDropdown();\n  }\n});\n\n\n//\n// loginButtonsLoggedInDropdown template and related\n//\n\nTemplate._loginButtonsLoggedInDropdown.events({\n  'click #login-buttons-open-change-password': function() {\n    loginButtonsSession.resetMessages();\n    loginButtonsSession.set('inChangePasswordFlow', true);\n  }\n});\n\nTemplate._loginButtonsLoggedInDropdown.helpers({\n  displayName: displayName,\n\n  inChangePasswordFlow: function () {\n    return loginButtonsSession.get('inChangePasswordFlow');\n  },\n\n  inMessageOnlyFlow: function () {\n    return loginButtonsSession.get('inMessageOnlyFlow');\n  },\n\n  dropdownVisible: function () {\n    return loginButtonsSession.get('dropdownVisible');\n  }\n});\n\nTemplate._loginButtonsLoggedInDropdownActions.helpers({\n  allowChangingPassword: function () {\n    // it would be more correct to check whether the user has a password set,\n    // but in order to do that we'd have to send more data down to the client,\n    // and it'd be preferable not to send down the entire service.password document.\n    //\n    // instead we use the heuristic: if the user has a username or email set.\n    var user = Meteor.user();\n    return user.username || (user.emails && user.emails[0] && user.emails[0].address);\n  }\n});\n\n\n//\n// loginButtonsLoggedOutDropdown template and related\n//\n\nTemplate._loginButtonsLoggedOutDropdown.events({\n  'click #login-buttons-password': function (event) {\n    event.preventDefault();\n    loginOrSignup();\n  },\n\n  'keypress #forgot-password-email': function (event) {\n    if (event.keyCode === 13)\n      forgotPassword();\n  },\n\n  'click #login-buttons-forgot-password': function () {\n    forgotPassword();\n  },\n\n  'click #signup-link': function () {\n    loginButtonsSession.resetMessages();\n\n    // store values of fields before swtiching to the signup form\n    var username = trimmedElementValueById('login-username');\n    var email = trimmedElementValueById('login-email');\n    var usernameOrEmail = trimmedElementValueById('login-username-or-email');\n    // notably not trimmed. a password could (?) start or end with a space\n    var password = elementValueById('login-password');\n\n    loginButtonsSession.set('inSignupFlow', true);\n    loginButtonsSession.set('inForgotPasswordFlow', false);\n    // force the ui to update so that we have the approprate fields to fill in\n    Tracker.flush();\n\n    // update new fields with appropriate defaults\n    if (username !== null)\n      document.getElementById('login-username').value = username;\n    else if (email !== null)\n      document.getElementById('login-email').value = email;\n    else if (usernameOrEmail !== null)\n      if (usernameOrEmail.indexOf('@') === -1)\n        document.getElementById('login-username').value = usernameOrEmail;\n    else\n      document.getElementById('login-email').value = usernameOrEmail;\n\n    if (password !== null)\n      document.getElementById('login-password').value = password;\n\n    // Force redrawing the `login-dropdown-list` element because of\n    // a bizarre Chrome bug in which part of the DIV is not redrawn\n    // in case you had tried to unsuccessfully log in before\n    // switching to the signup form.\n    //\n    // Found tip on how to force a redraw on\n    // http://stackoverflow.com/questions/3485365/how-can-i-force-webkit-to-redraw-repaint-to-propagate-style-changes/3485654#3485654\n    var redraw = document.getElementById('login-dropdown-list');\n    redraw.style.display = 'none';\n    redraw.offsetHeight; // it seems that this line does nothing but is necessary for the redraw to work\n    redraw.style.display = 'block';\n  },\n  'click #forgot-password-link': function () {\n    loginButtonsSession.resetMessages();\n\n    // store values of fields before swtiching to the signup form\n    var email = trimmedElementValueById('login-email');\n    var usernameOrEmail = trimmedElementValueById('login-username-or-email');\n\n    loginButtonsSession.set('inSignupFlow', false);\n    loginButtonsSession.set('inForgotPasswordFlow', true);\n    // force the ui to update so that we have the approprate fields to fill in\n    Tracker.flush();\n\n    // update new fields with appropriate defaults\n    if (email !== null)\n      document.getElementById('forgot-password-email').value = email;\n    else if (usernameOrEmail !== null)\n      if (usernameOrEmail.indexOf('@') !== -1)\n        document.getElementById('forgot-password-email').value = usernameOrEmail;\n\n  },\n  'click #back-to-login-link': function () {\n    loginButtonsSession.resetMessages();\n\n    var username = trimmedElementValueById('login-username');\n    var email = trimmedElementValueById('login-email')\n          || trimmedElementValueById('forgot-password-email'); // Ughh. Standardize on names?\n    // notably not trimmed. a password could (?) start or end with a space\n    var password = elementValueById('login-password');\n\n    loginButtonsSession.set('inSignupFlow', false);\n    loginButtonsSession.set('inForgotPasswordFlow', false);\n    // force the ui to update so that we have the approprate fields to fill in\n    Tracker.flush();\n\n    if (document.getElementById('login-username') && username !== null)\n      document.getElementById('login-username').value = username;\n    if (document.getElementById('login-email') && email !== null)\n      document.getElementById('login-email').value = email;\n\n    var usernameOrEmailInput = document.getElementById('login-username-or-email');\n    if (usernameOrEmailInput) {\n      if (email !== null)\n        usernameOrEmailInput.value = email;\n      if (username !== null)\n        usernameOrEmailInput.value = username;\n    }\n\n    if (password !== null)\n      document.getElementById('login-password').value = password;\n  },\n  'keypress #login-username, keypress #login-email, keypress #login-username-or-email, keypress #login-password, keypress #login-password-again': function (event) {\n    if (event.keyCode === 13)\n      loginOrSignup();\n  }\n});\n\nTemplate._loginButtonsLoggedOutDropdown.helpers({\n  // additional classes that can be helpful in styling the dropdown\n  additionalClasses: function () {\n    if (!hasPasswordService()) {\n      return false;\n    } else {\n      if (loginButtonsSession.get('inSignupFlow')) {\n        return 'login-form-create-account';\n      } else if (loginButtonsSession.get('inForgotPasswordFlow')) {\n        return 'login-form-forgot-password';\n      } else {\n        return 'login-form-sign-in';\n      }\n    }\n  },\n\n  dropdownVisible: function () {\n    return loginButtonsSession.get('dropdownVisible');\n  },\n\n  hasPasswordService: hasPasswordService\n});\n\n// return all login services, with password last\nTemplate._loginButtonsLoggedOutAllServices.helpers({\n  services: getLoginServices,\n\n  isPasswordService: function () {\n    return this.name === 'password';\n  },\n\n  hasOtherServices: function () {\n    return getLoginServices().length > 1;\n  },\n\n  hasPasswordService: hasPasswordService\n});\n\nTemplate._loginButtonsLoggedOutPasswordService.helpers({\n  fields: function () {\n    var loginFields = [\n      {fieldName: 'username-or-email', fieldLabel: 'Username or Email',\n       visible: function () {\n         return _.contains(\n           [\"USERNAME_AND_EMAIL\", \"USERNAME_AND_OPTIONAL_EMAIL\"],\n           passwordSignupFields());\n       }},\n      {fieldName: 'username', fieldLabel: 'Username',\n       visible: function () {\n         return passwordSignupFields() === \"USERNAME_ONLY\";\n       }},\n      {fieldName: 'email', fieldLabel: 'Email', inputType: 'email',\n       visible: function () {\n         return passwordSignupFields() === \"EMAIL_ONLY\";\n       }},\n      {fieldName: 'password', fieldLabel: 'Password', inputType: 'password',\n       visible: function () {\n         return true;\n       }}\n    ];\n\n    var signupFields = [\n      {fieldName: 'username', fieldLabel: 'Username',\n       visible: function () {\n         return _.contains(\n           [\"USERNAME_AND_EMAIL\", \"USERNAME_AND_OPTIONAL_EMAIL\", \"USERNAME_ONLY\"],\n           passwordSignupFields());\n       }},\n      {fieldName: 'email', fieldLabel: 'Email', inputType: 'email',\n       visible: function () {\n         return _.contains(\n           [\"USERNAME_AND_EMAIL\", \"EMAIL_ONLY\"],\n           passwordSignupFields());\n       }},\n      {fieldName: 'email', fieldLabel: 'Email (optional)', inputType: 'email',\n       visible: function () {\n         return passwordSignupFields() === \"USERNAME_AND_OPTIONAL_EMAIL\";\n       }},\n      {fieldName: 'password', fieldLabel: 'Password', inputType: 'password',\n       visible: function () {\n         return true;\n       }},\n      {fieldName: 'password-again', fieldLabel: 'Password (again)',\n       inputType: 'password',\n       visible: function () {\n         // No need to make users double-enter their password if\n         // they'll necessarily have an email set, since they can use\n         // the \"forgot password\" flow.\n         return _.contains(\n           [\"USERNAME_AND_OPTIONAL_EMAIL\", \"USERNAME_ONLY\"],\n           passwordSignupFields());\n       }}\n    ];\n\n    return loginButtonsSession.get('inSignupFlow') ? signupFields : loginFields;\n  },\n\n  inForgotPasswordFlow: function () {\n    return loginButtonsSession.get('inForgotPasswordFlow');\n  },\n\n  inLoginFlow: function () {\n    return !loginButtonsSession.get('inSignupFlow') && !loginButtonsSession.get('inForgotPasswordFlow');\n  },\n\n  inSignupFlow: function () {\n    return loginButtonsSession.get('inSignupFlow');\n  },\n\n  showCreateAccountLink: function () {\n    return !Accounts._options.forbidClientAccountCreation;\n  },\n\n  showForgotPasswordLink: function () {\n    return _.contains(\n      [\"USERNAME_AND_EMAIL\", \"USERNAME_AND_OPTIONAL_EMAIL\", \"EMAIL_ONLY\"],\n      passwordSignupFields());\n  }\n});\n\nTemplate._loginButtonsFormField.helpers({\n  inputType: function () {\n    return this.inputType || \"text\";\n  }\n});\n\n\n//\n// loginButtonsChangePassword template\n//\n\nTemplate._loginButtonsChangePassword.events({\n  'keypress #login-old-password, keypress #login-password, keypress #login-password-again': function (event) {\n    if (event.keyCode === 13)\n      changePassword();\n  },\n  'click #login-buttons-do-change-password': function () {\n    changePassword();\n  }\n});\n\nTemplate._loginButtonsChangePassword.helpers({\n  fields: function () {\n    return [\n      {fieldName: 'old-password', fieldLabel: 'Current Password', inputType: 'password',\n       visible: function () {\n         return true;\n       }},\n      {fieldName: 'password', fieldLabel: 'New Password', inputType: 'password',\n       visible: function () {\n         return true;\n       }},\n      {fieldName: 'password-again', fieldLabel: 'New Password (again)',\n       inputType: 'password',\n       visible: function () {\n         // No need to make users double-enter their password if\n         // they'll necessarily have an email set, since they can use\n         // the \"forgot password\" flow.\n         return _.contains(\n           [\"USERNAME_AND_OPTIONAL_EMAIL\", \"USERNAME_ONLY\"],\n           passwordSignupFields());\n       }}\n    ];\n  }\n});\n\n\n//\n// helpers\n//\n\nvar elementValueById = function(id) {\n  var element = document.getElementById(id);\n  if (!element)\n    return null;\n  else\n    return element.value;\n};\n\nvar trimmedElementValueById = function(id) {\n  var element = document.getElementById(id);\n  if (!element)\n    return null;\n  else\n    return element.value.replace(/^\\s*|\\s*$/g, \"\"); // trim() doesn't work on IE8;\n};\n\nvar loginOrSignup = function () {\n  if (loginButtonsSession.get('inSignupFlow'))\n    signup();\n  else\n    login();\n};\n\nvar login = function () {\n  loginButtonsSession.resetMessages();\n\n  var username = trimmedElementValueById('login-username');\n  var email = trimmedElementValueById('login-email');\n  var usernameOrEmail = trimmedElementValueById('login-username-or-email');\n  // notably not trimmed. a password could (?) start or end with a space\n  var password = elementValueById('login-password');\n\n  var loginSelector;\n  if (username !== null) {\n    if (!validateUsername(username))\n      return;\n    else\n      loginSelector = {username: username};\n  } else if (email !== null) {\n    if (!validateEmail(email))\n      return;\n    else\n      loginSelector = {email: email};\n  } else if (usernameOrEmail !== null) {\n    // XXX not sure how we should validate this. but this seems good enough (for now),\n    // since an email must have at least 3 characters anyways\n    if (!validateUsername(usernameOrEmail))\n      return;\n    else\n      loginSelector = usernameOrEmail;\n  } else {\n    throw new Error(\"Unexpected -- no element to use as a login user selector\");\n  }\n\n  Meteor.loginWithPassword(loginSelector, password, function (error, result) {\n    if (error) {\n      loginButtonsSession.errorMessage(error.reason || \"Unknown error\");\n    } else {\n      loginButtonsSession.closeDropdown();\n    }\n  });\n};\n\nvar signup = function () {\n  loginButtonsSession.resetMessages();\n\n  var options = {}; // to be passed to Accounts.createUser\n\n  var username = trimmedElementValueById('login-username');\n  if (username !== null) {\n    if (!validateUsername(username))\n      return;\n    else\n      options.username = username;\n  }\n\n  var email = trimmedElementValueById('login-email');\n  if (email !== null) {\n    if (!validateEmail(email))\n      return;\n    else\n      options.email = email;\n  }\n\n  // notably not trimmed. a password could (?) start or end with a space\n  var password = elementValueById('login-password');\n  if (!validatePassword(password))\n    return;\n  else\n    options.password = password;\n\n  if (!matchPasswordAgainIfPresent())\n    return;\n\n  Accounts.createUser(options, function (error) {\n    if (error) {\n      loginButtonsSession.errorMessage(error.reason || \"Unknown error\");\n    } else {\n      loginButtonsSession.closeDropdown();\n    }\n  });\n};\n\nvar forgotPassword = function () {\n  loginButtonsSession.resetMessages();\n\n  var email = trimmedElementValueById(\"forgot-password-email\");\n  if (email.indexOf('@') !== -1) {\n    Accounts.forgotPassword({email: email}, function (error) {\n      if (error)\n        loginButtonsSession.errorMessage(error.reason || \"Unknown error\");\n      else\n        loginButtonsSession.infoMessage(\"Email sent\");\n    });\n  } else {\n    loginButtonsSession.errorMessage(\"Invalid email\");\n  }\n};\n\nvar changePassword = function () {\n  loginButtonsSession.resetMessages();\n\n  // notably not trimmed. a password could (?) start or end with a space\n  var oldPassword = elementValueById('login-old-password');\n\n  // notably not trimmed. a password could (?) start or end with a space\n  var password = elementValueById('login-password');\n  if (!validatePassword(password))\n    return;\n\n  if (!matchPasswordAgainIfPresent())\n    return;\n\n  Accounts.changePassword(oldPassword, password, function (error) {\n    if (error) {\n      loginButtonsSession.errorMessage(error.reason || \"Unknown error\");\n    } else {\n      loginButtonsSession.set('inChangePasswordFlow', false);\n      loginButtonsSession.set('inMessageOnlyFlow', true);\n      loginButtonsSession.infoMessage(\"Password changed\");\n    }\n  });\n};\n\nvar matchPasswordAgainIfPresent = function () {\n  // notably not trimmed. a password could (?) start or end with a space\n  var passwordAgain = elementValueById('login-password-again');\n  if (passwordAgain !== null) {\n    // notably not trimmed. a password could (?) start or end with a space\n    var password = elementValueById('login-password');\n    if (password !== passwordAgain) {\n      loginButtonsSession.errorMessage(\"Passwords don't match\");\n      return false;\n    }\n  }\n  return true;\n};\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n\n\n\n\n(function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                     //\n// packages/accounts-ui-unstyled/login_buttons_dialogs.js                                                              //\n//                                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                       //\n// for convenience\nvar loginButtonsSession = Accounts._loginButtonsSession;\n\n// since we don't want to pass around the callback that we get from our event\n// handlers, we just make it a variable for the whole file\nvar doneCallback;\n\nAccounts.onResetPasswordLink(function (token, done) {\n  loginButtonsSession.set(\"resetPasswordToken\", token);\n  doneCallback = done;\n});\n\nAccounts.onEnrollmentLink(function (token, done) {\n  loginButtonsSession.set(\"enrollAccountToken\", token);\n  doneCallback = done;\n});\n\nAccounts.onEmailVerificationLink(function (token, done) {\n  Accounts.verifyEmail(token, function (error) {\n    if (! error) {\n      loginButtonsSession.set('justVerifiedEmail', true);\n    }\n\n    done();\n    // XXX show something if there was an error.\n  });\n});\n\n\n//\n// resetPasswordDialog template\n//\n\nTemplate._resetPasswordDialog.events({\n  'click #login-buttons-reset-password-button': function () {\n    resetPassword();\n  },\n  'keypress #reset-password-new-password': function (event) {\n    if (event.keyCode === 13)\n      resetPassword();\n  },\n  'click #login-buttons-cancel-reset-password': function () {\n    loginButtonsSession.set('resetPasswordToken', null);\n    if (doneCallback)\n      doneCallback();\n  }\n});\n\nvar resetPassword = function () {\n  loginButtonsSession.resetMessages();\n  var newPassword = document.getElementById('reset-password-new-password').value;\n  if (!validatePassword(newPassword))\n    return;\n\n  Accounts.resetPassword(\n    loginButtonsSession.get('resetPasswordToken'), newPassword,\n    function (error) {\n      if (error) {\n        loginButtonsSession.errorMessage(error.reason || \"Unknown error\");\n      } else {\n        loginButtonsSession.set('resetPasswordToken', null);\n        loginButtonsSession.set('justResetPassword', true);\n        if (doneCallback)\n          doneCallback();\n      }\n    });\n};\n\nTemplate._resetPasswordDialog.helpers({\n  inResetPasswordFlow: function () {\n    return loginButtonsSession.get('resetPasswordToken');\n  }\n});\n\n//\n// justResetPasswordDialog template\n//\n\nTemplate._justResetPasswordDialog.events({\n  'click #just-verified-dismiss-button': function () {\n    loginButtonsSession.set('justResetPassword', false);\n  }\n});\n\nTemplate._justResetPasswordDialog.helpers({\n  visible: function () {\n    return loginButtonsSession.get('justResetPassword');\n  },\n  displayName: displayName\n});\n\n\n\n//\n// enrollAccountDialog template\n//\n\nTemplate._enrollAccountDialog.events({\n  'click #login-buttons-enroll-account-button': function () {\n    enrollAccount();\n  },\n  'keypress #enroll-account-password': function (event) {\n    if (event.keyCode === 13)\n      enrollAccount();\n  },\n  'click #login-buttons-cancel-enroll-account': function () {\n    loginButtonsSession.set('enrollAccountToken', null);\n    if (doneCallback)\n      doneCallback();\n  }\n});\n\nvar enrollAccount = function () {\n  loginButtonsSession.resetMessages();\n  var password = document.getElementById('enroll-account-password').value;\n  if (!validatePassword(password))\n    return;\n\n  Accounts.resetPassword(\n    loginButtonsSession.get('enrollAccountToken'), password,\n    function (error) {\n      if (error) {\n        loginButtonsSession.errorMessage(error.reason || \"Unknown error\");\n      } else {\n        loginButtonsSession.set('enrollAccountToken', null);\n        if (doneCallback)\n          doneCallback();\n      }\n    });\n};\n\nTemplate._enrollAccountDialog.helpers({\n  inEnrollAccountFlow: function () {\n    return loginButtonsSession.get('enrollAccountToken');\n  }\n});\n\n\n//\n// justVerifiedEmailDialog template\n//\n\nTemplate._justVerifiedEmailDialog.events({\n  'click #just-verified-dismiss-button': function () {\n    loginButtonsSession.set('justVerifiedEmail', false);\n  }\n});\n\nTemplate._justVerifiedEmailDialog.helpers({\n  visible: function () {\n    return loginButtonsSession.get('justVerifiedEmail');\n  },\n  displayName: displayName\n});\n\n\n//\n// loginButtonsMessagesDialog template\n//\n\nTemplate._loginButtonsMessagesDialog.events({\n  'click #messages-dialog-dismiss-button': function () {\n    loginButtonsSession.resetMessages();\n  }\n});\n\nTemplate._loginButtonsMessagesDialog.helpers({\n  visible: function () {\n    var hasMessage = loginButtonsSession.get('infoMessage') || loginButtonsSession.get('errorMessage');\n    return !dropdown() && hasMessage;\n  }\n});\n\n\n//\n// configureLoginServiceDialog template\n//\n\nTemplate._configureLoginServiceDialog.events({\n  'click .configure-login-service-dismiss-button': function () {\n    loginButtonsSession.set('configureLoginServiceDialogVisible', false);\n  },\n  'click #configure-login-service-dialog-save-configuration': function () {\n    if (loginButtonsSession.get('configureLoginServiceDialogVisible') &&\n        ! loginButtonsSession.get('configureLoginServiceDialogSaveDisabled')) {\n      // Prepare the configuration document for this login service\n      var serviceName = loginButtonsSession.get('configureLoginServiceDialogServiceName');\n      var configuration = {\n        service: serviceName\n      };\n\n      // Fetch the value of each input field\n      _.each(configurationFields(), function(field) {\n        configuration[field.property] = document.getElementById(\n          'configure-login-service-dialog-' + field.property).value\n          .replace(/^\\s*|\\s*$/g, \"\"); // trim() doesnt work on IE8;\n      });\n\n      Array.prototype.some.call(\n        document.getElementById(\"configure-login-service-dialog\")\n          .getElementsByTagName(\"input\"),\n        function (input) {\n          if (input.getAttribute(\"name\") === \"loginStyle\" &&\n              input.checked) {\n            configuration.loginStyle = input.value;\n            return true;\n          }\n        }\n      );\n\n      // Configure this login service\n      Accounts.connection.call(\n        \"configureLoginService\", configuration, function (error, result) {\n          if (error)\n            Meteor._debug(\"Error configuring login service \" + serviceName,\n                          error);\n          else\n            loginButtonsSession.set('configureLoginServiceDialogVisible',\n                                    false);\n        });\n    }\n  },\n  // IE8 doesn't support the 'input' event, so we'll run this on the keyup as\n  // well. (Keeping the 'input' event means that this also fires when you use\n  // the mouse to change the contents of the field, eg 'Cut' menu item.)\n  'input, keyup input': function (event) {\n    // if the event fired on one of the configuration input fields,\n    // check whether we should enable the 'save configuration' button\n    if (event.target.id.indexOf('configure-login-service-dialog') === 0)\n      updateSaveDisabled();\n  }\n});\n\n// check whether the 'save configuration' button should be enabled.\n// this is a really strange way to implement this and a Forms\n// Abstraction would make all of this reactive, and simpler.\nvar updateSaveDisabled = function () {\n  var anyFieldEmpty = _.any(configurationFields(), function(field) {\n    return document.getElementById(\n      'configure-login-service-dialog-' + field.property).value === '';\n  });\n\n  loginButtonsSession.set('configureLoginServiceDialogSaveDisabled', anyFieldEmpty);\n};\n\n// Returns the appropriate template for this login service.  This\n// template should be defined in the service's package\nTemplate._configureLoginServiceDialog.templateForService = function(serviceName) {\n  serviceName = serviceName || loginButtonsSession.get('configureLoginServiceDialogServiceName');\n  // XXX Service providers should be able to specify their configuration\n  // template name.\n  return Template['configureLoginServiceDialogFor' +\n                  (serviceName === 'meteor-developer' ?\n                   'MeteorDeveloper' :\n                   capitalize(serviceName))];\n};\n\nvar configurationFields = function () {\n  var template = Template._configureLoginServiceDialog.templateForService();\n  return template.fields();\n};\n\nTemplate._configureLoginServiceDialog.helpers({\n  configurationFields: function () {\n    return configurationFields();\n  },\n  visible: function () {\n    return loginButtonsSession.get('configureLoginServiceDialogVisible');\n  },\n  configurationSteps: function () {\n    // renders the appropriate template\n    return Template._configureLoginServiceDialog.templateForService();\n  },\n  saveDisabled: function () {\n    return loginButtonsSession.get('configureLoginServiceDialogSaveDisabled');\n  }\n});\n\n// XXX from http://epeli.github.com/underscore.string/lib/underscore.string.js\nvar capitalize = function(str){\n  str = str == null ? '' : String(str);\n  return str.charAt(0).toUpperCase() + str.slice(1);\n};\n\nTemplate._configureLoginOnDesktopDialog.helpers({\n  visible: function () {\n    return loginButtonsSession.get('configureOnDesktopVisible');\n  }\n});\n\nTemplate._configureLoginOnDesktopDialog.events({\n  'click #configure-on-desktop-dismiss-button': function () {\n    loginButtonsSession.set('configureOnDesktopVisible', false);\n  }\n});\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n/* Exports */\nPackage._define(\"accounts-ui-unstyled\");\n\n})();\n","servePath":"/packages/accounts-ui-unstyled.js"}]