/**** Basic API test cases ****/

// assert success
curl --header "Content-Type: application/json" --request GET --data '{"email": "richardfmemory@gmail.com", "username": "rmemory", "firstName": "Richard", "lastName": "Memory", "password":"foobar"}' localhost:8888/api/v1

// assert fail (malformed JSON due to missing comma between password and confirm-password)
curl --header "Content-Type: application/json" --request GET --data '{"email": "richardfmemory@gmail.com", "username": "rmemory", "firstName": "Richard", "lastName": "Memory", "password":"foobar" "password-confirm":"barfoo"}' localhost:8888/api/v1

/**** Registration test cases ****/
// assert fail (missing confirm-password)
curl --header "Content-Type: application/json" --request GET --data '{"email": "richardfmemory@gmail.com", "username": "rmemory", "firstName": "Richard", "lastName": "Memory", "password":"foobar"}' localhost:8888/api/v1/register

// assert fail (incorrect confirm-password)
curl --header "Content-Type: application/json" --request GET --data '{"email": "richardfmemory@gmail.com", "username": "rmemory", "firstName": "Richard", "lastName": "Memory", "password":"foobar", "password-confirm":"barfoo"}' localhost:8888/api/v1/register

// assert success (user1, garbage JSON which is ignored; user successfully created)
curl --header "Content-Type: application/json" --request GET --data '{"email": "number1@gmail.com", "username": "number1", "firstName": "Number", "lastName": "One", "password":"foobar", "password-confirm":"foobar", "roles":["member"], "demographics":{"name":"Number One", "gender":"female"}, "goober":"booger"}' localhost:8888/api/v1/register

// assert success (user2)
curl --header "Content-Type: application/json" --request GET --data '{"email": "richardfmemory@gmail.com", "username": "rmemory", "firstName": "Richard", "lastName": "Memory", "password":"foobar", "password-confirm":"foobar", "roles":["member", "admin"], "demographics":{"name":"Richard Memory", "gender":"male"}}' localhost:8888/api/v1/register

// assert success (user3)
curl --header "Content-Type: application/json" --request GET --data '{"email": "johndoe@gmail.com", "username": "john", "firstName": "John", "lastName": "Doe", "password":"foobar", "password-confirm":"foobar", "roles":["member"], "demographics":{"name":"John Doe", "gender":"male"}}' localhost:8888/api/v1/register

// assert fail (duplicate of user1)
curl --header "Content-Type: application/json" --request GET --data '{"email": "richardfmemory@gmail.com", "username": "rmemory", "firstName": "Richard", "lastName": "Memory", "password":"foobar", "password-confirm":"foobar", "roles":["member", "admin"], "demographics":{"name":"Richard Memory", "gender":"male"}}' localhost:8888/api/v1/register

// assert success (user3)
curl --header "Content-Type: application/json" --request GET --data '{"email": "janedoe@gmail.com", "username": "jane", "firstName": "Jane", "lastName": "Doe", "password":"foobar", "password-confirm":"foobar", "roles":["member", "admin"], "demographics":{"name":"Jane Doe", "gender":"female"}}' localhost:8888/api/v1/register


/**** Login test cases ****/
// assert fail
curl --header "Content-Type: application/json" --request GET --cookie-jar ~/mycookie --data '{"username": "rmemory", "password": "wrongpassword"}' localhost:8888/api/v1/login

// assert success
curl --header "Content-Type: application/json" --request GET --cookie-jar ~/mycookie --data '{"username": "rmemory", "password": "foobar"}' localhost:8888/api/v1/login

// assert success (existing cookie/token should be ignored and replaced)
curl --header "Content-Type: application/json" --request GET --cookie-jar ~/mycookie --cookie ~/mycookie --data '{"username": "rmemory", "password": "foobar"}' localhost:8888/api/v1/login

curl --header "Content-Type: application/json" --request GET --cookie-jar ~/mycookie --cookie ~/mycookie --data '{"username": "jane", "password": "foobar"}' localhost:8888/api/v1/login

curl --header "Content-Type: application/json" --request GET --cookie-jar ~/mycookie --cookie ~/mycookie --data '{"username": "john", "password": "foobar"}' localhost:8888/api/v1/login


/* get user from username test cases */
// assert fail (missing cookie and token)
curl --header "Content-Type: application/json" --request GET localhost:8888/api/v1/user/rmemory

// assert fail (username doesn't exist)
curl --header "Content-Type: application/json" --request GET --cookie ~/mycookie localhost:8888/api/v1/user/wronguser

// assert success/fail (no cookie; go to https://jwt.io/, paste the token value returned by login, add APP_SECRET, encode, adjust timeout value, replace token below, make sure it fails)
curl --header "Content-Type: application/json" --request GET --data '{"token":""}' localhost:8888/api/v1/user/rmemory


// assert success (no cookie; paste token received from login)
curl --header "Content-Type: application/json" --request GET --data '{"token":""}' localhost:8888/api/v1/user/rmemory

// assert success-ish
curl --header "Content-Type: application/json" --request GET --cookie-jar ~/mycookie --cookie ~/mycookie --data '{"username": "jane", "password": "foobar"}' localhost:8888/api/v1/login
curl --header "Content-Type: application/json" --request GET --cookie ~/mycookie localhost:8888/api/v1/login localhost:8888/api/v1/user/rmemory
curl --header "Content-Type: application/json" --request GET --cookie ~/mycookie localhost:8888/api/v1/login localhost:8888/api/v1/user/jane
curl --header "Content-Type: application/json" --request GET --cookie ~/mycookie localhost:8888/api/v1/user/wronguser

curl --header "Content-Type: application/json" --request GET --cookie ~/mycookie localhost:8888/api/v1/users
